function _instanceof(n,w){if(null!=w&&"undefined"!=typeof Symbol&&w[Symbol.hasInstance])return!!w[Symbol.hasInstance](n);return n instanceof w}function _ts_generator(n,w){var k,C,_,A,T={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return A={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function verb(n){return function(w){return step([n,w])}}function step(A){if(k)throw new TypeError("Generator is already executing.");while(T)try{if(k=1,C&&(_=2&A[0]?C.return:A[0]?C.throw||((_=C.return)&&_.call(C),0):C.next)&&!(_=_.call(C,A[1])).done)return _;if(C=0,_)A=[2&A[0],_.value];switch(A[0]){case 0:case 1:_=A;break;case 4:T.label++;return{value:A[1],done:false};case 5:T.label++;C=A[1];A=[0];continue;case 7:A=T.ops.pop();T.trys.pop();continue;default:if(_=T.trys,!(_=_.length>0&&_[_.length-1])&&(6===A[0]||2===A[0])){T=0;continue}if(3===A[0]&&(!_||A[1]>_[0]&&A[1]<_[3])){T.label=A[1];break}if(6===A[0]&&T.label<_[1]){T.label=_[1];_=A;break}if(_&&T.label<_[2]){T.label=_[2];T.ops.push(A);break}if(_[2])T.ops.pop();T.trys.pop();continue}A=w.call(n,T)}catch(n){A=[6,n];C=0}finally{k=_=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:true}}}System.register("chunks:///main.js",["./renderCustomShareScore-23ac075a.js","cc"],function(){var n,w,k,C,_,A,T,I,L,O,D,M,N,z,B,F,x,U,G,H,V,q,W,K,j,Y,X,Z,J,Q,$,ee,et,en,ei,ea,er,eo,es,el,eu,eh,ep,ed,ey,ef,ev,eg,em,eb,ew,eS,ek,eC,eE,e_,eA,eT,eP,eR,eI,eL,eO,eD,eM,eN,ez,eB,eF,ex,eU,eG,eH,eV,eq,eW,eK,ej,eY,eX,eZ,eJ,eQ,e$,e0,e1,e2,e4,e3,e5,e6,e8,e9,e7,te,tt,tn,ti,ta,tr,to,ts,tl,tu,tc,th,tp,td,ty,tf,tv,tg,tm,tb,tw,tS;return{setters:[function(ew){n=ew._,w=ew.a,k=ew.b,C=ew.c,_=ew.d,A=ew.e,T=ew.f,I=ew.g,L=ew.h,O=ew.i,D=ew.j,M=ew.k,N=ew.A,z=ew.C,B=ew.G,F=ew.l,x=ew.m,U=ew.n,G=ew.o,H=ew.p,V=ew.q,q=ew.r,W=ew.L,K=ew.s,j=ew.t,Y=ew.u,X=ew.I,Z=ew.v,J=ew.w,Q=ew.T,$=ew.R,ee=ew.E,et=ew.x,en=ew.S,ei=ew.y,ea=ew.z,er=ew.B,eo=ew.D,es=ew.F,el=ew.H,eu=ew.J,eh=ew.K,ep=ew.M,ed=ew.N,ey=ew.O,ef=ew.P,ev=ew.Q,eg=ew.U,em=ew.V,eb=ew.W},function(n){ew=n.cclegacy,eS=n._decorator,ek=n.Node,eC=n.Color,eE=n.Canvas,e_=n.UITransform,eA=n.instantiate,eT=n.Label,eP=n.RichText,eR=n.Toggle,eI=n.Button,eL=n.director,eO=n.Component,eD=n.CCInteger,eM=n.CCFloat,eN=n.Widget,ez=n.tween,eB=n.Layout,eF=n.ccenum,ex=n.Sprite,eU=n.Enum,eG=n.easing,eH=n.UIOpacity,eV=n.EventHandler,eq=n.animation,eW=n.CCBoolean,eK=n.Input,ej=n.Graphics,eY=n.game,eX=n.profiler,eZ=n.sys,eJ=n.EventTarget,eQ=n.Vec3,e$=n.ParticleSystem2D,e0=n.math,e1=n.View,e2=n.ProgressBar,e4=n.Vec2,e3=n.CCString,e5=n.Director,e6=n.Layers,e8=n.randomRangeInt,e9=n.SpriteFrame,e7=n.Animation,te=n.pseudoRandomRangeInt,tt=n.pseudoRandom,tn=n.randomRange,ti=n.Pool,ta=n.Prefab,tr=n.find,to=n.repeat,ts=n.lerp,tl=n.approx,tu=n.EPSILON,tc=n.RealCurve,th=n.Gradient,tp=n.bits,td=n.random,ty=n.Material,tf=n.toRadian,tv=n.HorizontalTextAlignment,tg=n.Tween,tm=n.AnimationClip,tb=n.ScrollView,tw=n.NodeEventType,tS=n.Mask}],execute:function(){var tk,tC,tE,t_,tA,tT,tP,tR;ew._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var tI,tL,tO,tD,tM,tN,tz,tB,tF,tx,tU,tG,tH,tV,tq,tW,tK,tj,tY,tX,tZ=eS.ccclass,tJ=eS.property;tk=tZ("internal.DebugViewRuntimeControl"),tC=tJ(ek),tE=tJ(ek),t_=tJ(ek),tk((tT=n((tA=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"compositeModeToggle",tT,A(n)),_(n,"singleModeToggle",tP,A(n)),_(n,"EnableAllCompositeModeButton",tR,A(n)),n._single=0,n.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],n.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],n.strMisc=["CSM Layer Coloration","Lighting With Albedo"],n.compositeModeToggleList=[],n.singleModeToggleList=[],n.miscModeToggleList=[],n.textComponentList=[],n.labelComponentList=[],n.textContentList=[],n._currentColorIndex=0,n.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],n.color=[eC.WHITE,eC.BLACK,eC.RED,eC.GREEN,eC.BLUE],n}return T(s,[{key:"start",value:function(){if(this.node.parent.getComponent(eE)){var n=this.node.parent.getComponent(e_),w=.5*n.width,k=.5*n.height,C=.1*w-w,_=k-.1*k,A=this.node.getChildByName("MiscMode"),T=eA(A);T.parent=this.node,T.name="Buttons";var I=eA(A);I.parent=this.node,I.name="Titles";for(var L=0;L<2;L++){var O=eA(this.EnableAllCompositeModeButton.getChildByName("Label"));O.setPosition(C+(L>0?450:150),_,0),O.setScale(.75,.75,.75),O.parent=I;var D=O.getComponent(eT);D.string=L?"----------Composite Mode----------":"----------Single Mode----------",D.color=eC.WHITE,D.overflow=0,this.labelComponentList[this.labelComponentList.length]=D}_-=20;for(var M=0,N=0;N<this.strSingle.length;N++,M++){N===this.strSingle.length>>1&&(C+=200,M=0);var z=N?eA(this.singleModeToggle):this.singleModeToggle;z.setPosition(C,_-20*M,0),z.setScale(.5,.5,.5),z.parent=this.singleModeToggle.parent;var B=z.getComponentInChildren(eP);B.string=this.strSingle[N],this.textComponentList[this.textComponentList.length]=B,this.textContentList[this.textContentList.length]=B.string,z.on(eR.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[N]=z}C+=200,this.EnableAllCompositeModeButton.setPosition(C+15,_,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(eI.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=T;var F=this.EnableAllCompositeModeButton.getComponentInChildren(eT);this.labelComponentList[this.labelComponentList.length]=F;var x=eA(this.EnableAllCompositeModeButton);x.setPosition(C+90,_,0),x.setScale(.5,.5,.5),x.on(eI.EventType.CLICK,this.changeTextColor,this),x.parent=T,(F=x.getComponentInChildren(eT)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=F;var U=eA(this.EnableAllCompositeModeButton);U.setPosition(C+200,_,0),U.setScale(.5,.5,.5),U.on(eI.EventType.CLICK,this.hideUI,this),U.parent=this.node.parent,(F=U.getComponentInChildren(eT)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=F,this.hideButtonLabel=F,_-=40;for(var G=0;G<this.strMisc.length;G++){var H=eA(this.compositeModeToggle);H.setPosition(C,_-20*G,0),H.setScale(.5,.5,.5),H.parent=A;var V=H.getComponentInChildren(eP);V.string=this.strMisc[G],this.textComponentList[this.textComponentList.length]=V,this.textContentList[this.textContentList.length]=V.string,H.getComponent(eR).isChecked=!!G,H.on(eR.EventType.TOGGLE,G?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[G]=H}_-=150;for(var q=0;q<this.strComposite.length;q++){var W=q?eA(this.compositeModeToggle):this.compositeModeToggle;W.setPosition(C,_-20*q,0),W.setScale(.5,.5,.5),W.parent=this.compositeModeToggle.parent;var K=W.getComponentInChildren(eP);K.string=this.strComposite[q],this.textComponentList[this.textComponentList.length]=K,this.textContentList[this.textContentList.length]=K.string,W.on(eR.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[q]=W}}else console.error("debug-view-runtime-control should be child of Canvas")}},{key:"isTextMatched",value:function(n,w){var k=new String(n),C=k.search(">");return -1===C?n===w:(k=(k=k.substr(C+1)).substr(0,k.search("<")))===w}},{key:"toggleSingleMode",value:function(n){for(var w=eL.root.debugView,k=n.getComponentInChildren(eP),C=0;C<this.strSingle.length;C++)this.isTextMatched(k.string,this.strSingle[C])&&(w.singleMode=C)}},{key:"toggleCompositeMode",value:function(n){for(var w=eL.root.debugView,k=n.getComponentInChildren(eP),C=0;C<this.strComposite.length;C++)this.isTextMatched(k.string,this.strComposite[C])&&w.enableCompositeMode(C,n.isChecked)}},{key:"toggleLightingWithAlbedo",value:function(n){eL.root.debugView.lightingWithAlbedo=n.isChecked}},{key:"toggleCSMColoration",value:function(n){eL.root.debugView.csmLayerColoration=n.isChecked}},{key:"enableAllCompositeMode",value:function(n){var w=eL.root.debugView;w.enableAllCompositeMode(!0);for(var k=0;k<this.compositeModeToggleList.length;k++)this.compositeModeToggleList[k].getComponent(eR).isChecked=!0;var C=this.miscModeToggleList[0].getComponent(eR);C.isChecked=!1,w.csmLayerColoration=!1,(C=this.miscModeToggleList[1].getComponent(eR)).isChecked=!0,w.lightingWithAlbedo=!0}},{key:"hideUI",value:function(n){var w=this.node.getChildByName("Titles"),k=!w.active;this.singleModeToggleList[0].parent.active=k,this.miscModeToggleList[0].parent.active=k,this.compositeModeToggleList[0].parent.active=k,this.EnableAllCompositeModeButton.parent.active=k,w.active=k,this.hideButtonLabel.string=k?"Hide UI":"Show UI"}},{key:"changeTextColor",value:function(n){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var w=0;w<this.textComponentList.length;w++)this.textComponentList[w].string=this.strColor[this._currentColorIndex]+this.textContentList[w]+"</color>";for(var k=0;k<this.labelComponentList.length;k++)this.labelComponentList[k].color=this.color[this._currentColorIndex]}},{key:"onLoad",value:function(){}},{key:"update",value:function(n){}}]),s}(eO)).prototype,"compositeModeToggle",[tC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tP=n(tA.prototype,"singleModeToggle",[tE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tR=n(tA.prototype,"EnableAllCompositeModeButton",[t_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tA));ew._RF.pop(),ew._RF.push({},"84a2dB5IaRJ8JB+n9yXfBc7","AutoLayout",void 0);var tQ=eS.ccclass,t$=eS.property,t0=(tI=tQ("AutoLayoutWrappee"),tL=t$({type:e_}),tO=t$({type:e_}),tI((tN=n((tM=T(function e(){C(this,e),_(this,"wrapeeContainer",tN,this),_(this,"wrapee",tz,this)})).prototype,"wrapeeContainer",[tL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tz=n(tM.prototype,"wrapee",[tO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tD=tM))||tD),t1=(tB=tQ("AutoLayout"),tF=t$({displayName:"Use Auto Layout"}),tx=t$({type:[t0],displayName:"Children",visible:function(){return this.useAutoLayout}}),tU=t$({visible:!1,serializable:!0}),tG=t$({type:eD,displayName:"Selected Index",visible:function(){return this.useAutoLayout}}),tH=t$({type:eM,displayName:"Deselected Icon Width",group:"Edge Icons",visible:function(){return this.useAutoLayout}}),tV=t$({visible:!1,serializable:!0}),tB((tK=n((tW=function(n){w(f,n);var z,B=k(f);function f(){var n;C(this,f);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"useAutoLayout",tK,A(n)),_(n,"children",tj,A(n)),n.mappedChildren=[],_(n,"selected",tY,A(n)),_(n,"deselectedIconW",tX,A(n)),n.tweens=[],n}return T(f,[{key:"selectedIndex",get:function(){return this.selected},set:function(n){this.selected=n,this.updateLayout(!0)}},{key:"deselectedIconWidth",get:function(){return this.deselectedIconW},set:function(n){this.deselectedIconW=n,this.updateLayout(!0)}},{key:"__preload",value:function(){this.mappedChildren=this.children.map(function(n){var w=n.wrapeeContainer.getComponent(eN);if(!w)throw new Error("AutoLayout: Widget component not found");return I(I({},n),{},{wrapeeContainerWidget:w})})}},{key:"updateLayout",value:function(n){var w=arguments.length>0&&void 0!==n&&n;if(this._layoutDirty||w){this.updateChildrenAnchors();var k,C=L(this.mappedChildren);try{for(C.s();!(k=C.n()).done;){var _=k.value;_.wrapeeContainerWidget.updateAlignment()}}catch(n){C.e(n)}finally{C.f()}}O(D(f.prototype),"updateLayout",this).call(this,w)}},{key:"getSelectedWorldX",value:function(){var n=this.mappedChildren[this.selectedIndex].wrapeeContainer;return 0===this.selectedIndex||this.selectedIndex===this.children.length-1?n.getBoundingBoxToWorld().xMin+this.getAnchorX(this.selectedIndex)*n.width:n.getBoundingBoxToWorld().center.x}},{key:"getAnchorX",value:function(n){if(n<this.selectedIndex)return 0;if(n>this.selectedIndex)return 1;if(0===n){var w=this.mappedChildren[n].wrapeeContainer.width,k=this.deselectedIconWidth/2,C=this.paddingLeft;return((C+w+(w-k+this.spacingX))/2-C)/w}if(n===this.children.length-1){var _=this.mappedChildren[n].wrapeeContainer.width,A=_-this.deselectedIconWidth/2+this.spacingX;return((A+_+this.paddingRight)/2-A)/_}return .5}},{key:"updateChildrenAnchors",value:(z=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:w=this,k=L(this.tweens);try{for(k.s();!(n=k.n()).done;)n.value.stop()}catch(n){k.e(n)}finally{k.f()}this.tweens=[];return[4,Promise.all([this.children.flatMap(function(n,k){return w.getChildrenAnchorsTweens(n,w.getAnchorX(k))}).map(function(n){return N.runTweenAsync(n)})])];case 1:C.sent();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"updateChildrenAnchorsEditor",value:function(){var n=this;this.children.forEach(function(w,k){var C=n.getAnchorX(k);w.wrapee.setAnchorPoint(C,w.wrapee.anchorY),w.wrapeeContainer.setAnchorPoint(C,w.wrapeeContainer.anchorY)})}},{key:"getChildrenAnchorsTweens",value:function(n,w){return[ez(n.wrapee).to(.3,{anchorX:w},{easing:"sineInOut"}).call(function(){n.wrapee.setAnchorPoint(w,n.wrapee.anchorY)}),ez(n.wrapeeContainer).to(.3,{anchorX:w},{easing:"sineInOut"}).call(function(){n.wrapeeContainer.setAnchorPoint(w,n.wrapeeContainer.anchorY)})]}}]),f}(eB)).prototype,"useAutoLayout",[tF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),tj=n(tW.prototype,"children",[tx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tY=n(tW.prototype,"selected",[tU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n(tW.prototype,"selectedIndex",[tG],Object.getOwnPropertyDescriptor(tW.prototype,"selectedIndex"),tW.prototype),n(tW.prototype,"deselectedIconWidth",[tH],Object.getOwnPropertyDescriptor(tW.prototype,"deselectedIconWidth"),tW.prototype),tX=n(tW.prototype,"deselectedIconW",[tV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),tq=tW))||tq);ew._RF.pop(),ew._RF.push({},"bf320amyc1I86bS3oK0M9NR","DashboardEvents",void 0);var t2="STARS_UPDATED",t4="PLAY_BUTTON_PRESS",t3="REQUEST_NAVIGATION",t5="REQUEST_NAVIGATION_ANIMATION",t6="DASHBOARD_EVENTS_BUTTON_PRESS";ew._RF.pop(),ew._RF.push({},"68b8bf0Va5JT7NVPECDNC5l","DashboardScreens",void 0);var t8,t9,t7,ne,nt,nn,ni,na,nr,no,ns,nl,nh,np,nd,ny,nf,nv,ng,nm,nb,nw,nS,nk=function(n){return n[n.store=0]="store",n[n.collections=1]="collections",n[n.home=2]="home",n[n.leaderboard=3]="leaderboard",n[n.tournaments=4]="tournaments",n}(nk||{});eF(nk),ew._RF.pop(),ew._RF.push({},"ab9cd/wERRKYqhDoYtJ1L3w","MultiBackground",void 0);var nC=eS.ccclass,nE=eS.property,n_=globalThis.game.monitorError,nA=GameCore.Utils.Number,nT=(t8=nC("MultiBackground"),t9=nE({type:ex}),t7=nE({type:ex}),ne=nE({type:e_}),nt=nE({type:e_}),nn=nE({type:e_}),ni=nE(eD),na=nE(eN),nr=nE({type:eU(nk)}),no=nE({type:eU(nk)}),ns=z.onlyRunInLifeCycleAsync,nl=z.onlyRunInLifeCycle,t8((nd=n((np=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"background1",nd,A(n)),_(n,"background2",ny,A(n)),_(n,"screenUiTransform",nf,A(n)),_(n,"background1UiTransform",nv,A(n)),_(n,"background2UiTransform",ng,A(n)),_(n,"backgroundNudgeAmount",nm,A(n)),_(n,"nudgeableWidget",nb,A(n)),_(n,"pageOrder",nw,A(n)),_(n,"homePage",nS,A(n)),n.currentThemeId="",n.tryNudgeBackground=function(w){var k=w.to,C=n.getDirection(n.homePage,k),_=nA.sign(C),A=Math.abs(C),T=n.backgroundNudgeAmount*A,I=Math.min(n.background1UiTransform.width,n.background2UiTransform.width),L=Math.max(0,(I-n.screenUiTransform.width)/2),O=Math.min(L,T)*_;ez(n.nudgeableWidget).to(.5,{horizontalCenter:O},{easing:eG.cubicInOut}).start()},n}return T(c,[{key:"onLoad",value:function(){this.currentBackground=this.background1,this.nextBackground=this.background2,z.lazyValidateProperties(this),this.listenToNavigationEvents()}},{key:"onDestroy",value:function(){var n;null===(n=this.tweenSignal)||void 0===n||n.abort(),this.unlistenToNavigationEvents()}},{key:"listenToNavigationEvents",value:function(){this.node.scene.on(t5,this.tryNudgeBackground)}},{key:"unlistenToNavigationEvents",value:function(){this.node.scene.off(t5,this.tryNudgeBackground)}},{key:"getDirection",value:function(n,w){var k=this.pageOrder.indexOf(n),C=this.pageOrder.indexOf(w);return -1===k||-1===C?(null==n_||n_.sendException(new Error("MultiBackground.getDirection: fromIndex or toIndex is -1")),0):k-C}},{key:"setCurrentTheme",value:(L=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:return[4,B.loadThemeAsync(n)];case 1:w=k.sent();w?this.updateBackgroundSprites(w,n):null==n_||n_.sendException(new Error("MultiBackground.setCurrentTheme: Failed to load theme ".concat(n,"'s sprite.")));return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"updateBackgroundSprites",value:function(n,w){n.packable=!1,this.background1.spriteFrame=n,this.background2.spriteFrame=n,this.currentThemeId=w}},{key:"animateToNextTheme",value:(I=M(function(n){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:if(this.currentThemeId===n)return[2,Promise.resolve()];return[4,B.loadThemeAsync(n)];case 1:k=A.sent();if(!k)return[3,3];k.packable=!1,this.currentThemeId=n,this.nextBackground.node.active=!0,this.nextBackground.spriteFrame=k,this.nextBackground.node.setSiblingIndex(1);C=this.nextBackground.getComponent(eH);if(!C)throw new Error("".concat(this.nextBackground.node.name," UIOpacity is required"));C.opacity=0,null===(w=this.tweenSignal)||void 0===w||w.abort(),this.tweenSignal=new F;return[4,N.runTweenAsync(ez(C).to(1,{opacity:255}),this.tweenSignal)];case 2:if(A.sent(),!this.tweenSignal.aborted){this.currentBackground.node.active=!1;_=this.currentBackground;this.currentBackground=this.nextBackground,this.nextBackground=_}return[3,4];case 3:null==n_||n_.sendException(new Error("MultiBackground.animateToNextTheme: Failed to load theme ".concat(n,"'s sprite.")));A.label=4;case 4:return[2]}})}),function(n){return I.apply(this,arguments)})}]),c}(eO)).prototype,"background1",[t9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ny=n(np.prototype,"background2",[t7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nf=n(np.prototype,"screenUiTransform",[ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nv=n(np.prototype,"background1UiTransform",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ng=n(np.prototype,"background2UiTransform",[nn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nm=n(np.prototype,"backgroundNudgeAmount",[ni],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),nb=n(np.prototype,"nudgeableWidget",[na],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nw=n(np.prototype,"pageOrder",[nr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nS=n(np.prototype,"homePage",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return nk.home}}),n(np.prototype,"setCurrentTheme",[ns],Object.getOwnPropertyDescriptor(np.prototype,"setCurrentTheme"),np.prototype),n(np.prototype,"updateBackgroundSprites",[nl],Object.getOwnPropertyDescriptor(np.prototype,"updateBackgroundSprites"),np.prototype),nh=np))||nh);ew._RF.pop(),ew._RF.push({},"d159egaUVVLHKLg1UL865ub","SoundKeys",void 0);var nP="musics/",nR="sounds/",nI=GameCore.Utils.Object,nL={BUTTON_CLICK:"".concat(nR,"use_item_click"),BOMB_DEFUSE:"".concat(nR,"bomb_defuse"),BOMB_EXPLODE_1:"".concat(nR,"bomb_explode_1"),BOMB_EXPLODE_2:"".concat(nR,"bomb_explode_2"),CLICKS:"".concat(nR,"clicks"),CLOSE_POPUP_CLICK:"".concat(nR,"close_popup_click"),COLLECT_STARS:"".concat(nR,"collect_stars"),COMBO_1:"".concat(nR,"combo_1"),COMBO_2:"".concat(nR,"combo_2"),COMBO_3:"".concat(nR,"combo_3"),COMBO_4:"".concat(nR,"combo_4"),COMBO_5:"".concat(nR,"combo_5"),DAILY_REWARD:"".concat(nR,"daily_reward"),EXTRA_TIME_SPAWN:"".concat(nR,"extra_time_spawn"),GIFT_CHARGE:"".concat(nR,"gift_charge"),GIFT_EXPLODE:"".concat(nR,"gift_explode"),GIFT_REVEAL:"".concat(nR,"gift_reveal"),HINT_ITEM:"".concat(nR,"hint_item"),INVALID_MATCH:"".concat(nR,"invalid_match"),LEVEL_COMPLETE:"".concat(nR,"level_complete"),LEVEL_FAIL:"".concat(nR,"level_fail"),LEVEL_START:"".concat(nR,"level_start"),PROGRESS_STAR:"".concat(nR,"progress_star"),RESCUE_TIMER:"".concat(nR,"rescue_timer"),ROCKET_FLY:"".concat(nR,"rocket_fly"),SHUFFLE_ITEM:"".concat(nR,"shuffle_item"),THREE_STARS:"".concat(nR,"three_stars"),TICKING_BOMB_BEFORE_EXPLODE:"".concat(nR,"ticking_bomb_before_explode"),TILE_SELECT:"".concat(nR,"tile_select"),USE_ITEM_CLICK:"".concat(nR,"use_item_click"),BG_MUSIC:"".concat(nP,"bg_music"),PATCH_SHIFT:"".concat(nR,"patch_shift"),THUNDERBOLT:"".concat(nR,"thunderbolt"),WIND:"".concat(nR,"wind"),COLLECT_COINS:"".concat(nR,"collect_coins"),COLLECT_STOCK_COINS:"".concat(nR,"collect_stock_coins"),LEVEL_FAIL_TIMEOUT:"".concat(nR,"level_fail_timeout"),STAR_CHEST_DRUM_ROLL:"".concat(nR,"star_chest_drum_roll"),STAR_CHEST_OPEN:"".concat(nR,"star_chest_open"),LEADERBOARD_TRIUMPH:"".concat(nR,"leaderboard_triumph"),ITEM_REWARD:"".concat(nR,"item_reward"),COMBO_6:"".concat(nR,"combo_6"),COMBO_7:"".concat(nR,"combo_7"),COMBO_8:"".concat(nR,"combo_8"),COMBO_9:"".concat(nR,"combo_9"),COMBO_10:"".concat(nR,"combo_10"),COMBO_11:"".concat(nR,"combo_11"),COMBO_12:"".concat(nR,"combo_12"),COMBO_13:"".concat(nR,"combo_13"),TILE_MATCH:"".concat(nR,"tile_match"),TOURNAMENT_MUSIC:"".concat(nP,"tournament_music")},nO=nI.vals(nL),nD=nO.reduce(function(n,w,k){return n[w]=k,n},{});eF(nD);var nM,nN,nz,nB,nF,nx,nU,nG,nH,nV,nq,nW,nK,nj,nY,nX,nZ,nJ,nQ,n$,n0,n1,n2,n4,n3,n5,n6,n8,n9,n7,ie,it,ii,ia,ir,io=nO;ew._RF.pop(),ew._RF.push({},"ef63ctZn6BPAout9ufUgFVq","ExtendedButton",void 0);var is,il,iu,ic,ih=eS.ccclass,ip=eS.property,id=eS.disallowMultiple,iy=eS.executionOrder,iv=globalThis.game.analytics,ig=GameCore.Plugins.Analytics.Events,im=(nM=ih("ExtendedButton"),nN=iy(111),nz=ip(eV),nB=ip(eV),nF=ip(eq.AnimationController),nx=ip({override:!0,visible:!1}),nU=ip({override:!0,visible:!1}),nG=ip({override:!0,visible:!1}),nH=ip({override:!0,visible:!1}),nV=ip({override:!0,visible:!1}),nq=ip({override:!0,visible:!1}),nW=ip({override:!0,visible:!1}),nK=ip({override:!0,visible:!1}),nj=ip({override:!0,visible:!1}),nY=ip({override:!0,visible:!1}),nX=ip({override:!0,visible:!1}),nZ=ip(eW),nJ=ip(eW),nQ=ip(eW),n$=ip({visible:function(){return this.makeSound},type:nD}),n0=ip({tooltip:"Add a delay after click to prevent spamming (not apply for cancel click)"}),n1=ip({visible:function(){return this.disableSpamClick},tooltip:"Delay time in seconds"}),n2=ip({}),nM(n4=id(n4=nN((n5=n((n3=function(n){w(h,n);var I=k(h);function h(){var n;C(this,h);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"clickStartEvents",n5,A(n)),_(n,"clickEndEvents",n6,A(n)),_(n,"animationController",n8,A(n)),_(n,"useDesktopHover",n9,A(n)),_(n,"emitAnalyticsEvents",n7,A(n)),_(n,"makeSound",ie,A(n)),_(n,"soundKey",it,A(n)),_(n,"disableSpamClick",ii,A(n)),_(n,"disableSpamDelay",ia,A(n)),_(n,"isScrollViewCancelInnerEvents",ir,A(n)),n.currentClickBoundingBox=null,n.hasDown=!1,n.hasUp=!1,n.hasFinishClickCycle=!1,n.onTouchStart=function(w){n.interactable&&(n.hasDown||(n.currentClickBoundingBox=x.getBoundingBoxToWorld(n.node),n.handleDown(w)))},n.onTouchEnd=function(w){n.scheduleOnce(function(){n.interactable&&n.hasDown&&(n.hasUp||n.handleUp(w))},0)},n.onTouchCancel=function(w){if(n.interactable&&n.hasDown&&!n.hasUp){if(!n.isScrollViewCancelInnerEvents){var k,C,_=w.getUILocation();if(null!==(k=null===(C=n.currentClickBoundingBox)||void 0===C?void 0:C.contains(_))&&void 0!==k&&k)return void n.handleUp(w)}n.hasUp=!0,n.hasFinishClickCycle=!0,n.handleResetButtonState(),n.emitClickEndEvents(w)}},n.onMouseEnter=function(w){n.useDesktopHover&&n.interactable&&(n.hasDown||(n.hasFinishClickCycle=!1,n.setAnimationState("HOVER")))},n.onMouseLeave=function(w){n.useDesktopHover&&n.interactable&&(n.hasDown||n.hasUp||n.hasFinishClickCycle||n.handleResetButtonState())},n.handleResetButtonState=function(){n.hasDown=!1,n.hasUp=!1,n.setAnimationState("RESET")},n}return T(h,[{key:"transition",get:function(){return eI.Transition.NONE},set:function(n){U(D(h.prototype),"transition",eI.Transition.NONE,this,!0)}},{key:"normalColor",get:function(){return O(D(h.prototype),"normalColor",this)},set:function(n){U(D(h.prototype),"normalColor",n,this,!0)}},{key:"pressedColor",get:function(){return O(D(h.prototype),"pressedColor",this)},set:function(n){U(D(h.prototype),"pressedColor",n,this,!0)}},{key:"hoverColor",get:function(){return O(D(h.prototype),"hoverColor",this)},set:function(n){U(D(h.prototype),"hoverColor",n,this,!0)}},{key:"disabledColor",get:function(){return O(D(h.prototype),"disabledColor",this)},set:function(n){U(D(h.prototype),"disabledColor",n,this,!0)}},{key:"normalSprite",get:function(){return O(D(h.prototype),"normalSprite",this)},set:function(n){U(D(h.prototype),"normalSprite",n,this,!0)}},{key:"pressedSprite",get:function(){return O(D(h.prototype),"pressedSprite",this)},set:function(n){U(D(h.prototype),"pressedSprite",n,this,!0)}},{key:"hoverSprite",get:function(){return O(D(h.prototype),"hoverSprite",this)},set:function(n){U(D(h.prototype),"hoverSprite",n,this,!0)}},{key:"disabledSprite",get:function(){return O(D(h.prototype),"disabledSprite",this)},set:function(n){U(D(h.prototype),"disabledSprite",n,this,!0)}},{key:"duration",get:function(){return O(D(h.prototype),"duration",this)},set:function(n){U(D(h.prototype),"duration",n,this,!0)}},{key:"zoomScale",get:function(){return O(D(h.prototype),"zoomScale",this)},set:function(n){U(D(h.prototype),"zoomScale",n,this,!0)}},{key:"__preload",value:function(){O(D(h.prototype),"__preload",this).call(this),z.lazyValidateProperties(this)}},{key:"onDestroy",value:function(){var n;null===(n=O(D(h.prototype),"onDestroy",this))||void 0===n||n.call(this)}},{key:"onEnable",value:function(){var n;null===(n=O(D(h.prototype),"onEnable",this))||void 0===n||n.call(this),this.node.off(eK.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(ek.EventType.TOUCH_START,this.onTouchStart),this.node.on(ek.EventType.TOUCH_END,this.onTouchEnd),this.node.on(ek.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.on(ek.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(ek.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){var n;null===(n=O(D(h.prototype),"onDisable",this))||void 0===n||n.call(this),this.node.off(ek.EventType.TOUCH_START,this.onTouchStart),this.node.off(ek.EventType.TOUCH_END,this.onTouchEnd),this.node.off(ek.EventType.TOUCH_CANCEL,this.onTouchCancel),this.node.off(ek.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(ek.EventType.MOUSE_LEAVE,this.onMouseLeave),this.unschedule(this.handleResetButtonState),this.handleResetButtonState()}},{key:"handleDown",value:function(n){this.hasDown=!0,this.setAnimationState("DOWN"),this.makeSound&&G.playSound(io[this.soundKey]),this.emitClickStartEvents(n)}},{key:"emitClickStartEvents",value:function(n){var w,k=L(this.clickStartEvents);try{for(k.s();!(w=k.n()).done;){var C=w.value;C.emit([n,C.customEventData])}}catch(n){k.e(n)}finally{k.f()}}},{key:"emitClickEndEvents",value:function(n){var w,k=L(this.clickEndEvents);try{for(k.s();!(w=k.n()).done;){var C=w.value;C.emit([n,C.customEventData])}}catch(n){k.e(n)}finally{k.f()}}},{key:"handleUp",value:function(n){this.hasUp=!0,this.hasFinishClickCycle=!0,this.setAnimationState("RESET"),this.disableSpamClick?this.scheduleOnce(this.handleResetButtonState,this.disableSpamDelay):this.handleResetButtonState(),this.emitButtonEvents(n),this.emitClickEndEvents(n)}},{key:"emitButtonEvents",value:function(n){if(this.interactable){this.emitAnalyticsEvents&&iv.event(ig.BUTTON_CLICK,{button_name:this.node.name,screen_name:H.getCurrentPage()});var w,k=L(this.clickEvents);try{for(k.s();!(w=k.n()).done;){var C=w.value;C.emit([n,C.customEventData])}}catch(n){k.e(n)}finally{k.f()}}}},{key:"setAnimationState",value:function(n){this.animationController&&(this.animationController.setValue("DOWN","DOWN"===n),this.animationController.setValue("HOVER","HOVER"===n),this.animationController.setValue("RESET","RESET"===n))}},{key:"fakeClick",value:function(){var n=this;this.setAnimationState("DOWN"),this.scheduleOnce(function(){n.setAnimationState("RESET")},0)}},{key:"resetButtonState",value:function(){this.handleResetButtonState()}}]),h}(eI)).prototype,"clickStartEvents",[nz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),n6=n(n3.prototype,"clickEndEvents",[nB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),n8=n(n3.prototype,"animationController",[nF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(n3.prototype,"transition",[nx],Object.getOwnPropertyDescriptor(n3.prototype,"transition"),n3.prototype),n(n3.prototype,"normalColor",[nU],Object.getOwnPropertyDescriptor(n3.prototype,"normalColor"),n3.prototype),n(n3.prototype,"pressedColor",[nG],Object.getOwnPropertyDescriptor(n3.prototype,"pressedColor"),n3.prototype),n(n3.prototype,"hoverColor",[nH],Object.getOwnPropertyDescriptor(n3.prototype,"hoverColor"),n3.prototype),n(n3.prototype,"disabledColor",[nV],Object.getOwnPropertyDescriptor(n3.prototype,"disabledColor"),n3.prototype),n(n3.prototype,"normalSprite",[nq],Object.getOwnPropertyDescriptor(n3.prototype,"normalSprite"),n3.prototype),n(n3.prototype,"pressedSprite",[nW],Object.getOwnPropertyDescriptor(n3.prototype,"pressedSprite"),n3.prototype),n(n3.prototype,"hoverSprite",[nK],Object.getOwnPropertyDescriptor(n3.prototype,"hoverSprite"),n3.prototype),n(n3.prototype,"disabledSprite",[nj],Object.getOwnPropertyDescriptor(n3.prototype,"disabledSprite"),n3.prototype),n(n3.prototype,"duration",[nY],Object.getOwnPropertyDescriptor(n3.prototype,"duration"),n3.prototype),n(n3.prototype,"zoomScale",[nX],Object.getOwnPropertyDescriptor(n3.prototype,"zoomScale"),n3.prototype),n9=n(n3.prototype,"useDesktopHover",[nZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),n7=n(n3.prototype,"emitAnalyticsEvents",[nJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ie=n(n3.prototype,"makeSound",[nQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),it=n(n3.prototype,"soundKey",[n$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return nD[nL.BUTTON_CLICK]}}),ii=n(n3.prototype,"disableSpamClick",[n0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ia=n(n3.prototype,"disableSpamDelay",[n1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),ir=n(n3.prototype,"isScrollViewCancelInnerEvents",[n2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),n4=n3))||n4)||n4)||n4);ew._RF.pop(),ew._RF.push({},"0e570DdAIZPKY6DNtNerFmX","OpacityToggler",void 0);var ib,iw,iS,ik=eS.ccclass,iC=eS.requireComponent,iE=eS.property,i_=ik("OpacityToggler")(is=iC([eH])((iu=n((il=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"activeValue",iu,A(n)),_(n,"inActiveValue",ic,A(n)),n.signal=new F,n}return T(u,[{key:"__preload",value:function(){this.opacityComponent=this.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"changeState",value:function(n){var w=arguments.length>0&&void 0!==n&&n;this.signal.abort(),this.opacityComponent.opacity=w?this.activeValue:this.inActiveValue}},{key:"changeStateFade",value:(I=M(function(){var n,w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:n=C.length>0&&void 0!==C[0]&&C[0],w=C.length>1&&void 0!==C[1]?C[1]:.2;this.signal.abort(),this.signal=new F;k=n?this.activeValue:this.inActiveValue;return[4,N.runTweenAsync(ez(this.opacityComponent).to(w,{opacity:k}),this.signal)];case 1:_.sent();return[2]}})}),function(){return I.apply(this,arguments)})}]),u}(eO)).prototype,"activeValue",[iE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 255}}),ic=n(il.prototype,"inActiveValue",[iE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 128}}),is=il))||is)||is;ew._RF.pop(),ew._RF.push({},"7ef37Q3PZpKYaeik5JzGwNy","DebugResolution",void 0);var iA,iT,iP,iR,iI,iL,iO,iD,iM,iN,iz,iB,iF,ix,iU,iG,iH,iV,iq,iW,iK=eS.ccclass,ij=eS.property,iY=eS.requireComponent,iX=eS.disallowMultiple,iZ=eS.executeInEditMode,iJ=q.DesignSize,iQ=iJ.Portrait,i$=iJ.Landscape;iK("DebugResolution")(ib=iX(ib=iY([ej])(ib=iZ(!0)(((iS=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).handleLayoutChange=function(){var w;null===(w=n.graphics)||void 0===w||w.clear(),n.start()},n}return T(o,[{key:"drawPortrait",get:function(){return o._drawPortrait},set:function(n){n!==o._drawPortrait&&(n?this.drawPortraitResolution():this.graphics.clear(),o._drawPortrait=n,o._drawLandscape&&this.drawLandscapeResolution())}},{key:"drawLandscape",get:function(){return o._drawLandscape},set:function(n){n!==o._drawLandscape&&(n?this.drawLandscapeResolution():this.graphics.clear(),o._drawLandscape=n,o._drawPortrait&&this.drawPortraitResolution())}},{key:"__preload",value:function(){this.graphics=this.getComponent(ej),this.validateRequiredComponents(),this.listenGameEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){eY.on(V.LAYOUT_CHANGED,this.handleLayoutChange)}},{key:"start",value:function(){this.drawPortrait&&this.drawPortraitResolution(),this.drawLandscape&&this.drawLandscapeResolution()}},{key:"drawPortraitResolution",value:function(){var n=this.graphics;if(n){var w=iQ.WIDTH,k=iQ.HEIGHT,C=-w/2,_=-k/2;n.strokeColor=eC.GREEN,n.rect(C,_,w,k),n.stroke()}}},{key:"drawLandscapeResolution",value:function(){var n=this.graphics;if(n){var w=i$.WIDTH,k=i$.HEIGHT,C=-w/2,_=-k/2;n.strokeColor=eC.CYAN,n.rect(C,_,w,k),n.stroke()}}}]),o}(eO))._drawPortrait=!0,iS._drawLandscape=!0,n((iw=iS).prototype,"drawPortrait",[ij],Object.getOwnPropertyDescriptor(iw.prototype,"drawPortrait"),iw.prototype),n(iw.prototype,"drawLandscape",[ij],Object.getOwnPropertyDescriptor(iw.prototype,"drawLandscape"),iw.prototype),ib=iw))||ib)||ib)||ib);ew._RF.pop(),ew._RF.push({},"0e2d6yn/BVObK1kyTJ5a09a","GameStats",void 0);var i0=eS.ccclass,i1=eS.executionOrder,i2=eS.property,i4=GameCore.Utils.Valid,i3=eC.RED,i5=eC.BLACK,i6=eC.MAGENTA;iA=i0("GameStats"),iT=i1(-1e3),iP=i2(eT),iR=i2(eT),iI=i2(eT),iL=i2(eT),iO=i2(eT),iD=i2(eT),iM=i2(eT),iN=i2(eT),iA(iz=iT((iF=n((iB=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"fpsLabel",iF,A(n)),_(n,"drawCountLabel",ix,A(n)),_(n,"logicTimeLabel",iU,A(n)),_(n,"physicTimeLabel",iG,A(n)),_(n,"renderTimeLabel",iH,A(n)),_(n,"objectMemoryUsageLabel",iV,A(n)),_(n,"textureMemoryUsageLabel",iq,A(n)),_(n,"devicePixelRatioLabel",iW,A(n)),n.refreshInterval=.5,n.handleMouseDown=function(){n.bg.enabled=!n.bg.enabled},n.waitForStats=function(){eX.stats&&(n.unschedule(n.waitForStats),n.node.active=!0,n.stats=eX.stats,n.startUpdateStats())},n.updateStats=function(){n.updateFps(),n.updateDrawCalls(),n.updateLogicTime(),n.updatePhysicTime(),n.updateRenderTime(),n.updateObjectMemoryUsage(),n.updateTextureMemoryUsage(),n.updateDevicePixelRatio()},n}return T(s,[{key:"__preload",value:function(){this.bg=this.getComponent(ex),this.validateRequiredComponents(),this.listenInputEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenInputEvents",value:function(){this.node.on(eK.EventType.TOUCH_START,this.handleMouseDown)}},{key:"start",value:function(){this.bg.enabled=!1,this.node.active=!1,eX&&i4.isDebugger()&&(eX.showStats(),this.schedule(this.waitForStats,.5,20))}},{key:"startUpdateStats",value:function(){this.schedule(this.updateStats,this.refreshInterval)}},{key:"updateFps",value:function(){var n=this.getFps();this.updateFpsColor(n),this.fpsLabel.string="FPS: ".concat(n)}},{key:"updateFpsColor",value:function(n){this.fpsLabel.color=n<30?i3:n<48?i6:i5}},{key:"updateDrawCalls",value:function(){var n=this.getDrawCalls();this.updateDrawCallsColor(n),this.drawCountLabel.string="Draw Calls: ".concat(n)}},{key:"updateDrawCallsColor",value:function(n){var w=eZ.os===eZ.OS.IOS,k=w?80:25,C=w?60:15;this.drawCountLabel.color=n>k?i3:n>C?i6:i5}},{key:"updateLogicTime",value:function(){var n=this.getLogicTime();this.updateLogicTimeColor(n),this.logicTimeLabel.string="Logic Time: ".concat(n.toFixed(2),"ms")}},{key:"updateLogicTimeColor",value:function(n){this.logicTimeLabel.color=n>10?i3:n>5?i6:i5}},{key:"updatePhysicTime",value:function(){var n=this.getPhysicTime();this.updatePhysicTimeColor(n),this.physicTimeLabel.string="Physic Time: ".concat(n.toFixed(2),"ms")}},{key:"updatePhysicTimeColor",value:function(n){this.physicTimeLabel.color=n>10?i3:n>5?i6:i5}},{key:"updateRenderTime",value:function(){var n=this.getRenderTime();this.updateRenderTimeColor(n),this.renderTimeLabel.string="Render Time: ".concat(n.toFixed(2),"ms")}},{key:"updateRenderTimeColor",value:function(n){this.renderTimeLabel.color=n>10?i3:n>5?i6:i5}},{key:"updateObjectMemoryUsage",value:function(){var n=this.getObjectMemoryUsage();this.updateObjectMemoryUsageColor(n),this.objectMemoryUsageLabel.string="Object Mem: ".concat(n.toFixed(2),"MB")}},{key:"updateObjectMemoryUsageColor",value:function(n){this.objectMemoryUsageLabel.color=n>40?i3:n>25?i6:i5}},{key:"updateTextureMemoryUsage",value:function(){var n=this.getTextureMemoryUsage();this.updateTextureMemoryUsageColor(n),this.textureMemoryUsageLabel.string="Texture Mem: ".concat(n.toFixed(2),"MB")}},{key:"updateTextureMemoryUsageColor",value:function(n){this.textureMemoryUsageLabel.color=n>50?i3:n>35?i6:i5}},{key:"updateDevicePixelRatio",value:function(){var n=this.getDevicePixelRatio();this.updateDevicePixelRatioColor(n),this.devicePixelRatioLabel.string="Device Pixel Ratio: ".concat(n)}},{key:"updateDevicePixelRatioColor",value:function(n){this.devicePixelRatioLabel.color=n>2?i3:n<=1?i6:i5}},{key:"getFps",value:function(){var n=this.stats.fps.counter;return Math.floor(n.value)||0}},{key:"getDrawCalls",value:function(){return this.stats.draws.counter.value||0}},{key:"getLogicTime",value:function(){var n=this.stats.logic.counter;return Math.floor(1e3*n.value)/1e3||0}},{key:"getPhysicTime",value:function(){var n=this.stats.physics.counter;return Math.floor(1e3*n.value)/1e3||0}},{key:"getRenderTime",value:function(){var n=this.stats.render.counter;return Math.floor(1e3*n.value)/1e3||0}},{key:"getObjectMemoryUsage",value:function(){var n=this.stats.bufferMemory.counter;return Math.floor(1e3*n.value)/1e3||0}},{key:"getTextureMemoryUsage",value:function(){var n=this.stats.textureMemory.counter;return Math.floor(1e3*n.value)/1e3||0}},{key:"getDevicePixelRatio",value:function(){return window.devicePixelRatio||0}}]),s}(eO)).prototype,"fpsLabel",[iP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ix=n(iB.prototype,"drawCountLabel",[iR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iU=n(iB.prototype,"logicTimeLabel",[iI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iG=n(iB.prototype,"physicTimeLabel",[iL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iH=n(iB.prototype,"renderTimeLabel",[iO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iV=n(iB.prototype,"objectMemoryUsageLabel",[iD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iq=n(iB.prototype,"textureMemoryUsageLabel",[iM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iW=n(iB.prototype,"devicePixelRatioLabel",[iN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iz=iB))||iz);ew._RF.pop(),ew._RF.push({},"ca922n1V0RLioEyUJg8hQXH","GameEvents",void 0);var i8,i9=function(n){return n.CHALLENGE_FRIENDS="challenge-friends",n.REPLAY_FRIENDS="replay-friends",n.SHOW_CHALLENGE_RESULTS="show-challenge-results",n.NEXT_LEVEL="next-level",n.MAX_LEVEL="max-level",n.START_OVER="start-over",n.SELECT_LEVEL="select-level",n.GAME_START="game-start",n.GAME_PAUSE="game-pause",n.GAME_RESUME="game-resume",n.GAME_REPLAY="game-replay",n.GAME_FINISH="game-finish",n.GAME_EXIT="game-exit",n.USE_ITEM="use-item",n.SKIP_LEVEL="skip-level",n.ADD_ITEM="add-item",n.ADD_ITEMS="add-items",n.REFRESH_ITEMS="refresh-items",n.ADD_COINS="add-coins",n.REMOVE_COINS="remove-coins",n.REMOVE_COINS_SUCCESS="remove-coins-success",n.REMOVE_COINS_FAILED="remove-coins-failed",n.COIN_CHANGED="coin-changed",n.ABORT_COIN_ANIMATION="abort-coin-animation",n.ADD_STARS="add-stars",n.PAUSE_TIME="pause-time",n.RESUME_TIME="resume-time",n.TIME_OUT="time-out",n.HALF_TIME="half-time",n.RESCUE_START="rescue-time",n.RESCUE_FINISHED="clock-animation-finished",n.TIME_UPDATED="time-updated",n.APPLY_GRAVITY="apply-gravity",n.IDLE_ENTER="idle-enter",n.IDLE_EXIT="idle-exit",n.GRID_MATCH="grid-match",n.GRID_MATCH_SUCCESS="grid-match-success",n.GRID_MATCH_FAIL="grid-match-fail",n.GRID_CLEAR="grid-clear",n.GRID_SPAWN="grid-spawn",n.GRID_CREATE="grid-create",n.GRID_RESIZE="grid-resize",n.TILE_CLICK="tile-click",n.BOMB_EXPLODE="bomb-explode",n.SHOW_HINT="show-hint",n.ADD_COMBO="add-combo",n.COMBO_UPDATED="combo-updated",n.COMBO_ENDED="combo-ended",n.COMBO_PROGRESS="combo-progress",n.ADD_SCORE="add-score",n.SCORE_UPDATED="score-updated",n.SHOW_UI="show-ui",n.HIDE_UI="hide-ui",n.AUTO_PLAY="auto-play",n.GUIDE_MASK_CLICKED="guide-mask-clicked",n}(i9||{});ew._RF.pop(),ew._RF.push({},"8249dDH5xBEc4nnCGRgSjaW","PanelAnimationController",void 0);var i7,ae,at,an,ai,aa,ar,ao,as,al,au,ah,ap,ad,ay,af,av,ag,am=(0,eS.ccclass)("PanelAnimationController")(i8=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).animators=new Set,n.eventTarget=new eJ,n.handleRegistration=function(w){if(!w)throw new Error("Invalid event payload.");n.animators.has(w)&&console.warn("Animator already registered."),n.animators.add(w)},n.handleUnregistration=function(w){if(!w)throw new Error("Invalid event payload.");n.animators.has(w)||console.warn("Animator not registered."),n.animators.delete(w)},n.handleShowUIs=function(){var w=M(function(w){var k,C,_,A,T,I,O,D,M,N,z;return _ts_generator(this,function(B){switch(B.label){case 0:_=!1,A=[],T=L(n.animators);try{for(T.s();!(C=T.n()).done;){I=C.value;A.push(I)}}catch(n){T.e(n)}finally{T.f()}for(O=[],D=0,M=A;D<M.length;D++){z=M[D];if(!z.isReadyForAnimation()&&!_)_=!0,null==w||null===(N=w.fallback)||void 0===N||N.call(w);O.push(z.handleShowUI())}return[4,Promise.all(O)];case 1:B.sent(),null==w||null===(k=w.onComplete)||void 0===k||k.call(w),n.eventTarget.emit(i9.SHOW_UI);return[2]}})});return function(n){return w.apply(this,arguments)}}(),n.handleHideUIs=function(){var w=M(function(w){var k,C,_,A,T,I,O,D,M,N,z;return _ts_generator(this,function(B){switch(B.label){case 0:_=!1,A=[],T=L(n.animators);try{for(T.s();!(C=T.n()).done;){I=C.value;A.push(I)}}catch(n){T.e(n)}finally{T.f()}for(O=[],D=0,M=A;D<M.length;D++){z=M[D];if(!z.isReadyForAnimation()&&!_)_=!0,null==w||null===(N=w.fallback)||void 0===N||N.call(w);O.push(z.handleHideUI())}return[4,Promise.all(O)];case 1:B.sent(),null==w||null===(k=w.onComplete)||void 0===k||k.call(w),n.eventTarget.emit(i9.HIDE_UI);return[2]}})});return function(n){return w.apply(this,arguments)}}(),n}return T(o,[{key:"onEnable",value:function(){this.node.scene.on(i9.SHOW_UI,this.handleShowUIs,this),this.node.scene.on(i9.HIDE_UI,this.handleHideUIs,this)}},{key:"onDisable",value:function(){this.node.scene.off(i9.SHOW_UI,this.handleShowUIs,this),this.node.scene.off(i9.HIDE_UI,this.handleHideUIs,this)}},{key:"showUI",value:function(){return this.handleShowUIs()}},{key:"hideUI",value:function(){return this.handleHideUIs()}},{key:"on",value:function(n,w,k,C){this.eventTarget.on(n,w,k,C)}},{key:"off",value:function(n,w,k){this.eventTarget.off(n,w,k)}}],[{key:"getController",value:function(n){for(var w=null,k=n;null!==k;){if(w=k.getComponent(o))break;k=k.parent}return w}},{key:"registerAnimator",value:function(n){var w=this.getController(n.node);w?w.handleRegistration(n):console.warn("No PanelAnimationController found for animator ".concat(n.node.name))}},{key:"unregisterAnimator",value:function(n){var w=this.getController(n.node);w?w.handleUnregistration(n):console.warn("No PanelAnimationController found for animator ".concat(n.node.name))}}]),o}(eO))||i8;ew._RF.pop(),ew._RF.push({},"f190aWZvVlGiplYX4XrZG3a","PanelAnimator",void 0);var ab,aw=eS.ccclass,aS=eS.property,ak=GameCore.Utils.Object,aC=(i7=aw("AnimationConfig"),ae=aS({type:[eN]}),i7((ai=n((an=function(){function e(){C(this,e),_(this,"startHidden",ai,this),_(this,"nodes",aa,this),_(this,"posOffset",ar,this),_(this,"showEase",ao,this),_(this,"hideEase",as,this),_(this,"showDuration",al,this),_(this,"hideDuration",au,this)}return T(e,[{key:"setConfig",value:function(n){n&&ak.assign(this,n)}}]),e}()).prototype,"startHidden",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),aa=n(an.prototype,"nodes",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ar=n(an.prototype,"posOffset",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ao=n(an.prototype,"showEase",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backOut"}}),as=n(an.prototype,"hideEase",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"backIn"}}),al=n(an.prototype,"showDuration",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),au=n(an.prototype,"hideDuration",[aS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),at=an))||at),aE=(ah=aw("PanelAnimator"),ap=aS({type:aC,displayName:"Top animation nodes"}),ad=aS({type:aC,displayName:"Bottom animation nodes"}),ah((av=n((af=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"topConfig",av,A(n)),_(n,"botConfig",ag,A(n)),n.isReady=!1,n}return T(c,[{key:"onEnable",value:function(){am.registerAnimator(this)}},{key:"onDisable",value:function(){am.unregisterAnimator(this)}},{key:"onLoad",value:function(){this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos(),this.isReady=!0}},{key:"initUIPos",value:function(){this.topAnimator.switchState(this.topConfig.startHidden?"hidden":"shown",!0),this.botAnimator.switchState(this.botConfig.startHidden?"hidden":"shown",!0)}},{key:"isReadyForAnimation",value:function(){return this.isReady}},{key:"handleShowUI",value:(L=M(function(){return _ts_generator(this,function(n){if(this.isReady)return[2,Promise.all([this.topAnimator.switchState("shown"),this.botAnimator.switchState("shown")])];console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready"));return[2]})}),function(){return L.apply(this,arguments)})},{key:"handleHideUI",value:(I=M(function(){return _ts_generator(this,function(n){if(this.isReady)return[2,Promise.all([this.topAnimator.switchState("hidden"),this.botAnimator.switchState("hidden")])];console.warn("".concat(this.node.name,"'s ").concat(this.name,": not ready"));return[2]})}),function(){return I.apply(this,arguments)})},{key:"createAnimator",value:function(n,w){var k=n.nodes,C=n.posOffset,_=n.showEase,A=n.hideEase,T=n.showDuration,I=n.hideDuration,L=k.map(function(n){return"top"===w&&n.isAlignTop?{mode:"top",value:n.top}:"bottom"===w&&n.isAlignBottom?{mode:"bottom",value:n.bottom}:{mode:"position",value:n.node.position.y}}),O=k.map(function(n){return"top"===w&&n.isAlignTop?{mode:"top",value:n.top+C}:"bottom"===w&&n.isAlignBottom?{mode:"bottom",value:n.bottom-C}:{mode:"position",value:n.node.position.y+C}}),D="shown",M=new F;return{switchState:function(n,w){var C=arguments.length>1&&void 0!==w&&w;if(M.abort(),M=new F,D===n)return Promise.resolve(null);D=n;var z="hidden"===n?L:O,B="hidden"===n?O:L,x="hidden"===n?I:T,U="hidden"===n?A:_;return C?(k.forEach(function(n,w){var k=z[w],C=B[w].value;"top"===k.mode&&(n.top=C),"bottom"===k.mode&&(n.bottom=C),"position"===k.mode&&(n.node.position=new eQ(n.node.position.x,C,n.node.position.z))}),Promise.resolve(null)):Promise.all(k.map(function(n,w){var k=z[w],C=B[w].value;return N.runTweenAsync(c.getTween({widget:n,config:k,target:C,easing:U,duration:x}),M)}))}}}},{key:"setAnimator",value:function(n){var w=n.topConfig,k=n.botConfig,C=new aC,_=new aC;C.setConfig(w),_.setConfig(k),this.topConfig=C,this.botConfig=_,this.topAnimator=this.createAnimator(this.topConfig,"top"),this.botAnimator=this.createAnimator(this.botConfig,"bottom"),this.initUIPos()}}],[{key:"getTween",value:function(n){var w=n.widget,k=n.config,C=n.target,_=n.easing,A=n.duration;return"top"===k.mode?ez(w).call(function(){w.top=k.value}).to(A,{top:C},{easing:_}):"bottom"===k.mode?ez(w).call(function(){w.bottom=k.value}).to(A,{bottom:C},{easing:_}):ez(w.node.position).call(function(){w.node.position=new eQ(w.node.position.x,k.value,w.node.position.z)}).to(A,{y:C},{easing:_})}}]),c}(eO)).prototype,"topConfig",[ap],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new aC}}),ag=n(af.prototype,"botConfig",[ad],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new aC}}),ay=af))||ay);ew._RF.pop(),ew._RF.push({},"21a9aAlkBtGxKLqip8g0o6l","ParticleSystem2DExtra",void 0);var a_=eS.ccclass,aA=eS.disallowMultiple,aT=eS.executeInEditMode,aP=eS.requireComponent,aR=a_("ParticleSystem2DExtra")(ab=aT(!0)(ab=aA(!0)(ab=aP(e$)(ab=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).emitParticle=function(w){return function(k){w(k);var C=n.particleSystem._simulator.particles.length,_=n.particleSystem._simulator.particles[C-1];n.initParticle(_)}},n.step=function(w){return function(k){for(var C=n.particleSystem._simulator.particles,_=0;_<C.length;_++){var A=C[_];n.updateParticle(A,k)}w(k)}},n}return T(o,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(e$),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var n=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(n);var w=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(w)}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),o}(eO))||ab)||ab)||ab)||ab;ew._RF.pop(),ew._RF.push({},"9a5a3MgLaRAKbHluGCPsA8j","ExampleParticleSystem2DExtra",void 0);var aI,aL,aO,aD,aM,aN,az,aB,aF,ax,aU,aG;(0,eS.ccclass)("ExampleParticleSystem2DExtra")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"initParticle",value:function(n){n.maxSize=e0.randomRange(.25,1)*n.size,n.size=0,n.deltaSize=0,n.cycleDuration=e0.randomRange(.4,.6),n.life=n.timeToLive,this.setInitPosition(n.pos)}},{key:"updateParticle",value:function(n,w){this.updateScale(n)}},{key:"setInitPosition",value:function(n){var w=n.x,k=n.y;return n.x=w+e0.randomRange(-350,350),n.y=k+e0.randomRange(-350,350),n}},{key:"updateScale",value:function(n){var w=1-(n.life-n.timeToLive)%n.cycleDuration/n.cycleDuration;n.size=n.maxSize*Math.sin(w*Math.PI)}}]),o}(aR));ew._RF.pop(),ew._RF.push({},"6ea01hdw/9MHb28SCDAiRss","ResizeWithBannerAd",void 0);var aH,aV,aq,aW,aK,aj,aY,aX,aZ,aJ,aQ,a$=eS.ccclass,a0=eS.requireComponent,a1=eS.property,a2=globalThis.game,a4=a2.ads,a3=a2.event,a5=GameCore,a6=a5.Events,a8=a5.Configs.Ads.BannerDisplayAdOptions,a9=a5.Plugins.Ads,a7=a9.Types,re=a9.Status,rt=a5.Utils,rn=rt.Array,ri=rt.Function,ra=["top","topleft","topright"],rr=["bottom","bottomleft","bottomright"],ro=["left","topleft","bottomleft"],rs=["right","topright","bottomright"];aI=a$("ResizeWithBannerAd"),aL=a0(eN),aO=a1(eW),aD=a1(eW),aM=a1(eW),aN=a1(eW),aI(az=aL((aF=n((aB=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"includeSAB",aF,A(n)),_(n,"includeRightBanner",ax,A(n)),_(n,"includeBottomBanner",aU,A(n)),_(n,"includeLeftBanner",aG,A(n)),n.handleOnAdShowing=function(w){var k=w.placementId;n.checkValid()&&k&&a4.getAd(a7.BANNER,k)&&(n.resizeWhenBannerAdShow(k),n.emitResizeEvent())},n.handleOnAdClosed=function(w){var k=w.placementId;n.checkValid()&&k&&a4.getAd(a7.BANNER,k)&&(n.resizeWhenBannerAdClose(k),n.emitResizeEvent())},n.handleOnResize=function(){n.checkValid()&&a8.forEach(function(w){var k=w.PlacementId,C=a4.getAdStatus(a7.BANNER,k);C&&(C===re.SHOWING?n.resizeWhenBannerAdShow(k):C===re.IDLE&&n.resizeWhenBannerAdClose(k))})},n.resizeWhenBannerAdShow=function(w){var k=void 0,C=void 0,_=void 0,A=void 0,T=x.cssSizeToWorldSize(1),I=a4.getBannerConfig(w),L=I.PlacementId,O=I.BannerWidth,D=I.Position;if("top"===D)k=a4.getBannerHeight(L,T);else if("bottom"===D)n.includeBottomBanner?C=a4.getBannerHeight(L,T,n.includeSAB):n.includeSAB&&(C=a4.getSafeAreaBottom(T));else if("left"===D||"right"===D){if(void 0===O)return;var M=O;"getBannerOffset"in GameSDK.extra&&(M+=GameSDK.extra.getBannerOffset()),"left"===D&&n.includeLeftBanner?_=M*T:"right"===D&&n.includeRightBanner&&(A=M*T)}n.updateWidgets({top:k,bottom:C,left:_,right:A})},n.resizeWhenBannerAdClose=function(w){var k=a4.getBannerConfig(w).Position,C=x.cssSizeToWorldSize(1),_=n.includeSAB?a4.getSafeAreaBottom(C):0;n.updateWidgets({top:rn.has(ra,k)?0:void 0,bottom:rn.has(rr,k)?_:void 0,left:rn.has(ro,k)?0:void 0,right:rn.has(rs,k)?0:void 0})},n.emitResizeEvent=ri.debounce(function(){eY.emit(V.WIDGET_RESIZED)},100),n}return T(s,[{key:"__preload",value:function(){this.widget=this.getComponent(eN),z.lazyValidateProperties(this),a3.on(a6.AD_SHOWING,this.handleOnAdShowing),a3.on(a6.AD_CLOSED,this.handleOnAdClosed),eY.on(V.VIEW_RESIZED,this.handleOnResize)}},{key:"onDestroy",value:function(){a3.off(a6.AD_SHOWING,this.handleOnAdShowing),a3.off(a6.AD_CLOSED,this.handleOnAdClosed),eY.off(V.VIEW_RESIZED,this.handleOnResize)}},{key:"start",value:function(){this.handleOnResize()}},{key:"updateWidgets",value:function(n){var w=n.top,k=n.bottom,C=n.left,_=n.right;this.widget.top=null!=w?w:this.widget.top,this.widget.bottom=null!=k?k:this.widget.bottom,this.widget.left=null!=C?C:this.widget.left,this.widget.right=null!=_?_:this.widget.right,e1.instance.emit("canvas-resize")}},{key:"checkValid",value:function(){return this.node.activeInHierarchy&&null!==this.node.parent&&void 0!==this.node.parent}}]),s}(eO)).prototype,"includeSAB",[aO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),ax=n(aB.prototype,"includeRightBanner",[aD],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),aU=n(aB.prototype,"includeBottomBanner",[aM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),aG=n(aB.prototype,"includeLeftBanner",[aN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),az=aB))||az);ew._RF.pop(),ew._RF.push({},"3d28fQaHU5Lm4/Zyq/Jd2b6","TapperedProgressBar",void 0);var rl,ru,rh,rp,rd,ry,rf,rv=eS.ccclass,rg=eS.property,rm=eS.executeInEditMode,rb=eS.requireComponent,rw=(aH=rv("TapperedProgressBar"),aV=rb(eH),aq=rg({type:eH,displayName:"Fill opacity"}),aW=rg({type:ex,displayName:"Left Cap",tooltip:"If assigned, will be displayed when progress is larger than 0%"}),aK=rg({type:ex,displayName:"Right Cap",tooltip:"If assigned, will be displayed when progress is at 100%"}),aj=rg({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress",override:!0}),aH(aY=rm(aY=aV((aZ=n((aX=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"uiOpacity",aZ,A(n)),_(n,"leftCap",aJ,A(n)),_(n,"rightCap",aQ,A(n)),n}return T(s,[{key:"progress",get:function(){return O(D(s.prototype),"progress",this)},set:function(n){U(D(s.prototype),"progress",n,this,!0),this.updateAppearance()}},{key:"updateAppearance",value:function(){if(null!==this.uiOpacity){if(this.progress<=0)this.uiOpacity.opacity=0;else if(this.progress>.1)this.uiOpacity.opacity=255;else{var n=Math.floor(this.progress/.05*255);this.uiOpacity.opacity=n}}}},{key:"start",value:function(){this.updateAppearance()}}]),s}(e2)).prototype,"uiOpacity",[aq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),aJ=n(aX.prototype,"leftCap",[aW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),aQ=n(aX.prototype,"rightCap",[aK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),n(aX.prototype,"progress",[aj],Object.getOwnPropertyDescriptor(aX.prototype,"progress"),aX.prototype),aY=aX))||aY)||aY)||aY);ew._RF.pop(),ew._RF.push({},"aa60frMJLtIlJZh2yJhMp1s","DynamicLabel",void 0);var rS,rk,rC,rE,r_,rA,rT,rP,rR,rI,rL,rO,rD,rM,rN,rz,rB,rF,rx=eS.ccclass,rU=eS.property,rG=eS.executeInEditMode,rH=eS.requireComponent;rl=rx("DynamicLabel"),ru=rH(eT),rh=rG(!0),rp=rU({type:eM,min:1,max:200}),rd=rU({type:eM,min:.1,max:4}),rl(ry=ru(ry=rh((n((rf=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k)))._quality=1,n._size=1,n._outlineWidth=0,n._shadowOffset=new e4(0,0),n}return T(o,[{key:"size",get:function(){return this._size},set:function(n){this._size=n,this.label.fontSize=this.size*this.quality}},{key:"quality",get:function(){return this._quality},set:function(n){this._quality=n,this.node.scale=new eQ(1/this.quality,1/this.quality,1),this.label.fontSize=this.size*this.quality,this.label.outlineWidth=this._outlineWidth*this.quality,this.label.shadowOffset=this._shadowOffset.multiplyScalar(this.quality)}},{key:"__preload",value:function(){this.label=this.getComponent(eT)}},{key:"start",value:function(){this._quality=1/this.node.scale.x,this._size=this.label.fontSize/this.quality,this._outlineWidth=this.label.outlineWidth,this._shadowOffset=this.label.shadowOffset,this.quality=window.devicePixelRatio,console.info("\uD83D\uDD20 ".concat(this.node.name,"<Label> quality:"),this.quality)}}]),o}(eO)).prototype,"size",[rp],Object.getOwnPropertyDescriptor(rf.prototype,"size"),rf.prototype),n(rf.prototype,"quality",[rd],Object.getOwnPropertyDescriptor(rf.prototype,"quality"),rf.prototype),ry=rf))||ry)||ry);ew._RF.pop(),ew._RF.push({},"24e92x58aBHlrfObdu6qJYD","LocalizePreloader",void 0);var rV,rq,rW,rK,rj,rY,rX,rZ,rJ,rQ,r$,r0,r1,r2,r4,r3,r5,r6,r8,r9,r7,oe,ot=eS.ccclass,on=eS.property,oi=GameCore.Utils,oa=oi.Array,or=oi.Valid,oo=globalThis.game.language,os=Object.keys(W),ol=(rS=ot("LocalizeTextureKey"),rk=on({visible:!1}),rC=on(e3),rS((rA=n((r_=function(){function e(){C(this,e),_(this,"_key",rA,this)}return T(e,[{key:"key",get:function(){return this._key},set:function(n){oo.hasTextureKey(n)?this._key=n:console.warn("Key ".concat(n," not found in locales"))}}]),e}()).prototype,"_key",[rk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),n(r_.prototype,"key",[rC],Object.getOwnPropertyDescriptor(r_.prototype,"key"),r_.prototype),rE=r_))||rE),ou=(rT=ot("SupportedLocaleKey"),rP=on({visible:!1}),rR=on(e3),rT((rO=n((rL=function(){function e(){C(this,e),_(this,"_key",rO,this)}return T(e,[{key:"key",get:function(){return this._key},set:function(n){os.includes(n)?this._key=n:console.warn("Key ".concat(n," not found. Supported locales are ").concat(os.join(", ")))}}]),e}()).prototype,"_key",[rP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),n(rL.prototype,"key",[rR],Object.getOwnPropertyDescriptor(rL.prototype,"key"),rL.prototype),rI=rL))||rI);rD=ot("LocalizePreloader"),rM=on([ol]),rN=on({type:ou,tooltip:"Preload only for these locales"}),rD((rB=n((rz=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"keys",rB,A(n)),_(n,"locales",rF,A(n)),n}return T(s,[{key:"__preload",value:function(){var n=oo.getCurrentLocale(),w=this.locales.map(function(n){return n.key});if(oa.has(w,n)){var k=this.keys.reduce(function(n,w){if(!1===oo.hasTextureKey(w.key))return n;var k="".concat(oo.getTexture(w.key),"/spriteFrame");return n.push(k),n},[]);B.loadSpriteFramesAsync(k)}else or.isDebugger()&&console.info("Skipping preloading of textures because current locale is not in the list of preloading locales")}}]),s}(eO)).prototype,"keys",[rM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rF=n(rz.prototype,"locales",[rN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rz));ew._RF.pop(),ew._RF.push({},"3f364xnTJtDR5yeow2MWHhm","LocalizedLayout",void 0);var oh,op,od,oy,of,ov,og,om,ob,ow=eS.ccclass,oS=eS.property,ok=eS.executeInEditMode,oC=eS.disallowMultiple,oE=eS.requireComponent;rV=ow("LocalizedLayout"),rq=ok(!0),rW=oE(e_),rK=oS(K),rj=z.required(),rY=oS(e_),rX=oS({visible:!1}),rZ=oS({visible:!1}),rJ=oS({visible:!1}),rQ=oS({visible:!1}),r$=oS({type:eM,group:"Padding"}),r0=oS({type:eM,group:"Padding"}),r1=oS({type:eM,group:"Padding"}),r2=oS({type:eM,group:"Padding"}),rV(r4=oC(r4=rq(r4=rW((r5=n((r3=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"label",r5,A(n)),_(n,"layout",r6,A(n)),_(n,"_top",r8,A(n)),_(n,"_down",r9,A(n)),_(n,"_left",r7,A(n)),_(n,"_right",oe,A(n)),n.updateContentSize=function(w){var k,C=(null!=w?w:{}).localize;if(void 0!==n.label&&(void 0===C||n.label===C)){var _=null===(k=n.label.getComponent(e_))||void 0===k?void 0:k.contentSize;void 0!==_&&n.layout.setContentSize(_.width+n.left+n.right,_.height+n.top+n.down)}},n}return T(s,[{key:"top",get:function(){return this._top},set:function(n){this._top=n,this.updateContentSize()}},{key:"down",get:function(){return this._down},set:function(n){this._down=n,this.updateContentSize()}},{key:"left",get:function(){return this._left},set:function(n){this._left=n,this.updateContentSize()}},{key:"right",get:function(){return this._right},set:function(n){this._right=n,this.updateContentSize()}},{key:"__preload",value:function(){this.layout=this.getComponent(e_),z.validateRequiredProperties(this)}},{key:"start",value:function(){this.updateContentSize()}},{key:"onEnable",value:function(){this.listenEvent()}},{key:"onDisable",value:function(){this.unlistenEvent()}},{key:"listenEvent",value:function(){eY.on(V.LOCALIZE_APPLIED,this.updateContentSize)}},{key:"unlistenEvent",value:function(){eY.off(V.LOCALIZE_APPLIED,this.updateContentSize)}}]),s}(eO)).prototype,"label",[rK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r6=n(r3.prototype,"layout",[rj,rY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r8=n(r3.prototype,"_top",[rX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r9=n(r3.prototype,"_down",[rZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r7=n(r3.prototype,"_left",[rJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),oe=n(r3.prototype,"_right",[rQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n(r3.prototype,"top",[r$],Object.getOwnPropertyDescriptor(r3.prototype,"top"),r3.prototype),n(r3.prototype,"down",[r0],Object.getOwnPropertyDescriptor(r3.prototype,"down"),r3.prototype),n(r3.prototype,"left",[r1],Object.getOwnPropertyDescriptor(r3.prototype,"left"),r3.prototype),n(r3.prototype,"right",[r2],Object.getOwnPropertyDescriptor(r3.prototype,"right"),r3.prototype),r4=r3))||r4)||r4)||r4);ew._RF.pop(),ew._RF.push({},"aef305TaZhKVo1f4/qH1kf+","SecondOrderDynamics",void 0);var o_,oA,oT,oP,oR,oI,oL,oO,oD,oM=eS.ccclass,oN=eS.property,oz=function(){function e(n,w){C(this,e);var k=null!=w?w:{response:1,dampen:1,eager:1};this.k1=e.calcK1(k),this.k2=e.calcK2(k),this.k3=e.calcK3(k),this.xp=n.clone(),this.y=n.clone(),this.yd=new e4(0,0)}return T(e,[{key:"update",value:function(n,w,k){var C=arguments.length>2&&void 0!==k?k:null,_=C;null===_&&(_=new e4((w.x-this.xp.x)/n,(w.y-this.xp.y)/n),this.xp.x=w.x,this.xp.y=w.y);var A=Math.max(this.k2,n*n/2+n*this.k1/2,n*this.k1);return this.y.x=this.y.x+n*this.yd.x,this.y.y=this.y.y+n*this.yd.y,this.yd.x=this.yd.x+n*(w.x+this.k3*_.x-this.y.x-this.k1*this.yd.x)/A,this.yd.y=this.yd.y+n*(w.y+this.k3*_.y-this.y.y-this.k1*this.yd.y)/A,this.y}},{key:"setDynamics",value:function(n){this.k1=e.calcK1(n),this.k2=e.calcK2(n),this.k3=e.calcK3(n)}},{key:"reset",value:function(n){this.xp.set(n.x,n.y),this.y.set(n.x,n.y),this.yd.set(0,0)}},{key:"currentState",get:function(){return this.y}}],[{key:"calcK1",value:function(n){return n.dampen/(Math.PI*n.response)}},{key:"calcK2",value:function(n){return 1/(2*Math.PI*n.response*(2*Math.PI*n.response))}},{key:"calcK3",value:function(n){return n.eager*n.dampen/(2*Math.PI*n.response)}}]),e}(),oB=(oh=oM("SODConfig"),op=oN({type:eM,displayName:"Responsiveness",tooltip:"Higher values will result shorter response times."}),od=oN({type:eM,displayName:"Dampening",tooltip:"Higher values will result in less overshoot and oscillation."}),oy=oN({type:eM,displayName:"Eagerness",tooltip:"Higher values will result in more overshoot and oscillation, negative values will result in anticipation."}),oh((og=n((ov=T(function e(){C(this,e),_(this,"response",og,this),_(this,"dampen",om,this),_(this,"eager",ob,this)})).prototype,"response",[op],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 200}}),om=n(ov.prototype,"dampen",[od],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),ob=n(ov.prototype,"eager",[oy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),of=ov))||of);ew._RF.pop(),ew._RF.push({},"e9e74FEHyRLvar32WZD/F11","Trail",void 0);var oF,ox,oU,oG,oH,oV,oq,oW,oK,oj,oY,oX,oZ,oJ,oQ,o$,o0,o1,o2,o4,o3,o5,o6,o8,o9,o7,se=eS.ccclass,st=eS.property,sn=(o_=se("Trail"),oA=st({type:ek,displayName:"Target"}),oT=st({type:ej,displayName:"Graphics"}),oP=st({type:[oB],displayName:"Trail Nodes"}),o_((oL=n((oI=function(n){w(u,n);var I=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"target",oL,A(n)),_(n,"graphics",oO,A(n)),_(n,"trailNodes",oD,A(n)),n.trailNodeInstances=[],n}return T(u,[{key:"reset",value:function(){var n,w=L(this.trailNodeInstances);try{for(w.s();!(n=w.n()).done;)n.value.reset(new e4(this.node.worldPosition.x,this.node.worldPosition.y))}catch(n){w.e(n)}finally{w.f()}this.graphics.clear()}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.spawnTrailNodes()}},{key:"update",value:function(n){this.graphics.clear();var w=this.trailNodeInstances[0];this.drawTrail(n,w,this.target.worldPosition.x,this.target.worldPosition.y);for(var k=1;k<this.trailNodeInstances.length;k++){var C=this.trailNodeInstances[k-1],_=this.trailNodeInstances[k];this.drawTrail(n,_,C.currentState.x,C.currentState.y)}}},{key:"drawTrail",value:function(n,w,k,C){var _=this.graphics,A=new e4(k,C),T=w.update(n,A),I=new eQ(A.x,A.y,0),L=new eQ(T.x,T.y,0);_.node.inverseTransformPoint(I,I),_.node.inverseTransformPoint(L,L),_.moveTo(I.x,I.y),_.lineTo(L.x,L.y),_.stroke()}},{key:"spawnTrailNodes",value:function(){var n,w=L(this.trailNodes);try{for(w.s();!(n=w.n()).done;){var k=n.value,C=new e4(this.node.worldPosition.x,this.node.worldPosition.y),_=new oz(C,k);this.trailNodeInstances.push(_)}}catch(n){w.e(n)}finally{w.f()}}},{key:"validateRequiredComponents",value:function(){if(!this.target)throw new Error("Target is not set");if(!this.graphics)throw new Error("Graphics is not set");0===this.trailNodes.length&&console.warn("No trail nodes are set")}}]),u}(eO)).prototype,"target",[oA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oO=n(oI.prototype,"graphics",[oT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oD=n(oI.prototype,"trailNodes",[oP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),oR=oI))||oR);ew._RF.pop(),ew._RF.push({},"a2260jBMJFPCrn/Q4Vo4iB1","BatchNodes",void 0);var si,sa=eS.ccclass,sr=eS.executionOrder,so=eS.property,ss=GameCore.Utils.Function,sl="Batch By Name",su="Batch Label",sh="Batch Sprite",sp=(oF=sa("BatchNodes"),ox=sr(99999),oU=so({group:{name:sl}}),oG=so({type:[eD],group:{name:sl}}),oH=so({type:[e3],group:{name:sl}}),oV=so({group:{name:su}}),oq=so({group:{name:su}}),oW=so({group:{name:su}}),oK=so({group:{name:sh}}),oj=so({group:{name:sh}}),oY=so({readonly:!0}),oX=so({readonly:!0}),oZ=so({readonly:!0}),oF(oJ=ox((o$=n((oQ=function(n){w(u,n);var I=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"batchByName",o$,A(n)),_(n,"depthNames",o0,A(n)),_(n,"listName",o1,A(n)),_(n,"batchLabel",o2,A(n)),_(n,"depthLabel",o4,A(n)),_(n,"typeLabel",o3,A(n)),_(n,"batchSprite",o5,A(n)),_(n,"depthSprite",o6,A(n)),_(n,"batchAllNodes",o8,A(n)),_(n,"batchDepth",o9,A(n)),_(n,"checkOverlap",o7,A(n)),n.batchNode={},n.labelChildren=[],n.spriteChildren=[],n.allChildren=[],n.nameChildren=[],n.originalParents={},n.isInited=!1,n.handleNodeChange=ss.throttle(function(){n.isInited&&(console.warn("handleNodeChange",n.node.name),n.setupBatchNodes(n.node))},1e3),n.onAfterUpdate=function(){n.isInited&&n.hierarchyChildren()},n.onAfterRender=function(){n.isInited&&n.restoreOriginalChildren()},n}return T(u,[{key:"__preload",value:function(){this.enabled&&(eL.on(e5.EVENT_AFTER_UPDATE,this.onAfterUpdate),eL.on(e5.EVENT_AFTER_RENDER,this.onAfterRender))}},{key:"onDestroy",value:function(){eL.off(e5.EVENT_AFTER_UPDATE,this.onAfterUpdate),eL.off(e5.EVENT_AFTER_RENDER,this.onAfterRender)}},{key:"onLoad",value:function(){this.enabled&&(this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"onEnable",value:function(){this.isInited||(eL.on(e5.EVENT_AFTER_UPDATE,this.onAfterUpdate),eL.on(e5.EVENT_AFTER_RENDER,this.onAfterRender),this.setupBatchNodes(this.node),this.isInited=!0)}},{key:"handleActiveChange",value:function(n){n.once(ek.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.handleNodeChange)}},{key:"onDisable",value:function(){this.restoreOriginalChildren(),eL.off(e5.EVENT_AFTER_UPDATE,this.onAfterUpdate),eL.off(e5.EVENT_AFTER_RENDER,this.onAfterRender),this.isInited=!1}},{key:"setupBatchNodes",value:function(n){this.allChildren=[],this.nameChildren=[],this.labelChildren=[],this.spriteChildren=[],this.saveOriginalChildren(n),this.createGlobalNodes(n),this.createGlobalNameNodes(n),this.createGlobalLabelNode(n),this.createGlobalSpriteNode(n),this.sortGlobalNodes()}},{key:"sortGlobalNodes",value:function(){var n,w,k,C=this;null===(n=this.batchNode.node)||void 0===n||n.setSiblingIndex(0),null===(w=this.batchNode.label)||void 0===w||w.setSiblingIndex(this.depthLabel),null===(k=this.batchNode.sprite)||void 0===k||k.setSiblingIndex(this.depthSprite),this.listName.forEach(function(n,w){var k,_=C.depthNames[w];void 0!==_?null===(k=C.batchNode[n])||void 0===k||k.setSiblingIndex(_):console.warn("BatchNodes: depth is undefined",n,w,_)})}},{key:"createGlobalNodes",value:function(n){if(this.batchAllNodes){var w=new ek("GlobalBatchNode");w.active=!0,this.batchNode.node=w,n.addChild(w)}}},{key:"createGlobalNameNodes",value:function(n){if(this.batchByName){var w,k=L(this.listName);try{for(k.s();!(w=k.n()).done;){var C=w.value;if(!this.batchNode[C]){var _=new ek(C);_.active=!0,this.batchNode[C]=_,n.addChild(_)}}}catch(n){k.e(n)}finally{k.f()}}}},{key:"createGlobalLabelNode",value:function(n){if(this.batchLabel){var w=new ek("GlobalLabelNode");w.active=!0,this.batchNode.label=w,n.addChild(w)}}},{key:"createGlobalSpriteNode",value:function(n){if(this.batchSprite){var w=new ek("GlobalSpriteNode");w.active=!0,this.batchNode.sprite=w,n.addChild(w)}}},{key:"saveOriginalParents",value:function(){var n,w=[].concat(j(this.labelChildren),j(this.spriteChildren)),k=this.nameChildren,C=L(w);try{for(C.s();!(n=C.n()).done;){var _=n.value;_.node.parent&&(this.handleActiveChange(_.node),this.originalParents[_.uuid]=_.node.parent)}}catch(n){C.e(n)}finally{C.f()}var A,T=L(k);try{for(T.s();!(A=T.n()).done;){var I=A.value;I.parent&&(this.handleActiveChange(I),this.originalParents[I.uuid]=I.parent)}}catch(n){T.e(n)}finally{T.f()}}},{key:"saveOriginalChildren",value:function(n){var w,k=n.children,C=L(k);try{for(C.s();!(w=C.n()).done;){var _=w.value;this.saveLabelChildren(_),this.saveSpriteChildren(_),this.saveNodeChildrenByName(_),this.saveNodeChildrenByType(_)}}catch(n){C.e(n)}finally{C.f()}this.saveOriginalParents()}},{key:"saveLabelChildren",value:function(n){var w;if(this.batchLabel){var k=n.getComponentsInChildren(eT);"char"===this.typeLabel&&(k=k.filter(function(n){return n.cacheMode===eT.CacheMode.CHAR})),0!==k.length&&(w=this.labelChildren).push.apply(w,j(k))}}},{key:"saveSpriteChildren",value:function(n){var w;if(this.batchSprite){var k=n.getComponentsInChildren(ex);0!==k.length&&(w=this.spriteChildren).push.apply(w,j(k))}}},{key:"saveNodeChildrenByName",value:function(n){if(this.batchByName){var w,k=L(n.children);try{for(k.s();!(w=k.n()).done;){var C=w.value;this.listName.includes(C.name)?this.nameChildren.push(C):this.saveNodeChildrenByName(C)}}catch(n){k.e(n)}finally{k.f()}}}},{key:"saveNodeChildrenByType",value:function(n,w){var k,C=arguments.length>1&&void 0!==w?w:0;if(this.batchAllNodes){var _=n.getComponentsInChildren(eO);if((k=this.allChildren).push.apply(k,j(_)),!(this.batchDepth<1||C>=this.batchDepth)){var A,T=L(this.allChildren);try{for(T.s();!(A=T.n()).done;){var I=A.value;this.saveNodeChildrenByType(I.node,this.batchDepth)}}catch(n){T.e(n)}finally{T.f()}}}}},{key:"hierarchyChildren",value:function(){var n,t=function(n,w){n.node.isValid&&n.node.activeInHierarchy&&w&&!n.node.isChildOf(w)&&(n.node.setParent(w,!0),n.node.layer=e6.Enum.UI_2D)},w=["GlobalLabelNode","GlobalSpriteNode","GlobalBatchNode"],k=L(this.labelChildren);try{for(k.s();!(n=k.n()).done;)t(n.value,this.batchNode.label)}catch(n){k.e(n)}finally{k.f()}var C,_=L(this.spriteChildren);try{for(_.s();!(C=_.n()).done;)t(C.value,this.batchNode.sprite)}catch(n){_.e(n)}finally{_.f()}var A,T=L(this.allChildren);try{for(T.s();!(A=T.n()).done;)t(A.value,this.batchNode.node)}catch(n){T.e(n)}finally{T.f()}this.allChildren.sort(function(n,w){return n.constructor.name.localeCompare(w.constructor.name)}),this.labelChildren.sort(function(n,w){return n.cacheMode-w.cacheMode});var I,O=L(this.nameChildren);try{for(O.s();!(I=O.n()).done;){var D=I.value;if(D.isValid&&D.activeInHierarchy&&D.isTransformDirty()){var M=D.getComponent(eH);if(!(M&&M.opacity<1||w.includes(D.name))){var N=this.batchNode[D.name];N&&(D.isChildOf(N)||(D.setParent(N,!0),D.layer=e6.Enum.UI_2D))}}}}catch(n){O.e(n)}finally{O.f()}}},{key:"restoreOriginalChildren",value:function(){var n=[].concat(j(this.labelChildren),j(this.spriteChildren));if(n.length>0){var w,k=L(n);try{for(k.s();!(w=k.n()).done;){var C=w.value,_=this.originalParents[C.uuid];_&&(C.node.isChildOf(_)||C.node.setParent(_,!0))}}catch(n){k.e(n)}finally{k.f()}}var A,T=L(this.nameChildren);try{for(T.s();!(A=T.n()).done;){var I=A.value,O=this.originalParents[I.uuid];O&&(I.isChildOf(O)||I.setParent(O,!0))}}catch(n){T.e(n)}finally{T.f()}}}]),u}(eO)).prototype,"batchByName",[oU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o0=n(oQ.prototype,"depthNames",[oG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o1=n(oQ.prototype,"listName",[oH],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),o2=n(oQ.prototype,"batchLabel",[oV],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o4=n(oQ.prototype,"depthLabel",[oq],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),o3=n(oQ.prototype,"typeLabel",[oW],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"char"}}),o5=n(oQ.prototype,"batchSprite",[oK],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o6=n(oQ.prototype,"depthSprite",[oj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o8=n(oQ.prototype,"batchAllNodes",[oY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),o9=n(oQ.prototype,"batchDepth",[oX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o7=n(oQ.prototype,"checkOverlap",[oZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),oJ=oQ))||oJ)||oJ);ew._RF.pop(),ew._RF.push({},"9b958Lf6PFClb/JuJfTLzxG","Vibrate",void 0);var sd,sy=eS.ccclass,sf=GameCore.Utils.Browser,sv=globalThis.game.player,sg=sy("Vibrate")(si=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"vibrate",value:function(n){if(this.isVibrateEnable()&&!sf.vibrate(n)){if("performHapticFeedbackAsync"in GameSDK.extra)return void GameSDK.extra.performHapticFeedbackAsync();console.warn("Vibrate failed")}}},{key:"isVibrateEnable",value:function(){return!!sv.getPlayerSetting("vibrate")}}]),o}(eO))||si;ew._RF.pop(),ew._RF.push({},"62927KYr+tCcIzOaPtVc/q8","CoinData",void 0);var sm=10,sb=20,sw=100,sS=(Y(sd={},X.HINT,80),Y(sd,X.THUNDER,200),Y(sd,X.STORM,150),Y(sd,X.PLIERS,150),sd),sk=2e3,sC=300;ew._RF.pop(),ew._RF.push({},"8328a20Ku5GF4anma0sBaxm","DailyRewardsData",void 0);var sE={0:{id:1,type:"coin",value:20},1:{id:2,type:"coin",value:30},2:{id:3,type:"coin",value:50},3:{id:4,type:"coin",value:100},4:{id:5,type:"coin",value:150},5:{id:6,type:"coin",value:200},6:{id:7,type:"coin",value:250,items:{hint:3,thunder:3,storm:3,pliers:0}}};ew._RF.pop(),ew._RF.push({},"ad867amogBFGJo9jp78EnQP","DevTools",void 0);var s_=function(n){return n.UNLOCK_DEV_TOOLS="unlock-dev-tools",n.TRIGGER_UNLOCK_KEY="trigger-unlock-key",n.TRIGGER_RESET_SEQUENCE="trigger-reset-sequence",n}(s_||{}),sA={Events:s_,UNLOCK_SEQUENCE:"101013012031"};ew._RF.pop(),ew._RF.push({},"f16ffbXQPtDK58g6BNFwzJv","Tournament",void 0);var sT=function(n){return n.RELOAD_TOURNAMENT="reload-tournament",n}(sT||{});ew._RF.pop(),ew._RF.push({},"ad7acMQ2iJNKKA2RkT+nGNI","CommonError",void 0);var sP=function(n){w(o,n);var _=k(o);function o(n,w){var k;return C(this,o),(k=_.call(this,w)).code=n,k}return T(o)}(Z(Error));ew._RF.pop(),ew._RF.push({},"5ff78u05/tPepABfMzNaOjM","PlayerHasTournamentError",void 0);var sR=function(n){w(o,n);var _=k(o);function o(n,w){var k;return C(this,o),(k=_.call(this,"PLAYER_HAS_TOURNAMENT","Player has a tournament")).playerId=n,k.tournamentId=w,k}return T(o)}(sP);ew._RF.pop(),ew._RF.push({},"e80e4nIcfdLN56j5b9SMhvH","LeaderboardUtils",void 0);var sI=globalThis.game.leaderboard,sL=function(){function e(){C(this,e)}var n,w,k;return T(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"getAllLeaderboardAsync",value:(k=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:if(!sI)return[2,null];return[4,sI.getLeaderboardResponseAsync(n)];case 1:w=_.sent();if(!w)return[2,null];k=sI.getLeaderboardName(n);if(!k)return[3,3];return[4,this.requestLeaderboardAsync(k,w.amountPlayer)];case 2:C=(_.sent(),sI.getLeaderboard(k));return[3,4];case 3:C=null;_.label=4;case 4:return[2,C]}})}),function(n){return k.apply(this,arguments)})},{key:"requestLeaderboardAsync",value:(w=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:if(!this.isLeaderboardRequesting(n))return[3,2];return[4,this.waitForLeaderboardFinishAsync(n)];case 1:k.sent();return[3,4];case 2:return[4,sI.requestLeaderboardAsync(n,w)];case 3:k.sent();k.label=4;case 4:return[2]}})}),function(n,k){return w.apply(this,arguments)})},{key:"waitForLeaderboardFinishAsync",value:(n=M(function(n){var w;return _ts_generator(this,function(k){w=this;if(this.isLeaderboardRequesting(n))return[2,new Promise(function(k){var C=setInterval(function(){w.isLeaderboardRequesting(n)||(clearInterval(C),k())},100)})];return[2]})}),function(w){return n.apply(this,arguments)})},{key:"isLeaderboardRequesting",value:function(n){var w;return(null===(w=sI.getLeaderboard(n))||void 0===w?void 0:w.isRequesting)||!1}}]),e}();try{new sL}catch(n){console.error("LeaderboardUtils",n)}ew._RF.pop(),ew._RF.push({},"e14dbcdc89LQJIggfi5qO6U","MapData",void 0);var sO={mapOrder:[{id:1,theme:"summer",skins:["fruit"],levelCount:10},{id:2,theme:"autumn",skins:["flower"],levelCount:10},{id:3,theme:"winter",skins:["tool"],levelCount:10},{id:4,theme:"summer",skins:["sport"],levelCount:10},{id:5,theme:"autumn",skins:["cosmetics"],levelCount:10},{id:6,theme:"winter",skins:["ice-cream"],levelCount:10},{id:7,theme:"summer",skins:["cakes"],levelCount:10},{id:8,theme:"autumn",skins:["car"],levelCount:10},{id:9,theme:"spring-festival",skins:["flower","ice-cream"],levelCount:10},{id:10,theme:"tree-planting-festival",skins:["fruit","car","tool"],levelCount:10},{id:11,theme:"blue-sea-festival",skins:["sport","fruit"],levelCount:10},{id:12,theme:"music-festival",skins:["cakes","car","cosmetics"],levelCount:10},{id:13,theme:"harvest-festival",skins:["fruit","car","tool"],levelCount:10},{id:14,theme:"food-festival",skins:["cakes","ice-cream","cosmetics"],levelCount:10},{id:15,theme:"snow-festival",skins:["cakes","sport"],levelCount:10},{id:16,theme:"light-festival",skins:["ice-cream","car"],levelCount:10},{id:17,theme:"peace-festival",skins:["flower","sport","tool"],levelCount:10},{id:18,theme:"flower-festival",skins:["flower","fruit"],levelCount:10},{id:19,theme:"street-festival",skins:["fruit","ice-cream","sport"],levelCount:10},{id:20,theme:"color-garden",skins:["cakes","cosmetics","tool"],levelCount:10},{id:21,theme:"color-festival",skins:["flower","cakes","fruit"],levelCount:10},{id:22,theme:"nature-summer",skins:["flower","sport"],levelCount:10},{id:23,theme:"snow-mountain",skins:["cakes","ice-cream"],levelCount:10},{id:24,theme:"ice-festival",skins:["ice-cream","cosmetics"],levelCount:10},{id:25,theme:"green-grass-festival",skins:["flower","sport","tool"],levelCount:10},{id:26,theme:"community-festival",skins:["cosmetics","cakes","ice-cream"],levelCount:10},{id:27,theme:"water-festival",skins:["sport","ice-cream","flower"],levelCount:10},{id:28,theme:"animal-festival",skins:["flower","fruit","cakes"],levelCount:10},{id:29,theme:"lost-festival",skins:["sport","tool","car"],levelCount:10},{id:30,theme:"halloween-festival",skins:["cakes","car","fruit"],levelCount:10},{id:31,theme:"snow-music-festival",skins:["ice-cream","sport","tool"],levelCount:10},{id:32,theme:"christmas",skins:["cakes","flower","sport"],levelCount:10},{id:33,theme:"spring-flower-festival",skins:["flower","fruit"],levelCount:10},{id:34,theme:"tet-holiday",skins:["flower","cosmetics","fruit"],levelCount:10},{id:35,theme:"sea-festival",skins:["ice-cream","sport"],levelCount:10},{id:36,theme:"firework-festival",skins:["cosmetics","car","tool"],levelCount:10},{id:37,theme:"halloween-horror",skins:["cakes","car","fruit"],levelCount:10},{id:38,theme:"mid-autumn",skins:["flower","fruit","ice-cream"],levelCount:10},{id:39,theme:"christmas-sweet",skins:["cakes","flower","sport"],levelCount:10},{id:40,theme:"new-year-countdown",skins:["cosmetics","car","tool"],levelCount:10}]};ew._RF.pop(),ew._RF.push({},"6093adbLQZKpqgUpTV/sHj1","ThemeUtils",void 0);var sD=globalThis.game,sM=sD.player,sN=sD.storage,sz=sO.mapOrder.map(function(n){return{skins:n.skins,themeId:n.theme,currentProgress:0,maxProgress:n.levelCount,isLocked:!0}}),sB=function(){function e(){C(this,e),this.playerSkinProgress=sz.map(function(n){return I({},n)})}return T(e,[{key:"initDashboardSceneStorage",value:function(){var n=sN.getStorage("dashboard");if(null==n){var w=this.getCurrentMapProgressInstance();sN.addStorage("dashboard",{lastMapPayload:w,numOfMapsPassed:0,animateToCurrentLevel:!1});var k=sN.getStorage("collection");if(null==k){sN.addStorage("collection",{lastMapPack:w.id,animateMapPackUnlock:!1});var C=sN.getStorage("leaderboard_content");if(null==C){sN.addStorage("leaderboard_content",{lastTabOpened:"global",previousScore:-1});var _=sN.getStorage("tournament");null==_&&sN.addStorage("tournament",{animateTournamentLeader:!1,previousScore:-1})}}}}},{key:"getCurrentMapProgressInstance",value:function(){for(var n=void 0,w=void 0,k=0,C=0,_=0,A=0,T=sO.mapOrder.length;A<T;A++){var I=this.playerSkinProgress[A],L=sO.mapOrder[A],O=sO.mapOrder[A+1];if(I.currentProgress<I.maxProgress){var D;_=L.id,n=L.theme,w=null!==(D=null==O?void 0:O.theme)&&void 0!==D?D:n,k=I.currentProgress,C=I.maxProgress;break}}if(void 0===n||void 0===w){var M=sO.mapOrder[sO.mapOrder.length-1];return{id:_=M.id,currentTheme:n=M.theme,nextTheme:w=M.theme,progress:k=M.levelCount,max:C=M.levelCount}}return{id:_,currentTheme:n,nextTheme:w,progress:k,max:C}}},{key:"getUnlockedSkinsInstance",value:function(){var n,w=[],k=L(this.playerSkinProgress);try{for(k.s();!(n=k.n()).done;){var C=n.value;if(!C.isLocked&&1===C.skins.length){var _=C.skins[0];_&&w.push(_)}}}catch(n){k.e(n)}finally{k.f()}return w}},{key:"getLevelSkinsInstance",value:function(n){var w,k=null!=n?n:1,C=0,_=L(sO.mapOrder);try{for(_.s();!(w=_.n()).done;){var A=w.value;if(C+A.levelCount>=k)return A.skins;C+=A.levelCount}}catch(n){_.e(n)}finally{_.f()}return sO.mapOrder[sO.mapOrder.length-1].skins}},{key:"getLevelThemeInstance",value:function(n){var w,k=null!=n?n:1,C=0,_=L(sO.mapOrder);try{for(_.s();!(w=_.n()).done;){var A=w.value;if(C+A.levelCount>=k)return A.theme;C+=A.levelCount}}catch(n){_.e(n)}finally{_.f()}return sO.mapOrder[sO.mapOrder.length-1].theme}},{key:"getThemeSkinsInstance",value:function(n){var w,k=L(sO.mapOrder);try{for(k.s();!(w=k.n()).done;){var C=w.value;if(C.theme===n)return C.skins}}catch(n){k.e(n)}finally{k.f()}return[]}},{key:"getCollectionUnlockProgressInstance",value:function(){var n,w=[],k=L(this.playerSkinProgress);try{for(k.s();!(n=k.n()).done;){var C=n.value;w.push({skins:C.skins,theme:C.themeId,progress:C.currentProgress,max:C.maxProgress,isLocked:C.isLocked})}}catch(n){k.e(n)}finally{k.f()}return w}},{key:"updatePlayerSkinProgress",value:function(){var n,w=sM.getGameData(),k=(null!==(n=null==w?void 0:w.level)&&void 0!==n?n:1)-1;this.playerSkinProgress[0].isLocked=!1;for(var C=0,_=sO.mapOrder.length;C<_;C++){var A=sO.mapOrder[C];if(!(k<=0)){var T=k-A.levelCount>=0?A.levelCount:k;k-=T,this.increaseProgress(C,T)}}}},{key:"increaseProgress",value:function(n,w){if(n<0||n>=this.playerSkinProgress.length)throw new Error("increaseProgress: index out of range");var k,C=this.playerSkinProgress[n],_=C.currentProgress,A=C.maxProgress,T=_+w>A?A:_+w;T>0&&(C.isLocked=!1),T===A&&(null===(k=sO.mapOrder[n+1])||void 0===k?void 0:k.skins)&&(this.playerSkinProgress[n+1].isLocked=!1);C.currentProgress=T,C.maxProgress=A}}],[{key:"getInstance",value:function(){return this._instance||(this._instance=new e),this._instance}},{key:"init",value:function(){var n=this.getInstance();n.updatePlayerSkinProgress(),n.initDashboardSceneStorage()}},{key:"getCurrentMapProgress",value:function(){return this.getInstance().getCurrentMapProgressInstance()}},{key:"getUnlockedSkins",value:function(){return this.getInstance().getUnlockedSkinsInstance()}},{key:"getLevelSkins",value:function(n){return this.getInstance().getLevelSkinsInstance(n)}},{key:"getLevelTheme",value:function(n){return this.getInstance().getLevelThemeInstance(n)}},{key:"getThemeSkins",value:function(n){return this.getInstance().getThemeSkinsInstance(n)}},{key:"getCollectionUnlockProgress",value:function(){return this.getInstance().getCollectionUnlockProgressInstance()}},{key:"getCurrentUnlockingThemeIndex",value:function(){var n=this.getCollectionUnlockProgress();if(0===n.length)return null;var w=0;return n.forEach(function(n,k){n.isLocked||(w=k)}),w}}]),e}();ew._RF.pop(),ew._RF.push({},"0397cr2IpZEwbRzwQhlVHMO","MatchUtils",void 0);var sF=globalThis.game,sx=sF.match,sU=sF.player,sG=sF.leaderboard,sH=sF.frameCapture,sV=GameCore,sq=sV.Utils,sW=sq.Object,sK=sq.Valid,sj=sq.String,sY=sq.Array,sX=sV.Match.Modes,sZ=sV.Dtos.Match.Data,sJ=["Champion","Ultimate","Grand","Elite","Master's","Premier","Epic","Pro's","Supreme","Legendary","Victory","Prime","Titan's","Hero's","Star's"],sQ=function(){function e(){C(this,e)}var n,w,k,_,A,I,O,D,N,z,B,F,x,U,G,H,V,q,W;return T(e,[{key:"processStartSingleModeAsync",value:(W=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=sU.getPlayerId();return[4,sx.single.start.processAsync({playerId:n})];case 1:w.sent();return[2]}})}),function(){return W.apply(this,arguments)})},{key:"processFinishSingleModeAsync",value:(q=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,sx.single.finish.processAsync()];case 1:n.sent();return[2]}})}),function(){return q.apply(this,arguments)})},{key:"processStartTournamentModeAsync",value:(V=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:n=sU.getPlayerId(),w=GameSDK.context.getID();return[4,sx.tournament.continue.processAsync({playerId:n,contextId:w})];case 1:k.sent();return[2]}})}),function(){return V.apply(this,arguments)})},{key:"processFinishTournamentModeAsync",value:(H=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:n=sU.getPlayerId(),w=sU.getBestScore();return[4,sx.tournament.finish.processAsync({playerId:n,bestScore:w})];case 1:k.sent();return[2]}})}),function(){return H.apply(this,arguments)})},{key:"processStartChallengeModeAsync",value:(G=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:C.trys.push([0,2,,7]);return[4,this.processContinueChallengeAsync()];case 1:C.sent();return[3,7];case 2:n=C.sent();if(!sW.hasOwn(n,"name")||sK.isString(n.name))throw n;w="PlayerHasFinishedMatch"===n.name;if(!w)return[3,4];return[4,this.processChallengeNewOpponentAsync()];case 3:w=C.sent();C.label=4;case 4:k="PlayerNotJoinInMatch"===n.name;if(!k)return[3,6];return[4,this.processJoinChallengeAsync()];case 5:k=C.sent();C.label=6;case 6:return[3,7];case 7:return[2]}})}),function(){return G.apply(this,arguments)})},{key:"processFinishChallengeModeAsync",value:(U=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:sH.addWideframeRender("renderResultChallenge",sH.wideframe.renderResultChallenge);return[4,sx.challenge.finish.processAsync(n)];case 1:w.sent();return[2]}})}),function(n){return U.apply(this,arguments)})},{key:"processContinueChallengeAsync",value:(x=M(function(){var n,w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:n=this.getMatchState(),w=n.id,k=n.customData,C=k.playerId,_=k.opponentId;if(!sK.isString(w))throw new Error("Invalid match id");if(!sK.isString(C))throw new Error("Invalid player id");if(!sK.isString(_))throw new Error("Invalid opponent id");A=GameSDK.context.getID();if(!A)throw new Error("Cannot get contextId");return[4,sx.challenge.continue.processAsync({matchId:w,contextId:A,playerId:C,opponentId:_})];case 1:T.sent();return[2]}})}),function(){return x.apply(this,arguments)})},{key:"processChallengeNewOpponentAsync",value:(F=M(function(){var n,w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:n=sU.getConnectedPlayerIds(100,0),w=Math.floor(Math.random()*n.length),k=sU.getPlayerId(),C=n[w];return[4,sx.challenge.friend.processAsync({playerId:k,opponentId:C})];case 1:_.sent();return[2]}})}),function(){return F.apply(this,arguments)})},{key:"processJoinChallengeAsync",value:(B=M(function(){var n,w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:n=this.getMatchState(),w=n.id,k=n.customData,C=k.playerId,_=k.opponentId;if(!sK.isString(w))throw new Error("Invalid match id");if(!sK.isString(C))throw new Error("Invalid player id");if(!sK.isString(_))throw new Error("Invalid opponent id");return[4,sx.challenge.join.processAsync({matchId:w,playerId:C,opponentId:_})];case 1:A.sent();return[2]}})}),function(){return B.apply(this,arguments)})},{key:"getMatchState",value:function(){var n=sx.getMatchState();if(!n)throw new Error("Match state not found");return n}}],[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"startMatchAsync",value:(z=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:C.trys.push([0,10,,11]);w=null!=n?n:this.getMatchMode();switch(w){case sX.SINGLE:return[3,1];case sX.TOURNAMENT:return[3,3];case sX.CHALLENGE_FRIEND:return[3,5]}return[3,7];case 1:return[4,this.inst.processStartSingleModeAsync()];case 2:C.sent();return[3,9];case 3:return[4,this.inst.processStartTournamentModeAsync()];case 4:C.sent();return[3,9];case 5:return[4,this.inst.processStartChallengeModeAsync()];case 6:C.sent();return[3,9];case 7:return[4,this.inst.processStartSingleModeAsync()];case 8:C.sent();C.label=9;case 9:return[3,11];case 10:k=C.sent();console.warn("startMatchAsync",k);return[3,11];case 11:return[2]}})}),function(n){return z.apply(this,arguments)})},{key:"setProfileMatchDataAsync",value:(N=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,2,,3]);return[4,sx.handler.setProfileData(n)];case 1:k.sent();return[3,3];case 2:w=k.sent();console.warn("setProfileMatchDataAsync",w);return[3,3];case 3:return[2]}})}),function(n){return N.apply(this,arguments)})},{key:"setMatchCustomDataAsync",value:(D=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,2,,3]);return[4,sx.handler.setMatchCustomData(n)];case 1:k.sent();return[3,3];case 2:w=k.sent();console.warn("setMatchCustomDataAsync",w);return[3,3];case 3:return[2]}})}),function(n){return D.apply(this,arguments)})},{key:"setLeaderboardScoreAsync",value:(O=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,2,,3]);return[4,sx.handler.setLeaderboardScore(n)];case 1:k.sent();return[3,3];case 2:w=k.sent();console.warn("setLeaderboardScoreAsync",w);return[3,3];case 3:return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"finishMatchAsync",value:(I=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:C.trys.push([0,10,,11]);w=this.getMatchMode();switch(w){case sX.SINGLE:return[3,1];case sX.TOURNAMENT:return[3,3];case sX.CHALLENGE_FRIEND:return[3,5]}return[3,7];case 1:return[4,this.inst.processFinishSingleModeAsync()];case 2:C.sent();return[3,9];case 3:return[4,this.inst.processFinishTournamentModeAsync()];case 4:C.sent();return[3,9];case 5:return[4,this.inst.processFinishChallengeModeAsync(n)];case 6:C.sent();return[3,9];case 7:return[4,this.inst.processFinishSingleModeAsync()];case 8:C.sent();C.label=9;case 9:return[3,11];case 10:k=C.sent();console.warn("finishMatchAsync",k);return[3,11];case 11:return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"joinTournamentAsync",value:(A=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=sU.getPlayerId();return[4,sx.tournament.join.processAsync({tournamentId:n,playerId:w})];case 1:k.sent();return[2]}})}),function(n){return A.apply(this,arguments)})},{key:"continueTournamentAsync",value:(_=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=sU.getPlayerId();return[4,sx.tournament.continue.processAsync({playerId:w,contextId:n})];case 1:k.sent();return[2]}})}),function(n){return _.apply(this,arguments)})},{key:"createTournamentName",value:function(){var n=sJ[e0.randomRangeInt(0,sJ.length-1)],w="".concat(n," Tournament"),k=sj.removeDiacritics(w);return"".concat(k)}},{key:"getShortName",value:function(n,w){var k,C=arguments.length>1&&void 0!==w?w:50,_=n.split(" "),A=0,T="",I=L(_);try{for(I.s();!(k=I.n()).done;){var O=k.value;if(A+O.length+1>C)break;T+="".concat(O," "),A+=O.length+1}}catch(n){I.e(n)}finally{I.f()}return T.slice(0,-1)}},{key:"createTournamentPayload",value:function(){var n,w,k,C=sj.generateObjectId(),_=sU.getPlayerId(),A=sU.getPlayer().name,T=sU.getGameData(),I=null!==(n=null==T?void 0:T.level)&&void 0!==n?n:1,L=sB.getLevelTheme(I),O=this.inst.getMatchState().profiles;return{score:null!==(w=null===(k=(void 0===O?{}:O)[_])||void 0===k?void 0:k.score)&&void 0!==w?w:0,playerId:_,mode:sX.TOURNAMENT,name:this.createTournamentName(),leaderboardId:C,payload:{playerId:_,playerName:A,leaderboardId:C,themeId:L}}}},{key:"getTournamentsAsync",value:(k=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:w.trys.push([0,2,,3]);return[4,GameSDK.tournament.getTournamentsAsync()];case 1:return[2,w.sent()];case 2:n=w.sent();return[2,(console.error(n),[])];case 3:return[2]}})}),function(){return k.apply(this,arguments)})},{key:"processCreateTournamentAsync",value:(w=M(function(){var n,w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:return[4,this.getTournamentsAsync()];case 1:n=_.sent(),w=sY.search(n,function(n){var w,k=JSON.parse(null!==(w=n.getPayload())&&void 0!==w?w:"{}");return"DEFAULT"===n.getTournamentType()&&k.playerId===sU.getPlayerId()});if(w)throw new sR(sU.getPlayerId(),w.getID());k=this.createTournamentPayload();sU.setGameData({lastCreateTournamentShown:Date.now()});return[4,sx.tournament.create.processAsync(k)];case 2:_.sent();C=k.leaderboardId;sG.addLeaderboard({name:C,type:"tournament",autoSortRank:!0,leaderboardId:C});return[2]}})}),function(){return w.apply(this,arguments)})},{key:"getMatchMode",value:function(){var n=this.inst.getMatchState();return sK.isString(n.mode)?n.mode:null}},{key:"getMatchCustomData",value:function(){var n=this.inst.getMatchState();return sK.isObject(n.customData)?n.customData:null}},{key:"getMatchExtraDataAsync",value:(n=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:return[4,sx.api.getMatchAPI().getMatchDetailByIdAsync(n)];case 1:w=k.sent();return[2,new sZ(w).toObject().extraData]}})}),function(w){return n.apply(this,arguments)})},{key:"updateMatchStateAfterLevelFinish",value:function(n,w){this.setMatchCustomDataAsync({level:n,score:w});var k=sU.getPlayerId();this.setProfileMatchDataAsync({id:k,score:w})}}]),e}();ew._RF.pop(),ew._RF.push({},"d90c4WisP9LybAFqNuS6imZ","FailKeys",void 0);var s$,s0="time",s1="bomb";ew._RF.pop(),ew._RF.push({},"44b50YkamZDD5fO9vdZKeG7","InputController",void 0);var s2,s4=(0,eS.ccclass)("InputController")(s$=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).handleElementPointerDown=function(){},n.handleElementPointerUp=function(n){},n}return T(o,[{key:"onLoad",value:function(){this.listenInputEvents()}},{key:"listenInputEvents",value:function(){eZ.os!==eZ.OS.WINDOWS&&eZ.os!==eZ.OS.OSX||(document.addEventListener("pointerup",this.handleElementPointerUp),document.addEventListener("pointerdown",this.handleElementPointerDown))}},{key:"onDestroy",value:function(){eZ.os!==eZ.OS.WINDOWS&&eZ.os!==eZ.OS.OSX||(document.removeEventListener("pointerup",this.handleElementPointerUp),document.removeEventListener("pointerdown",this.handleElementPointerDown))}}]),o}(eO))||s$;ew._RF.pop(),ew._RF.push({},"ed5c6D+6KVEj5lrgtq+D9bJ","LayoutUtils",void 0);var s3=q.Layout,s5=function(){function e(){C(this,e),this.currentLayout="",eY.off(V.LAYOUT_CHANGED,e.onLayoutChanged),eY.on(V.LAYOUT_CHANGED,e.onLayoutChanged)}return T(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"getCurrentLayout",value:function(){return this.inst.currentLayout}},{key:"isPortrait",value:function(){return this.inst.currentLayout===s3.Portrait}},{key:"isLandscape",value:function(){return this.inst.currentLayout===s3.Landscape}}]),e}();s2=s5,s5.onLayoutChanged=function(n){s2.inst.currentLayout!==n&&(s2.inst.currentLayout=n,eY.emit(V.ORIENTATION_CHANGED,n))};try{new s5}catch(n){console.error("LayoutUtils",n)}ew._RF.pop(),ew._RF.push({},"7f144HjLfBLWbFvbRFCCt8e","Directions",void 0);var s6={Up:{x:0,y:1},Down:{x:0,y:-1},Left:{x:-1,y:0},Right:{x:1,y:0}};ew._RF.pop(),ew._RF.push({},"361eckT3VBO5ZFyetePNmNY","LevelGravity",void 0);var s8="fall-down",s9="fly-up",s7="push-left",le="push-right",lt="put-column-middle",ln="put-row-middle";function nu(n){for(var w=n.array,k=n.isLighter,C=n.out,_=void 0===C?new Set:C,A=0;A<w.length;A++)if(k(w.get(A))){for(var T=A+1;T<w.length;T++)if(!k(w.get(T))){w.swap(A,T),_.add(w.get(A));break}}return _}ew._RF.pop(),ew._RF.push({},"bfb989Gr/dArq4M9uSSrF5/","stagger",void 0),ew._RF.pop(),ew._RF.push({},"cf506DevntPeIl9QrpMEBY0","Grid",void 0);var li,la,lr,lo,ls,ll,lu,lc,lh,lp,ld,ly,lf,lv,lg,lm,lb,lw,lS,lk,lC,lE,l_,lA,lT,lP,lR,lI,lL,lO,lD,lM=function(){function e(n){var w;C(this,e),this.array=[];var k=null!=n?n:{},_=k.width,A=void 0===_?1:_,T=k.height,I=void 0===T?1:T,L=_instanceof(n,e)?n.array:null!==(w=null==n?void 0:n.content)&&void 0!==w?w:[];if(L.length!==A*I)throw new Error("Invalid content length");this.width=A,this.height=I,this.array=j(L)}return T(e,[{key:"asArray",value:function(){return this.array}},{key:"get",value:function(n,w){return this.array[w*this.width+n]}},{key:"set",value:function(n,w,k){this.array[w*this.width+n]=k}},{key:"isInBounds",value:function(n,w){return n>=0&&n<this.width&&w>=0&&w<this.height}},{key:"forEach",value:function(n){for(var w=0;w<this.height;w++)for(var k=0;k<this.width;k++)n(this.get(k,w),k,w)}},{key:"map",value:function(n){for(var w=[],k=0;k<this.height;k++)for(var C=0;C<this.width;C++)w.push(n(this.get(C,k),C,k));return w}},{key:"reduce",value:function(n,w){for(var k=w,C=0;C<this.height;C++)for(var _=0;_<this.width;_++)k=n(k,this.get(_,C),_,C);return k}},{key:"swap",value:function(n,w){var k=J(n,2),C=k[0],_=k[1],A=J(w,2),T=A[0],I=A[1],L=this.get(C,_);this.set(C,_,this.get(T,I)),this.set(T,I,L)}},{key:"shuffle",value:function(n){for(var w=null!=n?n:this.map(function(n,w,k){return[w,k]}),k=j(w),C=new Set,_=k.length-1;_>0;_--){var A=e8(0,_+1),T=[k[A],k[_]];k[_]=T[0],k[A]=T[1],C.add(this.get(k[_][0],k[_][1])),C.add(this.get(k[A][0],k[A][1]))}for(var I=0;I<k.length;I++){var L=J(w[I],2),O=L[0],D=L[1],M=J(k[I],2),N=M[0],z=M[1];this.swap([O,D],[N,z])}return C}},{key:"toShuffled",value:function(n){var w=new e({width:this.width,height:this.height,content:this.array}),k=w.shuffle(n);return[w,k]}},{key:"gravitate",value:function(n){var w=this,k=J(n.rowRange,2),C=k[0],_=k[1],A=J(n.colRange,2),T=A[0],I=A[1],L=n.direction,O=n.isLighter,D=n.onSwap,M=n.out,N=void 0===M?new Set:M,z=I-T+1,B=_-C+1;switch(L){case s6.Up:for(var f=function(n){nu({array:{length:B,get:function(k){return w.get(n,_-k)},swap:function(k,C){var A=w.get(n,_-k),T=w.get(n,_-C);w.swap([n,_-k],[n,_-C]),null==D||D(A,T)}},isLighter:O,out:N})},F=T;F<=I;F++)f(F);return N;case s6.Down:for(var g=function(n){nu({array:{length:B,get:function(k){return w.get(n,C+k)},swap:function(k,_){var A=w.get(n,C+k),T=w.get(n,C+_);w.swap([n,C+k],[n,C+_]),null==D||D(A,T)}},isLighter:O,out:N})},x=T;x<=I;x++)g(x);return N;case s6.Left:for(var b=function(n){nu({array:{length:z,get:function(k){return w.get(T+k,n)},swap:function(k,C){var _=w.get(T+k,n),A=w.get(T+C,n);w.swap([T+k,n],[T+C,n]),null==D||D(_,A)}},isLighter:O,out:N})},U=C;U<=_;U++)b(U);return N;case s6.Right:for(var S=function(n){nu({array:{length:z,get:function(k){return w.get(I-k,n)},swap:function(k,C){var _=w.get(I-k,n),A=w.get(I-C,n);w.swap([I-k,n],[I-C,n]),null==D||D(_,A)}},isLighter:O,out:N})},G=C;G<=_;G++)S(G);return N;default:throw new Error("Invalid direction")}}},{key:"toGravitated",value:function(){var n=new e({width:this.width,height:this.height,content:this.array}),w=n.gravitate.apply(n,arguments);return[n,w]}},{key:"toRotated",value:function(){for(var n=new e({width:this.height,height:this.width,content:new Array(this.width*this.height)}),w=0;w<this.height;w++)for(var k=0;k<this.width;k++)n.set(this.height-1-w,k,this.get(k,w));return n}}]),e}();ew._RF.pop(),ew._RF.push({},"4046cPYak1BDIVFKksVPsnk","index",void 0),ew._RF.pop(),ew._RF.push({},"ea140gA27tJa4LD9MT3t93/","Tile",void 0);var lN=eS.ccclass,lz=eS.property,lB=eS.requireComponent,lF=(li=lN("Tile"),la=lB([e_]),lr=lB([eH]),lo=lz({type:ex,group:"Sprite"}),ls=lz({type:ex,group:"Sprite"}),ll=lz({type:ex,group:"Sprite"}),lu=lz({type:ex,group:"Sprite"}),lc=lz({type:e_,displayName:"Background UI Transform"}),lh=lz(e9),lp=lz({type:eH,group:"Opacity"}),ld=lz({type:eH,group:"Opacity"}),ly=lz({type:eH,group:"Opacity"}),lf=lz({type:eH,group:"Opacity"}),lv=lz(im),lg=lz(e7),lm=lz(ek),li(lb=la(lb=lr((lS=n((lw=function(n){w(E,n);var I,L,O,D,x,U,H,V,q,W,K=k(E);function E(){var n;C(this,E);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=K.call.apply(K,[this].concat(k)),_(n,"icon",lS,A(n)),_(n,"bombComponent",lk,A(n)),_(n,"starComponent",lC,A(n)),_(n,"background",lE,A(n)),_(n,"bgUITransform",l_,A(n)),_(n,"defaultBackground",lA,A(n)),_(n,"uiOpacity",lT,A(n)),_(n,"shineOpacity",lP,A(n)),_(n,"glowOpacity",lR,A(n)),_(n,"iconOpacity",lI,A(n)),_(n,"button",lL,A(n)),_(n,"animationComponent",lO,A(n)),_(n,"container",lD,A(n)),n.id=null,n.isEmpty=!1,n.coord=new e4,n.signal=new F,n}return T(E,[{key:"onLoad",value:function(){z.lazyValidateProperties(this),this.special=this.createSpecialHandler(Q.none)}},{key:"update",value:function(n){var w;(null===(w=this.special)||void 0===w?void 0:w.type)===Q.bomb&&this.special.update(n)}},{key:"onDestroy",value:function(){var n,w;(null===(n=this.special)||void 0===n?void 0:n.type)===Q.bomb&&(null===(w=this.special)||void 0===w||w.onDestroy())}},{key:"setIgnoreInput",value:function(n){var w=!(arguments.length>0&&void 0!==n)||n;this.button.interactable=!w}},{key:"getCoord",value:function(){return this.coord}},{key:"setCoord",value:function(n,w){this.coord.set(n,w)}},{key:"isSimilarTo",value:function(n){return this.id===n.id}},{key:"inSamePositionAs",value:function(n,w){return _instanceof(n,E)?this.coord.equals(n.getCoord()):this.coord.x===n&&this.coord.y===w}},{key:"isHidden",value:function(){return this.isEmpty}},{key:"getSize",value:function(){return[this.bgUITransform.width,this.bgUITransform.height]}},{key:"onClick",value:function(){this.isHidden()||this.node.scene.emit(i9.TILE_CLICK,this)}},{key:"setIdentity",value:function(n){this.id=n,this.icon.spriteFrame=n;var w=this.getSize(),k=J(w,2),C=k[0],_=k[1],A=n.originalSize,T=A.width,I=A.height,L=Math.max(T/(.7*C),I/(.7*_));L>1&&this.icon.node.setScale(new eQ(1/L,1/L,1))}},{key:"setSpecialType",value:function(n,w){var k,C=arguments.length>0&&void 0!==n?n:Q.none,_=arguments.length>1?w:void 0;null===(k=this.special)||void 0===k||k.switch(C,_)}},{key:"setFocused",value:(W=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:w=ez(this.shineOpacity).to(.15,{opacity:n?255:0},{easing:"cubicOut"});this.shineOpacity.node.scale=n?eQ.ZERO:eQ.ONE;k=ez(this.shineOpacity.node).to(.15,{scale:n?eQ.ONE:eQ.ZERO},{easing:"cubicOut"});if(n){C=ez(this.glowOpacity).to(2,{opacity:150});C.to(2,{opacity:20}),this.glowOpacityTween=ez(this.glowOpacity).repeatForever(C).start()}else this.glowOpacityTween&&this.glowOpacityTween.stop(),this.glowOpacity.opacity=0;return[4,Promise.all([N.runTweenAsync(w),N.runTweenAsync(k)])];case 1:_.sent();return[2]}})}),function(n){return W.apply(this,arguments)})},{key:"setEmpty",value:function(n){var w,k,C,_=arguments.length>0&&void 0!==n&&n;if(!this.isEmpty){var A;if(this.signal.abort(),this.isEmpty=!0,this.setIgnoreInput(!0),this.button.resetButtonState(),_)return this.uiOpacity.opacity=0,void(null===(A=this.special)||void 0===A||A.switch(Q.none));(null===(w=this.special)||void 0===w?void 0:w.type)!==Q.star&&(null===(k=this.special)||void 0===k?void 0:k.type)!==Q.bomb||this.special.clear(),null===(C=this.special)||void 0===C||C.switch(Q.none),this.uiOpacity.opacity=0}}},{key:"setHint",value:(q=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:if(!n)return[3,2];return[4,this.loadShakeClip()];case 1:C.sent(),this.shakeClip&&N.runAnimationAsync(this.animationComponent,this.shakeClip.name,this.signal);return[3,4];case 2:if(null===(w=this.animationComponent)||void 0===w||w.stop(),!this.container)return[2];k=ez(this.container).to(.1,{scale:eQ.ONE,eulerAngles:eQ.ZERO});return[4,N.runTweenAsync(k,this.signal)];case 3:C.sent();C.label=4;case 4:return[2]}})}),function(n){return q.apply(this,arguments)})},{key:"playClearFX",value:(V=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:this.signal.abort();w=new F;this.signal=w;k=null;if("clear"!==n)return[3,2];return[4,this.loadClearClip()];case 1:_.sent(),k=this.clearClip;return[3,4];case 2:return[4,this.loadBreakClip()];case 3:_.sent(),k=this.breakClip;_.label=4;case 4:C=null===k||w.aborted;if(C)return[3,6];return[4,N.runAnimationAsync(this.animationComponent,k.name,w)];case 5:C=_.sent();_.label=6;case 6:return[2]}})}),function(n){return V.apply(this,arguments)})},{key:"restore",value:(H=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:this.signal.abort();w=new F;this.signal=w,this.animationComponent.stop(),this.isEmpty=!1,this.setIgnoreInput(!0),n&&this.setIdentity(n),this.uiOpacity.opacity=255,this.iconOpacity.opacity=255,this.node.setScale(eQ.ZERO),this.background.spriteFrame=this.defaultBackground,this.button.fakeClick();return[4,N.runTweenAsync(ez(this.node).to(.3,{scale:eQ.ONE},{easing:"backOut"}),w)];case 1:k.sent(),this.node.setScale(eQ.ONE),this.setIgnoreInput(!1);return[2]}})}),function(n){return H.apply(this,arguments)})},{key:"sync",value:(U=M(function(n){var w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:w=n.duration,k=void 0===w?.3:w,C=n.delay,_=void 0===C?0:C,A=n.easing,T=void 0===A?"cubicOut":A,I=(0,n.getTargetPosition)(this.coord),L=new eQ(I.x,I.y,this.node.position.z);return[4,N.runTweenAsync(ez(this.node).delay(_).to(k,{position:L},{easing:T}))];case 1:O.sent();return[2]}})}),function(n){return U.apply(this,arguments)})},{key:"fly",value:(x=M(function(n){var w,k,C,_,A,T,I,L,O,D,M,z,B,F,x,U,G,H;return _ts_generator(this,function(V){w=this,k=300,C=Math.sqrt(Math.pow(this.node.position.x,2)+Math.pow(this.node.position.y,2)),_=Math.max(k-.7*C,0),A=C/1e3,T=this.node.position.clone(),I=n.getTilePosition(this.coord),L=new eQ(I.x,I.y,this.node.position.z),O=this.background.node,D=2,M=1,z=360,B=.0025*_,F=0,x=new eQ(0,0,0),U=.75-B,G={value:0,prevElapsed:0},H=ez(G);return[2,(H.delay(A),H.to(.5,{value:0},{progress:function(n,k,C,_){var A=(D*=-1)*_,I=T.clone();return I.x+=A,w.node.setPosition(I),C}}),H.to(B,{value:1},{progress:function(n,C,A,T){var I=N.expoOut(T),L=B*T-G.prevElapsed,D=B*T,F=_*I;w.setHeight(F,k);var x=w.node.position.clone();M+=.1,eQ.rotateZ(x,x,new eQ(0,0,0),M*Math.PI*L),w.node.setPosition(new eQ(x.x,x.y,x.z));var U=(z+=10)*L;return O.angle+=U,G.prevElapsed=D,A}}),H.call(function(){x.set((w.node.position.x+L.x)/2,(w.node.position.y+L.y)/2,0),G.prevElapsed=0,O.angle%=360,O.angle-=360,F=O.angle}),H.to(U,{value:0},{progress:function(n,C,A,T){var I=U*T-G.prevElapsed,L=U*T,D=_*(1-T);w.setHeight(D,k);var M=w.node.position.clone();return eQ.rotateZ(M,M,x,Math.PI/U*I),w.node.setPosition(new eQ(M.x,M.y,M.z)),O.angle+=-F/U*I,G.prevElapsed=L,A}}),H.call(function(){w.node.setPosition(L),w.setHeight(0,k),O.angle=0}),N.runTweenAsync(H))]})}),function(n){return x.apply(this,arguments)})},{key:"moveAround",value:(D=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=[{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],w=this.container.position.clone(),k=-1,C=0;O.label=1;case 1:if(!(C<5))return[3,4];for(_=e0.randomRangeInt(0,4);k===_;)_=e0.randomRangeInt(0,4);k=_;A=n[_];if(!A)return[3,3];T=w.clone().add(new eQ(5*A.x,5*A.y)),I=ez(this.container).to(.1,{position:T},{easing:"smooth"});return[4,N.runTweenAsync(I)];case 2:O.sent();O.label=3;case 3:C++;return[3,1];case 4:L=ez(this.container).to(.1,{position:w},{easing:"smooth"});return[4,N.runTweenAsync(L)];case 5:O.sent();return[2]}})}),function(){return D.apply(this,arguments)})},{key:"loadBreakClip",value:(O=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(!!this.breakClip)return[3,2];return[4,B.loadAnimClipAsync($.TILE_BREAK_ANIM)];case 1:n=w.sent();n&&this.animationComponent&&(this.breakClip=n,this.animationComponent.addClip(this.breakClip));w.label=2;case 2:return[2]}})}),function(){return O.apply(this,arguments)})},{key:"loadClearClip",value:(L=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(!!this.clearClip)return[3,2];return[4,B.loadAnimClipAsync($.TILE_CLEAR_ANIM)];case 1:n=w.sent();n&&this.animationComponent&&(this.clearClip=n,this.animationComponent.addClip(this.clearClip));w.label=2;case 2:return[2]}})}),function(){return L.apply(this,arguments)})},{key:"loadShakeClip",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(this.shakeClip)return[2,Promise.resolve()];return[4,B.loadAnimClipAsync($.TILE_SHAKE_ANIM)];case 1:n=w.sent();if(!n||!this.animationComponent)return[2,Promise.resolve()];this.shakeClip=n,this.animationComponent.addClip(this.shakeClip);return[2]}})}),function(){return I.apply(this,arguments)})},{key:"setHeight",value:function(n,w){if(this.background){var k=this.background.node;k.setPosition(new eQ(k.position.x,n,0)),k.setScale(new eQ(1+n/w*.3,1+n/w*.3,1))}}},{key:"createSpecialHandler",value:function(n,w){var k=this;switch(n){case Q.bomb:return this.createBombHandler(null!=w?w:90);case Q.star:return this.createStarHandler();default:return{type:Q.none,switch:function(n,w){k.special=k.createSpecialHandler(n,w)}}}}},{key:"createBombHandler",value:function(n){var w=this,k=!1,C=n,a=function(){k=!0},o=function(){k=!1};this.node.scene.on(i9.TILE_CLICK,a),this.node.scene.on(i9.USE_ITEM,a),this.node.scene.on(i9.RESUME_TIME,a),this.node.scene.on(i9.PAUSE_TIME,o),this.node.scene.on(i9.TIME_OUT,o),this.bombComponent.node.active=!0;var r=function(){k=!1,w.bombComponent.node.active=!1,C=n,w.node.scene.off(i9.TILE_CLICK,a),w.node.scene.off(i9.USE_ITEM,a),w.node.scene.off(i9.GAME_RESUME,a),w.node.scene.off(i9.GAME_PAUSE,o),w.node.scene.off(i9.TIME_OUT,o)};return{type:Q.bomb,update:function(_){k&&(C-=_,w.bombComponent.fillRange=-C/n,C<=0&&(k=!1,w.bombComponent.node.active=!1,w.setEmpty(!0),w.node.scene.emit(i9.BOMB_EXPLODE,w)))},clear:function(){G.playSound(nL.BOMB_DEFUSE)},cleanup:r,onDestroy:function(){w.node.scene.off(i9.TILE_CLICK,a),w.node.scene.off(i9.USE_ITEM,a),w.node.scene.off(i9.GAME_RESUME,a),w.node.scene.off(i9.GAME_PAUSE,o),w.node.scene.off(i9.TIME_OUT,o)},switch:function(n,k){r(),w.special=w.createSpecialHandler(n,k)},detonateImmediately:function(){C=0}}}},{key:"createStarHandler",value:function(){var n=this;this.starComponent.node.active=!0;var t=function(){n.starComponent.node.active=!1};return{type:Q.star,clear:function(){n.starComponent.node.active=!1,G.playSound(nL.COLLECT_STARS);var w=n.node.worldPosition,k=w.x,C=w.y;n.node.scene.emit(i9.ADD_STARS,{startAnimationAt:[k,C]})},cleanup:t,switch:function(w){t(),n.special=n.createSpecialHandler(w)}}}}]),E}(eO)).prototype,"icon",[lo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lk=n(lw.prototype,"bombComponent",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lC=n(lw.prototype,"starComponent",[ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lE=n(lw.prototype,"background",[lu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l_=n(lw.prototype,"bgUITransform",[lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lA=n(lw.prototype,"defaultBackground",[lh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lT=n(lw.prototype,"uiOpacity",[lp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lP=n(lw.prototype,"shineOpacity",[ld],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lR=n(lw.prototype,"glowOpacity",[ly],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lI=n(lw.prototype,"iconOpacity",[lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lL=n(lw.prototype,"button",[lv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lO=n(lw.prototype,"animationComponent",[lg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lD=n(lw.prototype,"container",[lm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lb=lw))||lb)||lb)||lb);function xu(n,w,k,C){var _=arguments.length>3&&void 0!==C?C:0,A=k.x,T=k.y,I=J(w,2),L=I[0],O=I[1],D=L*(A-(n.width-1)/2)+_*(A-n.width/2),M=O*(T-(n.height-1)/2)+_*(T-n.height/2);return -1===A&&(D+=w[0]/4),A===n.width&&(D-=w[0]/4),-1===T&&(M+=w[1]/4),T===n.height&&(M-=w[1]/4),{x:D,y:M}}function Uu(n,w){var k=arguments.length>1&&void 0!==w?w:[0,0],C=J(n,2),_=C[0],A=C[1],T=J(k,2),I=T[0],L=T[1],O=1-I,D=1-L,M=_*O,N=A*D;return[M,N]}function Gu(n,w){for(var k=arguments.length>1&&void 0!==w&&w,C=n.split("-"),_=[],A=0;A<C.length;){var T=null,I=C[A];switch(I){case"normal":A+=1;break;case"fall":T=s8,A+=2;break;case"fly":T=s9,A+=2;break;case"push":"left"===C[A+1]?(T=s7,A+=2):(T=le,A+=2);break;case"put":"columns"===C[A+1]?(T=lt,A+=3):(T=ln,A+=3)}T&&(k&&(T=Hu(T)),_.push(T))}return _}function Hu(n){switch(n){case s8:return le;case s9:return s7;case s7:return s8;case le:return s9;case lt:return ln;case ln:return lt}}function Vu(n){return(_instanceof(n,lM)?n.asArray():n).filter(function(n){return!n.isHidden()})}function qu(n){return(_instanceof(n,lM)?n.asArray():n).filter(function(n){return n.isHidden()})}ew._RF.pop(),ew._RF.push({},"d6995j9hvVJYKs6vvV+rs1I","index",void 0),ew._RF.pop(),ew._RF.push({},"cb8ddC2w59DpqVoQENbYYcU","calcBoardScale",void 0),ew._RF.pop(),ew._RF.push({},"305c7LJx+ROLI4g8tTiAFyb","calcTilePosition",void 0),ew._RF.pop(),ew._RF.push({},"c522ca1UPhDYaToWf66t1X2","calcTileSize",void 0),ew._RF.pop(),ew._RF.push({},"37667B66RZBc5chlMqN6mH8","parseLevelGravity",void 0),ew._RF.pop(),ew._RF.push({},"f0f0bXgdxJHIJWOmA6n0Ood","getUncleared",void 0),ew._RF.pop(),ew._RF.push({},"a90bcq22hlMzbYdivjPpm0h","getBombTiles",void 0),ew._RF.pop(),ew._RF.push({},"92e23drVfRIgbDVZLTSdEkI","getCleared",void 0),ew._RF.pop(),ew._RF.push({},"7105bfR+Y5F1a0SDiMXZ9mV","getNearbyTiles",void 0);var lx=GameCore.Utils.Object;function Ku(n,w){var k=w.getCoord(),C=k.x,_=k.y;return lx.vals(s6).reduce(function(w,k){var A=k.x,T=k.y,I=C+A,L=_+T;return n.isInBounds(I,L)&&w.push(n.get(I,L)),w},[])}function ju(n){return Array.isArray(n)}function Yu(n,w){var k=arguments.length>1&&void 0!==w?w:Date.now(),C=ju(n)?n:n.asArray();return C[te(k,0,C.length)]}ew._RF.pop(),ew._RF.push({},"d1b9bBg+dBA+7n/Sz+RCIAX","getRandomTile",void 0),ew._RF.pop(),ew._RF.push({},"c4bf3uyS1pEdrTrwDEXeuZP","getRandomPair",void 0);var lU=GameCore.Utils.Array;function Zu(n,w){var k=arguments.length>1&&void 0!==w?w:Date.now(),C=_instanceof(n,lM)?n.asArray():n,_=Yu(C,k),A=lU.search(C,function(n){return n.isSimilarTo(_)&&!n.inSamePositionAs(_)});if(void 0===A)throw new Error("Could not find a matching tile");return[_,A]}ew._RF.pop(),ew._RF.push({},"cf8d6gfx2ZIsqm978cNLWaV","pseudoRandomIterable",void 0);var Ju=function(n){return n};function Qu(n,w,k){var C=arguments.length>2&&void 0!==k?k:Ju;return function(){var k,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:k=n,_=w;k<=0&&(k=Number.POSITIVE_INFINITY);A=0;T.label=1;case 1:if(!(A<k))return[3,4];return[4,C(_)];case 2:T.sent(),_=1e9*tt(_);T.label=3;case 3:A++;return[3,1];case 4:return[2]}})}()}function $u(n){return Array.isArray(n)}function ec(n,w,k){var C=arguments.length>2&&void 0!==k?k:Date.now(),_=$u(n)?n:n.asArray();if(_.length<w)return new Set(_);for(var A=new Set,T=Qu(-1,C),I=T.next();A.size<w;){if(I.done)throw new Error("RNG exhausted");A.add(Yu(_,I.value)),I=T.next()}return A}ew._RF.pop(),ew._RF.push({},"718b6Wu0pdGVK5KYSUDctVX","getRandomTiles",void 0),ew._RF.pop(),ew._RF.push({},"17ccarKybRNwYcZnBQhCUYy","index",void 0),ew._RF.pop(),ew._RF.push({},"bab6dqrPz9AaaBN5cy+QzPj","assignSpecialTiles",void 0);var lG=[1,4];function nc(n,w,k){var C,_=arguments.length>2&&void 0!==k?k:Date.now(),A=w.specials,T=A.bomb,I=te.apply(void 0,[_].concat(lG)),O=ec(n,T,_),D=n.asArray().filter(function(n){return!O.has(n)}),M=ec(D,I,_),N=L(O);try{for(N.s();!(C=N.n()).done;){var z=C.value,B=2*w.time/3;z.setSpecialType(Q.bomb,B)}}catch(n){N.e(n)}finally{N.f()}var F,x=L(M);try{for(x.s();!(F=x.n()).done;){var U=F.value;U.setSpecialType(Q.star)}}catch(n){x.e(n)}finally{x.f()}}ew._RF.pop(),ew._RF.push({},"228efPdzUNCMp4yYcBs9r+3","index",void 0),ew._RF.pop(),ew._RF.push({},"09be7lmGLNMvIObiqskePhz","createGrid",void 0);var lH=GameCore.Utils.Array;function ac(n){var w=n.levelData,k=w.columns,C=w.rows,_=n.identities,A=n.createTile,T=n.seed,I=function(n,w,k){var C,_=[],A=L(Qu(w/2,n,function(n){return te(n,0,k.length)}));try{for(A.s();!(C=A.n()).done;){var T=C.value;_.push(k[T]),_.push(k[T])}}catch(n){A.e(n)}finally{A.f()}return lH.shuffle(_),_}(void 0===T?Date.now():T,k*C,_),O=oc(n.levelData,_,I),D=oc(n.levelData,_,O.reverse()).reverse().map(function(n){var w=A(n);return w.setIdentity(n),w});return new lM({width:k,height:C,content:D})}function oc(n,w,k){var C=n.rows,_=n.columns,A=n.rules;if(!A.maxSpaceOfPair)return k;for(var T=function(n,w,k){for(var C=[],_=0;_<w;_++){C[_]=[];for(var A=0;A<k;A++)C[_][A]=n[_*k+A]}return C}(k,C,_),I=0;I<w.length;I++)for(var L=null,O=null,D=0;D<C;D++)for(var M=0;M<_;M++)if(T[D][M]===w[I]){if(!L||!O){L=D,O=M;continue}var N=A.maxSpaceOfPair+1;if(Math.abs(D-L)+Math.abs(M-O)<=N){O=M,L=D;continue}var z=rc(L,O,D,M),B=T[z.row][z.column];T[z.row][z.column]=T[D][M],T[D][M]=B}return function(n){for(var w=[],k=0;k<n.length;k++)for(var C=0;C<n[k].length;C++)w.push(n[k][C]);return w}(T)}function rc(n,w,k,C){var _=n,A=w;return k>n&&(_=n+1),k<n&&(_=n-1),C>w&&(A=w+1),C<w&&(A=w-1),{row:_,column:A}}ew._RF.pop(),ew._RF.push({},"5d998xlab9FLIpvw+sXMIYw","createGridFromFen",void 0);var lV=GameCore.Utils.Array;function sc(n){var w=n.customFen,k=n.identities,C=n.createTile,_=w.idSize,A=w.cols,T=w.rows,I=w.code;if(k.length<w.idSize)throw new Error("Invalid grid code. There are not enough identities/frames ".concat(k.length," to fill it according to fen code ").concat(_));var O=I.split(":");if(O.length!==T)throw new Error("Invalid grid code");var D=/[a-zA-Z]+\d+|./g,M=/[a-zA-Z]+/,N=/\d+/,z=O.reduceRight(function(n,_){var A,T=[],I=_.matchAll(D),O=L(I);try{for(O.s();!(A=O.n()).done;){var z,B,F=A.value[0],x=null===(z=N.exec(F))||void 0===z?void 0:z[0],U=void 0!==x?Number.parseInt(x,10):void 0,G=void 0!==U&&!Number.isNaN(U)&&U<k.length?k[U]:void 0,H=C(void 0!==G?G:k[0]),V=null===(B=M.exec(F))||void 0===B?void 0:B[0],q=void 0!==V?uc(V,w.encoding):void 0;q&&G?H.setSpecialType(q):H.setEmpty(),T.push(H)}}catch(n){O.e(n)}finally{O.f()}return n.concat(T)},[]);return new lM({width:A,height:T,content:z})}function uc(n,w){var k=lV.search(Object.entries(w),function(w){var k=J(w,2);k[0];return k[1]===n});if(void 0===k)throw new Error("Invalid special type ".concat(n));return k[0]}ew._RF.pop(),ew._RF.push({},"30de5d+cW5OjKyEubKVREbU","createRotatedGrid",void 0),ew._RF.pop(),ew._RF.push({},"9ceb6vNbn9PKozkdGjjZD67","ensureOneMatch",void 0);var lq=GameCore.Utils.Array;function hc(n,w){var k=arguments.length>1&&void 0!==w?w:Date.now(),C=n.asArray(),_=Yu(n,k),A=Ku(n,_);if(!A.some(function(n){return n.isSimilarTo(_)})){var T=Yu(A,k),I=lq.search(C,function(n){return!n.inSamePositionAs(_)&&!n.inSamePositionAs(T)&&n.isSimilarTo(T)});I.setIdentity(_.id),T.setIdentity(_.id)}}ew._RF.pop(),ew._RF.push({},"89318H0TDxMlJsVFwuKgrh3","index",void 0),ew._RF.pop(),ew._RF.push({},"fb4a9VOCxBBvpXFCcSt4P3J","NewbieSteps",void 0);var lW=[{startTile:{x:0,y:1},endTile:{x:3,y:1},localeTextKey:"guide.step1"},{startTile:{x:2,y:2},endTile:{x:3,y:0},localeTextKey:"guide.step2"},{startTile:{x:0,y:0},endTile:{x:3,y:3},localeTextKey:"guide.step3"},{startTile:{x:0,y:4},endTile:{x:2,y:3},localeTextKey:"guide.step4"},{startTile:{x:1,y:4},endTile:{x:1,y:2},localeTextKey:"guide.step5"}];ew._RF.pop(),ew._RF.push({},"627d5N3oStP8q9+ABNqnHBq","getBestPath",void 0);var lK=GameCore.Utils.Array;function yc(n,w){return n[0]===w[0]&&n[1]===w[1]}function fc(n){return new e4(n[0],n[1])}function vc(n,w){return n.x>=-1&&n.x<w.width+1&&n.y>=-1&&n.y<w.height+1}function gc(n,w){var k=arguments.length>1&&void 0!==w?w:lY;return k.map(function(w){return[n.tile[0]+w.x,n.tile[1]+w.y]})}var lj,lY=[s6.Up,s6.Down,s6.Left,s6.Right],lX=function(){function e(n,w){var k;if(C(this,e),this.f=0,this.g=0,this.h=0,w&&yc(n,w.tile))throw new Error("Tile cannot be its own parent");this.tile=n,this.parent=w;var _=e.calcDirection(this),A=w&&_&&w.cache.direction&&!_.equals(w.cache.direction)?1:0;this.cache={direction:_,turns:A+(null!==(k=null==w?void 0:w.cache.turns)&&void 0!==k?k:0)}}return T(e,[{key:"getKey",value:function(){var n;return"x:".concat(this.tile[0],",y:").concat(this.tile[1],",d:").concat(null===(n=this.cache.direction)||void 0===n?void 0:n.toString())}},{key:"equals",value:function(n){return this.getKey()===n.getKey()}}],[{key:"calcDirection",value:function(n){if(n.parent){var w=n.parent.tile,k=n.tile;return new e4(k[0]-w[0],k[1]-w[1])}return null}}]),e}();function Sc(n,w,k){var C=Ec(n,w),_=Ec(n,k);if(0===C.length||0===_.length)return kc(w,k);var A=function(n,w,k){var C=[],_=[],A=new lX(w,null),T=new lX(k,null),I=[T.tile];C.push(A);for(;C.length>0;){var O=C.shift();if(_.push(O),yc(O.tile,T.tile)){for(var D=[],M=O,N=O,z=O.parent;z;)z.cache.turns!==N.cache.turns&&(D.unshift({a:fc(z.tile),b:fc(M.tile)}),M=z),N=z,z=z.parent;return D.unshift({a:fc(N.tile),b:fc(M.tile)}),D}var B,F=gc(O,Ec(n,O.tile,I)),x=L(F);try{var g=function(){var n=B.value,w=new lX(n,O);if(w.cache.turns>8)return 0;var k=yc(w.tile,T.tile),A=_.some(function(n){return n.equals(w)});if(C.some(function(n){return n.equals(w)})||A&&!k)return 0;w.g=O.g+1+w.cache.turns,w.h=Cc(w,T),w.f=w.g+w.h,C.push(w)};for(x.s();!(B=x.n()).done;)g()}catch(n){x.e(n)}finally{x.f()}C.sort(function(n,w){return n.f-w.f})}return null}(n,w,k);return A||kc(w,k)}function kc(n,w){var k=fc(n),C=fc(w);return k.x===C.x||k.y===C.y?[{a:k,b:C}]:[{a:k,b:{x:k.x,y:C.y}},{a:{x:k.x,y:C.y},b:C}]}function Cc(n,w){var k=n.tile,C=w.tile;return Math.abs(k[0]-C[0])+Math.abs(k[1]-C[1])}function Ec(n,w,k){var C,_=arguments.length>2&&void 0!==k?k:[],A=[],T=L(lY);try{var r=function(){var k=C.value,T={x:w[0]+k.x,y:w[1]+k.y};if(n.isInBounds(T.x,T.y))return(n.get(T.x,T.y).isHidden()||lK.search(_,function(n){return yc(n,[T.x,T.y])}))&&A.push(k),1;vc(T,n)&&A.push(k)};for(T.s();!(C=T.n()).done;)r()}catch(n){T.e(n)}finally{T.f()}return A}ew._RF.pop(),ew._RF.push({},"b622ea7Aw5LT5yfRAx8qSap","getErrorPath",void 0),ew._RF.pop(),ew._RF.push({},"716f6/ILpZCPp1nebbdk8Oj","getGridFen",void 0);var lZ=(Y(lj={},Q.bomb,"b"),Y(lj,Q.star,"s"),Y(lj,Q.none,"t"),lj);function Tc(n){return n.reduce(function(n,w,k,C){return w.inSamePositionAs(k,C)||n.push([w,[k,C]]),n},[])}function Pc(n,w){var k,C,_,A,T,I,L,O;return _ts_generator(this,function(D){switch(D.label){case 0:k=0,C=n-1,_=0,A=w-1;D.label=1;case 1:if(!(k<=C&&_<=A))return[3,19];T=k;D.label=2;case 2:if(!(T<=C))return[3,5];return[4,{x:T,y:_}];case 3:D.sent();D.label=4;case 4:T++;return[3,2];case 5:I=++_;D.label=6;case 6:if(!(I<=A))return[3,9];return[4,{x:C,y:I}];case 7:D.sent();D.label=8;case 8:I++;return[3,6];case 9:L=--C;D.label=10;case 10:if(!(L>=k))return[3,13];return[4,{x:L,y:A}];case 11:D.sent();D.label=12;case 12:L--;return[3,10];case 13:O=--A;D.label=14;case 14:if(!(O>=_))return[3,17];return[4,{x:k,y:O}];case 15:D.sent();D.label=16;case 16:O--;return[3,14];case 17:k++;D.label=18;case 18:return[3,1];case 19:return[2]}})}ew._RF.pop(),ew._RF.push({},"badfeEqwgFEorJVHO9tJSXZ","getOutOfSync",void 0),ew._RF.pop(),ew._RF.push({},"cd0d548/WxD7KCyW2hwySVO","traverseSpiralIn",void 0),ew._RF.pop(),ew._RF.push({},"373ceVkYCtMTrQObvzJgg7s","getValidPath",void 0);var lJ,lQ,l$,l0,l1,l2,l4,l3,l5,l6,l8,l9,l7=GameCore.Utils.Array,ue=function(){function e(n,w){C(this,e),this.coord=new e4(n,w)}return T(e,[{key:"isHidden",value:function(){return!0}},{key:"isSimilarTo",value:function(){return!1}}]),e}();function Hc(n){return new e4(n[0],n[1])}function Vc(n,w,k){if(void 0===w||void 0===k)return function(n,w){var k,C=arguments.length>1&&void 0!==w?w:Pc,_=[],A=L(C(n.width,n.height));try{for(A.s();!(k=A.n()).done;){var T=k.value,I=n.get(T.x,T.y);I.isHidden()||_.push([I,[T.x,T.y]])}}catch(n){A.e(n)}finally{A.f()}var O,D=[],c=function(){var w=_.shift(),k=J(w,2),C=k[0],A=k[1];if(l7.search(D,function(n){return Kc(n,A)}))return 0;D.push(A);for(var T,l=function(){var w=J(L[I],2),k=w[0],_=w[1];if(!k.isSimilarTo(C)||l7.search(D,function(n){return Kc(n,_)}))return 0;var T=Vc(n,A,_);return null!==T?{v:{v:T}}:void 0},I=0,L=_;I<L.length;I++)if(0!==(T=l())&&T)return T.v};for(;_.length>0;)if(0!==(O=c())&&O)return O.v;return null}(n);var C,_=[w[0]+1,w[1]+1],A=[k[0]+1,k[1]+1],T=function(n){var w=l7.fillWith(n.width+2,function(n){return new ue(n-1,-1)}),k=l7.fillWith(n.width+2,function(w){return new ue(w-1,n.height)}),C=l7.fillWith(n.height,function(n){return new ue(-1,n)}),_=l7.fillWith(n.height,function(w){return new ue(n.width,w)}),o=function(A,T){var I=A-1,L=T-1;return -1===I?C[L]:I===n.width?_[L]:-1===L?w[I]:L===n.height?k[I]:n.get(I,L)};return{get:function(n,w){return o(n,w)},width:n.width+2,height:n.height+2}}(n),I=[_,A];if(_[0]===A[0]&&Yc(T,I,_[1],A[1],_[0])||_[1]===A[1]&&Xc(T,I,_[0],A[0],_[1]))return Qc([{a:Hc(_),b:Hc(A)}],{x:-1,y:-1});var O=_[1]<=A[1]?_:A,D=_[1]<=A[1]?A:_,M=_[0]<=A[0]?_:A,N=_[0]<=A[0]?A:_,z=[],B=[],F=Zc(T,I,1,Hc(O),Hc(D)),x=Zc(T,I,-1,Hc(O),Hc(D));-1===F&&-1===x||(C=-1!==F?F:x,z=[{a:Hc(_),b:{x:_[0],y:C}},{a:{x:_[0],y:C},b:{x:A[0],y:C}},{a:{x:A[0],y:C},b:Hc(A)}]);var U=Jc(T,I,1,Hc(M),Hc(N)),G=Jc(T,I,-1,Hc(M),Hc(N));-1===U&&-1===G||(C=-1!==U?U:G,z=[{a:Hc(_),b:{x:C,y:_[1]}},{a:{x:C,y:_[1]},b:{x:C,y:A[1]}},{a:{x:C,y:A[1]},b:Hc(A)}]);var H=function(n,w,k,C){for(var _=k.y+1;_<C.y;_++)if(Yc(n,w,k.y,_,k.x)&&Xc(n,w,k.x,C.x,_)&&Yc(n,w,_,C.y,C.x))return _;return -1}(T,I,Hc(O),Hc(D));-1!==H&&(C=H,B=[{a:Hc(_),b:{x:_[0],y:C}},{a:{x:_[0],y:C},b:{x:A[0],y:C}},{a:{x:A[0],y:C},b:Hc(A)}]);var V=function(n,w,k,C){for(var _=k.x+1;_<C.x;_++)if(Xc(n,w,k.x,_,k.y)&&Yc(n,w,k.y,C.y,_)&&Xc(n,w,_,C.x,C.y))return _;return -1}(T,I,Hc(M),Hc(N));return -1!==V&&(C=V,B=[{a:Hc(_),b:{x:C,y:_[1]}},{a:{x:C,y:_[1]},b:{x:C,y:A[1]}},{a:{x:C,y:A[1]},b:Hc(A)}]),z.length>0&&B.length>0?Qc(qc(z)<=qc(B)?z:B,{x:-1,y:-1}):z.length>0?Qc(z,{x:-1,y:-1}):B.length>0?Qc(B,{x:-1,y:-1}):null}function qc(n){var w,k=0,C=L(n);try{for(C.s();!(w=C.n()).done;)k+=Wc(w.value)}catch(n){C.e(n)}finally{C.f()}return k}function Wc(n){return n.a.x===n.b.x?Math.abs(n.a.y-n.b.y):n.a.y===n.b.y?Math.abs(n.a.x-n.b.x):0}function Kc(n,w){return n[0]===w[0]&&n[1]===w[1]}function jc(n,w,k){var C=arguments.length>2&&void 0!==k?k:[],_=n.get.apply(n,j(w));return _.isHidden()||C.some(function(n){return Kc(n,w)})}function Yc(n,w,k,C,_){for(var A=Math.min(k,C),T=Math.max(k,C),I=A;I<=T;I++)if(!jc(n,[_,I],w))return!1;return!0}function Xc(n,w,k,C,_){for(var A=Math.min(k,C),T=Math.max(k,C),I=A;I<=T;I++)if(!jc(n,[I,_],w))return!1;return!0}function Zc(n,w,k,C,_){var A=1===k?_.y:C.y,T=1===k?C.x:_.x;if(Yc(n,w,C.y,_.y,T))for(;A>=0&&A<n.height&&jc(n,[C.x,A],w)&&jc(n,[_.x,A],w);){if(Xc(n,w,C.x,_.x,A))return A;A+=k}return -1}function Jc(n,w,k,C,_){var A=1===k?_.x:C.x,T=1===k?C.y:_.y;if(Xc(n,w,C.x,_.x,T))for(;A>=0&&A<n.width&&jc(n,[A,C.y],w)&&jc(n,[A,_.y],w);){if(Yc(n,w,C.y,_.y,A))return A;A+=k}return -1}function Qc(n,w){return n.map(function(n){return{a:{x:n.a.x+w.x,y:n.a.y+w.y},b:{x:n.b.x+w.x,y:n.b.y+w.y}}})}ew._RF.pop(),ew._RF.push({},"0cceagmIDZNoZTxP8hBPplh","Board",void 0);var ut=eS.ccclass,un=eS.property,ui=eS.requireComponent,ua=globalThis.game.monitorError,ur=GameCore.Utils,uo=ur.Array,us=ur.Function,ul=ur.Valid,uu=q.Layout,uh=(lJ=ut("Board"),lQ=ui(e_),l$=z.required,l0=un(lF),l1=z.required,l2=un(ek),l4=un({displayName:"Tile Spacing",group:"Create config"}),lJ(l3=lQ((l6=n((l5=function(n){w(f,n);var I,O,D,B=k(f);function f(){var n;C(this,f);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"tilePrefab",l6,A(n)),_(n,"tilesHolder",l8,A(n)),_(n,"tileTrim",l9,A(n)),n.tileSize=[0,0],n.selectedTile=null,n.parsedGravityRules=[],n.normalMatches=0,n.normalMatchesSinceLastSpawn=0,n.spawnAttempts=0,n.hintPath=null,n.hintTiles=null,n.isAnimating=!1,n.animationQueue=[],n.isConsumingAnimation=!1,n.handleViewResized=us.debounce(function(){n.updateTilesHolderScale()},100),n}return T(f,[{key:"onLoad",value:function(){this.widget=this.getComponent(eN),this.uiTransform=this.getComponent(e_),z.validateRequiredProperties(this,f),this.tilePrefab.node.active=!1,this.listenEvents()}},{key:"onDestroy",value:function(){this.unlistenEvents()}},{key:"hasActiveGrid",value:function(){return void 0!==this.grid}},{key:"create",value:function(n,w,k){var C=this,_=arguments.length>2&&void 0!==k?k:Date.now(),A=j(n);uo.shuffle(A);var T=A.slice(0,w.colors);null==ua||ua.addMetadata({frames:T.map(function(n){return n.name})}),this.levelData=w,this.parsedGravityRules=Gu(w.mode,s5.isLandscape());var r=function(n){var w=eA(C.tilePrefab.node),k=w.getComponent(lF);return k.setIdentity(n),C.tilesHolder.addChild(w),w.active=!0,k},I=!1;if(void 0!==w.customFen)try{I=!0,this.grid=sc({customFen:w.customFen,identities:T,createTile:r}),this.grid.forEach(function(n,w,k){n.setCoord(w,k),n.setIgnoreInput(!1),n.node.setSiblingIndex(0)})}catch(n){console.error("Error creating grid from custom fen",n,"falling back to random grid"),I=!1}I||(this.grid=ac({levelData:w,seed:_,identities:T,createTile:r}),this.grid.forEach(function(n,w,k){n.setCoord(w,k),n.setIgnoreInput(!1),n.node.setSiblingIndex(0)}),hc(this.grid,_),nc(this.grid,w,_)),this.handleBoardLayout();var L=[this.tileTrim.x,this.tileTrim.y];this.tileSize=Uu(this.tilePrefab.getSize(),L),this.updateTilesHolderScale(),this.node.scene.emit(i9.GRID_CREATE,this),this.selectedTile=null,this.animationQueue=[],this.normalMatches=0,this.normalMatchesSinceLastSpawn=0,this.spawnAttempts=0,this.hintPath=null,this.processGameplayCycle()}},{key:"updateTilesHolderScale",value:function(){if(this.grid){var n=[this.grid.width,this.grid.height],w=[this.uiTransform.width,this.uiTransform.height],k=function(n,w,k){var C=J(n,2),_=C[0],A=C[1],T=J(w,2),I=T[0],L=T[1],O=J(k,2),D=O[0]/(_*I),M=O[1]/(A*L);return Math.min(D,M)}(n,this.tilePrefab.getSize(),w);this.tilesHolder.setScale(k,k),this.node.scene.emit(i9.GRID_RESIZE,k)}}},{key:"handleBoardLayout",value:function(){var n,w;this.grid&&s5.isLandscape()&&0!==this.levelData.level&&(this.grid=(n=this.grid,(w=n.toRotated()).forEach(function(n,w,k){n.setCoord(w,k)}),w))}},{key:"destroyTiles",value:function(){var n;null===(n=this.grid)||void 0===n||n.forEach(function(n){return n.node.destroy()})}},{key:"animateTilesAppear",value:function(){var n=this;if(void 0===this.grid){var w=new Error("animateTilesAppear: Grid is not initialized");if(ul.isDebugger())throw w;return null==ua||ua.sendException(w),Promise.resolve()}var k=this.grid;return new Promise(function(w){var C=function(){var C=M(function(){var C;return _ts_generator(this,function(_){switch(_.label){case 0:C=function(w){return xu(k,n.tileSize,w)};return[4,Promise.all(k.map(function(w,_,A){var T=tn(0,.5),I=w.node.scale.clone(),O=function(w,k){var C,_=e4.ZERO.clone(),A=L(n.parsedGravityRules);try{for(A.s();!(C=A.n()).done;){var T=C.value,I=n.getPrimitiveDirection(w,k,T);_.subtract2f(I.x,I.y)}}catch(n){A.e(n)}finally{A.f()}return _.normalize()}(_,A),D=xu(k,n.tileSize,{x:_,y:A}),M=O.multiplyScalar(100).add2f(D.x,D.y);return w.node.setPosition(M.x,M.y),w.node.setScale(0,0),Promise.all([N.runTweenAsync(ez(w.node).delay(T).to(.5,{scale:I},{easing:"elasticOut"})),w.sync({getTargetPosition:C,easing:"backOut",duration:.5,delay:T})])}))];case 1:_.sent(),w();return[2]}})});return function(){return C.apply(this,arguments)}}();n.animationQueue.push(C),n.consumeAnimationQueue()})}},{key:"animateTilesWave",value:function(){var n=this;if(void 0===this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","animateTilesWave"),Promise.resolve();var w=this.grid;return new Promise(function(k){var C=function(){var n=M(function(){var n;return _ts_generator(this,function(C){switch(C.label){case 0:n=function(n,w){for(var k=w.x,C=w.y,_="center"===n?{x:(k-1)/2,y:(C-1)/2}:n,A=_.x,T=_.y,I=[],L=0;L<k;L++){for(var O=[],D=0;D<C;D++){var M=A-L,N=T-D,z=Math.sqrt(M*M+N*N);O.push(z)}I.push(O)}return I}("center",{x:w.width,y:w.height});return[4,Promise.all(w.map(function(w,k,C){var _,A,T=.1*(null!==(_=null===(A=n[k])||void 0===A?void 0:A[C])&&void 0!==_?_:0),I=w.node.scale.clone();return Promise.all([N.runTweenAsync(ez(w.node).delay(T).to(.25,{scale:I.clone().multiplyScalar(1.2)},{easing:"quadOut"}).to(.25,{scale:I},{easing:"quadIn"}))])}))];case 1:C.sent(),k();return[2]}})});return function(){return n.apply(this,arguments)}}();n.animationQueue.push(C),n.consumeAnimationQueue()})}},{key:"animateTilesError",value:(D=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(void 0===this.grid)return[2,(this.reportOrThrowInDebugger("Grid is not initialized","animateTilesError"),Promise.resolve())];n=this.isAnimating;if(n)return[3,2];this.isAnimating=!0;return[4,Promise.all(this.grid.map(function(n){return n.moveAround()}))];case 1:n=(w.sent(),this.isAnimating=!1);w.label=2;case 2:return[2]}})}),function(){return D.apply(this,arguments)})},{key:"handleTileClick",value:function(n){if(!n.isHidden()){if(this.selectedTile===n)return G.playSound(nL.TILE_SELECT),this.selectedTile=null,void n.setFocused(!1);if(!this.selectedTile)return G.playSound(nL.TILE_SELECT),this.selectedTile=n,void n.setFocused(!0);if(!this.selectedTile.isSimilarTo(n))return G.playSound(nL.TILE_SELECT),this.selectedTile.setFocused(!1),this.selectedTile=n,void n.setFocused(!0);this.selectedTile.setFocused(!1),this.match(this.selectedTile,n),this.selectedTile=null}}},{key:"clearSelectedTile",value:function(){this.selectedTile&&(this.selectedTile.setFocused(!1),this.selectedTile=null)}},{key:"match",value:function(n,w){if(void 0!==this.grid){var k=[n.getCoord().x,n.getCoord().y],C=[w.getCoord().x,w.getCoord().y],_=Vc(this.grid,k,C);if(null===_){G.playSound(nL.INVALID_MATCH),this.animateTilesError();var A=0===this.levelData.level,T=function(n,w,k,C){if(C){var _=lW[4].startTile,A=lW[4].endTile;if(w[0]===_.x&&w[1]===_.y&&k[0]===A.x&&k[1]===A.y)return[{a:_,b:A}];if(w[0]===A.x&&w[1]===A.y&&k[0]===_.x&&k[1]===_.y)return[{a:_,b:A}]}return Sc(n,w,k)}(this.grid,k,C,A);return this.node.scene.emit(i9.GRID_MATCH,[n,w]),void this.node.scene.emit(i9.GRID_MATCH_FAIL,T)}G.playSound(nL.TILE_MATCH),this.node.scene.emit(i9.GRID_MATCH,[n,w]),this.node.scene.emit(i9.GRID_MATCH_SUCCESS,_,[n,w]),this.clear([[n,w]],"clear")}else this.reportOrThrowInDebugger("Grid is not initialized","match")}},{key:"clear",value:function(n,w){var k=arguments.length>1&&void 0!==w?w:"clear";this.normalMatches+=n.length;var C,_=L(n);try{for(_.s();!(C=_.n()).done;){var A=J(C.value,2),T=A[0],I=A[1];T.setEmpty(),I.setEmpty(),T.playClearFX(k),I.playClearFX(k),this.node.scene.emit(i9.GRID_CLEAR,[T,I])}}catch(n){_.e(n)}finally{_.f()}this.processGameplayCycle()}},{key:"showHint",value:function(){if(this.hintPath){var n=this.hintPath[0],w=this.hintPath[this.hintPath.length-1];if(n&&w){var k=n.a,C=w.b,_=this.getTileAt(k.x,k.y),A=this.getTileAt(C.x,C.y);_&&A?(_.setHint(!0),A.setHint(!0),this.hintTiles=[_,A]):this.reportOrThrowInDebugger("Hint tiles are not valid","showHint")}else this.reportOrThrowInDebugger("Hint path is not valid","showHint")}}},{key:"hideHint",value:function(){if(this.hintTiles){var n=J(this.hintTiles,2),w=n[0],k=n[1];w.setHint(!1),k.setHint(!1),this.hintTiles=null}}},{key:"getHintPath",value:function(){return this.hintPath}},{key:"getTileAt",value:function(n,w){return void 0===this.grid?null:this.grid.isInBounds(n,w)?this.grid.get(n,w):null}},{key:"getAnyTileWorldPosition",value:function(n,w){if(void 0===this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getAnyTileWorldPosition"),{x:0,y:0};var k=xu(this.grid,this.tileSize,{x:n,y:w});this.tilePrefab.node.setPosition(k.x,k.y);var C=this.tilePrefab.node.getWorldPosition();return{x:C.x,y:C.y}}},{key:"getTileSize",value:function(){return this.tileSize}},{key:"getGridSize",value:function(){return void 0===this.grid?(this.reportOrThrowInDebugger("Grid is not initialized","getGridSize"),[0,0]):[this.grid.width,this.grid.height]}},{key:"getUncleared",value:function(){return void 0===this.grid?(this.reportOrThrowInDebugger("Grid is not initialized","getUncleared"),[]):Vu(this.grid)}},{key:"getCleared",value:function(){return void 0===this.grid?(this.reportOrThrowInDebugger("Grid is not initialized","getCleared"),[]):qu(this.grid)}},{key:"getBombTiles",value:function(){var n;return void 0===this.grid?(this.reportOrThrowInDebugger("Grid is not initialized","getBombTiles"),[]):Vu(_instanceof(n=this.grid,lM)?n.asArray():n).filter(function(n){var w;return(null===(w=n.special)||void 0===w?void 0:w.type)===Q.bomb})}},{key:"getPairs",value:function(n,w){var k=arguments.length>0&&void 0!==n?n:1,C=!(arguments.length>1&&void 0!==w)||w;if(void 0===this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPairs"),[];for(var _=[],A=C?Vu(this.grid):qu(this.grid),a=function(){var n=Zu(A),w=J(n,2),k=w[0],C=w[1];_.push([k,C]),A=A.filter(function(n){return n!==k&&n!==C})};_.length<k;)a();return _}},{key:"setIgnoreInput",value:function(n){var w,k=!(arguments.length>0&&void 0!==n)||n;null===(w=this.grid)||void 0===w||w.forEach(function(n){return n.setIgnoreInput(k)})}},{key:"processShuffleRequest",value:function(n){if(void 0!==this.grid){var w=this.processShuffleStep(this.grid,!0,n);this.grid=w[0],this.hintPath=w[1],this.consumeAnimationQueue()}else this.reportOrThrowInDebugger("Grid is not initialized","processShuffleRequest")}},{key:"generateFenFromCurrentLevel",value:function(n){return f.generateFen(null!=n?n:this.levelData)}},{key:"listenEvents",value:function(){eY.on(V.VIEW_RESIZED,this.handleViewResized),eY.on(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(s5.getCurrentLayout())}},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized),eY.off(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:function(n){n===uu.Portrait?this.widget.left=20:n===uu.Landscape&&(this.widget.left=800)}},{key:"shakeGrid",value:(O=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.tilesHolder.position.clone(),w=ez(this.tilesHolder).to(.05,{position:n.clone().add3f(tn(5,10),tn(5,10),0)}).to(.05,{position:n.clone().subtract3f(tn(5,10),tn(5,10),0)}),k=ez(this.tilesHolder).repeat(2,w).to(.05,{position:n});return[4,N.runTweenAsync(k)];case 1:C.sent();return[2]}})}),function(){return O.apply(this,arguments)})},{key:"processGameplayCycle",value:function(){if(void 0!==this.grid){var n=Vu(this.grid);if(0!==n.length){var w=this.grid,k=n.length>=2&&this.spawnAttempts<this.levelData.rules.addRandomTilesPerMove&&this.normalMatches>=5,C=this.normalMatchesSinceLastSpawn>=2;k&&(C?(this.spawnAttempts++,this.normalMatchesSinceLastSpawn=0,this.processSpawnStep()):this.normalMatchesSinceLastSpawn++),n.length>14&&(w=this.processGravitationStep(w));var _=this.processShuffleStep(w);this.consumeAnimationQueue(),this.grid=_[0],this.hintPath=_[1]}}else this.reportOrThrowInDebugger("Grid is not initialized","processGameplayCycle")}},{key:"processSpawnStep",value:function(){var n;if(void 0!==this.grid){var w=ec(qu(this.grid),2),k=J(w,2),C=k[0],_=k[1],A=null!==(n=null==C?void 0:C.id)&&void 0!==n?n:void 0;void 0!==C&&void 0!==A&&void 0!==_?(C.restore(),_.restore(A),this.node.scene.emit(i9.GRID_SPAWN,[C,_])):this.reportOrThrowInDebugger("Failed to get random tiles","processSpawnStep")}else this.reportOrThrowInDebugger("Grid is not initialized","processSpawnStep")}},{key:"processGravitationStep",value:function(n){var w,k=this,C=n,_=[],A=L(this.parsedGravityRules);try{var r=function(){var n=w.value,A=Tc(C=k.toGravitated(C,n));if(0===A.length)return 1;var T,I=L(A);try{for(I.s();!(T=I.n()).done;){var O=J(T.value,2),D=O[0],N=J(O[1],2),z=N[0],B=N[1];D.setCoord(z,B)}}catch(n){I.e(n)}finally{I.f()}C.forEach(function(n){n.node.setSiblingIndex(0)});var F=function(){var n=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,Promise.all(A.map(function(n){var w=J(n,2),_=w[0],A=J(w[1],2),T=A[0],I=A[1];return _.sync({delay:.25,duration:.25,getTargetPosition:function(){return xu(C,k.tileSize,{x:T,y:I})}})}))];case 1:n.sent();return[2]}})});return function(){return n.apply(this,arguments)}}();_.push(F)};for(A.s();!(w=A.n()).done;)r()}catch(n){A.e(n)}finally{A.f()}var T=function(){var n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=0,w=_;C.label=1;case 1:if(!(n<w.length))return[3,4];k=w[n];return[4,k()];case 2:C.sent();C.label=3;case 3:n++;return[3,1];case 4:return[2]}})});return function(){return n.apply(this,arguments)}}();return this.animationQueue.push(T),C}},{key:"toGravitated",value:function(n,w){var k=new lM(n),C=n.height-1,_=n.width-1,A=[0,C],T=[0,_],I=Math.floor(n.height/2),L=Math.floor(n.width/2),u=function(n){return n.isHidden()};switch(w){case s8:k.gravitate({rowRange:A,colRange:T,direction:s6.Down,isLighter:u});break;case s9:k.gravitate({rowRange:A,colRange:T,direction:s6.Up,isLighter:u});break;case s7:k.gravitate({rowRange:A,colRange:T,direction:s6.Left,isLighter:u});break;case le:k.gravitate({rowRange:A,colRange:T,direction:s6.Right,isLighter:u});break;case lt:k.gravitate({rowRange:A,colRange:[L,_],direction:s6.Left,isLighter:u,out:k.gravitate({rowRange:A,colRange:[0,L-1],direction:s6.Right,isLighter:u})});break;case ln:k.gravitate({rowRange:[I,C],colRange:T,direction:s6.Down,isLighter:u,out:k.gravitate({rowRange:[0,I-1],colRange:T,direction:s6.Up,isLighter:u})})}return k}},{key:"getPrimitiveDirection",value:function(n,w,k){if(void 0===this.grid)return this.reportOrThrowInDebugger("Grid is not initialized","getPrimitiveDirection"),s6.Down;var C=Math.floor(this.grid.height/2),_=Math.floor(this.grid.width/2);switch(k){case s8:return s6.Down;case s9:return s6.Up;case s7:return s6.Left;case le:return s6.Right;case lt:return n>=_?s6.Left:s6.Right;case ln:return w>=C?s6.Down:s6.Up}}},{key:"processShuffleStep",value:function(n,w,k){var C,_,A=arguments.length>1&&void 0!==w&&w,T=arguments.length>2?k:void 0,I=Vc(n),O=Vu(n).map(function(n){var w=n.getCoord();return[w.x,w.y]});if(null!==I&&!A)return[n,I];var D=100;do{var M=n.toShuffled(O),N=J(M,1);I=Vc(_=N[0]),D--}while(null===I&&D>0);if(D<=0){var z,B=_.asArray().map(function(n){var w,k;return{name:null===(w=n.id)||void 0===w?void 0:w.name,type:null===(k=n.special)||void 0===k?void 0:k.type,active:!n.isHidden()}});return null==ua||ua.sendException(new Error("No paths found after 100 shuffle attempts"),{message:"No paths found after 100 shuffle attempts",level:this.levelData.level,gridAsArray:B}),this.node.scene.emit(i9.GAME_EXIT),[n,null!==(z=I)&&void 0!==z?z:[]]}var F,x=Tc(_),U=L(x);try{for(U.s();!(F=U.n()).done;){var G=J(F.value,2),H=G[0],V=J(G[1],2),q=V[0],W=V[1];H.setCoord(q,W)}}catch(n){U.e(n)}finally{U.f()}var K=void 0!==T?function(){return T(n,_)}:this.createShuffleAnimationHandler(n,_);return this.animationQueue.push(K),[_,null!==(C=I)&&void 0!==C?C:[]]}},{key:"createShuffleAnimationHandler",value:function(n,w){var k=this,C=function(){var C=M(function(){return _ts_generator(this,function(C){switch(C.label){case 0:return[4,Promise.all(n.map(function(n,C,_){return n.sync({duration:.3,easing:"smooth",getTargetPosition:function(){return xu(w,k.tileSize,{x:C,y:_},10)}})}))];case 1:C.sent();return[2]}})});return function(){return C.apply(this,arguments)}}(),_=function(){var n=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:w.forEach(function(n){n.node.setSiblingIndex(0)});return[4,Promise.all(w.map(function(n){return n.sync({duration:.4,easing:"smooth",delay:tn(0,.2),getTargetPosition:function(n){return xu(w,k.tileSize,n)}})}))];case 1:n.sent();return[2]}})});return function(){return n.apply(this,arguments)}}();return function(){var n=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,C()];case 1:n.sent();return[4,_()];case 2:n.sent();return[2]}})});return function(){return n.apply(this,arguments)}}()}},{key:"consumeAnimationQueue",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(!!this.isConsumingAnimation)return[3,5];this.isConsumingAnimation=!0;w.label=1;case 1:if(!(this.animationQueue.length>0))return[3,4];if(0===this.getUncleared().length){this.animationQueue=[];return[3,4]}n=this.animationQueue.shift();return[4,null==n?void 0:n()];case 2:w.sent();w.label=3;case 3:return[3,1];case 4:this.isConsumingAnimation=!1;w.label=5;case 5:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"clearAnimationQueue",value:function(){this.isConsumingAnimation=!1,this.animationQueue=[]}},{key:"reportOrThrowInDebugger",value:function(n,w){var k=arguments.length>0&&void 0!==n?n:"Unknown error thrown",C=arguments.length>1&&void 0!==w?w:"Board",_=new Error("".concat(C,": ").concat(k));if(ul.isDebugger())throw _;null==ua||ua.sendException(_)}}],[{key:"generateFen",value:function(n){for(var w=n,k=[],C=0;C<w.colors;C++)k.push(C+1);var _=Date.now(),A=ac({levelData:w,seed:_,identities:k,createTile:function(n){var w=n,k=void 0,C=new e4(0,0);return{get id(){return w},get special(){return k},get coord(){return C},setIdentity:function(n){w=n},isHidden:function(){return!1},setSpecialType:function(n){k={type:n}},setCoord:function(n,w){return C.set(n,w)},getCoord:function(){return C},isSimilarTo:function(n){return n.id===w},inSamePositionAs:function(n){return n.getCoord().equals(C)}}}});return A.forEach(function(n,w,k){n.setCoord(w,k)}),hc(A,_),nc(A,w,_),function(n,w){for(var k=arguments.length>1&&void 0!==w?w:lZ,C=n.width,_=n.height,A=[],T=new Map,I=_-1;I>=0;I--){for(var L=[],O=0;O<C;O++){var D,M,N=n.get(O,I),z=N.isHidden()?null:N.id;if(null!==z){var B=k[null!==(D=null===(M=N.special)||void 0===M?void 0:M.type)&&void 0!==D?D:Q.none];if(!T.has(z)){var F=T.size.toString();T.set(z,F)}var x="".concat(B).concat(T.get(z));L.push(x)}else L.push(".")}A.push(L.join(""))}return{code:A.join(":"),idSize:T.size,encoding:k,rows:_,cols:C}}(A)}}]),f}(eO)).prototype,"tilePrefab",[l$,l0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l8=n(l5.prototype,"tilesHolder",[l1,l2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l9=n(l5.prototype,"tileTrim",[l4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e4(.025,.1)}}),l3=l5))||l3)||l3);ew._RF.pop(),ew._RF.push({},"f7e1byg/txJGqnuJJ7xQV1M","withItemAnalytics",void 0);var up=GameCore.Plugins.Analytics.Events,ud=globalThis.game.analytics,hh=function(n,w){return function(){return ud.event(up.USE_ITEM,{item_name:n}),w.apply(void 0,arguments)}};ew._RF.pop(),ew._RF.push({},"bc704Yz8bdJzYja7TsWcGMN","useHintItem",void 0);var uy=hh(X.PLIERS,function(n,w){if(!w.isDrawingHint){var k=n.getHintPath();null!==k&&(G.playSound(nL.HINT_ITEM),w.drawHintPath(k,function(w){return n.getAnyTileWorldPosition(w.x,w.y)}),n.showHint())}});ew._RF.pop(),ew._RF.push({},"0a2423JE25HLIm5td77YE7e","usePliersItem",void 0);var uf=hh(X.PLIERS,function(n,w){var k,C=Yu(n.getBombTiles()),_=C.node.worldPosition;w.createDefuseExplosionAt(_.x,_.y),G.playSound(nL.BOMB_DEFUSE),null===(k=C.special)||void 0===k||k.switch(Q.none)});ew._RF.pop(),ew._RF.push({},"d2cd0VZLwhNMJwc3ppHvOtA","withLoweredVolume",void 0);var yh=function(n){return M(function(){var w;var k=arguments;return _ts_generator(this,function(C){switch(C.label){case 0:G.setVolumeMusic(0,!0);return[4,n.apply(void 0,k)];case 1:w=C.sent();return[2,(G.setVolumeMusic(.3,!0),w)]}})})};ew._RF.pop(),ew._RF.push({},"a62ebriH15FfI8l0x1GBX1p","useThunderItem",void 0);var uv,ug=GameCore.Utils.Function,gh=function(n,w){var k,C,_=N.waitTweenAsync(w),A=n(),T=(k=[_,A],{race:(C=M(function(){return _ts_generator(this,function(n){return[2,Promise.race(k)]})}),function(){return C.apply(this,arguments)}),catch:function(n){ug.allSettled(k).then(function(w){var k=w.filter(function(n){return"rejected"===n.status});k.length>0&&n(k)})}});return T.catch(function(n){console.error("Error loading tornado animation",n)}),T.race()},um=function(){var n=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:return[4,gh(function(){return w.loadThunderAnimation()},.5)];case 1:if(C.sent(),n.getUncleared().length<4)return[3,3];k=n.getPairs(2);n.clearSelectedTile();return[4,w.playThunderAnimation(k,n)];case 2:C.sent();C.label=3;case 3:return[2]}})});return function(w,k){return n.apply(this,arguments)}}(),ub=hh(X.THUNDER,yh((uv=um,M(function(){var n;var w=arguments;return _ts_generator(this,function(k){switch(k.label){case 0:B.setBlockInput(!0);return[4,uv.apply(void 0,w)];case 1:n=k.sent();return[2,(B.setBlockInput(!1),n)]}})}))));ew._RF.pop(),ew._RF.push({},"0e50bRTLUtMgYDDkS0nbFm5","useTornadoItem",void 0);var uw,uS=GameCore.Utils.Function,kh=function(n,w){var k,C,_=N.waitTweenAsync(w),A=n(),T=(k=[_,A],{race:(C=M(function(){return _ts_generator(this,function(n){return[2,Promise.race(k)]})}),function(){return C.apply(this,arguments)}),catch:function(n){uS.allSettled(k).then(function(w){var k=w.filter(function(n){return"rejected"===n.status});k.length>0&&n(k)})}});return T.catch(function(n){console.error("Error loading tornado animation",n)}),T.race()},uk=function(){var n=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:return[4,uS.allSettled(n.map(function(k,C,_){return k.sync({duration:.4,easing:"smooth",getTargetPosition:function(){return xu(n,w,{x:C,y:_},10)}})}))];case 1:k=C.sent();k.some(function(n){return"rejected"===n.status})&&console.error("Error playing padding animation",k.filter(function(n){return"rejected"===n.status}));return[2]}})});return function(w,k){return n.apply(this,arguments)}}(),uC=function(){var n=M(function(n,w){var k,C;return _ts_generator(this,function(_){switch(_.label){case 0:k=n.asArray().length;n.forEach(function(w,C,_){w.node.setSiblingIndex(k-1-(C+_*n.width))});return[4,uS.allSettled(n.map(function(k){return k.fly({getTilePosition:function(k){return xu(n,w,k)}})}))];case 1:C=_.sent();C.some(function(n){return"rejected"===n.status})&&console.error("Error playing shuffle animation",C.filter(function(n){return"rejected"===n.status}));return[2]}})});return function(w,k){return n.apply(this,arguments)}}(),uE=function(){var n=M(function(n,w,k,C){return _ts_generator(this,function(_){switch(_.label){case 0:G.playSound(nL.SHUFFLE_ITEM),G.playSound(nL.WIND);return[4,uk(n,k())];case 1:_.sent(),C();return[4,uC(w,k())];case 2:_.sent();return[2]}})});return function(w,k,C,_){return n.apply(this,arguments)}}(),u_=function(){var n=M(function(n,w){var k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:return[4,kh(function(){return w.loadTornadoAnimation()},.5)];case 1:A.sent();k=function(){return n.getTileSize()},C=function(){return w.playTornadoAnimation()},_=yh(function(n,w){return uE(n,w,k,C)});return[2,new Promise(function(w){n.processShuffleRequest(function(){var n=M(function(n,k){return _ts_generator(this,function(C){switch(C.label){case 0:return[4,_(n,k)];case 1:C.sent(),w();return[2]}})});return function(w,k){return n.apply(this,arguments)}}())})]}})});return function(w,k){return n.apply(this,arguments)}}(),uA=hh(X.THUNDER,yh(u_));ew._RF.pop(),ew._RF.push({},"c92ec8pmUJGbrL9PLjum+i5","Line",void 0);var uT=(0,eS.ccclass)("Line")(uw=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(e_)}},{key:"setPoints",value:function(n,w){this.node.setWorldPosition((n.x+w.x)/2,(n.y+w.y)/2,0),this.uiTransform.width=e4.distance(n,w)+10,this.uiTransform.width/=this.node.worldScale.x;var k=180*Math.atan2(w.y-n.y,w.x-n.x)/Math.PI;this.node.eulerAngles=new eQ(0,0,k)}}]),o}(eO))||uw;ew._RF.pop(),ew._RF.push({},"1e7cch8i/5DkYHOwJowrjeg","AFPool",void 0);var uP,uR,uI,uL,uO,uD,uM,uN,uz,uB,uF,ux=function(n){w(o,n);var _=k(o);function o(n,w,k,A,T){var I;return C(this,o),(I=_.call(this,n,w,T)).ator=k,I.ftor=A,I}return T(o,[{key:"alloc",value:function(){var n=O(D(o.prototype),"alloc",this).call(this);return this.ator&&this.ator(n),n}},{key:"free",value:function(n){this.ftor&&this.ftor(n),O(D(o.prototype),"free",this).call(this,n)}}]),o}(ti);ew._RF.pop(),ew._RF.push({},"6f7a1msxIxIbYLx5PpbL/BZ","PathDrawer",void 0);var uU,uG,uH,uV,uq,uW,uK,uj,uY,uX=eS.ccclass,uZ=eS.property,uJ=(uP=uX("PathDrawer"),uR=uZ({group:"Line",displayName:"Prefab",type:ta}),uI=uZ({group:"Line",displayName:"Holder",type:ek,tooltip:"Line Prefab"}),uL=uZ({group:"Point",displayName:"Prefab",type:ta}),uO=uZ({group:"Point",displayName:"Holder",type:ek}),uP((uN=n((uM=function(n){w(u,n);var I=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"linePrefab",uN,A(n)),_(n,"lineHolder",uz,A(n)),n.lineNodes=[],_(n,"pointPrefab",uB,A(n)),_(n,"pointHolder",uF,A(n)),n.pointNodes=[],n}return T(u,[{key:"start",value:function(){var n=this;this.linePool=new ux(function(){var w=eA(n.linePrefab);return n.lineHolder.addChild(w),w.parent=n.lineHolder,w.active=!1,w},0,function(w){n.lineNodes.push(w),w.active=!0},function(n){n.active=!1},function(n){n.isValid&&n.destroy()}),this.pointPool=new ux(function(){var w=eA(n.pointPrefab);return n.pointHolder.addChild(w),w.active=!1,w},0,function(w){n.pointNodes.push(w),w.active=!0},function(n){n.active=!1},function(n){n.isValid&&n.destroy()})}},{key:"drawPath",value:function(n){this.clearPath();var w,k=L(n);try{for(k.s();!(w=k.n()).done;){var C,_=w.value;null===(C=this.linePool.alloc().getComponent(uT))||void 0===C||C.setPoints(_.a,_.b)}}catch(n){k.e(n)}finally{k.f()}}},{key:"clearPath",value:function(){var n,w=L(this.lineNodes);try{for(w.s();!(n=w.n()).done;){var k=n.value;this.linePool.free(k)}}catch(n){w.e(n)}finally{w.f()}this.lineNodes=[];var C,_=L(this.pointNodes);try{for(_.s();!(C=_.n()).done;){var A=C.value;this.pointPool.free(A)}}catch(n){_.e(n)}finally{_.f()}this.pointNodes=[]}}]),u}(eO)).prototype,"linePrefab",[uR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uz=n(uM.prototype,"lineHolder",[uI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uB=n(uM.prototype,"pointPrefab",[uL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uF=n(uM.prototype,"pointHolder",[uO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uD=uM))||uD);ew._RF.pop(),ew._RF.push({},"5cc7bAmTI1JL7nwLzZcp45u","ErrorDrawer",void 0);var uQ,u$=eS.ccclass,u0=eS.property,u1=(uU=u$("ErrorDrawer"),uG=u0(e9),uH=u0(e9),uV=u0(e9),uU((uK=n((uW=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"one",uK,A(n)),_(n,"two",uj,A(n)),_(n,"error",uY,A(n)),n}return T(s,[{key:"start",value:function(){O(D(s.prototype),"start",this).call(this),this.pathAppearDuration=0}},{key:"drawPath",value:function(n){var w=this;if(this.clearPath(),n.forEach(function(k,C){var _;if(null===(_=w.linePool.alloc().getComponent(uT))||void 0===_||_.setPoints(k.a,k.b),0!==C){var A=w.pointPool.alloc();A.setWorldPosition(new eQ(k.a.x,k.a.y,0));var T=A.getComponent(ex);1===C&&n.length>3?T.spriteFrame=w.one:2===C&&n.length>3?T.spriteFrame=w.two:T.spriteFrame=w.error}}),1===n.length){var k=this.pointPool.alloc();k.setWorldPosition(new eQ(n[0].a.x+n[0].b.x,n[0].a.y+n[0].b.y,0).multiplyScalar(.5)),k.getComponent(ex).spriteFrame=this.error}this.pathAppearDuration=.8}},{key:"update",value:function(n){this.pathAppearDuration>0&&(this.pathAppearDuration-=n,this.pathAppearDuration<=0&&this.clearPath())}}]),s}(uJ)).prototype,"one",[uG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uj=n(uW.prototype,"two",[uH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uY=n(uW.prototype,"error",[uV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uq=uW))||uq);ew._RF.pop(),ew._RF.push({},"880e8aL9NFPj68zH2xVRIFR","HintDrawer",void 0);var u2,u4=(0,eS.ccclass)("HintDrawer")(uQ=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"drawPath",value:function(n){this.clearPath(),this.createPath(n),this.showPath()}},{key:"createPath",value:function(n){var w,k=L(n);try{for(k.s();!(w=k.n()).done;){var C,_=w.value;null===(C=this.linePool.alloc().getComponent(uT))||void 0===C||C.setPoints(_.a,_.b),this.pointPool.alloc().setWorldPosition(_.a.x,_.a.y,0)}}catch(n){k.e(n)}finally{k.f()}this.pointPool.alloc().setWorldPosition(n[n.length-1].b.x,n[n.length-1].b.y,0)}},{key:"showPath",value:function(){var n,w=L(this.lineNodes);try{for(w.s();!(n=w.n()).done;){var k=n.value.getComponent(eH);k.opacity=0,ez(k).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(n){w.e(n)}finally{w.f()}var C,_=L(this.pointNodes);try{for(_.s();!(C=_.n()).done;){var A=C.value.getComponent(eH);A.opacity=0,ez(A).to(.2,{opacity:255},{easing:"quadOut"}).start()}}catch(n){_.e(n)}finally{_.f()}}},{key:"clearPath",value:function(){var n,w=this,k=L(this.lineNodes);try{var i=function(){var k=n.value,C=k.getComponent(eH);ez(C).to(.15,{opacity:0},{onComplete:function(){C.opacity=255,w.linePool.free(k)}}).start()};for(k.s();!(n=k.n()).done;)i()}catch(n){k.e(n)}finally{k.f()}var C,_=L(this.pointNodes);try{var r=function(){var n=C.value,k=n.getComponent(eH);ez(k).to(.15,{opacity:0},{onComplete:function(){k.opacity=255,w.pointPool.free(n)}}).start()};for(_.s();!(C=_.n()).done;)r()}catch(n){_.e(n)}finally{_.f()}this.lineNodes=[],this.pointNodes=[]}}]),o}(uJ))||uQ;ew._RF.pop(),ew._RF.push({},"25f67BW5/5Jzox4v+yBBbyS","MatchDrawer",void 0);var u3,u5,u6,u8,u9,u7,ce,ct,cn,ci=(0,eS.ccclass)("MatchDrawer")(u2=function(n){w(s,n);var _,A,I=k(s);function s(){return C(this,s),I.apply(this,arguments)}return T(s,[{key:"drawPath",value:function(n){var w=this;n.forEach(function(n,k){var C,_=w.linePool.alloc();null===(C=_.getComponent(uT))||void 0===C||C.setPoints(n.a,n.b),w.animateLine(_);var A=w.pointPool.alloc();A.setWorldPosition(n.a.x,n.a.y,0),w.animatePoint(A,k)});var k=this.pointPool.alloc();k.setWorldPosition(n[n.length-1].b.x,n[n.length-1].b.y,0),this.animatePoint(k,n.length)}},{key:"animateLine",value:(A=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:w=n.getComponent(eH);w.opacity=0;k=ez(w).to(.25,{opacity:255},{easing:"quadOut"}).delay(.1).to(.2,{opacity:0});return[4,N.runTweenAsync(k)];case 1:C.sent(),w.opacity=255,this.linePool.free(n);return[2]}})}),function(n){return A.apply(this,arguments)})},{key:"animatePoint",value:(_=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:n.scale=eQ.ZERO;k=ez(n).delay(.03*w).to(.2,{scale:eQ.ONE},{easing:"quadOut"}).delay(.1).to(.2,{scale:eQ.ZERO},{easing:"backIn"});return[4,N.runTweenAsync(k)];case 1:C.sent(),this.pointPool.free(n);return[2]}})}),function(n,w){return _.apply(this,arguments)})},{key:"clearPath",value:function(){this.lineNodes=[],this.pointNodes=[]}}]),s}(uJ))||u2;ew._RF.pop(),ew._RF.push({},"bfdf2THr9lPJ4TOVDN8VgE4","PathDraw",void 0);var ca,cr=eS.ccclass,co=eS.property,cs=(u3=cr("PathDraw"),u5=co({group:{name:"Path Drawer"},type:ci}),u6=co({group:{name:"Path Drawer"},type:u4}),u8=co({group:{name:"Path Drawer"},type:u1}),u3((ce=n((u7=function(n){w(c,n);var O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"matchPath",ce,A(n)),_(n,"hintPath",ct,A(n)),_(n,"errorPath",cn,A(n)),n.isDrawingHint=!1,n}return T(c,[{key:"onLoad",value:function(){var n=this;this.node.scene.on(i9.GRID_RESIZE,function(w){n.node.setScale(w,w)})}},{key:"drawMatchPath",value:function(n,w){var k,C=n.map(function(n){return I({},n)}),_=L(C);try{for(_.s();!(k=_.n()).done;){var A=k.value;A.a=w(A.a),A.b=w(A.b)}}catch(n){_.e(n)}finally{_.f()}this.matchPath.drawPath(C)}},{key:"clearMatchPath",value:function(){this.matchPath.clearPath()}},{key:"drawHintPath",value:function(n,w){if(!this.isDrawingHint){this.isDrawingHint=!0;var k,C=n.map(function(n){return I({},n)}),_=L(C);try{for(_.s();!(k=_.n()).done;){var A=k.value;A.a=w(A.a),A.b=w(A.b)}}catch(n){_.e(n)}finally{_.f()}this.hintPath.drawPath(C)}}},{key:"clearHintPath",value:function(){this.isDrawingHint&&(this.isDrawingHint=!1,this.hintPath.clearPath())}},{key:"drawErrorPath",value:function(n,w){var k,C=n.map(function(n){return I({},n)}),_=L(C);try{for(_.s();!(k=_.n()).done;){var A=k.value;A.a=w(A.a),A.b=w(A.b)}}catch(n){_.e(n)}finally{_.f()}this.errorPath.drawPath(C)}}]),c}(eO)).prototype,"matchPath",[u5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=n(u7.prototype,"hintPath",[u6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=n(u7.prototype,"errorPath",[u8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u9=u7))||u9);ew._RF.pop(),ew._RF.push({},"1a5c0RyWQJOipSvNtPLsTHS","ClockManager",void 0);var cl,cu=eS.ccclass,cc=eS.disallowMultiple,ch=cu("ClockManager")(ca=cc(ca=function(n){w(l,n);var _,A=k(l);function l(){var n;C(this,l);for(var w=arguments.length,k=new Array(w),_=0;_<w;_++)k[_]=arguments[_];return(n=A.call.apply(A,[this].concat(k))).time=0,n.remaining=0,n.running=!1,n.halfTime=!1,n}return T(l,[{key:"onLoad",value:function(){this.node.scene.on(i9.RESCUE_START,this.refillTime,this)}},{key:"init",value:function(){this.running=!1,this.halfTime=!1}},{key:"setTime",value:function(n){this.time=n,this.remaining=n,this.node.scene.emit(i9.TIME_UPDATED,this.remaining)}},{key:"getRemainingTime",value:function(){return this.remaining}},{key:"startCountdown",value:function(){this.running=!0,this.remaining=this.time}},{key:"pause",value:function(){this.running=!1}},{key:"resume",value:function(){this.running=!0}},{key:"endCountDown",value:function(){this.running=!1,this.remaining=0,this.node.scene.emit(i9.TIME_OUT)}},{key:"update",value:function(n){this.running&&(this.remaining<=0?this.endCountDown():(this.remaining-=n,!this.halfTime&&this.remaining<=this.time/2&&(this.halfTime=!0,this.node.scene.emit(i9.HALF_TIME)),this.remaining>=0&&this.node.scene.emit(i9.TIME_UPDATED,this.remaining)))}},{key:"refillTime",value:(_=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:n=this,w=ez(this.node).to(3,{},{onUpdate:function(w,k){if(k){var C=e0.lerp(0,120,k);n.setTime(C)}}});return[4,N.runTweenAsync(w)];case 1:k.sent(),this.setTime(120),this.node.scene.emit(i9.RESCUE_FINISHED);return[2]}})}),function(){return _.apply(this,arguments)})}]),l}(eO))||ca)||ca;ew._RF.pop(),ew._RF.push({},"3afb9sM0KZKyod8UtofqZYu","ComboManager",void 0);var cp,cd,cy,cf,cv,cg,cm,cb,cw,cS,ck,cC=eS.ccclass,cE=[nL.COMBO_1,nL.COMBO_2,nL.COMBO_3,nL.COMBO_4,nL.COMBO_5,nL.COMBO_6,nL.COMBO_7,nL.COMBO_8,nL.COMBO_9,nL.COMBO_10,nL.COMBO_11,nL.COMBO_12,nL.COMBO_13],c_=cC("ComboManager")(cl=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"init",value:function(){this.currentCombo=0,this.setEmitEvent(!0),this.node.scene.on(i9.COMBO_ENDED,this.resetCombo,this),this.node.scene.on(i9.GAME_FINISH,this.resetCombo,this),this.node.scene.on(i9.GAME_REPLAY,this.resetCombo,this),this.node.scene.on(i9.NEXT_LEVEL,this.resetCombo,this),this.node.scene.on(i9.ADD_COMBO,this.addCombo,this)}},{key:"addCombo",value:function(){this.setCombo(this.currentCombo+1)}},{key:"resetCombo",value:function(){this.setCombo(0)}},{key:"getCombo",value:function(){return this.currentCombo}},{key:"setCombo",value:function(n){if(this.currentCombo=n,n>0){var w=Math.min(n-1,cE.length-1);G.playSound(cE[w]),this.vibrate(n)}this.emitEvent&&this.node.scene.emit(i9.COMBO_UPDATED,n)}},{key:"vibrate",value:function(n){var w;null===(w=tr("Vibrate"))||void 0===w||null===(w=w.getComponent(sg))||void 0===w||w.vibrate(Math.min(20+20*n,220))}},{key:"setEmitEvent",value:function(n){this.emitEvent=n}}]),o}(eO))||cl;ew._RF.pop(),ew._RF.push({},"78746Q4viBIlbRROK4J1bSl","Burst",void 0);var cA,cT=eS.ccclass,cP=eS.property,cR=(cp=cT("Burst"),cd=cP(eM),cy=cP(eD),cf=cP(eM),cv=cP(eD),cp((cb=n((cm=function(){function e(){C(this,e),_(this,"time",cb,this),_(this,"repeatCount",cw,this),_(this,"repeatInterval",cS,this),_(this,"count",ck,this),this.remainingCount=0,this.curTime=0}return T(e,[{key:"update",value:function(n,w){if(0===this.remainingCount&&(this.remainingCount=this.repeatCount,this.curTime=this.time),this.remainingCount>0){var k=to(n.time-n.startDelay.evaluate(0,1),n.duration)-w;k=k>0?k:0;var C=to(n.time-n.startDelay.evaluate(0,1),n.duration);this.curTime>=k&&this.curTime<C&&(n.emit(this.count,w-(C-this.curTime)),this.curTime+=this.repeatInterval,--this.remainingCount)}}},{key:"reset",value:function(){this.remainingCount=0,this.curTime=0}}]),e}()).prototype,"time",[cd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),cw=n(cm.prototype,"repeatCount",[cy],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),cS=n(cm.prototype,"repeatInterval",[cf],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ck=n(cm.prototype,"count",[cv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),cg=cm))||cg);ew._RF.pop(),ew._RF.push({},"726cc2e08FBqpVIg/tPM7H2","Particle",void 0);var cI,cL,cO,cD,cM,cN,cz,cB,cF,cx,cU,cG,cH,cV,cq,cW,cK,cj=eS.ccclass,cY=eS.executeInEditMode,cX=cj("Particle")(cA=cY(!0)(cA=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).remainingLifetime=0,n.startLifetime=0,n}return T(o,[{key:"onLoad",value:function(){this.node.layer=e6.Enum.UI_2D}},{key:"init",value:function(n){this.sprite=this.getComponent(ex),this.particleSystem=n,this.velocity=eQ.ZERO,this.remainingLifetime=0,this.startLifetime=0,this.startSize=eQ.ZERO,this.startColor=eC.WHITE.clone(),this.randomSeed=0}},{key:"reset",value:function(){this.node.rotation.set(0,0,0)}}]),o}(eO))||cA)||cA;ew._RF.pop(),ew._RF.push({},"00eb3NBo0tM/qcD6ViMjx0A","CurveRange",void 0);var cZ,cJ,cQ,c$,c0,c1,c2,c4,c3,c5,c6,c8,c9,c7,he,ht,hn,hi=eS.ccclass,ha=eS.property,hr=eU({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3}),ho=(cI=hi("CurveRange"),cL=ha({type:eU(hr)}),cO=ha({visible:function(){return this.mode===hr.Constant}}),cD=ha({visible:function(){return this.mode===hr.Curve}}),cM=ha({visible:function(){return this.mode===hr.TwoCurves}}),cN=ha({visible:function(){return this.mode===hr.TwoCurves}}),cz=ha({visible:function(){return this.mode===hr.TwoConstants}}),cB=ha({visible:function(){return this.mode===hr.TwoConstants}}),cI((cU=n((cx=function(){function e(){C(this,e),_(this,"mode",cU,this),_(this,"constant",cG,this),_(this,"spline",cH,this),_(this,"splineMin",cV,this),_(this,"splineMax",cq,this),_(this,"constantMin",cW,this),_(this,"constantMax",cK,this),this.spline.assignSorted([0,1],[0,1]),this.splineMin.assignSorted([0,1],[0,1]),this.splineMax.assignSorted([0,1],[0,1])}return T(e,[{key:"evaluate",value:function(n,w){switch(this.mode){case hr.Curve:return this.spline.evaluate(n);case hr.TwoCurves:return ts(this.splineMin.evaluate(n),this.splineMax.evaluate(n),w);case hr.TwoConstants:return ts(this.constantMin,this.constantMax,w);default:return this.constant}}},{key:"getMax",value:function(){switch(this.mode){case hr.Curve:return 1;case hr.TwoConstants:return this.constantMax;case hr.TwoCurves:return 1;default:return this.constant}}},{key:"isZero",value:function(){switch(this.mode){case hr.Curve:return tl(1,0,tu);case hr.TwoConstants:return tl(Math.max(Math.abs(this.constantMax),Math.abs(this.constantMin)),0,tu);case hr.TwoCurves:return tl(1,0,tu);default:return tl(this.constant,0,tu)}}}]),e}()).prototype,"mode",[cL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return hr.Constant}}),cG=n(cx.prototype,"constant",[cO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),cH=n(cx.prototype,"spline",[cD],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new tc}}),cV=n(cx.prototype,"splineMin",[cM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new tc}}),cq=n(cx.prototype,"splineMax",[cN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new tc}}),cW=n(cx.prototype,"constantMin",[cz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),cK=n(cx.prototype,"constantMax",[cB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),cF=cx))||cF);ew._RF.pop(),ew._RF.push({},"3fe5eBRNTJFCZgeD7SqFSh5","GradientRange",void 0);var hs=eS.ccclass,hl=eS.property,hu=eU({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),hp=new eC,hd=new eC,hy=(cZ=hs("GradientRange"),cJ=hl({type:eU(hu)}),cQ=hl({visible:function(){return this.mode===hu.Color}}),c$=hl({visible:function(){return this.mode===hu.TwoColors}}),c0=hl({visible:function(){return this.mode===hu.TwoColors}}),c1=hl({visible:function(){return this.mode===hu.Gradient||this.mode===hu.RandomColor}}),c2=hl({visible:function(){return this.mode===hu.TwoGradients}}),c4=hl({visible:function(){return this.mode===hu.TwoGradients}}),cZ((c6=n((c5=function(){function e(){C(this,e),_(this,"mode",c6,this),_(this,"color",c8,this),_(this,"colorMin",c9,this),_(this,"colorMax",c7,this),_(this,"gradient",he,this),_(this,"gradientMin",ht,this),_(this,"gradientMax",hn,this),this._color=eC.WHITE.clone()}return T(e,[{key:"evaluate",value:function(n,w){switch(this.mode){case hu.Color:return this.color;case hu.TwoColors:return eC.lerp(this._color,this.colorMin,this.colorMax,w),this._color;case hu.RandomColor:return this.gradient.getRandomColor(this._color);case hu.Gradient:return this.gradient.evaluateFast(this._color,n);case hu.TwoGradients:return eC.lerp(this._color,this.gradientMin.evaluateFast(hp,n),this.gradientMax.evaluateFast(hd,n),w),this._color;default:return this.color}}}]),e}()).prototype,"mode",[cJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return hu.Color}}),c8=n(c5.prototype,"color",[cQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return eC.WHITE.clone()}}),c9=n(c5.prototype,"colorMin",[c$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return eC.WHITE.clone()}}),c7=n(c5.prototype,"colorMax",[c0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return eC.WHITE.clone()}}),he=n(c5.prototype,"gradient",[c1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new th}}),ht=n(c5.prototype,"gradientMin",[c2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new th}}),hn=n(c5.prototype,"gradientMax",[c4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new th}}),c3=c5))||c3);function Md(n,w,k,C){!function(n,w){e4.set(n,Math.cos(w),Math.sin(w))}(n,C),n.z=0,eQ.multiplyScalar(n,n,w+(k-w)*td())}function Nd(n){var w=hr;switch(n.mode){case w.TwoCurves:case w.TwoConstants:return!0;default:return!1}}ew._RF.pop(),ew._RF.push({},"1a4c4Z/fWpFuL5b3emrVLug","ParticleFunction",void 0),ew._RF.pop(),ew._RF.push({},"c2fc2/T2apMGZCPX5a4abo/","ModuleRandSeed",void 0);var hf,hv,hg,hm,hb,hw,hS,hk=23541,hC=39825,hE=90794,h_=91041,hA=125292,hT=197866,hP=156497;ew._RF.pop(),ew._RF.push({},"39785+APfBJU5kvcdjZGiLr","ColorOvertimeModule",void 0);var hR,hI,hL,hO,hD,hM,hN,hz,hB,hF=eS.ccclass,hx=eS.property,hU=h_,hG=(hf=hF("ColorOvertimeModule"),hv=hx({type:eW}),hg=hx({type:hy}),hf((hw=n((hb=function(){function e(){C(this,e),_(this,"enable",hw,this),_(this,"color",hS,this)}return T(e,[{key:"update",value:function(n){if(this.enable){var w=n.randomSeed+hU,k=function(n){var w=hu;switch(n.mode){case w.TwoGradients:case w.TwoColors:return!0;default:return!1}}(this.color)?tt(w):0,C=1-n.remainingLifetime/n.startLifetime;n.sprite.color=n.startColor.clone().multiply(this.color.evaluate(C,k))}}}]),e}()).prototype,"enable",[hv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hS=n(hb.prototype,"color",[hg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hy}}),hm=hb))||hm);ew._RF.pop(),ew._RF.push({},"c397apirpxFfJTJN1KLAcGi","LimitVelocityOvertimeModule",void 0);var hH,hV,hq,hW,hK,hj,hY,hX=eS.ccclass,hZ=eS.property,hJ=hk,hQ=(hR=hX("LimitVelocityOvertimeModule"),hI=hZ({type:eW}),hL=hZ({type:ho}),hO=hZ({type:ho}),hR((hN=n((hM=function(){function e(){C(this,e),_(this,"enable",hN,this),_(this,"limit",hz,this),_(this,"dampen",hB,this),this.limit.constant=500,this.dampen.constant=.2}return T(e,[{key:"update",value:function(n,w){if(this.enable){var k=1-n.remainingLifetime/n.startLifetime,C=n.velocity.clone().normalize(),_=Nd(this.limit)?tt(n.randomSeed+hJ):0,A=Nd(this.dampen)?tt(n.randomSeed+hJ+1):0,T=n.velocity.length(),I=this.limit.evaluate(k,_),L=this.dampen.evaluate(k,A);n.velocity=C.multiplyScalar(this.dampenBeyondLimit(T,I,L,w))}}},{key:"dampenBeyondLimit",value:function(n,w,k,C){if(n<=w)return n;var _=1-Math.exp(-k*C);return e0.lerp(n,w,_)}}]),e}()).prototype,"enable",[hI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hz=n(hM.prototype,"limit",[hL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),hB=n(hM.prototype,"dampen",[hO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),hD=hM))||hD);ew._RF.pop(),ew._RF.push({},"442c2KaGHdNip4TBoeKOOoY","RendererModule",void 0);var h$,h0,h1,h2,h4,h3,h5,h6,h8,h9,h7,pe,pt,pn,pi=eS.ccclass,pa=eS.property,pr=(hH=pi("RendererModule"),hV=pa(ty),hq=pa(e9),hH((hj=n((hK=T(function e(){C(this,e),_(this,"material",hj,this),_(this,"spriteFrame",hY,this)})).prototype,"material",[hV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hY=n(hK.prototype,"spriteFrame",[hq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hW=hK))||hW);ew._RF.pop(),ew._RF.push({},"c6cfbhYVctHt53aUXC4oSWy","RotationOvertimeModule",void 0);var po,ps,pl,pu,pc,ph,pp,pd,py,pf,pv,pg,pm,pb,pw,pS,pk,pC,pE,p_,pA,pT,pP,pR=eS.ccclass,pI=eS.property,pL=hA,pO=(h$=pR("RotationOvertimeModule"),h0=pI({type:eW}),h1=pI(eW),h2=pI({type:ho}),h4=pI({type:ho,visible:function(){return this.separateAxes}}),h3=pI({type:ho,visible:function(){return this.separateAxes}}),h5=pI({type:ho}),h$((h9=n((h8=function(){function e(){C(this,e),_(this,"enable",h9,this),_(this,"separateAxes",h7,this),_(this,"x",pe,this),_(this,"y",pt,this),_(this,"z",pn,this)}return T(e,[{key:"update",value:function(n,w){if(this.enable){var k=1-n.remainingLifetime/n.startLifetime,C=n.randomSeed+pL,_=Nd(this.z)?tt(C):0,A=this.z.evaluate(k,_)*w,T=0,I=0;if(this.separateAxes){var L=Nd(this.x)?tt(C):0,O=Nd(this.y)?tt(C):0;T=this.x.evaluate(k,L)*w,I=this.y.evaluate(k,O)*w}n.node.eulerAngles=new eQ(n.node.eulerAngles.x+T,n.node.eulerAngles.y+I,n.node.eulerAngles.z+A)}}}]),e}()).prototype,"enable",[h0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h7=n(h8.prototype,"separateAxes",[h1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),pe=n(h8.prototype,"x",[h2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),pt=n(h8.prototype,"y",[h4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),pn=n(h8.prototype,"z",[h3,h5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),h6=h8))||h6);ew._RF.pop(),ew._RF.push({},"f63cd4ScDJFPrnTLNT4+QKu","ShapeModule",void 0);var pD,pM,pN,pz,pB,pF,px,pU=eS.ccclass,pG=eS.property,pH=eU({Circle:0,Rectangle:1}),pV=eU({Base:0,Edge:1}),kf=function(){return this.shape===pH.Circle},Cf=function(){return this.shape===pH.Rectangle},pq=[0,0],pW=(po=pU("ShapeModule"),ps=pG({type:eU(pH)}),pl=pG({type:eU(pV),visible:Cf}),pu=pG({}),pc=pG({}),ph=pG({}),pp=pG({range:[0,360],visible:kf}),pd=pG({range:[-360,360],visible:kf}),py=pG({min:0,visible:kf}),pf=pG({range:[0,1],step:.01,visible:kf}),pv=pG({visible:Cf}),po((pb=n((pm=function(){function e(){C(this,e),_(this,"shape",pb,this),_(this,"emitFrom",pw,this),_(this,"position",pS,this),_(this,"rotation",pk,this),_(this,"scale",pC,this),_(this,"arc",pE,this),_(this,"angle",p_,this),_(this,"radius",pA,this),_(this,"radiusThickness",pT,this),_(this,"rectangleThickness",pP,this)}return T(e,[{key:"emit",value:function(n){switch(this.shape){case pH.Circle:this.circleEmit(this.radius,this.radiusThickness,tf(this.generateArcAngle()),n);break;case pH.Rectangle:this.rectangleEmit(this.emitFrom,this.rectangleThickness,n)}}},{key:"circleEmit",value:function(n,w,k,C){var _=C.node.position;Md(_,n*(1-w),n,k+tf(this.angle)),C.velocity=_.clone().normalize()}},{key:"rectangleEmit",value:function(n,w,k){var C,_,A,T=k.node.position;switch(n){case pV.Base:_=T,A=w,e4.set(_,tn(-A.x,A.x),tn(-A.y,A.y));break;case pV.Edge:pq[0]=tn(-1,1),pq[1]=(0===(C=tn(-1,1))&&C++,tp.sign(C)),function(n){for(var w=0;w<n.length;w++){var k=w+e8(0,n.length-w),C=n[k];n[k]=n[w],n[w]=C}}(pq),this.applyRectThickness(pq,w),e4.set(T,pq[0],pq[1])}k.velocity=T.clone().normalize()}},{key:"generateArcAngle",value:function(){return tn(0,this.arc)}},{key:"applyRectThickness",value:function(n,w){w.x>0&&(n[0]*=w.x),w.y>0&&(n[1]*=w.y)}},{key:"gizmo",value:function(n){switch(n.strokeColor.fromHEX("#46C4FFB0"),n.fillColor.fromHEX("#46C4FF77"),n.lineWidth=8,this.shape){case pH.Circle:this.gizmoCircle(n);break;case pH.Rectangle:this.gizmoRectangle(n)}}},{key:"gizmoCircle",value:function(n){n.clear();var w=this.angle,k=this.angle+this.arc;if(this.createArcPath(n,this.radius,w,k),this.createArcPath(n,this.radius*(1-this.radiusThickness),w,k),this.arc<360&&this.radius>0){var C=this.radius*Math.cos(tf(this.angle)),_=this.radius*Math.sin(tf(this.angle)),A=this.radius*Math.cos(tf(this.arc+this.angle)),T=this.radius*Math.sin(tf(this.arc+this.angle));n.moveTo(C,_),n.lineTo(0,0),n.moveTo(A,T),n.lineTo(0,0)}n.stroke()}},{key:"gizmoRectangle",value:function(n){n.clear();var w=this.rectangleThickness.x,k=this.rectangleThickness.y;n.moveTo(w,k),n.lineTo(-w,k),n.lineTo(-w,-k),n.lineTo(w,-k),n.close(),n.stroke()}},{key:"createArcPath",value:function(n,w,k,C){if(!(w<=0))for(var _=(C-k)/48,A=0;A<=48;A++){var T=k+A*_,I=w*Math.cos(tf(T)),L=w*Math.sin(tf(T));0===A?n.moveTo(I,L):n.lineTo(I,L)}}}]),e}()).prototype,"shape",[ps],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return pH.Circle}}),pw=n(pm.prototype,"emitFrom",[pl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return pV.Base}}),pS=n(pm.prototype,"position",[pu],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new eQ(0,0,0)}}),pk=n(pm.prototype,"rotation",[pc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new eQ(0,0,0)}}),pC=n(pm.prototype,"scale",[ph],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new eQ(1,1,1)}}),pE=n(pm.prototype,"arc",[pp],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 360}}),p_=n(pm.prototype,"angle",[pd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 25}}),pA=n(pm.prototype,"radius",[py],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),pT=n(pm.prototype,"radiusThickness",[pf],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),pP=n(pm.prototype,"rectangleThickness",[pv],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e4(20,50)}}),pg=pm))||pg);ew._RF.pop(),ew._RF.push({},"1b7c1WztGdLzKO8gh4ulm2c","SizeOvertimeModule",void 0);var pK,pj,pY,pX,pZ,pJ,pQ,p$,p0,p1,p2,p4,p3,p5=eS.ccclass,p6=eS.property,p8=hC,p9=(pD=p5("SizeOvertimeModule"),pM=p6({type:eW}),pN=p6({type:ho}),pD((pF=n((pB=function(){function e(){C(this,e),_(this,"enable",pF,this),_(this,"size",px,this),this.size.constant=1}return T(e,[{key:"update",value:function(n){if(this.enable){var w=1-n.remainingLifetime/n.startLifetime,k=n.randomSeed+p8,C=Nd(this.size)?tt(k):0,_=this.size.evaluate(w,C);n.node.scale=new eQ(_*n.startSize.x,_*n.startSize.y,1)}}}]),e}()).prototype,"enable",[pM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),px=n(pB.prototype,"size",[pN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),pz=pB))||pz);ew._RF.pop(),ew._RF.push({},"530341yf3ZOmaqdU+AYM0/U","SpriteAnimationModule",void 0);var p7,de,dt,dn,di,da,dr,ds,dl,du=eS.ccclass,dc=eS.property,dh=hE,dp=(pK=du("SpriteAnimationModule"),pj=dc({type:eW}),pY=dc({type:e9}),pX=dc({type:ho}),pZ=dc({type:ho}),pJ=dc({type:eD}),pK((p0=n((p$=function(){function e(){C(this,e),_(this,"enable",p0,this),_(this,"frames",p1,this),_(this,"frameOverTime",p2,this),_(this,"startFrame",p4,this),_(this,"cycleCount",p3,this),this.frameOverTime.constant=0,this.startFrame.constant=0}return T(e,[{key:"update",value:function(n){if(this.enable){var w=1-n.remainingLifetime/n.startLifetime,k=Nd(this.startFrame)?tt(n.randomSeed+dh):0,C=Nd(this.frameOverTime)?tt(n.randomSeed+dh):0,_=this.startFrame.evaluate(w,k),A=to(this.cycleCount*(this.frameOverTime.evaluate(w,C)+_),this.frames.length);n.sprite.spriteFrame=this.frames[Math.floor(A)]}}}]),e}()).prototype,"enable",[pj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p1=n(p$.prototype,"frames",[pY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p2=n(p$.prototype,"frameOverTime",[pX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),p4=n(p$.prototype,"startFrame",[pZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),p3=n(p$.prototype,"cycleCount",[pJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pQ=p$))||pQ);ew._RF.pop(),ew._RF.push({},"f6ad5Yz6wpE2ZzModn16CYQ","VelocityOvertimeModule",void 0);var dd,dy,df,dv,dg,dm,db,dw,dS,dk,dC,dE,d_,dA,dT,dP,dR,dI,dL,dO,dD,dM,dN,dz,dB,dF,dx,dU,dG,dH,dV,dq,dW,dK,dj,dY,dX,dZ,dJ,dQ,d$,d0,d1,d2,d4,d3,d5,d6,d8,d9,d7,ye,yt=eS.ccclass,yn=eS.property,yi=(p7=yt("VelocityOvertimeModule"),de=yn({type:eW}),dt=yn({type:ho}),dn=yn({type:ho}),p7((dr=n((da=function(){function e(){C(this,e),_(this,"enable",dr,this),_(this,"x",ds,this),_(this,"y",dl,this),this._temp_v3=new eQ,this.x.constant=0,this.y.constant=0}return T(e,[{key:"update",value:function(n,w){if(this.enable){var k=1-n.remainingLifetime/n.startLifetime,C=Nd(this.x)?tt(n.randomSeed+hT):0,_=Nd(this.y)?tt(n.randomSeed+hP):0,A=eQ.set(this._temp_v3,this.x.evaluate(k,C),this.y.evaluate(k,_),0);eQ.add(n.velocity,n.velocity,A.multiplyScalar(w))}}}]),e}()).prototype,"enable",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ds=n(da.prototype,"x",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),dl=n(da.prototype,"y",[dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),di=da))||di);ew._RF.pop(),ew._RF.push({},"10bc3IfFqBLtpSgVri/NVeX","ParticleSystem",void 0);var ya,yr,yo,ys,yl,yu,yp,yd=eS.ccclass,yy=eS.property,yf=eS.executeInEditMode,yv=eS.disallowMultiple,yg=(dd=yd("ParticleSystem"),dy=yf(!0),df=yv(!0),dv=yy({}),dg=yy(eW),dm=yy(eM),db=yy(eW),dw=yy({type:ho}),dS=yy({type:ho}),dk=yy(hy),dC=yy(eW),dE=yy({type:ho,formerlySerializedAs:"startSize"}),d_=yy({type:ho,visible:function(){return this.startSize2D}}),dA=yy({type:ho}),dT=yy(eW),dP=yy({type:ho,formerlySerializedAs:"startRotation"}),dR=yy({type:ho}),dI=yy({type:ho}),dL=yy({type:pW}),dO=yy({type:yi}),dD=yy({type:p9}),dM=yy({type:pO}),dN=yy({type:hG}),dz=yy({type:dp}),dB=yy({type:hQ}),dF=yy(cR),dx=yy({type:pr}),dd(dU=dy(dU=df((n((dG=function(n){w(u,n);var I=k(u);function u(){var n;return C(this,u),(n=I.call(this))._preview=!1,_(n,"playOnAwake",dH,A(n)),_(n,"duration",dV,A(n)),_(n,"loop",dq,A(n)),_(n,"startDelay",dW,A(n)),_(n,"startLifetime",dK,A(n)),_(n,"startColor",dj,A(n)),_(n,"startSize2D",dY,A(n)),_(n,"startSizeX",dX,A(n)),_(n,"startSizeY",dZ,A(n)),_(n,"startSpeed",dJ,A(n)),_(n,"startRotation3D",dQ,A(n)),_(n,"startRotation",d$,A(n)),_(n,"gravityModifier",d0,A(n)),_(n,"rateOverTime",d1,A(n)),_(n,"shapeModule",d2,A(n)),_(n,"velocityOvertimeModule",d4,A(n)),_(n,"sizeOvertimeModule",d3,A(n)),_(n,"rotationOvertimeModule",d5,A(n)),_(n,"colorOvertimeModule",d6,A(n)),_(n,"spriteAnimationModule",d8,A(n)),_(n,"limitVelocityOvertimeModule",d9,A(n)),_(n,"bursts",d7,A(n)),_(n,"rendererModule",ye,A(n)),n.particles=[],n.time=0,n.emitRateTimeCounter=0,n.isPlaying=!1,n.isStopped=!0,n.isEmitting=!1,n.needToRestart=!1,n.startLifetime.constant=5,n.startSizeX.constant=1,n.startSpeed.constant=5,n.rateOverTime.constant=10,n}return T(u,[{key:"preview",get:function(){return this._preview},set:function(n){this._preview=n,this.graphics&&this.graphics.destroy()}},{key:"onEnable",value:function(){}},{key:"onLoad",value:function(){this.preview=null!==this.getComponent(ej),this.node.removeAllChildren()}},{key:"start",value:function(){this.node.position=new eQ(this.node.position.x,this.node.position.y,100),(this.playOnAwake&&!ee||this.preview&&ee)&&this.play()}},{key:"update",value:function(n){this.isPlaying&&(this.time+=n,this.emitting(n))}},{key:"play",value:function(){this.needToRestart&&(this.needToRestart=!1),this.isStopped&&(this.isStopped=!1),this.time=0,this.isPlaying=!0,this.isEmitting=!0}},{key:"stop",value:function(){this.isPlaying||(this.isPlaying=!1),this.isEmitting||(this.isEmitting=!1),this.isStopped=!0}},{key:"emitting",value:function(n){var w=this,k=this.startDelay.evaluate(0,1);if(this.time>k&&this.time>this.duration+k&&(this.loop||(this.isEmitting=!1)),this.isEmitting){if(this.emitRateTimeCounter+=this.rateOverTime.evaluate(this.time/this.duration,1)*n,this.emitRateTimeCounter>1){var C=Math.floor(this.emitRateTimeCounter);this.emitRateTimeCounter-=C,this.emit(C,n)}var _,A=L(this.bursts);try{for(A.s();!(_=A.n()).done;)_.value.update(this,n)}catch(n){A.e(n)}finally{A.f()}}var T=this.gravityModifier.evaluate(this.time/this.duration,1);this.particles.forEach(function(k,C){k.node.active&&(w.spriteAnimationModule.update(k),w.sizeOvertimeModule.update(k),w.rotationOvertimeModule.update(k,n),w.colorOvertimeModule.update(k),w.velocityOvertimeModule.update(k,n),w.applyGravityModifier(k,T),w.limitVelocityOvertimeModule.update(k,n),k.node.position.add(k.velocity.clone().multiplyScalar(n)),k.remainingLifetime-=n,k.remainingLifetime<=0&&(k.node.active=!1))})}},{key:"emit",value:function(n,w){if(null!==this.rendererModule.spriteFrame)for(var k=this.time%this.duration/this.duration,C=0;C<n;C++){var _=this.getFreeParticle();_.init(this),_.reset(),this.shapeModule.emit(_);var A=this.startSpeed.evaluate(k,this.rand());_.velocity=_.velocity.clone().multiplyScalar(A);var T=this.startSizeX.evaluate(k,this.rand()),I=this.startSize2D?new eQ(T,this.startSizeY.evaluate(k,this.rand()),1):new eQ(T,T,1);_.startSize=I.clone(),_.node.scale=I.clone();var L=this.startRotation.evaluate(k,this.rand());_.node.eulerAngles=new eQ(0,0,L),_.startColor=this.startColor.evaluate(k,this.rand()).clone(),_.sprite.color=_.startColor.clone(),_.startLifetime=this.startLifetime.evaluate(k,this.rand())+w,_.remainingLifetime=_.startLifetime,_.randomSeed=e8(0,233280)}}},{key:"applyGravityModifier",value:function(n,w){n.velocity.add(new eQ(0,-9.8*w,0))}},{key:"rand",value:function(){return tt(e8(0,tp.INT_MAX))}},{key:"getFreeParticle",value:function(){var n=this.particles.find(function(n){return!n.node.active});return n||(n=this.createParticle()),n.node.active=!0,n}},{key:"createParticle",value:function(){var n=new ek,w=eA(n),k=w.addComponent(cX),C=w.addComponent(ex);return this.particles.push(k),C.spriteFrame=this.rendererModule.spriteFrame,C.customMaterial=this.rendererModule.material,this.node.addChild(w),k}}]),u}(eO)).prototype,"preview",[dv],Object.getOwnPropertyDescriptor(dG.prototype,"preview"),dG.prototype),dH=n(dG.prototype,"playOnAwake",[dg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),dV=n(dG.prototype,"duration",[dm],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),dq=n(dG.prototype,"loop",[db],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),dW=n(dG.prototype,"startDelay",[dw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),dK=n(dG.prototype,"startLifetime",[dS],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),dj=n(dG.prototype,"startColor",[dk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hy}}),dY=n(dG.prototype,"startSize2D",[dC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),dX=n(dG.prototype,"startSizeX",[dE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),dZ=n(dG.prototype,"startSizeY",[d_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),dJ=n(dG.prototype,"startSpeed",[dA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),dQ=n(dG.prototype,"startRotation3D",[dT],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d$=n(dG.prototype,"startRotation",[dP],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),d0=n(dG.prototype,"gravityModifier",[dR],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),d1=n(dG.prototype,"rateOverTime",[dI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ho}}),d2=n(dG.prototype,"shapeModule",[dL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pW}}),d4=n(dG.prototype,"velocityOvertimeModule",[dO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yi}}),d3=n(dG.prototype,"sizeOvertimeModule",[dD],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new p9}}),d5=n(dG.prototype,"rotationOvertimeModule",[dM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pO}}),d6=n(dG.prototype,"colorOvertimeModule",[dN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hG}}),d8=n(dG.prototype,"spriteAnimationModule",[dz],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new dp}}),d9=n(dG.prototype,"limitVelocityOvertimeModule",[dB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new hQ}}),d7=n(dG.prototype,"bursts",[yy,dF],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ye=n(dG.prototype,"rendererModule",[dx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pr}}),dU=dG))||dU)||dU)||dU);ew._RF.pop(),ew._RF.push({},"91e6dGDvN1FKLi7g/JQPwl8","ItemCollectionFX",void 0);var ym,yb,yw,yS,yk,yC,yE,y_,yA,yT=eS.ccclass,yP=eS.property,yR=(ya=yT("ItemCollectionFX"),yr=yP(ex),yo=yP(yg),ya((yu=n((yl=function(n){w(u,n);var I=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"sprite",yu,A(n)),_(n,"particles",yp,A(n)),n}return T(u,[{key:"__preload",value:function(){z.lazyValidateProperties(this)}},{key:"playExplosionParticles",value:function(){var n,w=L(this.particles);try{for(w.s();!(n=w.n()).done;)n.value.play()}catch(n){w.e(n)}finally{w.f()}}}]),u}(eO)).prototype,"sprite",[yr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yp=n(yl.prototype,"particles",[yo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ys=yl))||ys);ew._RF.pop(),ew._RF.push({},"a7ff8uVnP1G3ppM9F/A5DYq","Cloud",void 0);var yI=eS.ccclass,yL=eS.property,yO=(ym=yI("Cloud"),yb=yL({type:ek}),yw=yL({type:ek}),yS=yL({type:e7}),ym((yE=n((yC=function(n){w(v,n);var I,L,O,D,z,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"cloudSprites",yE,A(n)),_(n,"lightnings",y_,A(n)),_(n,"animation",yA,A(n)),n}return T(v,[{key:"playInitAnimation",value:(z=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.moveToScreenCenter()];case 1:n.sent();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"playLightningAnimation",value:(D=M(function(n,w){var k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:k=this.lightnings[w],C=n.subtract(k.worldPosition),_=Math.atan2(C.y,C.x)*(180/Math.PI)+180,A=C.length();k.getComponent(e_).width=A,k.angle=_,k.active=!0;return[4,N.waitTweenAsync(.2)];case 1:T.sent(),k.active=!1;return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"playScaleTween",value:(O=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=this.cloudSprites.map(function(n){var w=ez(n).to(.1,{scale:new eQ(1.2,1.2)},{easing:"quadOut"}).to(.1,{scale:new eQ(1,1)},{easing:"quadOut"});return N.runTweenAsync(w)});return[4,Promise.all(n)];case 1:w.sent();return[2]}})}),function(){return O.apply(this,arguments)})},{key:"loadAnimation",value:(L=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(null!==this.animation.defaultClip)return[3,2];return[4,B.loadAnimClipAsync($.CLOUD_IDLE_ANIM)];case 1:n=w.sent();n&&this.animation&&(this.animation.defaultClip=n);w.label=2;case 2:return[2]}})}),function(){return L.apply(this,arguments)})},{key:"moveToScreenCenter",value:(I=M(function(){var n,w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:n=tr("Canvas").getComponent(e_),w=n.width,k=n.height,C=0,_=0;switch(Math.floor(4*Math.random())){case 0:C=Math.random()*w-w/2,_=k/2+300;break;case 1:C=Math.random()*w-w/2,_=-k/2-300;break;case 2:C=-w/2-300,_=Math.random()*k-k/2;break;case 3:C=w/2+300,_=Math.random()*k-k/2}this.node.position=new eQ(C,_);A=ez(this.node).to(.8,{position:new eQ(0,300)},{easing:"quadOut"});return[4,N.runTweenAsync(A)];case 1:T.sent();return[2]}})}),function(){return I.apply(this,arguments)})}]),v}(eO)).prototype,"cloudSprites",[yb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y_=n(yC.prototype,"lightnings",[yw],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),yA=n(yC.prototype,"animation",[yS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yk=yC))||yk);ew._RF.pop(),ew._RF.push({},"7df59GGBIxFo7OyHCGrEKe5","addItemEffect",void 0);var yD,yM,yN,yz,yB,yF,yx,yU,yG,yH,yV,yq,yW,yK,yj,yY,yX,yZ=function(){var n=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:n.playExplosionParticles(),G.playSound("sounds/item_reward");return[4,yJ(n)];case 1:k.sent();return[4,N.waitTweenAsync(.8)];case 2:k.sent();return[4,yQ(n,w)];case 3:k.sent();return[4,y$(n,w)];case 4:k.sent();return[2]}})});return function(w,k){return n.apply(this,arguments)}}(),yJ=function(){var n=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=ez(n.node).to(.1,{scale:new eQ(.8,1.2,1)}).to(.1,{scale:new eQ(1.2,.8,1)}).to(.1,{scale:new eQ(1,1,1)});return[4,N.runTweenAsync(w)];case 1:k.sent();return[2]}})});return function(w){return n.apply(this,arguments)}}(),yQ=function(){var n=M(function(n,w){var k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:k=w.node.worldPosition.clone().add3f(0,30,0),C=new eQ(.5,.5,.5),_=ez(n.node).to(1,{worldPosition:k,scale:C},{easing:"cubicInOut"});return[4,N.runTweenAsync(_)];case 1:A.sent();return[2]}})});return function(w,k){return n.apply(this,arguments)}}(),y$=function(){var n=M(function(n,w){var k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:k=w.node.worldPosition.clone(),C=k.clone().add3f(0,70,0),_=new eQ(.65,.65,.65),A=ez(n.node).to(.3,{worldPosition:C,scale:_},{easing:"cubicOut"}).to(.5,{worldPosition:k},{easing:"cubicIn"});return[4,N.runTweenAsync(A)];case 1:T.sent();return[2]}})});return function(w,k){return n.apply(this,arguments)}}();ew._RF.pop(),ew._RF.push({},"da8a1SD+ahMFpc6MIdiFP5H","ShiningStar",void 0);var y0,y1,y2,y4,y3,y5=eS.ccclass,y6=eS.property,y8=eS.disallowMultiple,y9=(yD=y5("ShiningStar"),yM=y6(ex),yN=y6({serializable:!0,visible:!1}),yz=y6({type:eM,displayName:"Scale up duration",min:.001}),yB=y6({serializable:!0,visible:!1}),yF=y6({type:eM,displayName:"Bounce and Fall duration",min:.001}),yx=y6({serializable:!0,visible:!1}),yU=y6({type:eM,displayName:"Start scale"}),yG=y6({serializable:!0,visible:!1}),yH=y6({type:eM,displayName:"End scale"}),yD(yV=y8((yW=n((yq=function(n){w(m,n);var I,L,O,D,B,F,x,U=k(m);function m(){var n;C(this,m);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=U.call.apply(U,[this].concat(k)),_(n,"shine",yW,A(n)),_(n,"twScaleUpDuration",yK,A(n)),_(n,"twBounceAndFallDuration",yj,A(n)),_(n,"twStartScale",yY,A(n)),_(n,"twEndScale",yX,A(n)),n.isBeingAnimated=!1,n}return T(m,[{key:"scaleUpDuration",get:function(){return this.twScaleUpDuration},set:function(n){this.twScaleUpDuration=n}},{key:"bounceAndFallDuration",get:function(){return this.twBounceAndFallDuration},set:function(n){this.twBounceAndFallDuration=n}},{key:"startScale",get:function(){return this.twStartScale},set:function(n){this.twStartScale=n}},{key:"endScale",get:function(){return this.twEndScale},set:function(n){this.twEndScale=n}},{key:"isAvailable",get:function(){return!this.isBeingAnimated}},{key:"__preload",value:function(){this.shineOpacity=this.shine.node.getComponent(eH),this.uiOpacity=this.node.getComponent(eH),this.validateRequiredComponents()}},{key:"onLoad",value:function(){this.uiOpacity.opacity=0}},{key:"playAnimation",value:(x=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!this.isAvailable)throw new Error("ShiningStar: This star is being animated.");this.isBeingAnimated=!0;return[4,this.animateAppear()];case 1:n.sent();return[4,this.animateDisappear()];case 2:n.sent(),this.isBeingAnimated=!1;return[2]}})}),function(){return x.apply(this,arguments)})},{key:"animateAppear",value:(F=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:this.shineOpacity.opacity=255;return[4,Promise.all([this.animateFadeIn(),this.animateScaleUp()])];case 1:n.sent();return[2]}})}),function(){return F.apply(this,arguments)})},{key:"animateDisappear",value:(B=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,Promise.all([this.animateBounceAndFall(),this.animateScaleDown()])];case 1:n.sent(),this.node.setScale(0,0),this.uiOpacity.opacity=0;return[2]}})}),function(){return B.apply(this,arguments)})},{key:"animateBounceAndFall",value:(D=M(function(){var n,w,k,C,_,A,T,I,L,O;return _ts_generator(this,function(D){switch(D.label){case 0:n=this.node.position.x,w=this.node.position.y,k=[60,120],C=(Math.random()*(k[1]-k[0])+k[0])*(Math.PI/180),_=n+200*Math.cos(C),A=w+200*Math.sin(C),T=w-500,I=N.runTweenAsync(ez(this.node).to(.2*this.twBounceAndFallDuration,{position:new eQ(_,A,this.node.position.z)},{easing:"sineOut"}).to(.4*this.twBounceAndFallDuration,{position:new eQ(_,T,this.node.position.z)},{easing:"cubicIn"})),L=[0,360],O=N.runTweenAsync(ez(this.node).to(this.twBounceAndFallDuration,{eulerAngles:new eQ(0,0,Math.random()*(L[1]-L[0])*(_>n?-1:1))},{easing:"sineOut"}));return[4,Promise.all([I,O])];case 1:D.sent(),this.node.eulerAngles=new eQ(0,0,0);return[2]}})}),function(){return D.apply(this,arguments)})},{key:"animateFadeIn",value:(O=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=Math.max(this.scaleUpDuration/4,.01);return[4,N.runTweenAsync(ez(this.uiOpacity).to(n,{opacity:255}))];case 1:w.sent();return[2]}})}),function(){return O.apply(this,arguments)})},{key:"animateScaleUp",value:(L=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:this.node.setScale(this.startScale,this.startScale);n=new eQ(this.endScale,this.endScale,1);return[4,N.runTweenAsync(ez(this.node).to(this.scaleUpDuration,{scale:n},{easing:"cubicOut"}))];case 1:w.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"animateScaleDown",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=new eQ(0,0,1);return[4,N.runTweenAsync(ez(this.node).delay(.1*this.bounceAndFallDuration).to(.5*this.bounceAndFallDuration,{scale:n},{easing:"cubicIn"}))];case 1:w.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),m}(eO)).prototype,"shine",[yM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yK=n(yq.prototype,"twScaleUpDuration",[yN],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),n(yq.prototype,"scaleUpDuration",[yz],Object.getOwnPropertyDescriptor(yq.prototype,"scaleUpDuration"),yq.prototype),yj=n(yq.prototype,"twBounceAndFallDuration",[yB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),n(yq.prototype,"bounceAndFallDuration",[yF],Object.getOwnPropertyDescriptor(yq.prototype,"bounceAndFallDuration"),yq.prototype),yY=n(yq.prototype,"twStartScale",[yx],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),n(yq.prototype,"startScale",[yU],Object.getOwnPropertyDescriptor(yq.prototype,"startScale"),yq.prototype),yX=n(yq.prototype,"twEndScale",[yG],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),n(yq.prototype,"endScale",[yH],Object.getOwnPropertyDescriptor(yq.prototype,"endScale"),yq.prototype),yV=yq))||yV)||yV);ew._RF.pop(),ew._RF.push({},"2e9aaj8L6lN1pTv2xGEj1sE","StarParticles",void 0);var y7,fe,ft,fn,fi,fa,fr,fo,fs,fl,fu,fh,fp,fd,fy,ff,fv,fg,fm,fb,fw,fS,fk,fC,fE,f_,fA,fT,fP,fR,fI,fL=eS.ccclass,fO=eS.property,fD=eS.disallowMultiple,fM=GameCore.Utils.Array,fN=(y0=fL("StarParticles"),y1=fO({type:[y9],displayName:"Prebuilt Shining stars"}),y0(y2=fD((y3=n((y4=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"shiningStars",y3,A(n)),n}return T(u,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"fireShiningStarAt",value:(I=M(function(n){var w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:w=this.getFirstAvailableShiningStar();if(void 0===w)throw new Error("No available shining stars. Please add more prebuilt shining stars or calls this function later.");k=J(n,2),C=k[0],_=k[1],A=new eQ(C,_,this.node.worldPosition.z);w.node.worldPosition=A;return[4,w.playAnimation()];case 1:T.sent();return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"getFirstAvailableShiningStar",value:function(){return fM.search(this.shiningStars,function(n){return n.isAvailable})}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),u}(eO)).prototype,"shiningStars",[y1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),y2=y4))||y2)||y2);ew._RF.pop(),ew._RF.push({},"2913d3KShhIEaPfSLUhFqvA","EffectManager",void 0);var fz=eS.ccclass,fB=eS.property,fF=(y7=fz("EffectManager"),fe=fB({group:"Thunder Effect",type:yO}),ft=fB({group:"Mask Effect",type:i_}),fn=fB({group:"Mask Effect",type:ek}),fi=fB({group:"Tornado Effect",type:ek}),fa=fB({group:"Clear Particle Effect",type:ek,displayName:"Particle holder node"}),fr=fB({group:"Clear Particle Effect",type:yg,displayName:"Emitter 1"}),fo=fB({group:"Clear Particle Effect",type:yg,displayName:"Emitter 2"}),fs=fB({group:"Star Particles Effect",type:fN}),fl=fB({group:"Confetti Effect",type:yg}),fu=fB({group:"Add Item Effect",type:yR}),fh=fB({group:"Add Item Effect",type:e9}),fp=fB({group:"Add Item Effect",type:e9}),fd=fB({group:"Add Item Effect",type:e9}),fy=fB({group:"Add Item Effect",type:e9}),y7((fg=n((fv=function(n){w(P,n);var I,O,D,F,x,U,H,V,q,W,K,j,Y=k(P);function P(){var n;C(this,P);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=Y.call.apply(Y,[this].concat(k)),_(n,"cloud",fg,A(n)),_(n,"backgroundMask",fm,A(n)),_(n,"masks",fb,A(n)),_(n,"tornado",fw,A(n)),n.bombExplosion=null,n.bombExplosionPool=null,n.defuseExplosion=null,n.defuseExplosionPool=null,_(n,"clearParticleHolder",fS,A(n)),_(n,"clearParticle1",fk,A(n)),_(n,"clearParticle2",fC,A(n)),_(n,"starParticle",fE,A(n)),_(n,"confetti",f_,A(n)),_(n,"itemEffect",fA,A(n)),_(n,"hintSpriteFrame",fT,A(n)),_(n,"thunderSpriteFrame",fP,A(n)),_(n,"tornadoSpriteFrame",fR,A(n)),_(n,"pliersSpriteFrame",fI,A(n)),n.maskTargets=[],n}return T(P,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"update",value:function(){var n=this;this.maskTargets.length>0&&this.maskTargets.forEach(function(w,k){w.isHidden()||(n.masks[k].worldPosition=w.node.worldPosition.clone())})}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(i9.GRID_RESIZE,this.handleBoardResize,this)}},{key:"handleBoardResize",value:function(n){this.clearParticleHolder.setScale(n,n)}},{key:"playClearEffectAt",value:function(n){this.clearParticle1.node.setWorldPosition(new eQ(n[0].x,n[0].y,1)),this.clearParticle2.node.setWorldPosition(new eQ(n[1].x,n[1].y,1)),this.clearParticle1.play(),this.clearParticle2.play()}},{key:"playStarEffectAt",value:function(n){this.starParticle.fireShiningStarAt(n)}},{key:"playConfettiEffect",value:function(){var n,w=L(this.confetti);try{for(w.s();!(n=w.n()).done;)n.value.play()}catch(n){w.e(n)}finally{w.f()}}},{key:"playTornadoAnimation",value:(j=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:w=null===(n=this.tornado.getChildByName("Sprite"))||void 0===n?void 0:n.getComponent(e7);if(!(null!==(null==w?void 0:w.defaultClip)))return[3,2];this.tornado.active=!0;k=ez(this.tornado);k.set({scale:new eQ(0,0,0)}),k.delay(.5),k.to(.5,{scale:new eQ(1,1,1)},{easing:"backOut"}),k.delay(.6),k.to(.3,{scale:new eQ(0,0,0)},{easing:"quadIn"}),k.set({active:!1}),B.setBlockInput(!0);return[4,N.runTweenAsync(k)];case 1:C.sent(),B.setBlockInput(!1);return[3,3];case 2:console.warn("EffectManager: Tornado animation is not loaded when animation play request was made.");C.label=3;case 3:return[2]}})}),function(){return j.apply(this,arguments)})},{key:"playThunderAnimation",value:(K=M(function(n,w){var k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:this.resetMasks();k=J(n,2),C=J(k[0],2),_=C[0],A=C[1],T=J(k[1],2),I=T[0],L=T[1];this.setMaskProperties(0,_.node.worldPosition,_.node.worldScale),this.setMaskProperties(1,A.node.worldPosition,A.node.worldScale),this.setMaskProperties(2,I.node.worldPosition,I.node.worldScale),this.setMaskProperties(3,L.node.worldPosition,L.node.worldScale),this.maskTargets=[_,A,I,L];return[4,this.setBackgroundMaskActive(!0)];case 1:O.sent(),this.cloud.node.active=!0;return[4,this.cloud.playInitAnimation()];case 2:O.sent();return[4,N.waitTweenAsync(.2)];case 3:O.sent();return[4,this.performCloudEffectToTiles(_,A,w)];case 4:O.sent();return[4,this.performCloudEffectToTiles(I,L,w)];case 5:O.sent(),this.cloud.node.active=!1;return[4,this.setBackgroundMaskActive(!1)];case 6:O.sent(),this.maskTargets=[];return[2]}})}),function(n,w){return K.apply(this,arguments)})},{key:"playItemAddAnimation",value:(W=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:k=w.itemType;if(!k)return[3,3];return[4,N.waitTweenAsync(.2)];case 1:switch(C.sent(),this.itemEffect.node.active=!0,this.itemEffect.node.parent=tr("Canvas"),this.itemEffect.node.worldPosition=n,this.itemEffect.node.scale=eQ.ONE,k){case X.HINT:this.itemEffect.sprite.spriteFrame=this.hintSpriteFrame;break;case X.THUNDER:this.itemEffect.sprite.spriteFrame=this.thunderSpriteFrame;break;case X.STORM:this.itemEffect.sprite.spriteFrame=this.tornadoSpriteFrame;break;case X.PLIERS:this.itemEffect.sprite.spriteFrame=this.pliersSpriteFrame}return[4,yZ(this.itemEffect,w)];case 2:C.sent(),this.itemEffect.node.active=!1;C.label=3;case 3:return[2]}})}),function(n,w){return W.apply(this,arguments)})},{key:"performCloudEffectToTiles",value:(q=M(function(n,w,k){var C;return _ts_generator(this,function(_){switch(_.label){case 0:this.shakeGame(),null===(C=tr("Vibrate"))||void 0===C||null===(C=C.getComponent(sg))||void 0===C||C.vibrate(500),G.playSound(nL.THUNDERBOLT),k.clear([[n,w]],"break");return[4,Promise.all([this.cloud.playLightningAnimation(n.node.worldPosition.clone(),0),this.cloud.playLightningAnimation(w.node.worldPosition.clone(),1),this.cloud.playScaleTween()])];case 1:_.sent(),this.node.scene.emit(i9.ADD_COMBO),this.node.scene.emit(i9.ADD_SCORE);return[2]}})}),function(n,w,k){return q.apply(this,arguments)})},{key:"createDefuseExplosionAt",value:(V=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:return[4,this.loadDefuseExplosionPrefab()];case 1:C.sent(),this.defuseExplosionPool||(this.defuseExplosionPool=new ux(this.createDefuseExplosion.bind(this),1,fx.getBombDefuseExplosion,fx.returnBombDefuseExplosion,fx.destroyBombDefuseExplosion));w=this.defuseExplosionPool.alloc();w.setWorldPosition(n);k=w.getComponent(e7);return[4,N.runAnimationAsync(k)];case 2:if(C.sent(),!this.defuseExplosionPool)throw new Error("EffectManager: defuseExplosionPool is null");this.defuseExplosionPool.free(w);return[2]}})}),function(n){return V.apply(this,arguments)})},{key:"createBombExplosionAt",value:(H=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:return[4,this.loadBombExplosionPrefab()];case 1:if(C.sent(),this.bombExplosionPool||(this.bombExplosionPool=new ux(this.createBombExplosion.bind(this),1,fU.getBombExplosion,fU.returnBombExplosion,fU.destroyBombExplosion)),!this.bombExplosionPool)return[3,3];w=this.bombExplosionPool.alloc();w.setWorldPosition(n);k=w.getComponent(e7);return[4,N.runAnimationAsync(k)];case 2:C.sent(),this.bombExplosionPool&&this.bombExplosionPool.free(w);C.label=3;case 3:return[2]}})}),function(n){return H.apply(this,arguments)})},{key:"setBackgroundMaskActive",value:(U=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:n&&(this.backgroundMask.node.active=!0);return[4,this.backgroundMask.changeStateFade(n,.25)];case 1:w.sent(),n||(this.backgroundMask.node.active=!1);return[2]}})}),function(n){return U.apply(this,arguments)})},{key:"resetMasks",value:function(){var n,w=L(this.masks);try{for(w.s();!(n=w.n()).done;)n.value.worldPosition=new eQ(-9999,-9999,0)}catch(n){w.e(n)}finally{w.f()}}},{key:"setMaskProperties",value:function(n,w,k){k&&(this.masks[n].worldScale=k),this.masks[n].worldPosition=w}},{key:"createDefuseExplosion",value:function(){if(!this.defuseExplosion)throw new Error("EffectManager: defuseExplosion is not loaded!");return fx.createDefuseExplosion(this.defuseExplosion,this.node)}},{key:"createBombExplosion",value:function(){if(!this.bombExplosion)throw new Error("EffectManager: bombExplosion is not loaded!");return fU.createBombExplosion(this.bombExplosion,this.node)}},{key:"loadBombExplosionPrefab",value:(x=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(this.bombExplosion)return[2,Promise.resolve()];return[4,B.loadPrefabAsync($.BOMB_EXPLODE_PREFAB)];case 1:n=w.sent();return[2,(n&&(this.bombExplosion=n),Promise.resolve())]}})}),function(){return x.apply(this,arguments)})},{key:"loadDefuseExplosionPrefab",value:(F=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(this.defuseExplosion)return[2,Promise.resolve()];return[4,B.loadPrefabAsync($.BOMB_DEFUSE_PREFAB)];case 1:n=w.sent();return[2,(n&&(this.defuseExplosion=n),Promise.resolve())]}})}),function(){return F.apply(this,arguments)})},{key:"loadThunderAnimation",value:(D=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.cloud.loadAnimation()];case 1:n.sent();return[2]}})}),function(){return D.apply(this,arguments)})},{key:"loadTornadoAnimation",value:(O=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:w=null===(n=this.tornado.getChildByName("Sprite"))||void 0===n?void 0:n.getComponent(e7);if(null!==(null==w?void 0:w.defaultClip))return[2,Promise.resolve()];return[4,B.loadAnimClipAsync($.TORNADO_IDLE_ANIM)];case 1:k=C.sent();return[2,(k&&(w.defaultClip=k),Promise.resolve())]}})}),function(){return O.apply(this,arguments)})},{key:"shakeGame",value:(I=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:n=this.node.position.clone(),w=ez(this.node).to(.05,{position:n.clone().add3f(tn(5,10),tn(5,10),0)}).to(.05,{position:n.clone().subtract3f(tn(5,10),tn(5,10),0)}).to(.05,{position:n});return[4,N.runTweenAsync(w)];case 1:k.sent();return[2]}})}),function(){return I.apply(this,arguments)})}]),P}(eO)).prototype,"cloud",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fm=n(fv.prototype,"backgroundMask",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fb=n(fv.prototype,"masks",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fw=n(fv.prototype,"tornado",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fS=n(fv.prototype,"clearParticleHolder",[fa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fk=n(fv.prototype,"clearParticle1",[fr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fC=n(fv.prototype,"clearParticle2",[fo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fE=n(fv.prototype,"starParticle",[fs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f_=n(fv.prototype,"confetti",[fl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fA=n(fv.prototype,"itemEffect",[fu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fT=n(fv.prototype,"hintSpriteFrame",[fh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fP=n(fv.prototype,"thunderSpriteFrame",[fp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fR=n(fv.prototype,"tornadoSpriteFrame",[fd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fI=n(fv.prototype,"pliersSpriteFrame",[fy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ff=fv))||ff),fx=function(){function e(){C(this,e)}return T(e,null,[{key:"createDefuseExplosion",value:function(n,w){var k=eA(n);return w.addChild(k),k.active=!1,k}},{key:"destroyBombDefuseExplosion",value:function(n){n.destroy()}},{key:"getBombDefuseExplosion",value:function(n){n.active=!0}},{key:"returnBombDefuseExplosion",value:function(n){n.active=!1}}]),e}(),fU=function(){function e(){C(this,e)}return T(e,null,[{key:"createBombExplosion",value:function(n,w){var k=eA(n);return w.addChild(k),k.active=!1,k}},{key:"destroyBombExplosion",value:function(n){n.destroy()}},{key:"getBombExplosion",value:function(n){n.active=!0}},{key:"returnBombExplosion",value:function(n){n.active=!1}}]),e}();ew._RF.pop(),ew._RF.push({},"062f3AVHntKsIyireZmXg9P","GuideKeys",void 0);var fG="newbie",fH="timer",fV="combo",fq="hint-item",fW="thunder-item",fK="storm-item",fj="pliers-item";ew._RF.pop(),ew._RF.push({},"6448denZfFEUru9tWmWGb7N","Guide01Newbie",void 0);var fY=function(){function e(n){var w=this;C(this,e),this.alignSkipButton=function(){var n=w.gameplay.board,k=w.manager.guideUi.guideSkipButton;if(k){var C=k.parent;if(C){var _=n.getTileAt(n.getGridSize()[0]-1,n.getGridSize()[1]-1);if(_){var A=n.tilesHolder.getWorldScale(),T=n.getTileSize()[1]*A.y,I=_.node.worldPosition.clone().add3f(T/2,T/2,0),L=x.cssSizeToWorldSize(x.getScreenHeightCss()),O=I.x-C.getComponent(e_).width/2,D=Math.min(I.y+100,L-(L-I.y)/2);C.setWorldPosition(O,D,0)}}}},this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:function(){this.currentStep=0,this.manager.node.scene.on(i9.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.on(i9.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.on(i9.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.on(e_.EventType.SIZE_CHANGED,this.alignSkipButton,this),this.showStep(this.currentStep),this.manager.node.scene.emit(i9.HIDE_UI)}},{key:"showNextStep",value:function(){this.currentStep+1<lW.length?(this.currentStep+=1,this.showStep(this.currentStep)):this.close()}},{key:"showStep",value:(w=M(function(n){var w,k,C,_,A,T,I,L,O,D,M,N,z;return _ts_generator(this,function(B){switch(B.label){case 0:w=this.gameplay,k=w.board,C=w.effectManager,_=lW[n].startTile,A=lW[n].endTile,T=k.getTileAt(_.x,_.y),I=k.getTileAt(A.x,A.y);if(!(T&&I))return[3,3];L=T.node.worldPosition,O=I.node.worldPosition;C.resetMasks(),C.setMaskProperties(0,L,T.node.worldScale),C.setMaskProperties(1,O,I.node.worldScale),C.setBackgroundMaskActive(!0);D=this.manager.guideUi,M=D.guideHand,N=D.guideTextBox,z=D.guideSkipButton;M.node.active=!0,z.active=!0,M.playHandAnimation(L,O),this.alignGuideTextBox(),this.alignSkipButton();return[4,N.hide()];case 1:B.sent(),N.setLocalizedText(lW[n].localeTextKey);return[4,N.show()];case 2:B.sent(),k.setIgnoreInput(!0),T.setIgnoreInput(!1),I.setIgnoreInput(!1),this.gameplay.comboManager.setEmitEvent(!1);B.label=3;case 3:return[2]}})}),function(n){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.gameplay,w=n.board,k=n.effectManager,C=lW[this.currentStep].startTile,_=lW[this.currentStep].endTile,A=w.getTileAt(C.x,C.y),T=w.getTileAt(_.x,_.y);if(A&&T){var I=A.node.worldPosition,L=T.node.worldPosition;k.setMaskProperties(0,I,A.node.worldScale),k.setMaskProperties(1,L,T.node.worldScale),this.alignGuideTextBox(),this.alignSkipButton()}}},{key:"alignGuideTextBox",value:function(){var n=this.gameplay.board,w=this.manager.guideUi.guideTextBox,k=n.getTileAt(0,0);if(k){var C=n.tilesHolder.getWorldScale(),_=n.getTileSize()[1]*C.y,A=k.node.worldPosition.y-_/2,T=w.widget.bottom+(A-w.widget.bottom)/2;w.node.setWorldPosition(w.node.worldPosition.x,T,0);var I=Math.max(Math.min(223,.85*(A-w.widget.bottom)),10),L=.7261538461538461*C.x;w.uiTransform.setContentSize(628*L,I)}}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.gameplay,w=n.board,k=n.effectManager;this.manager.node.scene.off(i9.GRID_MATCH_SUCCESS,this.showNextStep,this),this.manager.node.scene.off(i9.GRID_MATCH_FAIL,this.showNextStep,this),this.manager.node.scene.off(i9.GRID_RESIZE,this.handleViewResized,this),this.manager.guideUi.guideSkipButton.off(e_.EventType.SIZE_CHANGED,this.alignSkipButton,this),w.setIgnoreInput(!1);return[4,Promise.all([this.manager.guideUi.guideTextBox.hide(),k.setBackgroundMaskActive(!1)])];case 1:C.sent(),this.manager.guideUi.guideHand.node.active=!1,this.manager.completeGuide(fG);return[2]}})}),function(){return n.apply(this,arguments)})}]),e}();ew._RF.pop(),ew._RF.push({},"a52daB3sGxP8JyGBZo5K1+X","Guide02Timer",void 0);var fX=function(){function e(n){C(this,e),this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:(w=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=n.guideInfoTextLocalizer,_=this.gameplay.uiManager.currentLayout.clock,A=_.getComponent(e_).contentSize,T=A.width,I=A.height,L=_.node.worldPosition;T*=1.5,I*=1.5;return[4,this.gameplay.handleShowUI()];case 1:O.sent(),w.node.active=!0,w.setOtherMaskTransform(L.x,L.y,T,I),k.node.active=!0,C.key="guide.timer",k.node.setWorldPosition(L.x,L.y-I/2-50,0),k.horizontalAlign=tv.CENTER,k.getComponent(e_).setAnchorPoint(.5,.5);return[4,w.show()];case 2:O.sent(),this.manager.node.scene.once(i9.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(i9.PAUSE_TIME),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),eY.on(V.ORIENTATION_CHANGED,this.handleViewResized,this);return[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=this.gameplay.uiManager.currentLayout.clock,_=C.getComponent(e_).contentSize,A=_.width,T=_.height,I=C.node.worldPosition;A*=1.5,T*=1.5,w.setOtherMaskTransform(I.x,I.y,A,T),k.node.setWorldPosition(I.x,I.y-T/2-50,0)}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.manager.guideUi,w=n.guideInfoText,k=n.guideMasks;this.gameplay.comboManager.setEmitEvent(!0),this.gameplay.stateManager.isPlaying()&&this.manager.node.scene.emit(i9.RESUME_TIME);return[4,k.hide()];case 1:C.sent(),w.node.active=!1,this.manager.completeGuide(fH),this.unlistenEvents();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized,this),eY.off(V.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),e}();ew._RF.pop(),ew._RF.push({},"add56o6JFNHAZiCO6F+Z9jK","Guide03Combo",void 0);var fZ=function(){function e(n){C(this,e),this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:(w=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=n.guideInfoTextLocalizer,_=this.gameplay.uiManager.comboContainer,A=_.getComponent(e_).contentSize,T=A.width,I=A.height,L=_.node.worldPosition;T*=1.5,I*=1.5,w.node.active=!0,w.setOtherMaskTransform(L.x,L.y,T,I),k.node.active=!0,C.key="guide.combo",k.node.setWorldPosition(L.x-T/2-10,L.y,0),k.horizontalAlign=tv.RIGHT,k.getComponent(e_).setAnchorPoint(1,.5);return[4,w.show()];case 1:O.sent(),this.manager.node.scene.once(i9.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(i9.PAUSE_TIME),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),eY.on(V.ORIENTATION_CHANGED,this.handleViewResized,this);return[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=this.gameplay.uiManager.comboContainer,_=C.getComponent(e_).contentSize,A=_.width,T=_.height,I=C.node.worldPosition;A*=1.5,T*=1.5,w.setOtherMaskTransform(I.x,I.y,A,T),k.node.setWorldPosition(I.x-A/2-10,I.y,0)}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText;this.manager.node.scene.emit(i9.RESUME_TIME),w.node.off(ek.EventType.TOUCH_START,this.close,this);return[4,w.hide()];case 1:C.sent(),k.node.active=!1,this.manager.completeGuide(fV),this.unlistenEvents();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized,this),eY.off(V.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),e}();ew._RF.pop(),ew._RF.push({},"fd93d+WLXVHk4yJGmVeSjmR","Guide04Hint",void 0);var fJ=GameCore.Utils.Array,fQ=function(){function e(n){C(this,e),this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:(w=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=n.guideInfoTextLocalizer,_=fJ.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.HINT});if(!_)return[3,2];A=_.node.worldPosition,T=_.getComponent(e_).contentSize,I=T.width,L=T.height;I+=40,L+=40,w.node.active=!0,w.setItemMaskTransform(A.x,A.y,I,L),k.node.active=!0,C.key="guide.hint",k.node.setPosition(0,0),k.node.setWorldPosition(k.node.worldPosition.x,A.y+L/2+30,0),k.horizontalAlign=tv.CENTER,k.getComponent(e_).setAnchorPoint(.5,.5);return[4,w.show()];case 1:O.sent(),this.manager.node.scene.once(i9.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(i9.PAUSE_TIME),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),eY.on(V.ORIENTATION_CHANGED,this.handleViewResized,this);O.label=2;case 2:return[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=fJ.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.HINT});if(C){var _=C.node.worldPosition,A=C.getComponent(e_).contentSize,T=A.width,I=A.height;T+=40,I+=40,w.setItemMaskTransform(_.x,_.y,T,I),k.node.setWorldPosition(k.node.worldPosition.x,_.y+I/2+30,0)}}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText;this.manager.node.scene.emit(i9.RESUME_TIME);return[4,w.hide()];case 1:C.sent(),k.node.active=!1,this.manager.completeGuide(fq),this.unlistenEvents();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized,this),eY.off(V.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),e}();ew._RF.pop(),ew._RF.push({},"b08f4dC/r1EPbsfAe1wtcBg","Guide05Thunder",void 0);var f$=GameCore.Utils.Array,f0=function(){function e(n){C(this,e),this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:(w=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=n.guideInfoTextLocalizer,_=f$.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.THUNDER});if(!_)return[3,2];A=_.node.worldPosition,T=_.getComponent(e_).contentSize,I=T.width,L=T.height;I+=40,L+=40,w.node.active=!0,w.setItemMaskTransform(A.x,A.y,I,L),k.node.active=!0,C.key="guide.thunder",k.node.setPosition(0,0),k.node.setWorldPosition(k.node.worldPosition.x,A.y+L/2+30,0),k.horizontalAlign=tv.CENTER,k.getComponent(e_).setAnchorPoint(.5,.5);return[4,w.show()];case 1:O.sent(),this.manager.node.scene.once(i9.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(i9.PAUSE_TIME),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),eY.on(V.ORIENTATION_CHANGED,this.handleViewResized,this);O.label=2;case 2:return[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=f$.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.THUNDER});if(C){var _=C.node.worldPosition,A=C.getComponent(e_).contentSize,T=A.width,I=A.height;T+=40,I+=40,w.setItemMaskTransform(_.x,_.y,T,I),k.node.setWorldPosition(k.node.worldPosition.x,_.y+I/2+30,0)}}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText;this.manager.node.scene.emit(i9.RESUME_TIME);return[4,w.hide()];case 1:C.sent(),k.node.active=!1,this.manager.completeGuide(fW),this.unlistenEvents();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized,this),eY.off(V.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),e}();ew._RF.pop(),ew._RF.push({},"f4ef8MBZxxKC4bfuDzsLQ5X","Guide06Storm",void 0);var f1=GameCore.Utils.Array,f2=function(){function e(n){C(this,e),this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:(w=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=n.guideInfoTextLocalizer,_=f1.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.STORM});if(!_)return[3,2];A=_.node.worldPosition,T=_.getComponent(e_).contentSize,I=T.width,L=T.height;I+=40,L+=40,w.node.active=!0,w.setItemMaskTransform(A.x,A.y,I,L),k.node.active=!0,C.key="guide.storm",k.node.setPosition(0,0),k.node.setWorldPosition(k.node.worldPosition.x,A.y+L/2+30,0),k.horizontalAlign=tv.CENTER,k.getComponent(e_).setAnchorPoint(.5,.5);return[4,w.show()];case 1:O.sent(),this.manager.node.scene.once(i9.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(i9.PAUSE_TIME),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),eY.on(V.ORIENTATION_CHANGED,this.handleViewResized,this);O.label=2;case 2:return[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=f1.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.STORM});if(C){var _=C.node.worldPosition,A=C.getComponent(e_).contentSize,T=A.width,I=A.height;T+=40,I+=40,w.setItemMaskTransform(_.x,_.y,T,I),k.node.setWorldPosition(k.node.worldPosition.x,_.y+I/2+30,0)}}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText;this.manager.node.scene.emit(i9.RESUME_TIME);return[4,w.hide()];case 1:C.sent(),k.node.active=!1,this.manager.completeGuide(fK),this.unlistenEvents();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized,this),eY.off(V.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),e}();ew._RF.pop(),ew._RF.push({},"9920dDqYP9ITJp0bSlZ+K9R","Guide07Pliers",void 0);var f4,f3,f5,f6,f8,f9,f7,ve,vt,vn=GameCore.Utils.Array,vi=function(){function e(n){C(this,e),this.manager=n,this.gameplay=n.gameplay}var n,w;return T(e,[{key:"setup",value:(w=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=n.guideInfoTextLocalizer,_=vn.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.PLIERS});if(!_)return[3,2];A=_.node.worldPosition,T=_.getComponent(e_).contentSize,I=T.width,L=T.height;I+=40,L+=40,w.node.active=!0,w.setItemMaskTransform(A.x,A.y,I,L),k.node.active=!0,C.key="guide.pliers",k.node.setPosition(0,0),k.node.setWorldPosition(k.node.worldPosition.x,A.y+L/2+30,0),k.horizontalAlign=tv.CENTER,k.getComponent(e_).setAnchorPoint(.5,.5);return[4,w.show()];case 1:O.sent(),this.manager.node.scene.once(i9.GUIDE_MASK_CLICKED,this.close,this),this.manager.node.scene.emit(i9.PAUSE_TIME),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),eY.on(V.ORIENTATION_CHANGED,this.handleViewResized,this);O.label=2;case 2:return[2]}})}),function(){return w.apply(this,arguments)})},{key:"handleViewResized",value:function(){var n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText,C=vn.search(this.gameplay.uiManager.items,function(n){return n.itemType===X.PLIERS});if(C){var _=C.node.worldPosition,A=C.getComponent(e_).contentSize,T=A.width,I=A.height;T+=40,I+=40,w.setItemMaskTransform(_.x,_.y,T,I),k.node.setWorldPosition(k.node.worldPosition.x,_.y+I/2+30,0)}}},{key:"close",value:(n=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.manager.guideUi,w=n.guideMasks,k=n.guideInfoText;this.manager.node.scene.emit(i9.RESUME_TIME);return[4,w.hide()];case 1:C.sent(),k.node.active=!1,this.manager.completeGuide(fj),this.unlistenEvents();return[2]}})}),function(){return n.apply(this,arguments)})},{key:"unlistenEvents",value:function(){eY.off(V.VIEW_RESIZED,this.handleViewResized,this),eY.off(V.ORIENTATION_CHANGED,this.handleViewResized,this)}}]),e}();ew._RF.pop(),ew._RF.push({},"8ab11Ocp6VMg5ZkRHXv4Odu","GuideHand",void 0);var va,vr,vo,vs,vl,vu,vh,vp=eS.ccclass,vd=eS.property,vy=(f4=vp("GuideHand"),f3=vd(ek),f5=vd(ek),f6=vd(eH),f4((f7=n((f9=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"hand",f7,A(n)),_(n,"circleHighlight",ve,A(n)),_(n,"circleHighlightOpacity",vt,A(n)),n}return T(s,[{key:"start",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255}},{key:"playHandAnimation",value:function(n,w){var k=this;this.handTween&&this.handTween.stop();var C=ez(this.hand).to(.8,{worldPosition:w},{easing:"quartOut"}).to(.2,{scale:new eQ(.9,.9,.9),angle:15}).call(function(){k.playHighlightAnimation()}).to(.2,{scale:eQ.ONE,angle:0}).to(.8,{worldPosition:n},{easing:"quartOut"}).to(.2,{scale:new eQ(.9,.9,.9),angle:15}).call(function(){k.playHighlightAnimation()}).to(.2,{scale:eQ.ONE,angle:0});this.handTween=ez(this.hand).repeatForever(C).start()}},{key:"playHighlightAnimation",value:function(){this.circleHighlight.setScale(0,0),this.circleHighlightOpacity.opacity=255,this.circleHighlight.position=this.hand.position.clone(),ez(this.circleHighlight).to(.6,{scale:new eQ(1.5,1.5)},{easing:"quadOut"}).start(),ez(this.circleHighlightOpacity).to(.6,{opacity:0},{easing:"quadIn"}).start()}}]),s}(eO)).prototype,"hand",[f3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=n(f9.prototype,"circleHighlight",[f5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=n(f9.prototype,"circleHighlightOpacity",[f6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f8=f9))||f8);ew._RF.pop(),ew._RF.push({},"b2213ccDllApaGIouur6a6b","GameMask",void 0);var vf,vv,vg,vm,vb,vw,vS=eS.ccclass,vk=eS.property,vC=(va=vS("GameMask"),vr=vk(e_),vo=vk(ex),va((vu=n((vl=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"uiTransform",vu,A(n)),_(n,"sprite",vh,A(n)),n}return T(s,[{key:"texture",get:function(){return this.sprite.spriteFrame.texture}}]),s}(eO)).prototype,"uiTransform",[vr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vh=n(vl.prototype,"sprite",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vs=vl))||vs);ew._RF.pop(),ew._RF.push({},"ad9c7KiarJHXpRRfn9GOaVx","AlphaMasks",void 0);var vE,v_,vA,vT,vP,vR,vI,vL=eS.ccclass,vO=eS.property,vD=eS.executeInEditMode,vM=(vf=vL("AlphaMasks"),vv=vD(!0),vg=vO(vC),vf(vm=vv((vw=n((vb=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"masks",vw,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.UITransform=this.node.getComponent(e_)}},{key:"start",value:function(){this.material=this.getComponent(ex).getMaterialInstance(0)}},{key:"update",value:function(){var n=this,w=this.UITransform,k=w.width,C=w.height;this.masks.forEach(function(w,_){var A=w.uiTransform,T=A.width,I=A.height,L=A.anchorX,O=A.anchorY,D=T*w.node.scale.x,M=I*w.node.scale.y,N=new e4(D/k,M/C),z=new e4(.5+(.5-L)*N.x,.5-(.5-O)*N.y),B=new e4(z.x+(w.node.worldPosition.x-n.node.worldPosition.x)/k,z.y-(w.node.worldPosition.y-n.node.worldPosition.y)/C);n.material.setProperty("mask".concat(_,"Texture"),w.texture),n.material.setProperty("ratio".concat(_),N),n.material.setProperty("center".concat(_),B)})}},{key:"setMaskActive",value:function(n,w){n>=this.masks.length||this.material.setProperty("useMask".concat(n),w?1:0)}}]),s}(eO)).prototype,"masks",[vg],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vm=vb))||vm)||vm);ew._RF.pop(),ew._RF.push({},"69569cXv55L852IkWTL0swz","GuideMasks",void 0);var vN,vz,vB,vF,vx,vU,vG,vH,vV,vq,vW,vK,vj,vY,vX,vZ,vJ,vQ,v$=eS.ccclass,v0=eS.property,v1=(vE=v$("GuideMasks"),v_=v0(i_),vA=v0(vM),vE((vR=n((vP=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"background",vR,A(n)),_(n,"alphaMasks",vI,A(n)),n}return T(c,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"show",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:this.background.node.active=!0;return[4,this.background.changeStateFade(!0,.25)];case 1:n.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"hide",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.background.changeStateFade(!1,.25)];case 1:n.sent(),this.background.node.active=!1;return[2]}})}),function(){return I.apply(this,arguments)})},{key:"onClick",value:function(){this.node.scene.emit(i9.GUIDE_MASK_CLICKED)}},{key:"setOtherMaskTransform",value:function(n,w,k,C){this.alphaMasks.masks[1].node.worldPosition=new eQ(-9999,-9999,0);var _=this.alphaMasks.masks[0];this.setMaskTransform(_,n,w,k,C)}},{key:"setItemMaskTransform",value:function(n,w,k,C){this.alphaMasks.masks[0].node.worldPosition=new eQ(-9999,-9999,0);var _=this.alphaMasks.masks[1];this.setMaskTransform(_,n,w,k,C)}},{key:"setMaskTransform",value:function(n,w,k,C,_){n.uiTransform.setContentSize(C,_),n.node.setWorldPosition(w,k,0)}}]),c}(eO)).prototype,"background",[v_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vI=n(vP.prototype,"alphaMasks",[vA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vT=vP))||vT);ew._RF.pop(),ew._RF.push({},"abfb9zudJhHdZfeUgbnBrs0","GuideTextBox",void 0);var v2,v4,v3,v5,v6,v8,v9,v7,ge,gt,gn,gi,ga,gr,go,gs,gl,gu,gp,gd,gy,gf=eS.ccclass,gv=eS.property,gg=(vN=gf("GuideTextBox"),vz=z.required(),vB=gv(eT),vF=z.required(),vx=gv(eN),vU=z.required(),vG=gv(e_),vH=z.required(),vV=gv(i_),vq=z.required(),vW=gv(K),vN((vY=n((vj=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"guideText",vY,A(n)),_(n,"widget",vX,A(n)),_(n,"uiTransform",vZ,A(n)),_(n,"opacityToggler",vJ,A(n)),_(n,"localizer",vQ,A(n)),n}return T(c,[{key:"__preload",value:function(){z.validateRequiredProperties(this)}},{key:"setLocalizedText",value:function(n){this.localizer.key=n}},{key:"show",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.opacityToggler.changeStateFade(!0)];case 1:n.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"hide",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.opacityToggler.changeStateFade(!1)];case 1:n.sent();return[2]}})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"guideText",[vz,vB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vX=n(vj.prototype,"widget",[vF,vx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vZ=n(vj.prototype,"uiTransform",[vU,vG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vJ=n(vj.prototype,"opacityToggler",[vH,vV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vQ=n(vj.prototype,"localizer",[vq,vW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vK=vj))||vK);ew._RF.pop(),ew._RF.push({},"a2522Y5Q6JGSr90yCp/4qCm","GuideUI",void 0);var gm,gb,gw,gS,gk,gC=eS.ccclass,gE=eS.property,g_=(v2=gC("GuideUI"),v4=z.required(),v3=gE(vy),v5=z.required(),v6=gE(gg),v8=z.required(),v9=gE(eT),v7=z.required(),ge=gE(K),gt=z.required(),gn=gE(v1),gi=z.required(),ga=gE(ek),v2((gs=n((go=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"guideHand",gs,A(n)),_(n,"guideTextBox",gl,A(n)),_(n,"guideInfoText",gu,A(n)),_(n,"guideInfoTextLocalizer",gp,A(n)),_(n,"guideMasks",gd,A(n)),_(n,"guideSkipButton",gy,A(n)),n}return T(s,[{key:"__preload",value:function(){z.validateRequiredProperties(this)}}]),s}(eO)).prototype,"guideHand",[v4,v3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl=n(go.prototype,"guideTextBox",[v5,v6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=n(go.prototype,"guideInfoText",[v8,v9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gp=n(go.prototype,"guideInfoTextLocalizer",[v7,ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gd=n(go.prototype,"guideMasks",[gt,gn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gy=n(go.prototype,"guideSkipButton",[gi,ga],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gr=go))||gr);ew._RF.pop(),ew._RF.push({},"4d800jyvxFJIYnkeNGud6KJ","GuidelinesManager",void 0);var gA=game,gT=gA.player,gP=gA.analytics,gR=eS.ccclass,gI=eS.property,gL=GameCore,gO=gL.Match.Modes,gD=gL.Plugins.Analytics.Events,gM=gL.Utils.Array,gN=new e4(0,10),gz=new e4(0,10),gB="READY",gF="RUNNING",gx=(gm=gR("GuidelinesManager"),gb=gI(g_),gm((gk=n((gS=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"guideUi",gk,A(n)),n.guideHintDelay=null,n.guideStormDelay=null,n}return T(u,[{key:"init",value:function(n){this.gameplay=n,this.status=gB,this.node.scene.on(i9.COMBO_UPDATED,this.startComboGuide,this),this.node.scene.on(i9.TILE_CLICK,this.startAutoGuides,this),this.node.scene.on(i9.USE_ITEM,this.handleUseItem,this),this.node.scene.on(i9.GAME_FINISH,this.stopAutoGuides,this),this.node.scene.on(i9.GAME_REPLAY,this.stopAutoGuides,this),this.node.scene.on(i9.GAME_PAUSE,this.stopAutoGuides,this)}},{key:"show",value:function(){this.isNewbieGuideLevel()?(this.hasGuideItemShowed(fG)&&this.resetGuideItemShowed(),this.startGuide(fG)):this.startGuide(fH)}},{key:"startGuide",value:function(n){if(this.status===gF)return!1;if(this.hasGuideItemShowed(n))return!1;switch(this.addGuideItemShowed(n),this.status=gF,n){case fG:gP.event(gD.TUTORIAL_BEGIN),this.guide1=new fY(this),this.guide1.setup();break;case fH:this.guide2=new fX(this),this.guide2.setup();break;case fV:this.guide3=new fZ(this),this.guide3.setup();break;case fq:this.guide4=new fQ(this),this.guide4.setup();break;case fW:this.guide5=new f0(this),this.guide5.setup();break;case fK:this.guide6=new f2(this),this.guide6.setup();break;case fj:this.guide7=new vi(this),this.guide7.setup()}return!0}},{key:"completeGuide",value:function(n){gP.event(gD.TUTORIAL_STEP,{step:n}),this.status=gB,this.addGuideItemShowed(n),this.gameplay.stateManager.isPlaying()&&this.startAutoGuides()}},{key:"isHintGuideLevel",value:function(){var n=this.getCurrentLevel(),w=gN.x,k=gN.y;return n>=w&&n<=k}},{key:"isShowErrorPathLevel",value:function(){if(sQ.getMatchMode()===gO.TOURNAMENT)return!1;var n=this.getCurrentLevel(),w=gz.x,k=gz.y;return n>=w&&n<=k}},{key:"isNewbieGuideLevel",value:function(){return 0===this.getCurrentLevel()}},{key:"hasGuideItemShowed",value:function(n){return gM.has(this.getGuideItemShowed(),n)}},{key:"addGuideItemShowed",value:function(n){if(!this.hasGuideItemShowed(n)){var w=this.getGuideItemShowed();w.push(n),gT.setGameData({guideItemShowed:w})}}},{key:"resetGuideItemShowed",value:function(){gT.setGameData({guideItemShowed:[]})}},{key:"getGuideItemShowed",value:function(){var n,w;return null!==(n=null===(w=gT.getGameData())||void 0===w?void 0:w.guideItemShowed)&&void 0!==n?n:[]}},{key:"getCurrentLevel",value:function(){return this.gameplay.levelManager.getLevelData().level}},{key:"startComboGuide",value:function(n){this.isNewbieGuideLevel()||n<2||(this.startGuide(fV),this.node.scene.off(i9.COMBO_UPDATED,this.startComboGuide,this))}},{key:"startAutoGuides",value:function(){this.startHintGuide(),this.startStormGuide()}},{key:"stopAutoGuides",value:function(){null!==this.guideHintDelay&&this.guideHintDelay.stop(),null!==this.guideStormDelay&&this.guideStormDelay.stop()}},{key:"startHintGuide",value:function(){var n=this;this.isHintGuideLevel()&&(null===this.guideHintDelay&&(this.guideHintDelay=ez(this.node).delay(5).call(function(){n.isNewbieGuideLevel()||(n.hasGuideItemShowed(fq)&&n.status===gB?n.node.scene.emit(i9.SHOW_HINT):n.startGuide(fq),n.startHintGuide())})),this.guideHintDelay.stop(),this.guideHintDelay.start())}},{key:"startStormGuide",value:function(){var n=this;null===this.guideStormDelay&&(this.guideStormDelay=new tg(this.node).delay(10).call(function(){n.isNewbieGuideLevel()||n.hasGuideItemShowed(fK)||n.gameplay.itemManager.canUseItem(X.STORM)&&(n.startGuide(fK)||n.startStormGuide())})),this.guideStormDelay.stop(),this.guideStormDelay.start()}},{key:"startThunderGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(fW)}},{key:"startPliersGuide",value:function(){return!this.isNewbieGuideLevel()&&this.startGuide(fj)}},{key:"handleUseItem",value:function(n){switch(this.startAutoGuides(),n){case X.HINT:this.addGuideItemShowed(fq);break;case X.THUNDER:this.addGuideItemShowed(fW);break;case X.STORM:this.addGuideItemShowed(fK);break;case X.PLIERS:this.addGuideItemShowed(fj)}}},{key:"skipNewbieGuide",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:this.guideUi.guideSkipButton.active=!1;return[4,this.guide1.close()];case 1:w.sent();n=this.getCurrentLevel()+1;gT.setGameData({level:n}),this.node.scene.emit(i9.NEXT_LEVEL);return[2]}})}),function(){return I.apply(this,arguments)})},{key:"onDestroy",value:function(){var n,w,k,C,_,A;null===(n=this.guide2)||void 0===n||n.unlistenEvents(),null===(w=this.guide3)||void 0===w||w.unlistenEvents(),null===(k=this.guide4)||void 0===k||k.unlistenEvents(),null===(C=this.guide5)||void 0===C||C.unlistenEvents(),null===(_=this.guide6)||void 0===_||_.unlistenEvents(),null===(A=this.guide7)||void 0===A||A.unlistenEvents()}}]),u}(eO)).prototype,"guideUi",[gb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gw=gS))||gw);ew._RF.pop(),ew._RF.push({},"aa973zMvtZFD6GO7rUb6TBF","canUseHintItem",void 0);ew._RF.pop(),ew._RF.push({},"f3464SQfFhIs5PVRx8JpCO1","canUsePliersItem",void 0);ew._RF.pop(),ew._RF.push({},"ad5b3eazZ1B3YR8JJm+qvM6","canUseThunderItem",void 0);ew._RF.pop(),ew._RF.push({},"3b5b1bQTVlDaaFOGKDB5VZk","canUseTornadoItem",void 0);var gU,gG;ew._RF.pop(),ew._RF.push({},"e1fd9AcoshNdK0i6vow/F2P","ItemManager",void 0);var gH,gV=eS.ccclass,gq=globalThis.game.player,gW=(Y(gU={},X.HINT,{canActivate:!1,quantity:0}),Y(gU,X.THUNDER,{canActivate:!1,quantity:0}),Y(gU,X.STORM,{canActivate:!1,quantity:0}),Y(gU,X.PLIERS,{canActivate:!1,quantity:0}),gU),gK=gV("ItemManager")(gG=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).itemConfigs=gW,n}return T(o,[{key:"onLoad",value:function(){this.node.scene.on(i9.GRID_CREATE,this.updateItemsConfig,this),this.node.scene.on(i9.GRID_MATCH,this.updateItemsConfig,this),this.node.scene.on(i9.GRID_CLEAR,this.updateItemsConfig,this),this.node.scene.on(i9.GRID_SPAWN,this.updateItemsConfig,this),this.node.scene.on(i9.BOMB_EXPLODE,this.updateItemsConfig,this),this.node.scene.on(i9.REFRESH_ITEMS,this.updateItemsConfig,this)}},{key:"init",value:function(n){this.game=n}},{key:"getQuantity",value:function(n){return this.itemConfigs[n].quantity}},{key:"setQuantity",value:function(n,w,k){var C=arguments.length>2&&void 0!==k&&k,_=Math.max(0,w);this.itemConfigs[n].quantity=_,this.saveQuantity(n,w),this.updateItemConfig(n,C)}},{key:"saveQuantity",value:function(n,w){var k=gq.getGameData();k&&gq.setGameData({items:I(I({},k.items),{},Y({},n,w))})}},{key:"canUseItem",value:function(n){var w=this.game,k=w.board,C=w.pathDraw;switch(n){case X.HINT:return function(n,w){return n.getUncleared().length>0&&!1===w.isDrawingHint}(k,C);case X.PLIERS:return function(n){return n.getBombTiles().length>0}(k);case X.STORM:return function(n){return n.getUncleared().length>4}(k);case X.THUNDER:return function(n){return n.getUncleared().length>=4}(k);default:return!1}}},{key:"updateItemsConfig",value:function(){var n=gq.getGameData();if(n){for(var w=0,k=Object.keys(this.itemConfigs);w<k.length;w++){var C=k[w],_=this.itemConfigs[C];_.canActivate=this.canUseItem(C),_.quantity=n.items[C]||0}this.game.uiManager.currentLayout.updateStatus(I({items:this.itemConfigs},this.game.uiManager.config))}}},{key:"updateItemConfig",value:function(n,w){var k=arguments.length>1&&void 0!==w&&w,C=gq.getGameData();C&&(this.itemConfigs[n].canActivate=this.canUseItem(n),this.itemConfigs[n].quantity=C.items[n]||0,this.game.uiManager.currentLayout.updateStatus(I({items:I(I({},this.itemConfigs),{},Y({},n,I({animate:k},this.itemConfigs[n])))},this.game.uiManager.config)))}}]),o}(eO))||gG;ew._RF.pop(),ew._RF.push({},"bbe87JDGgVEkJdgCL2ydwxX","LevelManager",void 0);var gj,gY=eS.ccclass,gX=GameCore.Utils,gZ=gX.Device,gJ=gX.Array,gQ=globalThis.game.monitorError,g$={level:1,mode:"normal",time:900,colors:12,specials:{bomb:0,rocket:0},rules:{maxSpaceOfPair:1,addRandomTilesPerMove:0},columns:5,rows:6,theme:["flower"]},g0=gY("LevelManager")(gH=function(n){w(c,n);var _,A,I,L,O=k(c);function c(){return C(this,c),O.apply(this,arguments)}return T(c,[{key:"loadLevel",value:(L=M(function(){var n,w,k,C,_,A;var T=arguments;return _ts_generator(this,function(I){switch(I.label){case 0:n=T.length>0&&void 0!==T[0]?T[0]:1,w=T.length>1?T[1]:void 0;return[4,this.loadLevelData(n)];case 1:k=I.sent();this.levelData=k||this.levelData||g$;C=this.levelData,_=C.rows,A=C.columns;return[2,(gZ.isMobile()&&A>=6&&_>=10&&(this.levelData.columns=5,this.levelData.rows=10),null==gQ||gQ.addMetadata({level:n}),this.getLevelSpriteFrames(n,w))]}})}),function(){return L.apply(this,arguments)})},{key:"loadLevelData",value:(I=M(function(){var n,w,k,C,_;var A=arguments;return _ts_generator(this,function(T){switch(T.label){case 0:n=A.length>0&&void 0!==A[0]?A[0]:1,w=10,k=this.paddingZero("".concat(Math.floor(n/w)+1),3),C=n%w;return[4,B.loadJsonAsync("".concat($.LEVEL_DATA_FOLDER,"/").concat(k))];case 1:_=T.sent();return[2,_?_[C]:null]}})}),function(){return I.apply(this,arguments)})},{key:"getLevelData",value:function(){return this.levelData}},{key:"getLevelSpriteFrames",value:(A=M(function(n,w){var k,C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:if(!(w&&e0.random()<=.5))return[3,2];k=sB.getThemeSkins(w),C=k[e0.randomRangeInt(0,k.length)];return[4,this.loadSkinFrames(C)];case 1:return[2,L.sent()];case 2:_=sB.getLevelSkins(n);if(0===_.length)throw new Error("No skins found for level ".concat(n));if(!(_.length>1))return[3,4];return[4,this.loadSkinFrames(_)];case 3:return[2,L.sent()];case 4:A=_[0],T=sB.getUnlockedSkins();if(T.length>1&&e0.random()<=.5){I=T.filter(function(n){return n!==A});A=I[e0.randomRangeInt(0,I.length)]}return[4,this.loadSkinFrames(A)];case 5:return[2,L.sent()]}})}),function(n,w){return A.apply(this,arguments)})},{key:"loadSkinFrames",value:(_=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:if(!Array.isArray(n))return[3,2];w=n.map(function(){var n=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w="".concat($.TILE_SKIN_FOLDER,"/").concat(n);return[4,B.loadSpriteFramesDirAsync(w)];case 1:return[2,k.sent()]}})});return function(w){return n.apply(this,arguments)}}());k=gJ.flatten;return[4,Promise.all(w)];case 1:return[2,k.apply(gJ,[_.sent()])];case 2:C="".concat($.TILE_SKIN_FOLDER,"/").concat(n);return[4,B.loadSpriteFramesDirAsync(C)];case 3:return[2,_.sent()]}})}),function(n){return _.apply(this,arguments)})},{key:"paddingZero",value:function(n,w){for(var k="",C=0;C<w-n.length;C++)k+="0";return k+n}}]),c}(eO))||gH;ew._RF.pop(),ew._RF.push({},"3f8fenpEyBKaaNxBYL5960v","ScoreManager",void 0);var g1=eS.ccclass,g2=GameCore.Match.Modes,g4=g1("ScoreManager")(gj=function(n){w(l,n);var _,A=k(l);function l(){var n;C(this,l);for(var w=arguments.length,k=new Array(w),_=0;_<w;_++)k[_]=arguments[_];return(n=A.call.apply(A,[this].concat(k))).currentScore=0,n.tournamentStartScore=0,n}return T(l,[{key:"addScore",value:function(n,w,k){var C=this.getLevelMultiplier(n),_=this.getComboMultiplier(w),A=this.getTimeMultiplier(n,k),T=Math.floor(this.currentScore+10*C*_*A),I=10*Math.ceil(T/10);this.setScore(I)}},{key:"init",value:function(){this.initCurrentScore(),this.updateScore()}},{key:"initCurrentScore",value:function(){var n=sQ.getMatchMode();this.currentScore=n===g2.TOURNAMENT?this.tournamentStartScore:0}},{key:"setScore",value:function(n){this.currentScore=n,this.updateScore()}},{key:"updateTournamentStartScore",value:function(){this.tournamentStartScore=this.currentScore}},{key:"resetTournamentStartScore",value:function(){this.tournamentStartScore=0}},{key:"updateScore",value:(_=M(function(){return _ts_generator(this,function(n){this.node.scene.emit(i9.SCORE_UPDATED,this.currentScore);return[2]})}),function(){return _.apply(this,arguments)})},{key:"getCurrentScore",value:function(){return this.currentScore}},{key:"getLevelMultiplier",value:function(n){return 1+.1*(n-1)}},{key:"getComboMultiplier",value:function(n){return 1+.1*(n-1)}},{key:"getTimeMultiplier",value:function(n,w){return n<=2?4:1+.05*w}}]),l}(eO))||gj;ew._RF.pop(),ew._RF.push({},"e6116mseMNPD6VcLUtkvez6","BaseState",void 0);var g3=function(){function e(n){C(this,e),this.game=null,this.data={},this.game=n.getGameplay(),this.manager=n,this.updateStateData(),this.logDebug()}return T(e,[{key:"logDebug",value:function(){var n=this.constructor.name;console.info("[STATE] ".concat(n),this.data)}},{key:"updateStateData",value:function(){if(this.game){var n=this.game.getGameData();n&&(this.data=n)}}},{key:"updateGameData",value:function(n){var w;null===(w=this.game)||void 0===w||w.setGameData(n)}}]),e}();ew._RF.pop(),ew._RF.push({},"e4ee7Ho9zJPVKobpdsCwGlp","FailState",void 0);var g5=globalThis.game,g6=g5.analytics,g8=g5.match,g9=g5.storage,g7=GameCore,me=g7.Match.Modes,mt=g7.Dtos.Match.Data,mn=function(n){w(c,n);var _,A,I,L,O=k(c);function c(n,w){var k;return C(this,c),k=O.call(this,n),G.stopAllSounds(),k.vibrateDevice(),k.pauseCountdown(),k.updateMatchCustomData(),k.handleGameOver(w),k.logLevelFailAnalytics(),k}return T(c,[{key:"pauseCountdown",value:function(){var n;null===(n=this.game)||void 0===n||n.uiManager.pauseTime()}},{key:"vibrateDevice",value:function(){var n;null===(n=tr("Vibrate"))||void 0===n||null===(n=n.getComponent(sg))||void 0===n||n.vibrate(500)}},{key:"handleGameOver",value:(L=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=sQ.getMatchMode();if(B.setBlockInput(!0),w===me.SINGLE)return[3,5];if(w!==me.TOURNAMENT)return[3,2];return[4,this.handleTournamentGameOver()];case 1:k.sent();return[3,4];case 2:if(w!==me.CHALLENGE_FRIEND)return[2,void this.showFailScreen(n)];return[4,this.handleChallengeGameOver()];case 3:k.sent();k.label=4;case 4:B.setBlockInput(!1);return[3,6];case 5:this.showFailScreen(n);k.label=6;case 6:return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"handleTournamentGameOver",value:(I=M(function(){var n,w,k,C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:k=this;if(!this.game)return[3,5];C=(null!==(n=sQ.getMatchCustomData())&&void 0!==n?n:{}).tournamentId;if(!C)return[3,5];if(et.validateTournamentExpired(C))return[2,(g9.setStorageData("tournament","animateTournamentLeader",!1),en.showNotificationScreenWithLocalizedKey("error.tourEnded",2),void(null===(_=this.game)||void 0===_||_.scheduleOnce(function(){var n;null===(n=k.game)||void 0===n||n.node.scene.emit(i9.GAME_EXIT)},2)))];L.label=1;case 1:L.trys.push([1,3,,4]);A=g9.getStorageData("tournament","previousScore"),T=this.game.scoreManager.getCurrentScore()>A;g9.setStorageData("tournament","animateTournamentLeader",T);return[4,sQ.finishMatchAsync()];case 2:L.sent();return[3,4];case 3:I=L.sent();console.warn(I);return[3,4];case 4:null===(w=this.game)||void 0===w||w.node.scene.emit(i9.GAME_EXIT);L.label=5;case 5:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"handleChallengeGameOver",value:(A=M(function(){var n,w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:if(!this.game)return[3,6];_.label=1;case 1:_.trys.push([1,4,,5]);n=g8.getMatchState().id;return[4,g8.api.getMatchAPI().getMatchDetailByIdAsync(n)];case 2:w=_.sent(),k=new mt(w).toObject().extraData;return[4,sQ.finishMatchAsync({extraData:null!=k?k:void 0})];case 3:_.sent();return[3,5];case 4:C=_.sent();console.warn(C);return[3,5];case 5:this.game.node.scene.emit(i9.SHOW_CHALLENGE_RESULTS);_.label=6;case 6:return[2]}})}),function(){return A.apply(this,arguments)})},{key:"showFailScreen",value:(_=M(function(n){var w;return _ts_generator(this,function(k){w=this.data.level;n===s0&&G.playSound(nL.LEVEL_FAIL_TIMEOUT),G.playSound(nL.LEVEL_FAIL),en.openScreen(ei.RESCUES_SCREEN,{level:w,failKey:n});return[2]})}),function(n){return _.apply(this,arguments)})},{key:"updateMatchCustomData",value:function(){var n;if(this.game){var w=this.data.level,k=void 0===w?1:w,C=null===(n=this.game)||void 0===n?void 0:n.scoreManager.getCurrentScore();sQ.updateMatchStateAfterLevelFinish(k,C)}}},{key:"logLevelFailAnalytics",value:function(){if(this.game){var n=this.data.level,w=void 0===n?0:n,k=this.game.scoreManager.getCurrentScore(),C=sQ.getMatchMode()||void 0;g6.levelFail(w,k,C)}}},{key:"initialize",value:function(){var n=this.manager.createInitializeState(this.manager);this.manager.change(n)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var n=this.manager.createPlayingState(this.manager);this.manager.change(n)}},{key:"fail",value:function(){}},{key:"finish",value:function(){var n=this.manager.createFinishState(this.manager);this.manager.change(n)}},{key:"update",value:function(){}}]),c}(g3);ew._RF.pop(),ew._RF.push({},"a9bc11SkV9L/5L+Y+fhswfJ","FinishState",void 0);var mi=globalThis.game,ma=mi.analytics,mr=mi.player,mo=mi.leaderboard,ms=mi.match,ml=GameCore,mu=ml.Match.Modes,mc=ml.Utils.Time,mh=GameCore.Configs.Ads.NotifyPlayerBeforeShow,mp=function(n){w(f,n);var _,A,L,O,D,N,z,B=k(f);function f(n){var w;return C(this,f),(w=B.call(this,n)).handleFinishStateFlow(),w}return T(f,[{key:"handleFinishStateFlow",value:(z=M(function(){var n;return _ts_generator(this,function(w){if(this.game){this.processCrazyGamesEvent(),this.attemptCallCreateShortcut(),this.game.uiManager.pauseTime();n=sQ.getMatchMode();n!==mu.CHALLENGE_FRIEND&&n!==mu.TOURNAMENT&&this.updatePlayerProgress(),this.updateMatchCustomData(),n===mu.CHALLENGE_FRIEND?this.handleFinishChallenge():n===mu.TOURNAMENT?this.handleFinishTournament():this.handleFinishSingle(),this.logLevelCompleteAnalytics()}return[2]})}),function(){return z.apply(this,arguments)})},{key:"processCrazyGamesEvent",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"attemptCallCreateShortcut",value:function(){var n=this.data.level;(void 0===n?0:n)<2||ea.canShowInterstitialAd()||"checkAndCreateShortcutAsync"in GameSDK.extra&&GameSDK.extra.checkAndCreateShortcutAsync().catch(function(n){console.warn("createShortcutAsync",n)})}},{key:"updatePlayerProgress",value:function(){if(this.game){var n=this.data.level;if(n){var w=n+1,k=mr.getGameData();if(k){var C=k.totalLevel,_=k.level,A=Math.max(_,w),T=I({},k);A<C&&(T.level=A),mr.setGameData(T)}}}}},{key:"updateMatchCustomData",value:function(){if(this.game){var n=this.data.level,w=void 0===n?1:n,k=this.game.scoreManager.getCurrentScore();sQ.updateMatchStateAfterLevelFinish(w,k)}}},{key:"logLevelCompleteAnalytics",value:function(){if(this.game){var n=this.data.level,w=void 0===n?0:n,k=this.game.scoreManager.getCurrentScore(),C=sQ.getMatchMode()||void 0;ma.levelComplete(w,k,C)}}},{key:"handleFinishChallenge",value:(N=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:if(!this.game)return[3,7];C.label=1;case 1:C.trys.push([1,4,,6]);n=ms.getMatchState().id;return[4,sQ.getMatchExtraDataAsync(n)];case 2:w=C.sent();return[4,sQ.finishMatchAsync({extraData:null!=w?w:void 0})];case 3:C.sent();return[3,6];case 4:k=C.sent();console.warn(k);return[4,sQ.finishMatchAsync()];case 5:C.sent();return[3,6];case 6:this.game.node.scene.emit(i9.SHOW_CHALLENGE_RESULTS);C.label=7;case 7:return[2]}})}),function(){return N.apply(this,arguments)})},{key:"handleFinishTournament",value:(D=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:if(this.handlePostTournamentScore(),!this.game)return[3,4];n=this.data.level,w=void 0===n?1:n;G.playSound(nL.LEVEL_COMPLETE,{volume:.5}),this.game.effectManager.playConfettiEffect();return[4,mc.sleepAsync(500)];case 1:C.sent();k=ea.canShowInterstitialAd();if(!k)return[3,3];return[4,ea.showInterstitialAdAsync({forLevel:w})];case 2:k=C.sent();C.label=3;case 3:this.game.node.scene.emit(i9.NEXT_LEVEL);C.label=4;case 4:return[2]}})}),function(){return D.apply(this,arguments)})},{key:"handlePostTournamentScore",value:(O=M(function(){var n,w,k,C,_,A,T;return _ts_generator(this,function(I){switch(I.label){case 0:if(!this.game)return[3,7];w=null===(n=this.game)||void 0===n?void 0:n.scoreManager.getCurrentScore();if(!w)return[3,7];I.label=1;case 1:I.trys.push([1,3,,4]);return[4,GameSDK.tournament.postScoreAsync(w)];case 2:I.sent();return[3,4];case 3:k=I.sent();console.warn("GameSDK post score async",k);return[3,4];case 4:C=sQ.getMatchCustomData();if(!C)return[3,7];_=C.leaderboardId,A=C.playerId;T=_&&A;if(!T)return[3,6];return[4,mo.setLeaderboardScoreAsync(_,A,w)];case 5:T=I.sent();I.label=6;case 6:I.label=7;case 7:return[2]}})}),function(){return O.apply(this,arguments)})},{key:"handleFinishSingle",value:(L=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:G.turnUpMusic();n=this.data.level,w=void 0===n?0:n;if(!(w>0&&w%5==0))return[3,2];return[4,this.handleFinishHardLevel()];case 1:k.sent();return[3,4];case 2:return[4,this.handleFinishNormalLevel()];case 3:k.sent();k.label=4;case 4:this.handleNextLevelSingle();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"handleFinishNormalLevel",value:(A=M(function(){var n,w,k,C,_,A,T,I,L,O,D;return _ts_generator(this,function(M){switch(M.label){case 0:A=this.data.level,T=void 0===A?0:A,I=null!==(n=null===(w=mr.getGameData())||void 0===w?void 0:w.coins)&&void 0!==n?n:0,L=null!==(k=null===(C=sQ.getMatchCustomData())||void 0===C?void 0:C.score)&&void 0!==k?k:0;O=ea.canShowInterstitialAd();if(!O)return[3,4];D=mh;if(!D)return[3,2];return[4,null===(_=this.game)||void 0===_?void 0:_.uiManager.interstitialAdIndicator.flash()];case 1:D=M.sent();M.label=2;case 2:return[4,ea.showInterstitialAdAsync({forLevel:T})];case 3:O=M.sent();M.label=4;case 4:G.playSound(nL.LEVEL_COMPLETE,{volume:.5});return[4,en.openScreenAndWaitForClose(ei.LEVEL_COMPLETE_SCREEN,{level:T,coins:I,score:L,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!1})];case 5:M.sent();return[2]}})}),function(){return A.apply(this,arguments)})},{key:"handleFinishHardLevel",value:(_=M(function(){var n,w,k,C,_,A,T,I,L,O,D,M,N,z;return _ts_generator(this,function(B){switch(B.label){case 0:A=this.data.level,T=void 0===A?0:A,I=null!==(n=null===(w=mr.getGameData())||void 0===w?void 0:w.coins)&&void 0!==n?n:0,L=null!==(k=null===(C=sQ.getMatchCustomData())||void 0===C?void 0:C.score)&&void 0!==k?k:0;G.playSound(nL.LEVEL_COMPLETE,{volume:.5});return[4,en.openScreenAndWaitForClose(ei.LEVEL_COMPLETE_SCREEN,{level:T,coins:I,score:L,overrideAnimation:{openScreen:"LevelCompleteOpenScreen"},lookingForRewards:!0})];case 1:O=B.sent().screenData,D=(null!=O?O:{}).canShowRewardsAd;if(!(void 0!==D&&D))return[3,6];return[4,en.openScreenAndWaitForClose(ei.GET_REWARDS_SCREEN)];case 2:M=B.sent().screenData,N=null!==(_=null==M?void 0:M.getRewardsSuccess)&&void 0!==_&&_;N&&this.getRewardItems();return[4,en.openScreenAndWaitForClose(ei.LEVEL_COMPLETE_SCREEN,{level:T,coins:I,score:L,getRewardsSuccess:N,lookingForRewards:!1})];case 3:B.sent();z=N;if(z)return[3,5];return[4,ea.showInterstitialAdAsync({forLevel:T})];case 4:z=B.sent();B.label=5;case 5:return[3,8];case 6:return[4,ea.showInterstitialAdAsync({forLevel:T})];case 7:B.sent();B.label=8;case 8:return[2]}})}),function(){return _.apply(this,arguments)})},{key:"handleNextLevelSingle",value:function(){var n=this.data.level,w=mr.getGameData();this.game&&n&&w&&(n>=w.totalLevel?this.game.node.scene.emit(i9.MAX_LEVEL):this.game.node.scene.emit(i9.NEXT_LEVEL))}},{key:"getRewardItems",value:function(){this.game&&(this.game.node.scene.emit(i9.ADD_ITEM,{item:X.STORM,quantity:1}),this.game.node.scene.emit(i9.ADD_ITEM,{item:X.THUNDER,quantity:1}))}},{key:"initialize",value:function(){var n=this.manager.createInitializeState(this.manager);this.manager.change(n)}},{key:"ready",value:function(){}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),f}(g3);ew._RF.pop(),ew._RF.push({},"37a5cRy3ANBGpVlH3wyS3Ra","InitializeState",void 0);var md=globalThis.game,my=md.player,mf=md.match,mv=GameCore.Match.Modes,mg=function(n){w(f,n);var _,A,L,O,D,z,B=k(f);function f(n){var w;return C(this,f),(w=B.call(this,n)).clearBoard(),w.initCountdown(),w.initScore(),w.loadLevel().then(function(){w.updateUI()}),w}return T(f,[{key:"clearBoard",value:function(){this.game&&(this.game.rescueTiles=[],this.game.board.destroyTiles(),this.game.board.clearAnimationQueue(),this.game.pathDraw.clearMatchPath())}},{key:"loadLevel",value:(z=M(function(){var n,w,k,C,_,A,T;return _ts_generator(this,function(I){switch(I.label){case 0:if(!this.game)return[3,8];n=sQ.getMatchMode();I.label=1;case 1:I.trys.push([1,6,,8]);if(n!==mv.CHALLENGE_FRIEND)return[3,3];return[4,this.loadChallengeFriendMode()];case 2:w=I.sent(),k=w.frames,C=w.extraData;G.playSound(nL.LEVEL_START),this.handleChallengeFriendModeStart(k,C);return[3,5];case 3:return[4,this.loadSingleMode()];case 4:_=I.sent();G.playSound(nL.LEVEL_START),n===mv.SINGLE?this.handleSingleModeStart(_):n===mv.TOURNAMENT&&this.handleTournamentModeStart(_);I.label=5;case 5:return[3,8];case 6:A=I.sent();console.error("Error loading level:",A);return[4,this.loadSingleMode()];case 7:T=I.sent();G.playSound(nL.LEVEL_START),this.handleSingleModeStart(T);return[3,8];case 8:return[2]}})}),function(){return z.apply(this,arguments)})},{key:"loadChallengeFriendMode",value:(D=M(function(){var n,w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:n=mf.getMatchState().id;return[4,sQ.getMatchExtraDataAsync(n)];case 1:w=_.sent();if(!w)throw new Error("Match mode ".concat(mv.CHALLENGE_FRIEND," but no extraData (for opponent initialization) was found in match data."));k=this.game.levelManager;return[4,k.loadLevel(w.level)];case 2:C=_.sent();return[2,(this.updateGameData({level:w.level,levelData:k.getLevelData()}),{frames:C,extraData:w})]}})}),function(){return D.apply(this,arguments)})},{key:"loadSingleMode",value:(O=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:n=this.game.levelManager;return[4,n.loadLevel(this.data.level,this.data.themeId)];case 1:w=k.sent();return[2,(this.updateGameData({levelData:n.getLevelData()}),w)]}})}),function(){return O.apply(this,arguments)})},{key:"handleChallengeFriendModeStart",value:(L=M(function(n,w){var k,C,_,A,T,L,O;return _ts_generator(this,function(D){switch(D.label){case 0:if(!this.game)return[3,3];k=this.game.levelManager.getLevelData(),C=w.level,_=w.fen,A=w.gravity,T=w.rules,L=w.time,O=my.getPlayerId();return[4,Promise.all([sQ.setMatchCustomDataAsync({level:C,score:0}),sQ.setProfileMatchDataAsync({id:O,score:0})])];case 1:D.sent(),this.game.board.create(n,I(I({},k),{},{level:C,customFen:_,mode:A,rules:T,time:L})),this.game.board.setIgnoreInput(!0);return[4,this.game.board.animateTilesAppear()];case 2:D.sent(),this.game.board.setIgnoreInput(!1),this.ready();D.label=3;case 3:return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"handleSingleModeStart",value:(A=M(function(n){var w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:if(!this.game)return[3,6];k=this.game.levelManager.getLevelData(),C=this.data.level,_=my.getPlayerId();return[4,Promise.all([sQ.setMatchCustomDataAsync({level:C,score:0}),sQ.setProfileMatchDataAsync({id:_,score:0})])];case 1:T.sent(),this.game.board.create(n,k),this.game.board.setIgnoreInput(!0);return[4,this.game.board.animateTilesAppear()];case 2:T.sent(),null!==(w=this.game.guidelinesManager)&&void 0!==w&&w.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1);A=C&&C>0&&C%5==0;if(!A)return[3,5];s5.isLandscape()&&this.game.handleShowUI(),en.openScreen(ei.HARD_LEVEL_SCREEN);return[4,N.waitTweenAsync(1.3)];case 3:T.sent(),en.closeScreen(ei.HARD_LEVEL_SCREEN);return[4,this.game.board.animateTilesWave()];case 4:A=T.sent();T.label=5;case 5:this.ready();T.label=6;case 6:return[2]}})}),function(n){return A.apply(this,arguments)})},{key:"handleTournamentModeStart",value:(_=M(function(n){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:if(!this.game)return[3,3];k=this.game.levelManager.getLevelData(),C=this.data.level,_=my.getPlayerId();return[4,Promise.all([sQ.setMatchCustomDataAsync({level:C}),sQ.setProfileMatchDataAsync({id:_})])];case 1:A.sent(),this.game.board.create(n,k),this.game.board.setIgnoreInput(!0);return[4,this.game.board.animateTilesAppear()];case 2:A.sent(),null!==(w=this.game.guidelinesManager)&&void 0!==w&&w.isNewbieGuideLevel()||this.game.board.setIgnoreInput(!1),this.ready();A.label=3;case 3:return[2]}})}),function(n){return _.apply(this,arguments)})},{key:"initScore",value:function(){this.game&&this.game.scoreManager.init()}},{key:"initCountdown",value:function(){this.game&&this.game.clockManager.init()}},{key:"updateUI",value:function(){if(this.game){var n=this.game.getGameData();if(n){var w=n.level,k=void 0===w?0:w,C=n.levelData;this.game.uiManager.setLevelText(k),C&&this.game.clockManager.setTime(C.time)}}}},{key:"initialize",value:function(){}},{key:"ready",value:function(){var n=this.manager.createReadyState(this.manager);this.manager.change(n)}},{key:"playing",value:function(){}},{key:"fail",value:function(){}},{key:"finish",value:function(){}},{key:"update",value:function(){}}]),f}(g3);ew._RF.pop(),ew._RF.push({},"e3b372NaI5HvY5HnTleBQKd","PlayingState",void 0);var mm=function(n){w(o,n);var _=k(o);function o(n){var w;return C(this,o),(w=_.call(this,n)).startCountdown(),w}return T(o,[{key:"startCountdown",value:function(){this.game&&(this.game.clockManager.startCountdown(),this.game.uiManager.startCountdown())}},{key:"initialize",value:function(){var n=this.manager.createInitializeState(this.manager);this.manager.change(n)}},{key:"ready",value:function(){var n=this.manager.createReadyState(this.manager);this.manager.change(n)}},{key:"playing",value:function(){}},{key:"fail",value:function(n){var w=this.manager.createFailState(this.manager,n);this.manager.change(w)}},{key:"finish",value:function(){var n=this.manager.createFinishState(this.manager);this.manager.change(n)}},{key:"update",value:function(){this.updateStateData()}}]),o}(g3);ew._RF.pop(),ew._RF.push({},"5ef69tJ5eNNv7o22H/XfSD2","ReadyState",void 0);var mb,mw=globalThis.game.analytics,mS=GameCore.Utils.Valid,mk=function(n){w(o,n);var _=k(o);function o(n){var w;return C(this,o),w=_.call(this,n),G.stopAllSounds(),G.turnDownMusic(),w.handleGuideFlow(),w.setGridPlayable(),w.logLevelStartAnalytics(),w}return T(o,[{key:"initialize",value:function(){var n=this.manager.createInitializeState(this.manager);this.manager.change(n)}},{key:"ready",value:function(){}},{key:"playing",value:function(){var n=this.manager.createPlayingState(this.manager);this.manager.change(n)}},{key:"fail",value:function(n){if(mS.isDebugger()){var w=this.manager.createFailState(this.manager);this.manager.change(w)}}},{key:"finish",value:function(){if(mS.isDebugger()){var n=this.manager.createFinishState(this.manager);this.manager.change(n)}}},{key:"update",value:function(){}},{key:"setGridPlayable",value:function(){var n;null!==(n=this.manager.getGameplay().guidelinesManager)&&void 0!==n&&n.isNewbieGuideLevel()||this.manager.getGameplay().board.setIgnoreInput(!1)}},{key:"handleGuideFlow",value:function(){var n,w;this.game&&(null!==(n=this.game.guidelinesManager)&&void 0!==n&&n.isNewbieGuideLevel()||this.game.handleShowUI(),null===(w=this.game.guidelinesManager)||void 0===w||w.show())}},{key:"logLevelStartAnalytics",value:function(){if(this.game){var n=this.data.level,w=void 0===n?0:n,k=(sQ.getMatchCustomData()||{}).score,C=void 0===k?0:k,_=sQ.getMatchMode()||void 0;mw.levelStart(w,C,_)}}}]),o}(g3);ew._RF.pop(),ew._RF.push({},"bb0e3beWSxOOLCv7gjyg2s0","StateManager",void 0);var mC,mE=(0,eS.ccclass)("StateManager")(mb=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"getGameplay",value:function(){return this.gameplay}},{key:"init",value:function(n){this.gameplay=n,this.state=new mg(this)}},{key:"change",value:function(n){this.state=n}},{key:"initialize",value:function(){this.state.initialize()}},{key:"isInitialize",value:function(){return _instanceof(this.state,mg)}},{key:"ready",value:function(){this.state.ready()}},{key:"isReady",value:function(){return _instanceof(this.state,mk)}},{key:"playing",value:function(){this.state.playing()}},{key:"isPlaying",value:function(){return _instanceof(this.state,mm)}},{key:"fail",value:function(n){this.state.fail(n)}},{key:"isFail",value:function(){return _instanceof(this.state,mn)}},{key:"finish",value:function(){this.state.finish()}},{key:"isFinished",value:function(){return _instanceof(this.state,mp)}},{key:"update",value:function(n){this.state&&this.state.update(n)}},{key:"createInitializeState",value:function(){for(var n=arguments.length,w=new Array(n),k=0;k<n;k++)w[k]=arguments[k];return er(mg,w)}},{key:"createReadyState",value:function(){for(var n=arguments.length,w=new Array(n),k=0;k<n;k++)w[k]=arguments[k];return er(mk,w)}},{key:"createPlayingState",value:function(){for(var n=arguments.length,w=new Array(n),k=0;k<n;k++)w[k]=arguments[k];return er(mm,w)}},{key:"createFailState",value:function(){for(var n=arguments.length,w=new Array(n),k=0;k<n;k++)w[k]=arguments[k];return er(mn,w)}},{key:"createFinishState",value:function(){for(var n=arguments.length,w=new Array(n),k=0;k<n;k++)w[k]=arguments[k];return er(mp,w)}}]),o}(eO))||mb;ew._RF.pop(),ew._RF.push({},"a95ba1U+uJB66zZU7UYL4e5","TournamentManager",void 0);var m_,mA,mT,mP,mR,mI,mL,mO,mD,mM=eS.ccclass,mN=GameCore.Utils.Object,mz=globalThis.game.player,mB=mM("TournamentManager")(mC=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).leaderData=[],n.isInited=!1,n}return T(o,[{key:"init",value:function(n){var w=this,k=mz.getPlayerId();this.leaderData=mN.vals(n.leaders).reduce(function(n,w){if(w.playerId!==k&&w.score>0){var C={score:w.score,rank:w.rank};n.push(C)}return n},[]),this.leaderData.sort(function(n,w){return n.score-w.score}),this.leaderData.forEach(function(n,k){n.rank=w.leaderData.length-k}),this.isInited=!0}}]),o}(eO))||mC;ew._RF.pop(),ew._RF.push({},"2b89dXjcudIaZRJFuh5TAAI","InterstitialAdIndicator",void 0);var mF=eS.ccclass,mx=eS.property,mU=["ads.interNotice.backInSec","ads.interNotice.hangTight","ads.interNotice.quickAd"];var mG,mH=GameCore.Configs.Ads.NotifyPlayerBeforeShow,mV=(m_=mF("InterstitialAdIndicator"),mA=z.required(),mT=mx(eH),mP=z.required(),mR=mx(K),m_((mO=n((mL=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"uiOpacity",mO,A(n)),_(n,"labelLocalizer",mD,A(n)),n}return T(u,[{key:"__preload",value:function(){z.validateRequiredProperties(this)}},{key:"flash",value:(I=M(function(){var n,w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:if(!1===mH)return[2,Promise.resolve()];null===(n=this.signal)||void 0===n||n.abort();k=new F;this.signal=k,this.labelLocalizer.key=(w=Math.floor(Math.random()*mU.length),mU[w]);C=ez(this.uiOpacity).to(.25,{opacity:255},{easing:"linear"}).delay(.25).to(.25,{opacity:100},{easing:"linear"}).delay(.125);return[4,N.runTweenAsync(ez(this.uiOpacity).repeat(2,C).to(.25,{opacity:0},{easing:"linear"}),k)];case 1:_.sent(),this.uiOpacity.opacity=0;return[2]}})}),function(){return I.apply(this,arguments)})}]),u}(eO)).prototype,"uiOpacity",[mA,mT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mD=n(mL.prototype,"labelLocalizer",[mP,mR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mI=mL))||mI);ew._RF.pop(),ew._RF.push({},"dfab8xSeglD/abIKphEhi4g","ComboContainer",void 0);var mq,mW=eS.ccclass,mK=GameCore.Match.Modes,mj=mW("ComboContainer")(mG=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"__preload",value:function(){this.widget=this.node.getComponent(eN)}},{key:"onLoad",value:function(){z.lazyValidateProperties(this)}},{key:"updateStatus",value:function(){sQ.getMatchMode()===mK.TOURNAMENT?this.widget.top=180:this.widget.top=160}}]),o}(eO))||mG;ew._RF.pop(),ew._RF.push({},"ed00dMDxYRJP4fZMawN9JnW","ComboProgressBar",void 0);var mY,mX,mZ,mJ,mQ,m$,m0,m1,m2,m4,m3,m5,m6,m8,m9,m7,be,bt,bn,bi,ba,br,bo,bs,bl,bu,bc=eS.ccclass,bh=bc("ComboProgressBar")(mq=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"start",value:function(){this.progressBar=this.getComponent(rw),this.opacity=this.getComponent(eH),this.comboTimer=0,this.isActive=!1,this.node.scene.on(i9.COMBO_UPDATED,this.handleComboUpdated,this)}},{key:"update",value:function(n){this.isActive&&(this.comboTimer>0?(this.comboTimer-=n,this.progressBar.progress=this.comboTimer/2):(this.isActive=!1,this.opacity.opacity=0,this.node.scene.emit(i9.COMBO_ENDED)))}},{key:"handleComboUpdated",value:function(n){0===n?this.opacity.opacity=0:n>0&&(this.isActive=!0,this.comboTimer=2),n>1&&(this.opacity.opacity=255)}},{key:"pause",value:function(){this.isActive=!1}},{key:"resume",value:function(){this.isActive=!0}}]),o}(eO))||mq;ew._RF.pop(),ew._RF.push({},"c3d9fl9+INO3ac7Q2zvmRKy","SpecialItem",void 0);var bp,bd,by,bf,bv,bg,bm,bb=eS.ccclass,bw=eS.property,bS=(Y(mY={},X.HINT,"item.hintDesc"),Y(mY,X.PLIERS,"item.pliersDesc"),Y(mY,X.STORM,"item.stormDesc"),Y(mY,X.THUNDER,"item.thunderDesc"),mY),bk=(mX=bb("SpecialItem"),mZ=bw({editorOnly:!0,tooltip:"A debug button has infinite quantity"}),mJ=z.required,mQ=bw({type:eI,tooltip:"The button that activates the item"}),m$=bw({type:eD,group:"Quantity",tooltip:"The starting quantity of the item",displayName:"Quantity"}),m0=z.required,m1=bw({type:eT,group:"Quantity",tooltip:"The label that shows the quantity",displayName:"Label"}),m2=z.required,m4=bw({type:ek,group:"Quantity",tooltip:"The node that shows the quantity of the item",displayName:"Quantity node"}),m3=z.required,m5=bw({type:ek,group:"Quantity",tooltip:"The node that shows the plus icon when there is no item",displayName:"Plus node"}),m6=z.required,m8=bw({type:eH,group:"Animation"}),m9=z.required,m7=bw({type:eH,tooltip:"The opacity component of the button",displayName:"Button UI Opacity"}),mX((bn=n((bt=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"isDevButton",bn,A(n)),_(n,"button",bi,A(n)),_(n,"quantity",ba,A(n)),_(n,"quantityLabel",br,A(n)),_(n,"quantityNode",bo,A(n)),_(n,"plusNode",bs,A(n)),_(n,"glowUIOpacity",bl,A(n)),_(n,"uiOpacity",bu,A(n)),n.vibrateComp=null,n}return T(c,[{key:"itemType",get:function(){}},{key:"onLoad",value:function(){z.validateRequiredProperties(this,c)}},{key:"updateStatus",value:function(n){var w;if(void 0!==this.itemType){var k=null===(w=n.items)||void 0===w?void 0:w[this.itemType];k&&(this.setActiveStatus(k.canActivate),this.setQuantity(k.quantity,k.animate))}}},{key:"setActiveStatus",value:function(n){var w;null===(w=this.signal)||void 0===w||w.abort();var k=new F;this.signal=k,this.button.interactable=n,N.runTweenAsync(ez(this.uiOpacity).to(.2,{opacity:n?255:128}),k)}},{key:"activate",value:(L=M(function(){return _ts_generator(this,function(n){this.quantity<=0?this.requestItem():(this.vibrate(),this.node.scene.emit(i9.USE_ITEM,this.itemType));return[2]})}),function(){return L.apply(this,arguments)})},{key:"setQuantity",value:function(n,w){var k=arguments.length>1&&void 0!==w&&w,C=n;if(this.isDevButton)return this.quantityLabel.string="i",this.quantityNode.active=!0,void(this.plusNode.active=!1);C=Math.max(0,C),this.quantity=C,this.quantityLabel.string="".concat(this.quantity),C<=0?(this.quantityNode.active=!1,this.plusNode.active=!0):(this.quantityNode.active=!0,this.plusNode.active=!1),k&&this.animateAddItem()}},{key:"requestItem",value:function(){void 0!==this.itemType?en.openScreen(ei.GET_ITEM_SCREEN,{item:this.itemType,localizedMessageKey:bS[this.itemType],quantity:1}):console.warn("Item type is not defined")}},{key:"vibrate",value:function(){var n,w;this.vibrateComp=null!==(n=this.vibrateComp)&&void 0!==n?n:this.node.getComponent(sg),null===(w=this.vibrateComp)||void 0===w||w.vibrate(50)}},{key:"animateAddItem",value:(I=M(function(){return _ts_generator(this,function(n){return[2,(this.glowUIOpacity.opacity=0,Promise.all([N.runTweenAsync(ez(this.node).to(.1,{scale:new eQ(1.15,1.15,1.15)},{easing:"cubicOut"}).delay(.2).to(.7,{scale:eQ.ONE},{easing:"elasticOut"})),N.runTweenAsync(ez(this.glowUIOpacity).to(.1,{opacity:100}).delay(.2).to(.6,{opacity:0}))]))]})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"isDevButton",[mZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bi=n(bt.prototype,"button",[mJ,mQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ba=n(bt.prototype,"quantity",[m$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),br=n(bt.prototype,"quantityLabel",[m0,m1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bo=n(bt.prototype,"quantityNode",[m2,m4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bs=n(bt.prototype,"plusNode",[m3,m5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=n(bt.prototype,"glowUIOpacity",[m6,m8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bu=n(bt.prototype,"uiOpacity",[m9,m7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be=bt))||be);ew._RF.pop(),ew._RF.push({},"9e40aEq56tMKLFoeACyl+eH","Clock",void 0);var bC=eS.ccclass,bE=eS.disallowMultiple,b_=eS.property,bA=(bp=bC("Clock"),bd=b_(ek),by=b_(eT),bp(bf=bE((bg=n((bv=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"clockIcon",bg,A(n)),_(n,"timeLabel",bm,A(n)),n}return T(c,[{key:"__preload",value:function(){this.node.scene.on(i9.TIME_UPDATED,this.updateTimeLabel,this),this.node.scene.on(i9.RESCUE_START,this.handleRescueStart,this),this.node.scene.on(i9.RESCUE_FINISHED,this.handleRescueFinished,this)}},{key:"updateStatus",value:function(n){n.time&&this.updateTimeLabel(n.time)}},{key:"updateTimeLabel",value:function(n){var w=this.convertSecondsToMmSs(n);this.timeLabel.string=w}},{key:"convertSecondsToMmSs",value:function(n){var w=Math.floor(n/60),k=Math.floor(n%60),C=this.padZero(w),_=this.padZero(k);return"".concat(C,":").concat(_)}},{key:"padZero",value:function(n){return n<10?"0".concat(n):"".concat(n)}},{key:"handleRescueStart",value:(L=M(function(){var n,w,k;return _ts_generator(this,function(C){n=ez(this.node).to(.5,{scale:new eQ(1.1,1.1,1)}),w=ez(this.clockIcon).to(.15,{angle:-15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}).to(.15,{angle:15},{easing:"cubicOut"}).to(.15,{angle:0},{easing:"cubicIn"}),k=ez(this.clockIcon).repeat(5,w);N.runTweenAsync(k),N.runTweenAsync(n);return[2]})}),function(){return L.apply(this,arguments)})},{key:"handleRescueFinished",value:(I=M(function(){var n;return _ts_generator(this,function(w){n=ez(this.node).to(.5,{scale:new eQ(1,1,1)});N.runTweenAsync(n);return[2]})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"clockIcon",[bd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bm=n(bv.prototype,"timeLabel",[by],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bf=bv))||bf)||bf);ew._RF.pop(),ew._RF.push({},"af947t5g91EkZVWXv5upZaV","CacheUtils",void 0);var bT,bP,bR,bI,bL,bO,bD,bM,bN,bz,bB,bF=GameCore.Utils.Image,bx=globalThis.game.frameCapture,bU=function(){function e(){C(this,e)}var n,w,k;return T(e,null,[{key:"inst",get:function(){return this._instance||(this._instance=new e),this._instance}},{key:"getPlayerAvatar",value:(k=M(function(n,w,k,C){var _,A;return _ts_generator(this,function(T){switch(T.label){case 0:_=this.playerAvatarCache.get("".concat(w,":").concat(k));A=_;if(A)return[3,2];return[4,this.loadPlayerAvatar(n,w,k,C)];case 1:A=_=T.sent();T.label=2;case 2:return[2,_]}})}),function(n,w,C,_){return k.apply(this,arguments)})},{key:"loadPlayerAvatar",value:(w=M(function(n,w,k,C){var _,A;return _ts_generator(this,function(T){switch(T.label){case 0:return[4,this.loadImage(n,k,k,"".concat(w,":").concat(k))];case 1:_=T.sent();if((null==C||!C.aborted)&&_){A=e9.createWithImage(_);return[2,(this.playerAvatarCache.set("".concat(w,":").concat(k),A),A)]}return[2]}})}),function(n,k,C,_){return w.apply(this,arguments)})},{key:"isAvatarCached",value:function(n,w){return this.playerAvatarCache.has("".concat(n,":").concat(w))}},{key:"loadImage",value:(n=M(function(n,w,k,C){var _,A;return _ts_generator(this,function(T){switch(T.label){case 0:T.trys.push([0,5,,6]);return[4,bx.captureAsync({width:w,height:k,name:"LeaderAvatar",renderOptions:Y({},C,{name:C,type:"image",depth:0,position:[0,0],size:[w,k],image:n})})];case 1:_=T.sent();if(!_)return[3,3];return[4,bF.loadImage(_)];case 2:A=T.sent();return[3,4];case 3:A=null;T.label=4;case 4:return[2,A];case 5:T.sent();return[2,null];case 6:return[2]}})}),function(w,k,C,_){return n.apply(this,arguments)})}]),e}();bU.playerAvatarCache=new Map;try{new bU}catch(n){console.error("CacheUtils",n)}ew._RF.pop(),ew._RF.push({},"540108ucKBPYbN9gW5TFh/q","LeaderRail",void 0);var bG,bH,bV,bq,bW,bK=eS.ccclass,bj=eS.property,bY=(bT=bK("LeaderRail"),bP=bj(eT),bR=bj(ek),bI=bj(ex),bL=bj(yg),bT((bM=n((bD=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"scoreLabel",bM,A(n)),_(n,"crown",bN,A(n)),_(n,"avatar",bz,A(n)),_(n,"spark",bB,A(n)),n.score=0,n}return T(c,[{key:"__preload",value:function(){this.defaultAvatar=this.avatar.spriteFrame,this.uiOpacity=this.getComponent(eH)}},{key:"updateScore",value:(L=M(function(n,w){var k,C,_,A,T;var I=arguments;return _ts_generator(this,function(L){switch(L.label){case 0:k=this,C=I.length>2&&void 0!==I[2]&&I[2],_=n-this.score,A=C?0:.5,T=ez(this.node).to(A,{},{onUpdate:function(n,w){if(w){var C=Math.floor(_*w)+k.score;k.scoreLabel.string=C.toString()}}});return[4,N.runTweenAsync(T,w)];case 1:L.sent(),this.score=n,this.scoreLabel.string=n.toString();return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"updatePhoto",value:(I=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=GameSDK.player.getPhoto(),w=GameSDK.player.getID();if(!(n&&w))return[3,2];return[4,bU.getPlayerAvatar(n,w,50)];case 1:k=C.sent();k?(k.packable=!0,this.avatar.spriteFrame=k):this.avatar.spriteFrame=this.defaultAvatar;C.label=2;case 2:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"setCrown",value:function(n){this.crown.active=n}},{key:"setOpacity",value:function(n){this.uiOpacity.opacity=n}},{key:"playSparkParticle",value:function(){this.spark.play()}},{key:"stopSparkParticle",value:function(){this.spark.stop()}}]),c}(eO)).prototype,"scoreLabel",[bP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bN=n(bD.prototype,"crown",[bR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bz=n(bD.prototype,"avatar",[bI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bB=n(bD.prototype,"spark",[bL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bO=bD))||bO);ew._RF.pop(),ew._RF.push({},"00759vwS/dHS6GvHKvVE5Q1","TournamentProgressBar",void 0);var bX,bZ,bJ,bQ,b$,b0,b1,b2,b4,b3,b5,b6,b8,b9,b7,we,wt=eS.ccclass,wn=eS.property,wi=474,wa=(bG=wt("TournamentProgressBar"),bH=wn(bY),bG((bW=n((bq=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"playerLeader",bW,A(n)),n.onUpdate=function(){n.playerLeader&&n.playerLeader.node&&(n.playerLeader.node.position=new eQ(n.progressBar.progress*wi-237,0,0))},n}return T(u,[{key:"__preload",value:function(){this.progressBar=this.getComponent(e2)}},{key:"updateProgress",value:(I=M(function(n,w){var k,C,_;var A=arguments;return _ts_generator(this,function(T){switch(T.label){case 0:k=A.length>2&&void 0!==A[2]?A[2]:.5,C=A.length>3&&void 0!==A[3]?A[3]:"cubicOut",_=ez(this.progressBar).to(k,{progress:n},{easing:C,onUpdate:this.onUpdate});return[4,N.runTweenAsync(_,w)];case 1:T.sent();return[2]}})}),function(n,w){return I.apply(this,arguments)})},{key:"getProgress",value:function(){return this.progressBar.progress}}]),u}(eO)).prototype,"playerLeader",[bH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bV=bq))||bV);ew._RF.pop(),ew._RF.push({},"16d68fBLT1Ha7lXADThDtfC","TournamentRail",void 0);var wr,wo,ws,wl,wu,wc,wh,wp,wd,wy=eS.ccclass,wf=eS.property,wv=GameCore,wg=wv.Utils.Array,wm=wv.Match.Modes,wb=(bX=wy("TournamentRail"),bZ=wf(wa),bJ=wf(bY),bQ=wf(ek),b$=wf(ek),b0=wf(K),b1=wf(K),b2=z.onlyRunInLifeCycleAsync,bX((b5=n((b3=function(n){w(v,n);var I,L,O,D,z,B=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"progressBar",b5,A(n)),_(n,"playerLeader",b6,A(n)),_(n,"flag",b8,A(n)),_(n,"sword",b9,A(n)),_(n,"currentRankLocalizer",b7,A(n)),_(n,"nextRankLocalizer",we,A(n)),n.nextLeaderIndex=0,n.score=0,n.minScore=0,n.maxScore=0,n.signal=new F,n}return T(v,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(eH),this.playerLeader.updatePhoto()}},{key:"updateStatus",value:(z=M(function(n){var w,k,C;return _ts_generator(this,function(_){if(sQ.getMatchMode()===wm.TOURNAMENT){this.signal.abort();k=new F;this.signal=k,this.uiOpacity.opacity=255,this.score=null!==(w=n.score)&&void 0!==w?w:this.score;C=n.leaderData;C&&(this.nextLeaderIndex=this.getScoreReachedLeaderIndex(this.score,C),this.syncRail(C,k,!0))}else this.uiOpacity.opacity=0;return[2]})}),function(n){return z.apply(this,arguments)})},{key:"syncRail",value:(D=M(function(n,w){var k,C,_,A,T,I,L;var O=arguments;return _ts_generator(this,function(D){switch(D.label){case 0:k=O.length>2&&void 0!==O[2]&&O[2],C=n[this.nextLeaderIndex-1],_=n[this.nextLeaderIndex],A=C?C.rank:_?_.rank+1:1;this.setRankLabel(A,this.currentRankLocalizer);T=!_;this.nextRankLocalizer.node.active=!T,this.runActiveAnimation(this.sword,!T,w,k),this.playerLeader.setCrown(T),this.playerLeader.updateScore(this.score,w,k);I=k?0:void 0;if(!T)return[3,2];this.playerLeader.playSparkParticle();return[4,this.progressBar.updateProgress(1,w,I)];case 1:D.sent();return[3,4];case 2:this.playerLeader.stopSparkParticle(),this.setRankLabel(_.rank,this.nextRankLocalizer),this.minScore=C?C.score:0,this.maxScore=_.score;L=(this.score-this.minScore)/(this.maxScore-this.minScore);L=.8*L+.1;return[4,this.progressBar.updateProgress(L,w,I)];case 3:D.sent();D.label=4;case 4:return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"handleScoreUpdated",value:(O=M(function(n){var w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:w=n.score,k=n.leaderData;if(!(void 0!==w&&k&&this.score!==w))return[3,4];this.signal.abort();C=new F;this.signal=C,this.score=w;_=this.getScoreReachedLeaderIndex(w,k);if(!(_>this.nextLeaderIndex))return[3,3];this.nextLeaderIndex=_;A=(1-this.progressBar.getProgress())/1.5;A=Math.min(A,.5);return[4,this.progressBar.updateProgress(1,C,A,"cubicIn")];case 1:T.sent(),this.runBubbleAnimation(this.sword,C);return[4,this.progressBar.updateProgress(0,C,0)];case 2:T.sent(),this.runBubbleAnimation(this.flag,C);T.label=3;case 3:this.syncRail(k,C);T.label=4;case 4:return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"runBubbleAnimation",value:(L=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:n.scale=eQ.ONE;k=ez(n).to(.1,{scale:new eQ(1.2,1.2,1.2)}).to(.2,{scale:eQ.ONE},{easing:"backOut"});return[4,N.runTweenAsync(k,w)];case 1:C.sent(),n.scale=eQ.ONE;return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"runActiveAnimation",value:(I=M(function(n,w,k){var C,_,A,T,I;var L=arguments;return _ts_generator(this,function(O){switch(O.label){case 0:C=L.length>3&&void 0!==L[3]&&L[3],_=w?eQ.ZERO:eQ.ONE,A=w?eQ.ONE:eQ.ZERO;if(!C)return[3,1];n.scale=A;return[3,3];case 1:if(!!n.scale.equals(A))return[3,3];T=w?"backOut":"quadOut";n.scale=_;I=ez(n).to(.1,{scale:new eQ(1.2,1.2,1.2)}).to(.2,{scale:A},{easing:T});return[4,N.runTweenAsync(I,k)];case 2:O.sent(),n.scale=A;O.label=3;case 3:return[2]}})}),function(n,w,k){return I.apply(this,arguments)})},{key:"getScoreReachedLeaderIndex",value:function(n,w){var k=wg.searchIndex(w,function(w){return w.score>=n});return -1===k?w.length:k}},{key:"setRankLabel",value:function(n,w){1!==n?2!==n?3!==n?(w.key="status.nth",w.setParams([n.toString()])):w.key="status.third":w.key="status.second":w.key="status.first"}}]),v}(eO)).prototype,"progressBar",[bZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b6=n(b3.prototype,"playerLeader",[bJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b8=n(b3.prototype,"flag",[bQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b9=n(b3.prototype,"sword",[b$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b7=n(b3.prototype,"currentRankLocalizer",[b0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),we=n(b3.prototype,"nextRankLocalizer",[b1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(b3.prototype,"updateStatus",[b2],Object.getOwnPropertyDescriptor(b3.prototype,"updateStatus"),b3.prototype),b4=b3))||b4);ew._RF.pop(),ew._RF.push({},"ac5371+oVZBLoBKwAM7rH3r","GameSceneLayout",void 0);var ww,wS,wk,wC,wE,w_,wA,wT,wP,wR=eS.ccclass,wI=eS.property,wL=(wr=wR("GameSceneLayout"),wo=wI(wb),ws=wI(bA),wl=wI(bk),wr((wh=n((wc=function(n){w(d,n);var I,O,D,N=k(d);function d(){var n;C(this,d);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=N.call.apply(N,[this].concat(k)),_(n,"tournamentRail",wh,A(n)),_(n,"clock",wp,A(n)),_(n,"items",wd,A(n)),n.isInited=!1,n.entranceSignal=new F,n.exitSignal=new F,n}return T(d,[{key:"waitForInitAsync",value:(D=M(function(){var n;return _ts_generator(this,function(w){n=this;if(!this.isInited)return[2,new Promise(function(w){var k=setInterval(function(){n.isInited&&(clearInterval(k),w())},100)})];return[2]})}),function(){return D.apply(this,arguments)})},{key:"setLevelText",value:function(n){}},{key:"disableLayout",value:function(){}},{key:"enableLayout",value:function(){}},{key:"updateStatus",value:function(n){this.clock.updateStatus(n),this.tournamentRail.updateStatus(n);var w,k=L(this.items);try{for(k.s();!(w=k.n()).done;)w.value.updateStatus(n)}catch(n){k.e(n)}finally{k.f()}}},{key:"playExitAnimUI",value:(O=M(function(){return _ts_generator(this,function(n){return[2]})}),function(){return O.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(I=M(function(){return _ts_generator(this,function(n){return[2]})}),function(){return I.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){}},{key:"unHighlightCoinContainer",value:function(){}}]),d}(eO)).prototype,"tournamentRail",[wo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wp=n(wc.prototype,"clock",[ws],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wd=n(wc.prototype,"items",[wl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),wu=wc))||wu);ew._RF.pop(),ew._RF.push({},"46f05OkhTtGz6xBJuPMZGqH","ScoreBlock",void 0);var wO,wD,wM,wN,wz,wB,wF,wx,wU,wG,wH,wV,wq,wW=eS.ccclass,wK=eS.property,wj=eS.disallowMultiple,wY=(ww=wW("ScoreBlock"),wS=wK(eT),wk=wK(eW),wC=wK({visible:function(){return this.isResizeWidth}}),ww(wE=wj((wA=n((w_=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"scoreText",wA,A(n)),_(n,"isResizeWidth",wT,A(n)),_(n,"maxScoreWidth",wP,A(n)),n.panelWidthDiff=0,n}return T(c,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(e_),this.scoreUITransform=this.scoreText.node.getComponent(e_),this.panelWidthDiff=this.uiTransform.width-this.maxScoreWidth,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateScore",value:(L=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:w=this,k=n-this.score,C=ez(this.node).to(.1,{},{onUpdate:function(n,C){if(C){var _=Math.floor(k*C)+w.score;w.scoreText.string=_.toString(),w.resizeWidth()}}});return[4,N.runTweenAsync(C)];case 1:_.sent(),this.setScore(n);return[4,this.resizeWidth()];case 2:_.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"setScore",value:function(n){var w=null!=n?n:0;this.score=w,this.scoreText.string=w.toString()}},{key:"resizeWidth",value:(I=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this;if(!this.isResizeWidth)return[3,2];w=this.uiTransform.width,k=(this.scoreUITransform.width>this.maxScoreWidth?this.scoreUITransform.width:this.maxScoreWidth)+this.panelWidthDiff;this.uiTween&&this.uiTween.stop(),this.uiTween=ez(this.node).to(.05,{},{easing:"sineOut",onUpdate:function(C,_){_&&(n.uiTransform.width=e0.lerp(w,k,_))}});return[4,N.runTweenAsync(this.uiTween)];case 1:C.sent(),this.uiTransform.width=k;C.label=2;case 2:return[2]}})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"scoreText",[wS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wT=n(w_.prototype,"isResizeWidth",[wk],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),wP=n(w_.prototype,"maxScoreWidth",[wC],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),wE=w_))||wE)||wE);ew._RF.pop(),ew._RF.push({},"b1ef276tNtH+oc5BqYfDMXl","Sidebar",void 0);var wX,wZ,wJ,wQ,w$,w0,w1,w2,w4,w3,w5,w6=eS.ccclass,w8=eS.property,w9=eS.disallowMultiple,w7=(wO=w6("Sidebar"),wD=w8(wY),wM=w8(eT),wN=w8(ek),wz=w8(ek),wB=w8(tc),wO(wF=w9((wU=n((wx=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"scoreBlock",wU,A(n)),_(n,"levelNumber",wG,A(n)),_(n,"sidebarContainer",wH,A(n)),_(n,"leavesContainer",wV,A(n)),_(n,"entranceCurve",wq,A(n)),n.originSidebarPosition=0,n.originLeavesPosition=0,n}return T(s,[{key:"onLoad",value:function(){this.node.scene.on(i9.SCORE_UPDATED,this.updateScore,this)}},{key:"onDestroy",value:function(){this.node.scene.off(i9.SCORE_UPDATED,this.updateScore,this)}},{key:"saveOriginPos",value:function(){this.originSidebarPosition=this.sidebarContainer.position.y,this.originLeavesPosition=this.leavesContainer.position.y}},{key:"initUIPos",value:function(){this.sidebarContainer.setPosition(this.sidebarContainer.position.x,this.originSidebarPosition+1200),this.leavesContainer.setPosition(this.leavesContainer.position.x,this.originLeavesPosition+150)}},{key:"playExitAnimUI",value:function(n){var w=ez(this.sidebarContainer).to(.2,{position:new eQ(this.sidebarContainer.position.x,this.originSidebarPosition+1200,0)},{easing:"quadIn"}),k=ez(this.leavesContainer);return k.delay(.1).to(.2,{position:new eQ(this.leavesContainer.position.x,this.originLeavesPosition+150,0)},{easing:"quadIn"}),[N.runTweenAsync(w,n),N.runTweenAsync(k,n)]}},{key:"playEntranceAnimUI",value:function(n){var w=this,k=ez(this.sidebarContainer).to(.3,{position:new eQ(this.sidebarContainer.position.x,this.originSidebarPosition,0)},{easing:function(n){return w.entranceCurve.evaluate(n)}}),C=ez(this.leavesContainer);return C.to(.2,{position:new eQ(this.leavesContainer.position.x,this.originLeavesPosition,0)},{easing:"quadIn"}),[N.runTweenAsync(k,n),N.runTweenAsync(C,n)]}},{key:"setLevelText",value:function(n){this.levelNumber.string=n.toString()}},{key:"updateStatus",value:function(n){this.scoreBlock.setScore(n.score),n.level&&this.setLevelText(n.level)}},{key:"updateScore",value:function(n){this.scoreBlock.updateScore(n)}}]),s}(eO)).prototype,"scoreBlock",[wD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wG=n(wx.prototype,"levelNumber",[wM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wH=n(wx.prototype,"sidebarContainer",[wN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wV=n(wx.prototype,"leavesContainer",[wz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wq=n(wx.prototype,"entranceCurve",[wB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new tc}}),wF=wx))||wF)||wF);ew._RF.pop(),ew._RF.push({},"0ff4fFbKylIvaONtaTZkRQV","LandscapeLayout",void 0);var Se,St,Sn,Si,Sa,Sr,So,Ss=eS.ccclass,Sl=eS.property,Su=(wX=Ss("LandscapeLayout"),wZ=Sl(w7),wJ=Sl(ek),wQ=Sl(ek),w$=Sl(ek),wX((w2=n((w1=function(n){w(v,n);var I,z,B=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"sidebar",w2,A(n)),_(n,"tournamentContainer",w4,A(n)),_(n,"leftAnimNodes",w3,A(n)),n.originLeftNodesPos=[],_(n,"rightAnimNodes",w5,A(n)),n.originRightNodesPos=[],n}return T(v,[{key:"onLoad",value:function(){var n=this;eL.once(e5.EVENT_AFTER_UPDATE,function(){n.saveOriginPos(),n.initUIPos(),n.isInited=!0})}},{key:"saveOriginPos",value:function(){this.sidebar.saveOriginPos();var n,w=L(this.leftAnimNodes);try{for(w.s();!(n=w.n()).done;){var k=n.value;this.originLeftNodesPos.push(k.position.clone())}}catch(n){w.e(n)}finally{w.f()}var C,_=L(this.rightAnimNodes);try{for(_.s();!(C=_.n()).done;){var A=C.value;this.originRightNodesPos.push(A.position.clone())}}catch(n){_.e(n)}finally{_.f()}}},{key:"initUIPos",value:function(){var n=this;this.sidebar.initUIPos(),this.leftAnimNodes.forEach(function(w,k){var C=n.originLeftNodesPos[k].clone();C.y+=1200,w.setPosition(C)}),this.rightAnimNodes.forEach(function(w,k){var C=n.originRightNodesPos[k].clone();C.x+=750,w.setPosition(C)})}},{key:"playExitAnimUI",value:(z=M(function(){var n,w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:n=this,w=C.length>0&&void 0!==C[0]?C[0]:.2;this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new F;k=[];this.leftAnimNodes.forEach(function(C,_){var A=new eQ(n.node.position.x,n.originLeftNodesPos[_].y+1200,0),T=ez(C);T.to(w,{position:A},{easing:"quadIn"}),k.push(N.runTweenAsync(T,n.exitSignal))}),this.rightAnimNodes.forEach(function(C,_){var A=new eQ(n.originRightNodesPos[_].x+750,C.position.y,0),T=ez(C);T.to(w,{position:A},{easing:"backIn"}),k.push(N.runTweenAsync(T,n.exitSignal))}),k.push.apply(k,j(this.sidebar.playExitAnimUI(this.exitSignal)));return[4,Promise.all(k)];case 1:_.sent();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(I=M(function(){var n,w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:n=this,w=C.length>0&&void 0!==C[0]?C[0]:.4;this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new F;k=[];this.leftAnimNodes.forEach(function(C,_){var A=new eQ(n.node.position.x,n.originLeftNodesPos[_].y,0),T=ez(C);T.to(w,{position:A},{easing:"quadOut"}),k.push(N.runTweenAsync(T,n.entranceSignal))}),this.rightAnimNodes.forEach(function(C,_){var A=new eQ(n.originRightNodesPos[_].x,C.position.y,0),T=ez(C);T.to(w,{position:A},{easing:"backOut"}),k.push(N.runTweenAsync(T,n.entranceSignal))}),k.push.apply(k,j(this.sidebar.playEntranceAnimUI(this.entranceSignal)));return[4,Promise.all(k)];case 1:_.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"setLevelText",value:function(n){this.sidebar.setLevelText(n)}},{key:"updateStatus",value:function(n){O(D(v.prototype),"updateStatus",this).call(this,n),this.sidebar.updateStatus(n)}}]),v}(wL)).prototype,"sidebar",[wZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w4=n(w1.prototype,"tournamentContainer",[wJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w3=n(w1.prototype,"leftAnimNodes",[wQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w5=n(w1.prototype,"rightAnimNodes",[w$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),w0=w1))||w0);ew._RF.pop(),ew._RF.push({},"396015KIPBL3bHTUOHN7pCl","UIMasks",void 0);var Sh,Sp,Sd,Sy,Sf,Sv,Sg,Sm=eS.ccclass,Sb=eS.property,Sw=(Se=Sm("UIMasks"),St=Sb(i_),Sn=Sb(vM),Se((Sr=n((Sa=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"background",Sr,A(n)),_(n,"alphaMasks",So,A(n)),n}return T(c,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"show",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:this.alphaMasks.setMaskActive(0,s5.isPortrait()),this.alphaMasks.setMaskActive(1,s5.isLandscape()),this.background.node.active=!0;return[4,this.background.changeStateFade(!0,.25)];case 1:n.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"hide",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.background.changeStateFade(!1,.25)];case 1:n.sent(),this.background.node.active=!1;return[2]}})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"background",[St],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),So=n(Sa.prototype,"alphaMasks",[Sn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Si=Sa))||Si);ew._RF.pop(),ew._RF.push({},"424745QWUlDPabdCe8UcRwy","ChallengeScoreBlock",void 0);var SS,Sk,SC,SE,S_,SA,ST,SP,SR,SI=eS.ccclass,SO=eS.property,SD=(Sh=SI("ChallengeScoreBlock"),Sp=SO(ex),Sd=SO(e9),Sh((Sv=n((Sf=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"avatar",Sv,A(n)),_(n,"defaultAvatar",Sg,A(n)),n}return T(u,[{key:"updateInfo",value:(I=M(function(n,w,k){var C,_;return _ts_generator(this,function(A){switch(A.label){case 0:C=this;this.setScore(k),this.scheduleOnce(function(){return C.resizeWidth()},0);A.label=1;case 1:A.trys.push([1,3,,4]);return[4,bU.getPlayerAvatar(n,w,50)];case 2:_=A.sent();if(!_)return[2];_.packable=!0,this.avatar.spriteFrame=_;return[3,4];case 3:A.sent();this.avatar.spriteFrame=this.defaultAvatar;return[3,4];case 4:return[2]}})}),function(n,w,k){return I.apply(this,arguments)})}]),u}(wY)).prototype,"avatar",[Sp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sg=n(Sf.prototype,"defaultAvatar",[Sd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sy=Sf))||Sy);ew._RF.pop(),ew._RF.push({},"f963aJjCvtD0Y2LplwjDer1","ScoreContainer",void 0);var SM,SN,Sz,SB,SF,Sx,SU,SG,SH,SV,Sq,SW,SK,Sj,SY,SX,SZ=eS.ccclass,SJ=eS.property,SQ=GameCore.Match.Modes,S$=globalThis.game.match,S0=(SS=SZ("ScoreContainer"),Sk=SJ(wY),SC=SJ(SD),SE=SJ(SD),SS((ST=n((SA=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"scoreBlock",ST,A(n)),_(n,"playerScoreBlock",SP,A(n)),_(n,"opponentScoreBlock",SR,A(n)),n.scoreBlockShown=!1,n.challengeScoreBlockShown=!1,n}return T(s,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"onDestroy",value:function(){this.unlistenGameEvents()}},{key:"listenGameEvents",value:function(){this.node.scene.on(i9.SCORE_UPDATED,this.updateScore,this)}},{key:"unlistenGameEvents",value:function(){this.node.scene.off(i9.SCORE_UPDATED,this.updateScore,this)}},{key:"updateStatus",value:function(n){switch(S$.getMatchState().mode){case SQ.CHALLENGE_FRIEND:this.showChallengeScoreBlock(),this.hideScoreBlock(),this.playerScoreBlock.setScore(n.score);break;case SQ.SINGLE:this.hideChallengeScoreBlock(),this.showScoreBlock(),this.scoreBlock.setScore(n.score);break;default:this.hideScoreBlock(),this.hideChallengeScoreBlock()}}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"showChallengeScoreBlock",value:function(){var n;if(!this.challengeScoreBlockShown){this.challengeScoreBlockShown=!0;var w=S$.getMatchState(),k=null!==(n=sQ.getMatchCustomData())&&void 0!==n?n:{},C=k.playerId,_=k.opponentId;if(C&&_){this.playerScoreBlock.node.active=!0,this.opponentScoreBlock.node.active=!0;var A=w.profiles[C],T=w.profiles[_];this.playerScoreBlock.updateInfo(A.photo,C,A.score),this.opponentScoreBlock.updateInfo(T.photo,_,T.score)}}}},{key:"hideChallengeScoreBlock",value:function(){this.challengeScoreBlockShown&&(this.challengeScoreBlockShown=!1,this.playerScoreBlock.node.active=!1,this.opponentScoreBlock.node.active=!1)}},{key:"showScoreBlock",value:function(){var n;if(!this.scoreBlockShown){this.scoreBlockShown=!0;var w=(null!==(n=sQ.getMatchCustomData())&&void 0!==n?n:{}).score;this.scoreBlock.node.active=!0,this.scoreBlock.setScore(w)}}},{key:"hideScoreBlock",value:function(){this.scoreBlockShown&&(this.scoreBlockShown=!1,this.scoreBlock.node.active=!1)}},{key:"updateScore",value:function(n){this.challengeScoreBlockShown?this.playerScoreBlock.updateScore(n):this.scoreBlockShown&&this.scoreBlock.updateScore(n)}}]),s}(eO)).prototype,"scoreBlock",[Sk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SP=n(SA.prototype,"playerScoreBlock",[SC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SR=n(SA.prototype,"opponentScoreBlock",[SE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S_=SA))||S_);ew._RF.pop(),ew._RF.push({},"61791zAr2tJR4p22EZ5QRfk","Header",void 0);var S1,S2,S4,S3,S5,S6,S8,S9,S7,ke=eS.ccclass,kt=eS.property,kn=(SM=ke("Header"),SN=kt(K),Sz=kt(ek),SB=kt(ek),SF=kt(ek),Sx=kt(ek),SU=kt(S0),SG=z.onlyRunInLifeCycle,SM((Sq=n((SV=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"levelTextLocalizer",Sq,A(n)),_(n,"settingNode",SW,A(n)),_(n,"homeNode",SK,A(n)),_(n,"leftNode",Sj,A(n)),_(n,"coinNode",SY,A(n)),_(n,"scoreContainer",SX,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.uiOpacity=this.node.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateStatus",value:function(n){this.scoreContainer.updateStatus(n),n.level&&this.setLevelText(n.level)}},{key:"highlightCoinContainer",value:function(){var n=tr("Canvas/Screens");if(n){var w=this.coinNode.worldPosition.clone();this.coinNode.parent=n,this.coinNode.worldPosition=w}}},{key:"removeCoinContainerHighlight",value:function(){var n=this.coinNode.worldPosition.clone();this.coinNode.parent=this.leftNode,this.coinNode.worldPosition=n}},{key:"setLevelText",value:function(n){this.levelTextLocalizer.setParams([n.toString()])}},{key:"setButtonsInteractable",value:function(n){var w=!(arguments.length>0&&void 0!==n)||n;this.settingNode.getComponent(eI).interactable=w,this.homeNode.getComponent(eI).interactable=w}},{key:"setActive",value:function(n){this.uiOpacity.opacity=n?255:0}}]),s}(eO)).prototype,"levelTextLocalizer",[SN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SW=n(SV.prototype,"settingNode",[Sz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SK=n(SV.prototype,"homeNode",[SB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sj=n(SV.prototype,"leftNode",[SF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SY=n(SV.prototype,"coinNode",[Sx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SX=n(SV.prototype,"scoreContainer",[SU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(SV.prototype,"setActive",[SG],Object.getOwnPropertyDescriptor(SV.prototype,"setActive"),SV.prototype),SH=SV))||SH);ew._RF.pop(),ew._RF.push({},"456584ngz9FupmxndAXqCbY","PortraitLayout",void 0);var ki=eS.ccclass,ka=eS.property,kr=(S1=ki("PortraitLayout"),S2=ka(kn),S4=ka([ek]),S3=ka([ek]),S1((S8=n((S6=function(n){w(g,n);var I,B,x=k(g);function g(){var n;C(this,g);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=x.call.apply(x,[this].concat(k)),_(n,"header",S8,A(n)),_(n,"topAnimNodes",S9,A(n)),n.originTopNodesPos=[],_(n,"botAnimNodes",S7,A(n)),n.originBotNodesPos=[],n.hideBotWorldY=-80,n}return T(g,[{key:"onLoad",value:function(){var n=this;this.validateRequiredComponents(),eL.once(e5.EVENT_AFTER_UPDATE,function(){n.saveOriginPos(),n.initUIPos(),n.isInited=!0})}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"saveOriginPos",value:function(){var n,w=L(this.topAnimNodes);try{for(w.s();!(n=w.n()).done;){var k=n.value;this.originTopNodesPos.push(k.position.clone())}}catch(n){w.e(n)}finally{w.f()}var C,_=L(this.botAnimNodes);try{for(_.s();!(C=_.n()).done;){var A=C.value;this.originBotNodesPos.push(A.position.clone())}}catch(n){_.e(n)}finally{_.f()}}},{key:"initUIPos",value:function(){var n=this;this.topAnimNodes.forEach(function(w,k){var C=n.originTopNodesPos[k].clone();C.y+=200,w.setPosition(C)});var w=new eQ(0,this.hideBotWorldY,0);this.botAnimNodes.forEach(function(k,C){var _,A,T=n.originBotNodesPos[C].clone();w.y=n.hideBotWorldY;var I=null!==(_=null===(A=k.parent)||void 0===A?void 0:A.inverseTransformPoint(w,w).y)&&void 0!==_?_:200;T.y=I,k.setPosition(T)})}},{key:"setLevelText",value:function(n){this.header.setLevelText(n)}},{key:"disableLayout",value:function(){this.header.setButtonsInteractable(!1)}},{key:"enableLayout",value:function(){this.header.setButtonsInteractable()}},{key:"updateStatus",value:function(n){O(D(g.prototype),"updateStatus",this).call(this,n),this.header.updateStatus(n)}},{key:"playExitAnimUI",value:(B=M(function(){var n,w,k,C,_,A,T,I,O,D,M,z;var B=arguments;return _ts_generator(this,function(x){switch(x.label){case 0:n=this,w=B.length>0&&void 0!==B[0]?B[0]:.17;this.entranceSignal.abort(),this.exitSignal.abort(),this.exitSignal=new F;k=[];this.topAnimNodes.forEach(function(C,_){var A=new eQ(C.position.x,n.originTopNodesPos[_].y+200,0),T=ez(C);T.to(w,{position:A},{easing:"backIn"}),k.push(N.runTweenAsync(T,n.exitSignal))});_=new eQ(0,this.hideBotWorldY,0),A=L(this.botAnimNodes);try{for(A.s();!(C=A.n()).done;){O=C.value;_.y=this.hideBotWorldY;D=null!==(T=null===(I=O.parent)||void 0===I?void 0:I.inverseTransformPoint(_,_).y)&&void 0!==T?T:200,M=new eQ(O.position.x,D,0),z=ez(O);z.to(w,{position:M},{easing:"backIn"}),k.push(N.runTweenAsync(z,this.exitSignal))}}catch(n){A.e(n)}finally{A.f()}return[4,Promise.all(k)];case 1:x.sent(),this.exitSignal.aborted||this.header.setActive(!1);return[2]}})}),function(){return B.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(I=M(function(){var n,w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:n=this,w=C.length>0&&void 0!==C[0]?C[0]:.2;this.exitSignal.abort(),this.entranceSignal.abort(),this.entranceSignal=new F,this.header.setActive(!0);k=[];this.topAnimNodes.forEach(function(C,_){var A=new eQ(C.position.x,n.originTopNodesPos[_].y,0),T=ez(C);T.to(w,{position:A},{easing:"backOut"}),k.push(N.runTweenAsync(T,n.entranceSignal))}),this.botAnimNodes.forEach(function(C,_){var A=new eQ(C.position.x,n.originBotNodesPos[_].y,0),T=ez(C);T.to(w,{position:A},{easing:"backOut"}),k.push(N.runTweenAsync(T,n.entranceSignal))});return[4,Promise.all(k)];case 1:_.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.header.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.header.removeCoinContainerHighlight()}}]),g}(wL)).prototype,"header",[S2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S9=n(S6.prototype,"topAnimNodes",[S4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S7=n(S6.prototype,"botAnimNodes",[S3],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),S5=S6))||S5);ew._RF.pop(),ew._RF.push({},"805dbJxaCpKBpzq9ejSgrc8","TileType",void 0);var ko,ks,kl,ku,kp,kd="bomb";ew._RF.pop(),ew._RF.push({},"151afQBVDpOYpTjtwP+wYH+","DevTools",void 0);var ky,kv,kg,km,kb,kw,kS,kk,kC,kE,k_,kA,kT,kP,kR,kI,kL,kO=GameCore,kD=kO.Dtos.Player,kM=kO.Utils.Function,kN=eS.ccclass,kz=eS.property,kB=globalThis.game,kF=kB.player,kx=kB.language,kU=Object.keys(W),kG=(ko=kN("DevToolsContainer"),ks=kz(ek),ko((kp=n((ku=function(n){w(y,n);var I,O,D,N,z=k(y);function y(){var n;C(this,y);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=z.call.apply(z,[this].concat(k)),_(n,"devToolsToggle",kp,A(n)),n.isActive=!0,n.game=null,n.bundleName="lowest",n.currentLocaleIndex=0,n.debouncedStarsNotification=kM.debounce(function(){var n=kF.getGameData();n&&en.showNotificationScreen("Stars added. Current stars: ".concat(n.stars))},700),n}return T(y,[{key:"injectGameplay",value:function(n){this.game=n}},{key:"start",value:function(){this.initCurrentLocale()}},{key:"initCurrentLocale",value:function(){var n=kx.getCurrentLocale();this.currentLocaleIndex=kU.indexOf(n)}},{key:"hideAllButtons",value:function(){var n,w=this.getComponentsInChildren(eI),k=L(w);try{for(k.s();!(n=k.n()).done;){var C=n.value.node.parent;C&&C.name!==this.devToolsToggle.name&&(C.active=!1)}}catch(n){k.e(n)}finally{k.f()}}},{key:"showAllButtons",value:function(){var n,w=this.getComponentsInChildren(eI),k=L(w);try{for(k.s();!(n=k.n()).done;){var C=n.value.node.parent;C&&C.name!==this.devToolsToggle.name&&(C.active=!0)}}catch(n){k.e(n)}finally{k.f()}}},{key:"handleClickDevToolsButton",value:function(){this.isActive?(this.hideAllButtons(),this.isActive=!1):(this.showAllButtons(),this.isActive=!0)}},{key:"handleResetData",value:function(){kF.setPlayerData(kD.Data.getDefaultData()),en.openScreen(ei.NOTIFICATION_SCREEN,{duration:3,message:"Items and stars will only be reset if you refresh the game page now."}),this.node.scene.emit(i9.START_OVER,0)}},{key:"handleNextLevel",value:(N=M(function(){var n,w,k,C;return _ts_generator(this,function(_){C=(null!==(n=null===(w=this.game)||void 0===w||null===(w=w.getGameData())||void 0===w?void 0:w.level)&&void 0!==n?n:1)+1;null===(k=this.game)||void 0===k||k.setGameData({level:C-1}),kF.setGameData({level:C}),this.node.scene.emit(i9.NEXT_LEVEL);return[2]})}),function(){return N.apply(this,arguments)})},{key:"handlePrevLevel",value:(D=M(function(){var n,w,k,C;return _ts_generator(this,function(_){C=Math.max((null!==(n=null===(w=this.game)||void 0===w||null===(w=w.getGameData())||void 0===w?void 0:w.level)&&void 0!==n?n:2)-1,1);null===(k=this.game)||void 0===k||k.setGameData({level:C-1}),kF.setGameData({level:C}),this.node.scene.emit(i9.NEXT_LEVEL);return[2]})}),function(){return D.apply(this,arguments)})},{key:"handleEnterSelectLevel",value:(O=M(function(n){var w,k;return _ts_generator(this,function(C){k=Number(n.string);null===(w=this.game)||void 0===w||w.setGameData({level:k-1}),kF.setGameData({level:k}),this.node.scene.emit(i9.NEXT_LEVEL);return[2]})}),function(n){return O.apply(this,arguments)})},{key:"handleClickBuildVersionButton",value:function(){var n=globalThis.game.getBuildVersion();en.showNotificationScreen("Build version: ".concat(n))}},{key:"handleClickWinLevelButton",value:function(){this.node.scene.emit(i9.GAME_FINISH)}},{key:"handleClickTimeOutButton",value:function(){var n;null===(n=this.game)||void 0===n||n.clockManager.setTime(.1)}},{key:"handleClickExplodeButton",value:function(){var n,w,k=this.game;if(k){var C=null===(n=k.getGameData())||void 0===n||null===(n=n.levelData)||void 0===n?void 0:n.specials.bomb;if(C&&!(C<=0)){var _=k.board.getBombTiles();if(0!==_.length){var A=_[0];if(!A||(null===(w=A.special)||void 0===w?void 0:w.type)!==kd)throw new Error("Invalid bomb tile");A.special.detonateImmediately()}else console.info("No bomb tiles found")}}}},{key:"handleFillItem",value:function(){this.node.scene.emit(i9.ADD_ITEM,{item:X.HINT,quantity:2}),this.node.scene.emit(i9.ADD_ITEM,{item:X.STORM,quantity:2}),this.node.scene.emit(i9.ADD_ITEM,{item:X.THUNDER,quantity:2}),this.node.scene.emit(i9.ADD_ITEM,{item:X.PLIERS,quantity:2})}},{key:"handleAutoPlay",value:function(){this.node.scene.emit(i9.AUTO_PLAY)}},{key:"handleAddStars",value:function(){var n=kF.getGameData();n&&(kF.setGameData({stars:n.stars+10}),this.debouncedStarsNotification())}},{key:"handleSwitchQualityAssets",value:function(){switch(this.bundleName){case"lowest":this.bundleName="highest";break;case"highest":this.bundleName="lowest"}eY.emit(V.CHANGE_QUALITY_ASSETS,{quality:this.bundleName})}},{key:"handleSwitchLocale",value:(I=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:this.currentLocaleIndex=(this.currentLocaleIndex+1)%kU.length;n=kU[this.currentLocaleIndex];en.showLoadingNotificationScreen();k.label=1;case 1:k.trys.push([1,3,,4]);if(!n)throw new Error("Locale is undefined");return[4,this.preloadLanguageAsync(n)];case 2:k.sent(),eY.emit(V.CHOOSE_LANGUAGE,{locale:n,saveToPlayerData:!0}),en.showNotificationScreen("Language changed to ".concat(n));return[3,4];case 3:w=k.sent();console.error(w),en.showNotificationScreen("Failed to change language");return[3,4];case 4:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"preloadLanguageAsync",value:function(n){return new Promise(function(w,k){eY.emit(V.PRELOAD_LANGUAGE,{locale:n,onLoad:w,onError:k})})}}]),y}(eO)).prototype,"devToolsToggle",[ks],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kl=ku))||kl);ew._RF.pop(),ew._RF.push({},"a3b0f6zU+1D97PyszsgST1H","UIManager",void 0);var kH,kV,kq,kW,kK,kj,kY,kX,kZ=eS.ccclass,kJ=eS.property,kQ=GameCore,k$=kQ.Utils.Valid,k0=kQ.Match.Modes,k1=q.Layout,k2=(ky=kZ("UIManager"),kv=kJ(mV),kg=kJ(kr),km=kJ(Su),kb=kJ(kG),kw=kJ(bh),kS=kJ(mj),kk=kJ(Sw),ky((k_=n((kE=function(n){w(f,n);var I,O,D,N,z,B=k(f);function f(){var n;C(this,f);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"interstitialAdIndicator",k_,A(n)),_(n,"portraitLayout",kA,A(n)),_(n,"landscapeLayout",kT,A(n)),_(n,"devTools",kP,A(n)),_(n,"comboProgressBar",kR,A(n)),_(n,"comboContainer",kI,A(n)),_(n,"uiMasks",kL,A(n)),n.uiShown=!1,n.config={},n.showDevTools=function(){n.devTools&&(n.devTools.node.active=!0)},n}return T(f,[{key:"onLoad",value:function(){this.node.scene.on(sA.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.on(i9.RESCUE_START,this.showRescueAnimation,this),this.node.scene.on(i9.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.on(i9.SCORE_UPDATED,this.handleScoreUpdated,this),eY.on(V.ORIENTATION_CHANGED,this.onOrientationChanged,this),this.onOrientationChanged(s5.getCurrentLayout())}},{key:"onDestroy",value:function(){this.node.scene.off(sA.Events.UNLOCK_DEV_TOOLS,this.showDevTools),this.node.scene.off(i9.RESCUE_START,this.showRescueAnimation,this),this.node.scene.off(i9.RESCUE_FINISHED,this.hideRescueAnimation,this),this.node.scene.off(i9.SCORE_UPDATED,this.handleScoreUpdated,this),eY.off(V.ORIENTATION_CHANGED,this.onOrientationChanged,this)}},{key:"init",value:function(n){this.game=n,this.initDevTools(n)}},{key:"initDevTools",value:function(n){var w=this;window.addEventListener("reset-game-data",function(){var n;null===(n=w.devTools)||void 0===n||n.handleResetData()}),this.devTools&&(this.devTools.node.active=k$.isDebugger(),this.devTools.injectGameplay(n))}},{key:"setLevelText",value:function(n){this.config.level=n,this.currentLayout.setLevelText(n)}},{key:"startCountdown",value:function(){this.comboProgressBar.resume()}},{key:"pauseTime",value:function(){this.comboProgressBar.pause()}},{key:"resumeTime",value:function(){this.comboProgressBar.resume()}},{key:"setComboUI",value:function(n){this.comboContainer.getComponent(i_).changeStateFade(n,.1)}},{key:"disableLayout",value:function(){this.currentLayout.disableLayout()}},{key:"enableLayout",value:function(){this.currentLayout.enableLayout()}},{key:"updateStatus",value:function(){var n;this.currentLayout.updateStatus({score:this.game.scoreManager.getCurrentScore(),leaderData:null===(n=this.game.tournamentManager)||void 0===n?void 0:n.leaderData,items:this.game.itemManager.itemConfigs}),this.comboContainer.updateStatus()}},{key:"showRescueAnimation",value:(z=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.uiMasks.show()];case 1:n.sent();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"hideRescueAnimation",value:(N=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.uiMasks.hide()];case 1:n.sent();return[2]}})}),function(){return N.apply(this,arguments)})},{key:"playExitAnimUI",value:(D=M(function(){var n;var w=arguments;return _ts_generator(this,function(k){switch(k.label){case 0:n=w.length>0&&void 0!==w[0]?w[0]:.2;this.uiShown=!1;return[4,this.currentLayout.playExitAnimUI(n)];case 1:k.sent();return[2]}})}),function(){return D.apply(this,arguments)})},{key:"playEntranceAnimUI",value:(O=M(function(){var n;var w=arguments;return _ts_generator(this,function(k){switch(k.label){case 0:n=w.length>0&&void 0!==w[0]?w[0]:.17;this.uiShown=!0;return[4,this.currentLayout.playEntranceAnimUI(n)];case 1:k.sent();return[2]}})}),function(){return O.apply(this,arguments)})},{key:"highlightCoinContainer",value:function(){this.currentLayout.highlightCoinContainer()}},{key:"unHighlightCoinContainer",value:function(){this.currentLayout.unHighlightCoinContainer()}},{key:"handleClickedPauseGame",value:function(){en.openScreen(ei.PAUSE_SCREEN),this.node.scene.emit(i9.GAME_PAUSE)}},{key:"handleReturnHome",value:function(){en.openScreen(ei.QUIT_LEVEL_SCREEN),this.node.scene.emit(i9.GAME_PAUSE)}},{key:"items",get:function(){return this.currentLayout.items}},{key:"setInteractableItems",value:function(n){var w,k=!(arguments.length>0&&void 0!==n)||n,C=L(this.items);try{for(C.s();!(w=C.n()).done;){var _=w.value;k?_.button.interactable=!0:void 0!==_.itemType?_.button.interactable=this.game.itemManager.canUseItem(_.itemType):console.warn("Item type is not defined")}}catch(n){C.e(n)}finally{C.f()}}},{key:"onOrientationChanged",value:(I=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n===k1.Portrait?(this.landscapeLayout.node.active=!1,this.portraitLayout.node.active=!0,this.currentLayout=this.portraitLayout):n===k1.Landscape&&(this.portraitLayout.node.active=!1,this.landscapeLayout.node.active=!0,this.currentLayout=this.landscapeLayout);k=this.currentLayout;if(!k)return[3,2];this.currentLayout.updateStatus({level:this.config.level,score:this.game.scoreManager.getCurrentScore(),time:this.game.clockManager.getRemainingTime(),leaderData:null===(w=this.game.tournamentManager)||void 0===w?void 0:w.leaderData,items:this.game.itemManager.itemConfigs});return[4,this.currentLayout.waitForInitAsync()];case 1:k=(C.sent(),this.uiShown?this.playEntranceAnimUI(0):this.playExitAnimUI(0));C.label=2;case 2:return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"handleScoreUpdated",value:function(n){var w;this.config.score=n,sQ.getMatchMode()===k0.TOURNAMENT&&this.currentLayout.tournamentRail.handleScoreUpdated({score:n,leaderData:null===(w=this.game.tournamentManager)||void 0===w?void 0:w.leaderData})}}]),f}(eO)).prototype,"interstitialAdIndicator",[kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kA=n(kE.prototype,"portraitLayout",[kg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kT=n(kE.prototype,"landscapeLayout",[km],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kP=n(kE.prototype,"devTools",[kb],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),kR=n(kE.prototype,"comboProgressBar",[kw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kI=n(kE.prototype,"comboContainer",[kS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kL=n(kE.prototype,"uiMasks",[kk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kC=kE))||kC);ew._RF.pop(),ew._RF.push({},"157f203vjtMma2FDvAlyM6h","Gameplay",void 0);var k4=globalThis.game,k3=k4.player,k5=k4.ads,k6=k4.event,k8=k4.match,k9=k4.storage,k7=k4.analytics,Ce=k4.monitorError,Ct=k4.leaderboard,Cn=GameCore,Ci=Cn.Events,Ca=Cn.Utils,Cr=Ca.Time,Co=Ca.Array,Cs=Ca.Valid,Cl=Cn.Configs.Gameplay,Cu=Cn.Match.Modes,Ch=eS.ccclass,Cp=eS.property,Cd=[],Cy={level:1,isFromLoader:!1};kH=Ch("Gameplay"),kV=Cp(uh),kq=Cp(i_),kW=Cp(cs),kH((kj=n((kK=function(n){w(p,n);var L,O,D=k(p);function p(){var n;C(this,p);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"board",kj,A(n)),_(n,"opacityToggler",kY,A(n)),_(n,"pathDraw",kX,A(n)),n.gameData=null,n.rescueTiles=[],n.isAutoPlayEnabled=!1,n.handleOpenScreen=function(w){w.screenName===eo[ei.GET_ITEM_SCREEN]&&n.uiManager.highlightCoinContainer()},n.handleShowUI=M(function(){return _ts_generator(this,function(w){switch(w.label){case 0:n.uiManager.updateStatus(),n.uiManager.disableLayout(),n.uiManager.setInteractableItems(!1);return[4,n.uiManager.playEntranceAnimUI()];case 1:w.sent(),n.uiManager.enableLayout(),n.uiManager.setInteractableItems(!0);return[2]}})}),n.handleHideUI=M(function(){return _ts_generator(this,function(w){switch(w.label){case 0:n.uiManager.disableLayout(),n.uiManager.setInteractableItems(!1);return[4,n.uiManager.playExitAnimUI()];case 1:w.sent();return[2]}})}),n.handleCloseScreen=function(w){w.screenName===eo[ei.GET_ITEM_SCREEN]&&n.uiManager.unHighlightCoinContainer()},n.handlePauseGame=function(){n.node.scene.emit(i9.PAUSE_TIME),n.node.pauseSystemEvents(!0),n.opacityToggler.changeStateFade(!1,.1),n.uiManager.setComboUI(!1),n.processCrazyGamesGameplayStop()},n.handleResumeGame=function(){var w;n.node.resumeSystemEvents(!0),n.stateManager.isPlaying()&&n.node.scene.emit(i9.RESUME_TIME),n.processCrazyGamesGameplayStart(),n.opacityToggler.changeStateFade(!0,.1),n.uiManager.setComboUI(!0),null===(w=n.guidelinesManager)||void 0===w||w.startAutoGuides()},n.handleReplayGame=M(function(){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:n.handleHideHint();A.label=1;case 1:A.trys.push([1,6,,7]);w=sQ.getMatchMode();k=w===Cu.SINGLE;if(!k)return[3,3];return[4,sQ.finishMatchAsync()];case 2:k=A.sent();A.label=3;case 3:C=w!==Cu.CHALLENGE_FRIEND;if(!C)return[3,5];return[4,sQ.startMatchAsync()];case 4:C=A.sent();A.label=5;case 5:w===Cu.TOURNAMENT&&(n.scoreManager.resetTournamentStartScore(),n.setGameData({level:1}));return[3,7];case 6:_=A.sent();console.warn("handleReplayGame",_);return[3,7];case 7:n.stateManager.initialize();return[2]}})}),n.handleFinishGame=function(){var w;n.attemptCallCreateShortcut(),null!==(w=n.guidelinesManager)&&void 0!==w&&w.isNewbieGuideLevel()?(n.guidelinesManager.guideUi.guideSkipButton.active=!1,n.handleNextLevel()):n.stateManager.finish()},n.handleNextLevel=M(function(){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:if(!n.gameData)return[3,12];k=sQ.getMatchMode();A.label=1;case 1:A.trys.push([1,5,,6]);if(k!==Cu.SINGLE)return[3,3];return[4,sQ.finishMatchAsync()];case 2:A.sent();return[3,4];case 3:k===Cu.TOURNAMENT&&n.scoreManager.updateTournamentStartScore();A.label=4;case 4:return[3,6];case 5:C=A.sent();console.warn("handleNextLevel",C);return[3,6];case 6:_=(null!==(w=n.gameData.level)&&void 0!==w?w:1)+1;n.setGameData({level:_});if(k!==Cu.TOURNAMENT)return[3,8];return[4,sQ.setMatchCustomDataAsync({level:_})];case 7:A.sent();return[3,11];case 8:return[4,sQ.setMatchCustomDataAsync({level:_,score:0})];case 9:A.sent();return[4,sQ.startMatchAsync()];case 10:A.sent();A.label=11;case 11:n.stateManager.initialize(),console.log("Next level",n.gameData.level);A.label=12;case 12:return[2]}})}),n.handleStartOver=function(){var w=M(function(w){var k;return _ts_generator(this,function(C){k3.setGameData({level:null!=w?w:1}),n.gameData=k3.getGameData(),n.stateManager.initialize(),console.info("Start over",null===(k=n.gameData)||void 0===k?void 0:k.level);return[2]})});return function(n){return w.apply(this,arguments)}}(),n.handleMaxLevel=function(){n.gameData&&(n.initData(),en.openScreen(ei.CONGRATULATION_SCREEN,{level:n.gameData.level}),console.info("Max level",n.gameData.level))},n.handleExitGame=M(function(){return _ts_generator(this,function(n){try{k9.setStorageData("dashboard","animateToCurrentLevel",!0),k9.setStorageData("collection","animateMapPackUnlock",!0)}catch(n){console.warn("handleExitGame",n)}return[2]})}),n.handleTileClick=function(w){n.stateManager.playing(),n.board.handleTileClick(w),n.handleHideHint()},n.handleGridMatchSuccess=function(w,k){n.pathDraw.drawMatchPath(w,function(w){var k=w.x,C=w.y;return n.board.getAnyTileWorldPosition(k,C)}),n.comboManager.addCombo(),n.handleAddScore(),n.effectManager.playClearEffectAt([k[0].node.worldPosition,k[1].node.worldPosition])},n.handleGridMatchFail=function(w){var k;null!==(k=n.guidelinesManager)&&void 0!==k&&k.isShowErrorPathLevel()&&n.pathDraw.drawErrorPath(w,function(w){var k=w.x,C=w.y;return n.board.getAnyTileWorldPosition(k,C)})},n.checkIfGameIsFinish=function(){0===n.board.getUncleared().length&&n.node.scene.emit(i9.GAME_FINISH)},n.handlePauseTime=function(){n.clockManager.pause(),n.uiManager.pauseTime()},n.handleResumeTime=function(){n.clockManager.resume(),n.uiManager.resumeTime()},n.handleClockTimeout=function(){n.stateManager.fail(s0)},n.handleHalfTime=function(){void 0!==n.guidelinesManager&&(n.board.getUncleared().length>=n.board.getCleared().length&&n.guidelinesManager.startThunderGuide()||n.board.getBombTiles().length>0&&n.guidelinesManager.startPliersGuide())},n.handleStartRescue=function(){var w,k,C;for(G.turnDownMusic(),B.setBlockInput(!0),n.board.setIgnoreInput(!0);n.rescueTiles.length>0;){var _=n.rescueTiles.pop();null==_||_.restore()}var A=null!==(w=sQ.getMatchMode())&&void 0!==w?w:void 0;k7.levelRescue(null!==(k=null===(C=n.gameData)||void 0===C?void 0:C.level)&&void 0!==k?k:1,void 0,A)},n.handleFinishRescue=function(){B.setBlockInput(!1),n.board.setIgnoreInput(!1)},n.handleBombExplode=function(){var w=M(function(w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:n.rescueTiles.push(w),n.board.setIgnoreInput(!0),B.getBlockInput()||(G.playSound(nL.BOMB_EXPLODE_1),B.setBlockInput(!0));k=w.node.worldPosition;return[4,n.effectManager.createBombExplosionAt(new eQ(k.x,k.y,0))];case 1:C.sent(),B.setBlockInput(!1),n.stateManager.isFail()||n.stateManager.fail(s1);return[2]}})});return function(n){return w.apply(this,arguments)}}(),n.handleShowHint=function(){if(!n.pathDraw.isDrawingHint){var w=n.board.getHintPath();w&&(G.playSound(nL.HINT_ITEM),n.pathDraw.drawHintPath(w,function(w){return n.board.getAnyTileWorldPosition(w.x,w.y)}),n.board.showHint(),n.node.scene.emit(i9.REFRESH_ITEMS))}},n.handleHideHint=function(){n.pathDraw.isDrawingHint&&(n.pathDraw.clearHintPath(),n.board.hideHint(),n.node.scene.emit(i9.REFRESH_ITEMS))},n.handleAddScore=function(){var w=n.levelManager.getLevelData().level,k=n.comboManager.getCombo(),C=n.clockManager.getRemainingTime();n.scoreManager.addScore(w,k,C)},n.handleUseItem=function(){var w=M(function(w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:k=(n.stateManager.playing(),w!==X.HINT&&n.handleHideHint(),n.itemManager.setQuantity(w,n.itemManager.getQuantity(w)-1),w);switch(k){case X.HINT:return[3,1];case X.PLIERS:return[3,2];case X.STORM:return[3,3];case X.THUNDER:return[3,5]}return[3,7];case 1:uy(n.board,n.pathDraw),n.node.scene.emit(i9.REFRESH_ITEMS);return[3,7];case 2:uf(n.board,n.effectManager),n.node.scene.emit(i9.REFRESH_ITEMS);return[3,7];case 3:n.node.scene.emit(i9.HIDE_UI);return[4,uA(n.board,n.effectManager)];case 4:C.sent(),n.node.scene.emit(i9.SHOW_UI);return[3,7];case 5:n.node.scene.emit(i9.HIDE_UI);return[4,ub(n.board,n.effectManager)];case 6:C.sent(),n.board.getUncleared().length>0&&n.node.scene.emit(i9.SHOW_UI);C.label=7;case 7:return[2]}})});return function(n){return w.apply(this,arguments)}}(),n.handleAutoPlay=function(){n.isAutoPlayEnabled?n.disableAutoPlay():n.enableAutoPlay()},n.enableAutoPlay=function(){n.isAutoPlayEnabled=!0,n.schedule(n.autoPlay,.5)},n.disableAutoPlay=function(){n.isAutoPlayEnabled=!1,n.unschedule(n.autoPlay)},n.autoPlay=function(){if(n.stateManager.isReady()||n.stateManager.isPlaying()){var w=n.board.getHintPath();if(!w)throw new Error("No path found");var k=w[0],C=w.slice(-1)[0];if(void 0!==k&&void 0!==C){var _=k.a,A=C.b,T=n.board.getTileAt(_.x,_.y),I=n.board.getTileAt(A.x,A.y);if(!T||!I)throw new Error("Tile is null");T.onClick(),I.onClick()}else{var L=new Error("No path found");if(Cs.isDebugger())throw L;null==Ce||Ce.sendException(L)}}},n.handleAddStars=function(w){var k=k3.getGameData();if(!k)return Promise.resolve([]);k3.setGameData({stars:k.stars+1});var C=w.startAnimationAt;C&&n.effectManager.playStarEffectAt(C)},n.handleChallengeFriends=M(function(){var w,k,C,_,A,T,I,L,O,D,M,N,z,B,F;return _ts_generator(this,function(x){switch(x.label){case 0:x.trys.push([0,4,,5]);en.showLoadingScreen();_=n.board.generateFenFromCurrentLevel(),A=(null!==(w=k3.getGameData())&&void 0!==w?w:{}).level,T=void 0===A?1:A;T=Math.max(1,T);I=null!==(k=null===(C=n.gameData)||void 0===C?void 0:C.levelData)&&void 0!==k?k:{},L=I.mode,O=void 0===L?"":L,D=I.rules,M=void 0===D?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:D,N=I.time,z=void 0===N?0:N;return[4,k8.context.choose.processAsync({playerId:k3.getPlayerId(),fallbackSingleMode:!1,extraData:{level:T,fen:_,gravity:O,rules:M,time:z}})];case 1:x.sent();B=sQ.getMatchMode()===Cu.TOURNAMENT;if(!B)return[3,3];return[4,n.tryInitTournamentMode(!0)];case 2:B=x.sent();x.label=3;case 3:en.closeLoadingScreen(),n.node.scene.emit(i9.GAME_RESUME),n.node.scene.emit(i9.GAME_REPLAY,{level:T});return[3,5];case 4:F=x.sent();if(console.warn("Unable to invite friends",F),en.closeLoadingScreen(),en.showNotificationScreenWithLocalizedKey("error.tryLater"),!_instanceof(F,Error))return[2];null==Ce||Ce.sendException(F),n.node.scene.emit(i9.GAME_RESUME),n.node.scene.emit(i9.SHOW_UI);return[3,5];case 5:return[2]}})}),n.handleAdShow=function(w){var k=w.placementId;k&&-1!==Cd.indexOf(k)&&(Cd.splice(Cd.indexOf(k),1),k5.hideBannerAdAsync(k).catch(function(){}),0===Cd.length&&k6.off(Ci.AD_SHOWING,n.handleAdShow))},n.handleAddItem=function(){var w=M(function(w){var k,C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:k=w.animate,C=w.item,_=w.quantity,A=Co.search(n.uiManager.items,function(n){return n.itemType===C});if(!(void 0!==A))return[3,3];T=n.itemManager.getQuantity(C)+_;if(n.itemManager.setQuantity(C,T),n.uiManager.setInteractableItems(!1),n.handlePauseGame(),!k)return[3,2];I=k.startWorldPosition;return[4,n.effectManager.playItemAddAnimation(new eQ(I.x,I.y),A)];case 1:L.sent();L.label=2;case 2:n.itemManager.setQuantity(C,T,!0),n.uiManager.setInteractableItems(!0),n.handleResumeGame();return[3,4];case 3:console.warn("Item ".concat(C," not found"));L.label=4;case 4:return[2]}})});return function(n){return w.apply(this,arguments)}}(),n}return T(p,[{key:"__preload",value:function(){this.initComponents(),this.validateRequiredComponents(),this.listenCoreEvents(),this.listenInputEvents(),this.listenFlowEvents()}},{key:"onLoad",value:function(){sB.init()}},{key:"initComponents",value:function(){this.initUIManager(),this.initLevelManager(),this.initStateManager(),this.initEffectManager(),this.initItemManager(),this.initComboManager(),this.initClockManager(),this.initScoreManager(),this.initInputController(),this.initGuidelinesManager()}},{key:"initUIManager",value:function(){var n;this.uiManager=null===(n=this.node.parent)||void 0===n?void 0:n.getComponentInChildren(k2),this.uiManager.init(this)}},{key:"initLevelManager",value:function(){this.levelManager=this.getComponent(g0)}},{key:"initStateManager",value:function(){this.stateManager=this.getComponent(mE)}},{key:"initInputController",value:function(){this.inputController=this.getComponent(s4)}},{key:"initEffectManager",value:function(){this.effectManager=this.getComponent(fF)}},{key:"initItemManager",value:function(){this.itemManager=this.getComponent(gK),this.itemManager.init(this)}},{key:"initComboManager",value:function(){this.comboManager=this.getComponent(c_),this.comboManager.init()}},{key:"initClockManager",value:function(){this.clockManager=this.getComponent(ch),this.clockManager.init()}},{key:"initScoreManager",value:function(){this.scoreManager=this.getComponent(g4),this.scoreManager.init()}},{key:"initGuidelinesManager",value:function(){Cl.Tutorial.Enabled&&(this.guidelinesManager=this.getComponent(gx),this.guidelinesManager.init(this))}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenCoreEvents",value:function(){Cd=[],k6.off(Ci.AD_SHOWING,this.handleAdShow),k6.clear(Ci.OPENING_SCREEN),k6.clear(Ci.CLOSING_SCREEN),k6.on(Ci.OPENING_SCREEN,this.handleOpenScreen),k6.on(Ci.CLOSING_SCREEN,this.handleCloseScreen)}},{key:"listenInputEvents",value:function(){this.node.scene.on(i9.SHOW_UI,this.handleShowUI),this.node.scene.on(i9.HIDE_UI,this.handleHideUI),this.node.scene.on(i9.GAME_PAUSE,this.handlePauseGame),this.node.scene.on(i9.GAME_RESUME,this.handleResumeGame),this.node.scene.on(i9.GAME_REPLAY,this.handleReplayGame),this.node.scene.on(i9.GAME_FINISH,this.handleFinishGame),this.node.scene.on(i9.NEXT_LEVEL,this.handleNextLevel),this.node.scene.on(i9.START_OVER,this.handleStartOver),this.node.scene.on(i9.MAX_LEVEL,this.handleMaxLevel),this.node.scene.on(i9.GAME_EXIT,this.handleExitGame),this.node.scene.on(i9.TILE_CLICK,this.handleTileClick),this.node.scene.on(i9.GRID_MATCH_SUCCESS,this.handleGridMatchSuccess),this.node.scene.on(i9.GRID_MATCH_FAIL,this.handleGridMatchFail),this.node.scene.on(i9.PAUSE_TIME,this.handlePauseTime),this.node.scene.on(i9.RESUME_TIME,this.handleResumeTime),this.node.scene.on(i9.TIME_OUT,this.handleClockTimeout),this.node.scene.on(i9.HALF_TIME,this.handleHalfTime),this.node.scene.on(i9.RESCUE_START,this.handleStartRescue),this.node.scene.on(i9.RESCUE_FINISHED,this.handleFinishRescue),this.node.scene.on(i9.BOMB_EXPLODE,this.handleBombExplode),this.node.scene.on(i9.SHOW_HINT,this.handleShowHint),this.node.scene.on(i9.ADD_SCORE,this.handleAddScore),this.node.scene.on(i9.GRID_CLEAR,this.checkIfGameIsFinish),this.node.scene.on(i9.USE_ITEM,this.handleUseItem),this.node.scene.on(i9.ADD_ITEM,this.handleAddItem),this.node.scene.on(i9.AUTO_PLAY,this.handleAutoPlay),this.node.scene.on(i9.ADD_STARS,this.handleAddStars)}},{key:"listenFlowEvents",value:function(){this.node.scene.on(i9.CHALLENGE_FRIENDS,this.handleChallengeFriends)}},{key:"start",value:(O=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:this.initDataFirstTime();return[4,this.tryInitTournamentMode()];case 1:n.sent(),this.initGame();return[2]}})}),function(){return O.apply(this,arguments)})},{key:"initDataFirstTime",value:function(){var n,w,k=this.getSceneData(),C=(null!=k?k:{}).isFromLoader,_=void 0!==C&&C,A=(null!=k?k:{}).level;void 0===A&&(A=sQ.getMatchMode()===Cu.TOURNAMENT?1:null!==(n=null===(w=k3.getGameData())||void 0===w?void 0:w.level)&&void 0!==n?n:0);this.initData(),this.setGameData({level:A,isFromLoader:_})}},{key:"initData",value:function(){var n,w=this.getSceneData(),k=(null!=w?w:{}).isFromLoader,C=void 0!==k&&k,_=null!==(n=k3.getGameData())&&void 0!==n?n:{},A=_.level,T=void 0===A?1:A,L=_.items;0===T&&C&&L?(L.hint=2,L.thunder=1,L.storm=1,L.pliers=0,k3.setGameData({items:L,coins:500,lastRewardedItems:Date.now()}),this.node.scene.emit(i9.ADD_COINS,{coins:500,playSound:!1})):L&&this.checkItemsRewardable()&&(L.hint<5&&(L.hint+=1),L.thunder<5&&(L.thunder+=1),L.storm<5&&(L.storm+=1),L.pliers<5&&(L.pliers+=1),k3.setGameData({items:L,lastRewardedItems:Date.now()})),this.setGameData(I(I({},Cy),{},{level:T}))}},{key:"checkItemsRewardable",value:function(){var n,w=(null!==(n=k3.getGameData())&&void 0!==n?n:{}).lastRewardedItems,k=void 0===w?0:w;return!Cr.isToday(k)}},{key:"initGame",value:function(){this.stateManager.init(this),this.stateManager.initialize()}},{key:"tryInitTournamentMode",value:(L=M(function(){var n,w,k,C,_,A,T,I,L,O,D,M,N,z,B,F;var x=arguments;return _ts_generator(this,function(U){switch(U.label){case 0:k=x.length>0&&void 0!==x[0]&&x[0],C=sQ.getMatchMode();if(C!==Cu.TOURNAMENT)return[3,8];_=null!==(n=sQ.getMatchCustomData())&&void 0!==n?n:{},A=_.leaderboardId,T=_.tournamentId;if(!(A&&T))return[3,8];return[4,et.requestTournamentDataAsync()];case 1:U.sent();I=et.getTournamentDataById(T);if(!I)return[3,8];L=I.payload.themeId;this.setGameData({themeId:L});O=Ct.getLeaderboardName(A);if(!O)return[3,8];D=null;if(!(null!==(w=this.gameData)&&void 0!==w&&w.isFromLoader||k))return[3,3];return[4,sL.getAllLeaderboardAsync(A)];case 2:D=U.sent();return[3,5];case 3:return[4,sL.waitForLeaderboardFinishAsync(O)];case 4:U.sent(),D=Ct.getLeaderboard(O);U.label=5;case 5:if(!D)return[3,8];this.tournamentManager=this.getComponent(mB),this.tournamentManager.init(D);M=k3.getPlayerId(),N=D.leaders[M];if(!!N)return[3,7];return[4,Ct.getLeadersByPlayerIdsAsync(O,[M])];case 6:z=U.sent();if(0===z.length)return[2];N=z[0];U.label=7;case 7:if(N){B=N,F=B.score;k9.setStorageData("tournament","previousScore",F)}U.label=8;case 8:return[2]}})}),function(){return L.apply(this,arguments)})},{key:"setGameData",value:function(n){var w,k,C,_=null!==(w=null!==(k=n.level)&&void 0!==k?k:null===(C=this.gameData)||void 0===C?void 0:C.level)&&void 0!==w?w:1;this.gameData=I(I(I({},this.gameData),n),{},{level:_})}},{key:"getGameData",value:function(){return this.gameData}},{key:"getSceneData",value:function(){return es.getSceneData(this.node.scene)}},{key:"attemptCallCreateShortcut",value:function(){var n,w=null!==(n=this.getGameData())&&void 0!==n?n:{},k=w.level,C=void 0===k?0:k,_=w.nextLevelCount;C<2||(void 0===_?0:_)<2||"checkAndCreateShortcutAsync"in GameSDK.extra&&GameSDK.extra.checkAndCreateShortcutAsync().catch(function(n){console.warn("checkAndCreateShortcutAsync",n)})}},{key:"processCrazyGamesGameplayStart",value:function(){"gameplayStart"in GameSDK.extra&&GameSDK.extra.gameplayStart()}},{key:"processCrazyGamesGameplayStop",value:function(){"gameplayStop"in GameSDK.extra&&GameSDK.extra.gameplayStop()}},{key:"disableRewardAdsItemForCrazyGames",value:function(){GameSDK.getSDKName()}}]),p}(eO)).prototype,"board",[kV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kY=n(kK.prototype,"opacityToggler",[kq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kX=n(kK.prototype,"pathDraw",[kW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kK));ew._RF.pop(),ew._RF.push({},"c863f/bTTdAjqEM+Kj9OaKi","DashboardEventButtonTypes",void 0);var Cv=function(n){return n[n.STAR_CHEST=0]="STAR_CHEST",n[n.BALLOON=1]="BALLOON",n}(Cv||{});eF(Cv),ew._RF.pop(),ew._RF.push({},"17fa4eEXEhIfZh+ad9Oqcmw","Leaderboard",void 0);var Cg=function(n){return n.WORLD_TAB_SELECTED="world-tab-selected",n.FRIENDS_TAB_SELECTED="friends-tab-selected",n}(Cg||{}),Cm="#AE4212",Cb="#3D5172",Cw="#92200C",CS="#8F5542",Ck="#8A4733",CC="#3e7110",CE="#3e7110";ew._RF.pop(),ew._RF.push({},"4cd93d4ECxKDYSG9apAx603","LevelMission",void 0),ew._RF.pop(),ew._RF.push({},"c0656MbbYRE+KSk63rv74ZI","SkinKeys",void 0);var C_;ew._RF.pop(),ew._RF.push({},"2737dY5lxxEY6mKDXeUQJUc","ThemeLocaleKeys",void 0);var CA=(Y(C_={},el.SUMMER,"theme.summer"),Y(C_,el.AUTUMN,"theme.autumn"),Y(C_,el.WINTER,"theme.winter"),Y(C_,el.SPRING_FESTIVAL,"theme.springFestival"),Y(C_,el.TREE_PLANTING_FESTIVAL,"theme.treePlantingFestival"),Y(C_,el.BLUE_SEA_FESTIVAL,"theme.blueSeaFestival"),Y(C_,el.MUSIC_FESTIVAL,"theme.musicFestival"),Y(C_,el.HARVEST_FESTIVAL,"theme.harvestFestival"),Y(C_,el.FOOD_FESTIVAL,"theme.foodFestival"),Y(C_,el.SNOW_FESTIVAL,"theme.snowFestival"),Y(C_,el.LIGHT_FESTIVAL,"theme.lightFestival"),Y(C_,el.PEACE_FESTIVAL,"theme.peaceFestival"),Y(C_,el.FLOWER_FESTIVAL,"theme.flowerFestival"),Y(C_,el.STREET_FESTIVAL,"theme.streetFestival"),Y(C_,el.COLOR_GARDEN,"theme.colorGarden"),Y(C_,el.COLOR_FESTIVAL,"theme.colorFestival"),Y(C_,el.NATURE_SUMMER,"theme.natureSummer"),Y(C_,el.SNOW_MOUNTAIN,"theme.snowMountain"),Y(C_,el.ICE_FESTIVAL,"theme.iceFestival"),Y(C_,el.GREEN_GRASS_FESTIVAL,"theme.greenGrassFestival"),Y(C_,el.COMMUNITY_FESTIVAL,"theme.communityFestival"),Y(C_,el.WATER_FESTIVAL,"theme.waterFestival"),Y(C_,el.ANIMAL_FESTIVAL,"theme.animalFestival"),Y(C_,el.LOST_FESTIVAL,"theme.lostFestival"),Y(C_,el.HALLOWEEN_FESTIVAL,"theme.halloweenFestival"),Y(C_,el.SNOW_MUSIC_FESTIVAL,"theme.snowMusicFestival"),Y(C_,el.CHRISTMAS,"theme.christmas"),Y(C_,el.SPRING_FLOWER_FESTIVAL,"theme.springFlowerFestival"),Y(C_,el.TET_HOLIDAY,"theme.tetHoliday"),Y(C_,el.SEA_FESTIVAL,"theme.seaFestival"),Y(C_,el.FIREWORK_FESTIVAL,"theme.fireworkFestival"),Y(C_,el.HALLOWEEN_HORROR,"theme.halloweenHorror"),Y(C_,el.MID_AUTUMN,"theme.midAutumn"),Y(C_,el.CHRISTMAS_SWEET,"theme.christmasSweet"),Y(C_,el.NEW_YEAR_COUNTDOWN,"theme.newYearCountdown"),Y(C_,el.HAPPY_NEW_YEAR,"theme.happyNewYear"),C_);ew._RF.pop(),ew._RF.push({},"78297LLtrJKMpOIidCw/BA9","index",void 0),ew._RF.pop(),ew._RF.push({},"176c3V0yoFEhIdpVcCIhDz7","isEmptyBoard",void 0),ew._RF.pop(),ew._RF.push({},"5262atLmldNy7Q3MtHgiSRI","HintItem",void 0);(0,eS.ccclass)("HintItem")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"itemType",get:function(){return X.HINT}}]),o}(bk));ew._RF.pop(),ew._RF.push({},"3f4c1AB+jdNFqylpogoaiDZ","PliersItem",void 0);(0,eS.ccclass)("PliersItem")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"itemType",get:function(){return X.PLIERS}}]),o}(bk));ew._RF.pop(),ew._RF.push({},"d6e51+oy6NCF7cKvf6KOWiu","StormItem",void 0);(0,eS.ccclass)("StormItem")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"itemType",get:function(){return X.STORM}}]),o}(bk));ew._RF.pop(),ew._RF.push({},"b30ffJjU2lAH5yu2NkzVVnO","ThunderItem",void 0);var CT,CP,CR,CI,CL,CO,CD,CM,CN,Cz,CB,CF,Cx,CU,CG,CH,CV,Cq;(0,eS.ccclass)("ThunderItem")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"itemType",get:function(){return X.THUNDER}}]),o}(bk));ew._RF.pop(),ew._RF.push({},"28c5eNXZLBE+50Dno043fmy","useTornadoThunderCombined",void 0),ew._RF.pop(),ew._RF.push({},"944cbG3+yRMsJZimXjukGdn","Coin",void 0);var CW,CK,Cj,CY,CX,CZ,CJ,CQ,C$,C0,C1,C2=eS.ccclass,C4=eS.property,C3=(CT=C2("Coin"),CP=C4(e$),CR=C4(e7),CI=C4(tm),CL=C4(tm),CO=z.onlyRunInLifeCycle,CD=z.onlyRunInLifeCycle,CM=z.onlyRunInLifeCycle,CN=z.onlyRunInLifeCycle,Cz=z.onlyRunInLifeCycleAsync,CB=z.onlyRunInLifeCycleAsync,CF=z.onlyRunInLifeCycle,CT((CG=n((CU=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"emittingParticles",CG,A(n)),_(n,"animation",CH,A(n)),_(n,"spin",CV,A(n)),_(n,"rest",Cq,A(n)),n}return T(u,[{key:"__preload",value:function(){z.lazyValidateProperties(this)}},{key:"resetDisabled",value:function(){this.stopParticles(),this.stopAnimation(),this.hide(),this.node.active=!1,this.node.setPosition(0,0,this.node.position.z)}},{key:"hide",value:function(){this.node.setScale(eQ.ZERO)}},{key:"stopParticles",value:function(){this.emittingParticles.stopSystem()}},{key:"playTrailParticles",value:function(){this.emittingParticles.resetSystem()}},{key:"playSpinAnimationAfterDelay",value:(I=M(function(){var n,w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:n=C.length>0&&void 0!==C[0]?C[0]:0,w=C.length>1?C[1]:void 0;k=n>0;if(!k)return[3,2];return[4,N.waitTweenAsync(n)];case 1:k=_.sent();_.label=2;case 2:return[4,this.playSpinAnimation(w)];case 3:_.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"playSpinAnimation",value:function(n){return N.runAnimationAsync(this.animation,this.spin.name,n)}},{key:"stopAnimation",value:function(){this.animation.play(this.rest.name)}}]),u}(eO)).prototype,"emittingParticles",[CP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CH=n(CU.prototype,"animation",[CR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CV=n(CU.prototype,"spin",[CI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cq=n(CU.prototype,"rest",[CL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(CU.prototype,"resetDisabled",[CO],Object.getOwnPropertyDescriptor(CU.prototype,"resetDisabled"),CU.prototype),n(CU.prototype,"hide",[CD],Object.getOwnPropertyDescriptor(CU.prototype,"hide"),CU.prototype),n(CU.prototype,"stopParticles",[CM],Object.getOwnPropertyDescriptor(CU.prototype,"stopParticles"),CU.prototype),n(CU.prototype,"playTrailParticles",[CN],Object.getOwnPropertyDescriptor(CU.prototype,"playTrailParticles"),CU.prototype),n(CU.prototype,"playSpinAnimationAfterDelay",[Cz],Object.getOwnPropertyDescriptor(CU.prototype,"playSpinAnimationAfterDelay"),CU.prototype),n(CU.prototype,"playSpinAnimation",[CB],Object.getOwnPropertyDescriptor(CU.prototype,"playSpinAnimation"),CU.prototype),n(CU.prototype,"stopAnimation",[CF],Object.getOwnPropertyDescriptor(CU.prototype,"stopAnimation"),CU.prototype),Cx=CU))||Cx);ew._RF.pop(),ew._RF.push({},"0c6a8vx5IhFvKJ5IUimm0Je","CoinTextPopup",void 0);var C5,C6,C8,C9,C7,Ee,Et,En,Ei,Ea,Er,Eo,Es,El,Eu,Eh,Ep,Ed,Ey=eS.ccclass,Ef=eS.property,Ev=eQ.ZERO.clone().add3f(0,-100,0),Eg=eQ.ZERO.clone().add3f(0,100,0),Em=GameCore.Utils.Number,Eb=(CW=Ey("CoinTextPopup"),CK=Ef(eT),Cj=Ef(eH),CY=z.onlyRunInLifeCycle,CX=z.onlyRunInLifeCycle,CZ=z.onlyRunInLifeCycleAsync,CJ=z.onlyRunInLifeCycleAsync,CW((C0=n((C$=function(n){w(y,n);var I,L,O,D=k(y);function y(){var n;C(this,y);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"label",C0,A(n)),_(n,"uiOpacity",C1,A(n)),n}return T(y,[{key:"__preload",value:function(){z.lazyValidateProperties(this),this.node.active=!1}},{key:"show",value:(O=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:this.enableNode(),this.initializePopup(n);return[4,this.showTextPopupAnimation(w)];case 1:k.sent();return[4,this.hidePopup()];case 2:k.sent(),this.disableNode();return[2]}})}),function(n,w){return O.apply(this,arguments)})},{key:"enableNode",value:function(){this.node.active=!0}},{key:"disableNode",value:function(){this.node.active=!1}},{key:"initializePopup",value:function(n){var w=Em.getShortNumber(n,3);this.label.string=w,this.uiOpacity.opacity=255,this.node.setScale(.5,.5,.5),this.node.setPosition(Ev)}},{key:"hidePopup",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:this.node.setScale(eQ.ONE),this.node.setPosition(Eg);return[4,N.runTweenAsync(ez(this.uiOpacity).to(.5,{opacity:0}))];case 1:n.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"showTextPopupAnimation",value:(I=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,Promise.all([N.runTweenAsync(ez(this.node).to(1.5,{position:Eg},{easing:"sineOut"}),n),N.runTweenAsync(ez(this.node).to(.5,{scale:eQ.ONE},{easing:"backOut"}),n)])];case 1:w.sent();return[2]}})}),function(n){return I.apply(this,arguments)})}]),y}(eO)).prototype,"label",[CK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C1=n(C$.prototype,"uiOpacity",[Cj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(C$.prototype,"disableNode",[CY],Object.getOwnPropertyDescriptor(C$.prototype,"disableNode"),C$.prototype),n(C$.prototype,"initializePopup",[CX],Object.getOwnPropertyDescriptor(C$.prototype,"initializePopup"),C$.prototype),n(C$.prototype,"hidePopup",[CZ],Object.getOwnPropertyDescriptor(C$.prototype,"hidePopup"),C$.prototype),n(C$.prototype,"showTextPopupAnimation",[CJ],Object.getOwnPropertyDescriptor(C$.prototype,"showTextPopupAnimation"),C$.prototype),CQ=C$))||CQ);ew._RF.pop(),ew._RF.push({},"8a5c3m7o41LNqGBKPo0oqf1","CoinManager",void 0);var Ew,ES=eS.ccclass,Ek=eS.disallowMultiple,EC=eS.property,EE=globalThis.game,E_=EE.player,EA=EE.monitorError,ET=0x3b9ac9ff,EP=10,ER=1,EI=1,EL=(C5=ES("CoinManager"),C6=z.required(),C8=EC(ta),C9=z.required(),C7=EC(ta),Ee=z.required(),Et=EC(ek),En=z.onlyRunInLifeCycleAsync,Ei=z.onlyRunInLifeCycleAsync,Ea=z.onlyRunInLifeCycleAsync,Er=z.onlyRunInLifeCycleAsync,Eo=z.onlyRunInLifeCycleAsync,Es=z.onlyRunInLifeCycleAsync,C5(El=Ek((Eh=n((Eu=function(n){w(g,n);var L,O,D,B,x=k(g);function g(){var n;C(this,g);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return(n=x.call.apply(x,[this].concat(k))).coins=0,_(n,"coinPrefab",Eh,A(n)),_(n,"coinTextPopup",Ep,A(n)),_(n,"coinAnimContainer",Ed,A(n)),n.coinObjects=[],n}return T(g,[{key:"onLoad",value:function(){z.validateRequiredProperties(this),this.getCoinsFromPlayerData(),this.prepareCoinCollection(),this.prepareCoinTextPopup(),this.listenToCoinEvents()}},{key:"start",value:function(){this.emitCoinAmount()}},{key:"init",value:function(){this.updateCoins({coins:this.coins})}},{key:"listenToCoinEvents",value:function(){this.node.scene.on(i9.ADD_COINS,this.addCoins,this),this.node.scene.on(i9.REMOVE_COINS,this.removeCoins,this),this.node.scene.on(i9.ABORT_COIN_ANIMATION,this.abortCoinAnimation,this)}},{key:"prepareCoinCollection",value:function(){for(var n=0;n<EP;n++){var w=eA(this.coinPrefab);w.setParent(this.coinAnimContainer),w.setPosition(0,0),w.active=!1,this.coinObjects.push(w.getComponent(C3))}}},{key:"prepareCoinTextPopup",value:function(){var n=eA(this.coinTextPopup);n.setParent(this.node),n.active=!1,this.coinTextPopupNode=n.getComponent(Eb)}},{key:"handleCollectionAnim",value:(B=M(function(n,w,k,C,_){var A,T;return _ts_generator(this,function(I){switch(I.label){case 0:A=this;if(!w)return[3,2];T=this.coinObjects.slice(0,this.getShortAmount(n));if(0===T.length)return[2,(console.warn("Requested coins amount is ".concat(n,". Shortened to ").concat(this.getShortAmount(n),". No coin objects was found to animate collection.")),void(null==EA||EA.sendException(new Error("Requested coins amount is ".concat(n,". Shortened to ").concat(this.getShortAmount(n),". No coin objects was found to animate collection.")),{coins:n,animatedCoins:T.length,hasCoinTextPopup:!!this.coinTextPopupNode,hasTargetContainer:!!w,coinCollectionCount:this.coinObjects.length})))];G.playSound(nL.COLLECT_STOCK_COINS);return[4,Promise.all([this.playCoinFlyAndexplodeAnimation(w,T,k,C,_),N.waitTweenAsync(k+C/2,_).then(function(){return A.animateCoinTextPopup(n,_)})])];case 1:I.sent(),_.abort();return[3,3];case 2:console.warn("No target coin container assigned to CoinManager. No coin collection animation will be played");I.label=3;case 3:return[2]}})}),function(n,w,k,C,_){return B.apply(this,arguments)})},{key:"playCoinFlyAndexplodeAnimation",value:(D=M(function(n,w,k,C,_){var A,T;return _ts_generator(this,function(I){switch(I.label){case 0:A=this,T=k+C;return[4,Promise.all([].concat(j(w.flatMap(function(w){w.node.active=!0,w.stopParticles();var T=[0,.5*Math.min(k,C)],I=tn.apply(void 0,T),L=k-I,O=C+I;return[A.animateCoinExplode(w.node,L,_),N.waitTweenAsync(L,_).then(function(){return A.animateCoinFlyBack(n,w,O,_)})]})),[N.waitTweenAsync(T,_).then(function(){return n.emitExplodeEffect(_)})]))];case 1:I.sent();return[2]}})}),function(n,w,k,C,_){return D.apply(this,arguments)})},{key:"animateCoinTextPopup",value:function(n,w){return this.coinTextPopupNode.show(n,w)}},{key:"animateCoinFlyBack",value:(O=M(function(n,w,k,C){var _,A,T;return _ts_generator(this,function(I){switch(I.label){case 0:_=w.node.worldPosition.clone(),A=eQ.ZERO.clone(),T=n.getCoinIconWorldScale();return[4,N.runTweenAsync(ez(w.node).to(k,{scale:T},{onStart:function(){w.playSpinAnimationAfterDelay(0,C),w.playTrailParticles()},onUpdate:function(k,C){if(void 0!==C){var T=eG.cubicIn(C),I=n.getCoinIconWorldPosition();w.node.worldPosition=eQ.lerp(A,_,I,T)}},onComplete:function(){w.emittingParticles.stopSystem(),w.stopAnimation(),w.hide()}}),C)];case 1:I.sent();return[4,N.waitTweenAsync(1,C)];case 2:I.sent(),w.resetDisabled();return[2]}})}),function(n,w,k,C){return O.apply(this,arguments)})},{key:"animateCoinExplode",value:(L=M(function(n,w,k){var C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:C=[-200,200],_=[-200,200],A=tn(C[0],C[1]),T=tn(_[0],_[1]);n.setPosition(0,0,n.position.z),n.setScale(eQ.ZERO);I=new eQ(A,T,n.position.z);return[4,Promise.all([N.runTweenAsync(ez(n).delay(.1*w).to(.8*w,{scale:eQ.ONE},{easing:"elasticOut"}),k),N.runTweenAsync(ez(n).to(w,{position:I},{easing:"circOut"}),k)])];case 1:L.sent();return[2]}})}),function(n,w,k){return L.apply(this,arguments)})},{key:"getCoinsFromPlayerData",value:function(){var n=E_.getGameData();this.coins=n?n.coins:0}},{key:"getCoins",value:function(){return this.coins}},{key:"updateCoins",value:function(n){var w,k;if(this.coins>ET&&(this.coins=ET),n.coins!==this.coins){var C=Math.max(0,n.coins-this.coins);this.coins=n.coins,E_.setGameData({coins:this.coins});var _=n.collectionAnimation;null===(w=this.collectionAnimSignal)||void 0===w||w.abort();var A=new F;if(this.collectionAnimSignal=A,null==_||null===(k=_.signal)||void 0===k||k.chain(A),void 0===_||_.animateTextOnly)this.node.scene.emit(i9.COIN_CHANGED,I(I({},n),{},{collectionAnimation:{animateTextOnly:!0,signal:null==_?void 0:_.signal}}));else{var T=_.floatDuration,L=void 0===T?ER:T,O=_.flyDuration,D=void 0===O?EI:O,M=_.target,N=void 0===M?this.targetContainer:M;this.collectionAnimSignal=A,this.targetContainer=N;var z=I(I({},n),{},{collectionAnimation:{floatDuration:L,flyDuration:D,animateTextOnly:!1,signal:A,target:N}});this.node.scene.emit(i9.COIN_CHANGED,z),this.handleCollectionAnim(C,this.targetContainer,L,D,A)}}}},{key:"addCoins",value:function(n){this.updateCoins(I(I({},n),{},{coins:this.coins+n.coins}))}},{key:"removeCoins",value:function(n){this.coins<n.coins?this.node.scene.emit(i9.REMOVE_COINS_FAILED):(this.updateCoins(I(I({},n),{},{coins:this.coins-n.coins})),this.node.scene.emit(i9.REMOVE_COINS_SUCCESS))}},{key:"emitCoinAmount",value:function(){this.node.scene.emit(i9.COIN_CHANGED,{coins:this.coins})}},{key:"getShortAmount",value:function(n){return Math.min(n,EP)}},{key:"abortCoinAnimation",value:function(){var n;null===(n=this.collectionAnimSignal)||void 0===n||n.abort()}},{key:"untilFinishesCollectAnim",value:function(){return void 0===this.collectionAnimSignal?Promise.resolve():this.collectionAnimSignal.untilAborted()}},{key:"setTargetContainer",value:function(n){this.targetContainer=n}},{key:"getTargetContainer",value:function(){return this.targetContainer}},{key:"onDestroy",value:function(){var n;null===(n=this.collectionAnimSignal)||void 0===n||n.abort()}}]),g}(eO)).prototype,"coinPrefab",[C6,C8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ep=n(Eu.prototype,"coinTextPopup",[C9,C7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ed=n(Eu.prototype,"coinAnimContainer",[Ee,Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Eu.prototype,"handleCollectionAnim",[En],Object.getOwnPropertyDescriptor(Eu.prototype,"handleCollectionAnim"),Eu.prototype),n(Eu.prototype,"playCoinFlyAndexplodeAnimation",[Ei],Object.getOwnPropertyDescriptor(Eu.prototype,"playCoinFlyAndexplodeAnimation"),Eu.prototype),n(Eu.prototype,"animateCoinTextPopup",[Ea],Object.getOwnPropertyDescriptor(Eu.prototype,"animateCoinTextPopup"),Eu.prototype),n(Eu.prototype,"animateCoinFlyBack",[Er],Object.getOwnPropertyDescriptor(Eu.prototype,"animateCoinFlyBack"),Eu.prototype),n(Eu.prototype,"animateCoinExplode",[Eo],Object.getOwnPropertyDescriptor(Eu.prototype,"animateCoinExplode"),Eu.prototype),n(Eu.prototype,"untilFinishesCollectAnim",[Es],Object.getOwnPropertyDescriptor(Eu.prototype,"untilFinishesCollectAnim"),Eu.prototype),El=Eu))||El)||El);ew._RF.pop(),ew._RF.push({},"d2a57+mB4NG9rcdh+dy1VPe","traverse4",void 0),ew._RF.pop(),ew._RF.push({},"ca614iJ+X5LrL1rX/wDQDTD","shuffle",void 0),ew._RF.pop(),ew._RF.push({},"1cf4cygDSdP5JL+7w3wIJL7","traverseRandom",void 0),ew._RF.pop(),ew._RF.push({},"1faa9NgJrBE7p8Zs/HBWrZn","pad",void 0),ew._RF.pop(),ew._RF.push({},"c20acgKcuRFP6+Am/XjOFeP","ParticleSystem2DExtra",void 0);var EO=eS.ccclass,ED=eS.disallowMultiple,EM=eS.executeInEditMode,EN=eS.requireComponent,Ez=EO("ParticleSystem2DExtra")(Ew=EM(!0)(Ew=ED(!0)(Ew=EN(e$)(Ew=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).emitParticle=function(w){return function(k){w(k);var C=n.particleSystem._simulator.particles.length,_=n.particleSystem._simulator.particles[C-1];n.initParticle(_)}},n.step=function(w){return function(k){for(var C=n.particleSystem._simulator.particles,_=0;_<C.length;_++){var A=C[_];n.updateParticle(A,k)}w(k)}},n}return T(o,[{key:"__preload",value:function(){this.particleSystem=this.getComponent(e$),this.validateRequiredComponents(),this.overrideFunctions()}},{key:"overrideFunctions",value:function(){var n=this.particleSystem._simulator.emitParticle.bind(this.particleSystem._simulator);this.particleSystem._simulator.emitParticle=this.emitParticle(n);var w=this.particleSystem._simulator.step.bind(this.particleSystem._simulator);this.particleSystem._simulator.step=this.step(w)}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),o}(eO))||Ew)||Ew)||Ew)||Ew;ew._RF.pop(),ew._RF.push({},"664feJL84ZOTaM99dgWY4x0","ExampleParticleSystem2DExtra",void 0);var EB;(0,eS.ccclass)("ExampleParticleSystem2DExtra")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"initParticle",value:function(n){n.maxSize=e0.randomRange(.25,1)*n.size,n.size=0,n.deltaSize=0,n.cycleDuration=e0.randomRange(.4,.6),n.life=n.timeToLive,this.setInitPosition(n.pos)}},{key:"updateParticle",value:function(n,w){this.updateScale(n)}},{key:"setInitPosition",value:function(n){var w=n.x,k=n.y;return n.x=w+e0.randomRange(-350,350),n.y=k+e0.randomRange(-350,350),n}},{key:"updateScale",value:function(n){var w=1-(n.life-n.timeToLive)%n.cycleDuration/n.cycleDuration;n.size=n.maxSize*Math.sin(w*Math.PI)}}]),o}(Ez));ew._RF.pop(),ew._RF.push({},"4a9beTdMntC0q9yngb8a2go","BootScene",void 0);var EF,Ex,EU,EG,EH,EV,Eq,EW,EK,Ej,EY=eS.ccclass,EX=eS.disallowMultiple,EZ=GameCore,EJ=EZ.Events,EQ=EZ.Configs,E$=EZ.Utils.Valid,E0=globalThis.game,E1=E0.ads,E2=E0.player,E4=E0.event;EY("BootScene")(EB=EX(EB=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).processWhenGameSdkStarted=function(){n.setupGameData(),n.processPreloadAssets()},n.processPreloadAssets=M(function(){var w;return _ts_generator(this,function(k){switch(k.label){case 0:k.trys.push([0,2,,3]);return[4,n.loadCurrentPlayerTheme()];case 1:k.sent();return[3,3];case 2:w=k.sent();console.error("loadCurrentPlayerTheme",w);return[3,3];case 3:return[2]}})}),n.handlePauseAudio=function(){E4.on(EJ.VISIBILITY_HIDDEN,n.handleMuteAudio),E4.on(EJ.VISIBILITY_VISIBLE,n.handleUnMuteAudio)},n.handleMuteAudio=function(){G.muteAudio(!0)},n.handleUnMuteAudio=function(){E1.isAdFullSizeShowing()||G.muteAudio(!1)},n}return T(o,[{key:"__preload",value:function(){this.setupAndroidPlatformAds(),this.processCrazyGamesLoadingStart(),this.listenEvents()}},{key:"onLoad",value:function(){this.handlePauseAudio(),EQ.Core.StartSDKAfterLoadGame||en.showLoadingFullScreen(eu.BOOT_SCENE)}},{key:"start",value:function(){this.processCrazyGamesLoadingStop()}},{key:"listenEvents",value:function(){E4.catchUp(EJ.GAME_SDK_STARTED,this.processWhenGameSdkStarted)}},{key:"setupGameData",value:function(){var n=E2.getGameData();if(n){var w=n.totalLevel,k=Math.max(w,eh),C=I(I({},n),{},{totalLevel:k});E2.setGameData(C)}}},{key:"loadCurrentPlayerTheme",value:function(){var n=sO.mapOrder,w=n[0];if(E$.isObject(w)){var k=E2.getGameData(),C=null==k?void 0:k.level;if(!E$.isNumber(C))return B.loadThemeAsync(w.theme);var _,A=L(n);try{for(A.s();!(_=A.n()).done;){var T=_.value;if((C-=T.levelCount)<=0){w=T;break}}}catch(n){A.e(n)}finally{A.f()}return B.loadThemeAsync(w.theme)}}},{key:"processCrazyGamesLoadingStart",value:function(){"gameLoadingStart"in GameSDK.extra&&GameSDK.extra.gameLoadingStart()}},{key:"processCrazyGamesLoadingStop",value:function(){"gameLoadingStop"in GameSDK.extra&&GameSDK.extra.gameLoadingStop()}},{key:"setupAndroidPlatformAds",value:function(){}}]),o}(eO))||EB);ew._RF.pop(),ew._RF.push({},"29f874DL75LO5NzzNYZvHDh","RigidBodyObject",void 0);var E3,E5,E6,E8,E9,E7,_e,_t,_n,_i,_a,_r,_o=eS.ccclass,_s=eS.property;EF=_o("RigidBodyObject"),Ex=_s(eM),EU=_s(e4),EG=_s(eM),EH=_s(eW),EF((Eq=n((EV=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"gravityScale",Eq,A(n)),_(n,"linearVelocity",EW,A(n)),_(n,"bounce",EK,A(n)),_(n,"simulate",Ej,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.canvas=this.node.scene.getComponentInChildren(eE).getComponent(e_),this.uiTransform=this.node.getComponent(e_)}},{key:"update",value:function(n){if(this.simulate){this.applyGravity();var w=this.node.worldPosition.clone();w.add(new eQ(this.linearVelocity.x*n,this.linearVelocity.y*n,0)),w=this.applyBounce(w),this.node.setWorldPosition(w)}}},{key:"applyForce",value:function(n){this.linearVelocity.add(n)}},{key:"applyGravity",value:function(){var n=new e4(0,-9.8*this.gravityScale);this.applyForce(n)}},{key:"applyBounce",value:function(n){var w=this.uiTransform.getBoundingBoxToWorld();w.yMin<0&&(n.y=w.height/2,this.linearVelocity.y*=-this.bounce),w.xMin<0&&(n.x=w.width/2,this.linearVelocity.x*=-1);var k=this.canvas.width;return w.xMax>k&&(n.x=k-w.width/2,this.linearVelocity.x*=-1),n}}]),s}(eO)).prototype,"gravityScale",[Ex],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),EW=n(EV.prototype,"linearVelocity",[EU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new e4(0,0)}}),EK=n(EV.prototype,"bounce",[EG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ej=n(EV.prototype,"simulate",[EH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EV));ew._RF.pop(),ew._RF.push({},"93d88BQCU5B0L/TmaCaYNfm","AnimSkipOverlay",void 0);var _l,_u,_c,_h,_p,_d,_y,_f,_v,_g,_m,_b,_w,_S,_k,_C,_E=eS.ccclass,__=eS.property,_A=eS.disallowMultiple,SL=function(){},_T=(E3=_E("AnimSkipOverlay"),E5=__(eH),E6=__(eH),E8=__(eI),E9=z.onlyRunInLifeCycleAsync,E7=z.onlyRunInLifeCycleAsync,_e=z.onlyRunInLifeCycleAsync,E3(_t=_A((_i=n((_n=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"containerUIOpacity",_i,A(n)),_(n,"maskUIOpacity",_a,A(n)),_(n,"skipButton",_r,A(n)),n.isOpened=!1,n.currentCallback=SL,n}return T(c,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.containerUIOpacity.node.active=!1,this.skipButton.interactable=!1}},{key:"onSkipButtonPress",value:function(){this.currentCallback(),this.close()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"open",value:(L=M(function(n){var w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:this.containerUIOpacity.node.active=!0;w=n.onSkip,k=n.opacity,C=void 0===k?255:k,_=n.transitionDuration,A=void 0===_?.2:_;this.maskUIOpacity.opacity=C;return[4,this.animateUIOpacity(0,255,A)];case 1:T.sent(),this.currentCallback=w,this.skipButton.interactable=!0,this.isOpened=!0,this.node.scene.emit(V.OPENED_SKIP_OVERLAY,n);return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"close",value:(I=M(function(){var n;var w=arguments;return _ts_generator(this,function(k){switch(k.label){case 0:n=w.length>0&&void 0!==w[0]?w[0]:.2;this.skipButton.interactable=!1,this.currentCallback=SL;return[4,this.animateUIOpacity(255,0,n)];case 1:k.sent(),this.maskUIOpacity.opacity=0,this.containerUIOpacity.node.active=!1,this.isOpened=!1,this.node.scene.emit(V.CLOSED_SKIP_OVERLAY);return[2]}})}),function(){return I.apply(this,arguments)})},{key:"animateUIOpacity",value:function(n,w,k){return this.containerUIOpacity.opacity=n,N.runTweenAsync(ez(this.containerUIOpacity).to(k,{opacity:w}))}},{key:"untilClosed",value:function(){var n=this;return!1===this.isOpened?Promise.resolve():new Promise(function(w){n.node.scene.once(V.CLOSED_SKIP_OVERLAY,w)})}}]),c}(eO)).prototype,"containerUIOpacity",[E5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_a=n(_n.prototype,"maskUIOpacity",[E6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_r=n(_n.prototype,"skipButton",[E8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(_n.prototype,"open",[E9],Object.getOwnPropertyDescriptor(_n.prototype,"open"),_n.prototype),n(_n.prototype,"close",[E7],Object.getOwnPropertyDescriptor(_n.prototype,"close"),_n.prototype),n(_n.prototype,"untilClosed",[_e],Object.getOwnPropertyDescriptor(_n.prototype,"untilClosed"),_n.prototype),_t=_n))||_t)||_t);ew._RF.pop(),ew._RF.push({},"755d1r2cMRLvo4fObNWxss/","CoinContainer",void 0);var _P,_R,_I,_L,_O,_D,_M,_N,_z,_B=eS.ccclass,_F=eS.property,_x=GameCore.Utils.Number,_U=(_l=_B("CoinContainer"),_u=_F(eT),_c=_F(ex),_h=_F(eH),_p=_F(e$),_d=z.onlyRunInLifeCycle,_y=z.onlyRunInLifeCycleAsync,_f=z.onlyRunInLifeCycleAsync,_v=z.onlyRunInLifeCycle,_g=z.onlyRunInLifeCycle,_l((_w=n((_b=function(n){w(y,n);var I,L,O,D=k(y);function y(){var n;C(this,y);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"coinLabel",_w,A(n)),_(n,"coinIcon",_S,A(n)),_(n,"explosionCircle",_k,A(n)),_(n,"explosionParticles",_C,A(n)),n.currentCoin=0,n}return T(y,[{key:"setCoinTextFromNumber",value:function(n){var w=_x.getShortNumber(n,3);this.coinLabel.string=w}},{key:"handleAddCoinButton",value:function(){en.openScreen(ei.GET_COIN_SCREEN,{quantity:sC})}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.listenToEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenToEvents",value:function(){this.node.scene.on(i9.COIN_CHANGED,this.updateCoins,this)}},{key:"updateCoins",value:(O=M(function(n){var w,k,C,_,A,T,I,L,O;return _ts_generator(this,function(D){switch(D.label){case 0:_=n.coins,A=n.collectionAnimation,T=n.playSound;if(!(void 0!==A&&!1!==this.node.activeInHierarchy))return[3,4];I=A.signal;if(null===(w=this.animAbortSignal)||void 0===w||w.abort(),this.animAbortSignal=null!=I?I:new F,!A.animateTextOnly)return[3,2];return[4,this.animateCoinText(_,0,T,I)];case 1:return[2,(D.sent(),void this.setCoins(_))];case 2:L=null!==(k=A.flyDuration)&&void 0!==k?k:0,O=(null!==(C=A.floatDuration)&&void 0!==C?C:0)+L;return[4,this.animateCoinText(_,O,T,I)];case 3:D.sent(),this.setCoins(_);return[3,5];case 4:this.setCoins(_);D.label=5;case 5:return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"setCoins",value:function(n){this.setCoinTextFromNumber(n),this.currentCoin=n}},{key:"animateCoinText",value:(L=M(function(n,w){var k,C,_,A;var T=arguments;return _ts_generator(this,function(I){switch(I.label){case 0:k=this,C=!(T.length>2&&void 0!==T[2])||T[2],_=T.length>3?T[3]:void 0,A=this.currentCoin;return[4,N.waitTweenAsync(w,_)];case 1:I.sent(),C&&G.playSound(nL.COLLECT_COINS);return[4,N.runOnUpdateAsync(this.node,1,function(w){var C=Math.round(A+(n-A)*w);k.setCoinTextFromNumber(C)},_)];case 2:I.sent();return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"emitExplodeEffect",value:(I=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:this.initializeExplosionCircle(),this.explosionParticles.resetSystem();return[4,Promise.all([N.runTweenAsync(ez(this.explosionCircle.node).to(.4,{scale:new eQ(3,3,3)},{easing:"quadOut"}),n),N.runTweenAsync(ez(this.explosionCircle).delay(.2).to(.2,{opacity:0}),n)])];case 1:w.sent(),this.resetExplosionCircle();return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"resetExplosionCircle",value:function(){this.explosionCircle.node.setScale(0,0),this.explosionCircle.opacity=0}},{key:"initializeExplosionCircle",value:function(){this.explosionCircle.opacity=255,this.explosionCircle.node.setScale(0,0)}},{key:"getCoinIconWorldPosition",value:function(){return this.coinIcon.node.worldPosition}},{key:"getCoinIconWorldScale",value:function(){return this.coinIcon.node.worldScale}},{key:"onDestroy",value:function(){var n;null===(n=this.animAbortSignal)||void 0===n||n.abort()}}]),y}(eO)).prototype,"coinLabel",[_u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_S=n(_b.prototype,"coinIcon",[_c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_k=n(_b.prototype,"explosionCircle",[_h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_C=n(_b.prototype,"explosionParticles",[_p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(_b.prototype,"setCoins",[_d],Object.getOwnPropertyDescriptor(_b.prototype,"setCoins"),_b.prototype),n(_b.prototype,"animateCoinText",[_y],Object.getOwnPropertyDescriptor(_b.prototype,"animateCoinText"),_b.prototype),n(_b.prototype,"emitExplodeEffect",[_f],Object.getOwnPropertyDescriptor(_b.prototype,"emitExplodeEffect"),_b.prototype),n(_b.prototype,"resetExplosionCircle",[_v],Object.getOwnPropertyDescriptor(_b.prototype,"resetExplosionCircle"),_b.prototype),n(_b.prototype,"initializeExplosionCircle",[_g],Object.getOwnPropertyDescriptor(_b.prototype,"initializeExplosionCircle"),_b.prototype),_m=_b))||_m);ew._RF.pop(),ew._RF.push({},"95ba56f1qVFfLLdPv++OfLw","SmoothScrollView",void 0);var _G,_H=eS.ccclass,_V=eS.property,_q=(_P=_H("SmoothScrollView"),_R=_V({type:eW,group:"Mouse Scroll"}),_I=_V({type:eM,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),_L=_V({type:eM,group:"Mouse Scroll",visible:function(){return this.mouseScroll}}),_P((_M=n((_D=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"mouseScroll",_M,A(n)),_(n,"mouseScrollSpeed",_N,A(n)),_(n,"mouseScrollDuration",_z,A(n)),n}return T(s,[{key:"_onMouseWheel",value:function(n,w){if(this.mouseScroll){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(n,w)){var k=new eQ,C=n.getScrollY()<0?1:-1;this.vertical?k.set(0,C*this.mouseScrollSpeed,0):this.horizontal&&k.set(C*this.mouseScrollSpeed,0,0),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._startAutoScroll(k,this.mouseScrollDuration,!0),this._stopPropagationIfTargetIsMe(n)}}else O(D(s.prototype),"_onMouseWheel",this).call(this,n,w)}}]),s}(tb)).prototype,"mouseScroll",[_R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_N=n(_D.prototype,"mouseScrollSpeed",[_I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),_z=n(_D.prototype,"mouseScrollDuration",[_L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),_O=_D))||_O);ew._RF.pop(),ew._RF.push({},"904917NfYBJy781QxKjEPIO","ViewNode",void 0);var _W,_K,_j,_Y,_X,_Z,_J,_Q,_$,_0,_1,_2,_4,_3,_5,_6,_8,_9,_7,Ae,At=eS.ccclass,An=eS.requireComponent,Ai=At("ViewNode")(_G=An(eH)(_G=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).order=0,n}return T(o,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"setVisible",value:function(n){this.uiOpacity.opacity=n?255:0}},{key:"isVisible",value:function(){return this.uiOpacity.opacity>0}}]),o}(eO))||_G)||_G;ew._RF.pop(),ew._RF.push({},"0b250nSw/RHRq8vKigzgfhs","ScrollViewLayout",void 0);var Aa,Ar,Ao,As,Al,Au,Ac,Ah,Ap,Ad,Ay,Af,Av,Ag,Am,Ab,Aw,AS,Ak,AC,AE,A_,AA,AT,AP,AR,AI,AL,AO,AD,AM,AN,Az=eS.ccclass,AB=eS.property,AF=eS.requireComponent,Ax=GameCore.Utils.Array,AU=(_W=Az("ScrollViewLayout"),_K=AF(_q),_j=AB(e_),_Y=AB(eM),_X=AB(ta),_Z=AB(eD),_J=AB(eD),_Q=z.onlyRunInLifeCycleAsync,_$=z.onlyRunInLifeCycleAsync,_0=z.onlyRunInLifeCycleAsync,_1=z.onlyRunInLifeCycle,_2=z.onlyRunInLifeCycle,_4=z.onlyRunInLifeCycle,_W(_3=_K((_6=n((_5=function(n){w(v,n);var I,O,D,B=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"viewport",_6,A(n)),_(n,"spacing",_8,A(n)),_(n,"nodePrefab",_9,A(n)),_(n,"maxNodeCount",_7,A(n)),_(n,"extendCount",Ae,A(n)),n.nodePool=[],n.nodeHeight=0,n.scrollSignal=new F,n.onNodeVisible=function(){},n.onNodeInvisible=function(){},n}return T(v,[{key:"__preload",value:function(){this.scrollView=this.getComponent(_q),this.uiTransform=this.getComponent(e_)}},{key:"start",value:function(){var n=eA(this.nodePrefab);this.nodeHeight=n.getComponent(e_).height,n.destroy(),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"init",value:function(n,w){this.createNodePool(),this.onNodeVisible=null!=n?n:this.onNodeVisible,this.onNodeInvisible=null!=w?w:this.onNodeInvisible;for(var k=0;k<this.nodePool.length;k++)this.nodePool[k].setVisible(!1);this.updateVisibility()}},{key:"updateNodeVisibility",value:function(){for(var n=0;n<this.nodePool.length;n++)this.nodePool[n].isVisible()?this.onNodeVisible(this.nodePool[n]):this.onNodeInvisible(this.nodePool[n])}},{key:"listenEvents",value:function(){this.scrollView.node.on(tb.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.on(tw.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.on(tw.MOUSE_WHEEL,this.abortScrollSignal,this)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(tb.EventType.SCROLLING,this.updateVisibility,this),this.scrollView.node.off(tw.TOUCH_MOVE,this.abortScrollSignal,this),this.scrollView.node.off(tw.MOUSE_WHEEL,this.abortScrollSignal,this)}},{key:"scrollToOrder",value:(D=M(function(n,w){var k,C,_,A,T;var I=arguments;return _ts_generator(this,function(L){switch(L.label){case 0:k=I.length>2&&void 0!==I[2]?I[2]:2,C=this.getNodeScrollOffset(n),_=this.scrollView.getScrollOffset().y,A=(C=Math.max(C,0))-(_=Math.max(_,0));T=Math.abs(A)<5;if(T)return[3,2];return[4,this.scrollToOffset(new e4(0,C),k,w)];case 1:T=L.sent();L.label=2;case 2:return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"scrollToTop",value:(O=M(function(n){var w;var k=arguments;return _ts_generator(this,function(C){switch(C.label){case 0:w=k.length>1&&void 0!==k[1]?k[1]:2;return[4,this.scrollToOffset(new e4(0,0),w,n)];case 1:C.sent();return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"scrollToOffset",value:(I=M(function(n,w,k){var C;return _ts_generator(this,function(_){switch(_.label){case 0:C=new F;this.scrollSignal=C,this.scrollView.scrollToOffset(n,w),C.addAbortListener(this.handleScrollSignalAborted.bind(this)),k.addAbortListener(this.handleExternalSignalAborted.bind(this,n,C));return[4,N.waitTweenAsync(w,k)];case 1:_.sent();return[2]}})}),function(n,w,k){return I.apply(this,arguments)})},{key:"updateVisibility",value:function(){for(var n=this.viewport.getBoundingBoxToWorld(),w=n.yMax,k=n.yMin,C=0;C<this.maxNodeCount;C++){var _=this.getNodeBoundingBoxWorld(C),A=_.top,T=_.bot;if(A<k||T>w){var I=this.getNodeByOrder(C);I&&(this.onNodeInvisible(I),I.setVisible(!1))}else{var L=this.getNodeByOrder(C);if(L)L.isVisible()||(L.order=C,this.onNodeVisible(L),L.setVisible(!0));else{var O=this.getInvisibleNode();O&&(O.node.setPosition(this.getNodePosition(C)),O.order=C,this.onNodeVisible(O),O.setVisible(!0))}}}}},{key:"updateLayout",value:function(){var n,w=this.getVisibleNodes(),k=L(w);try{for(k.s();!(n=k.n()).done;){var C=n.value;C.node.setPosition(this.getNodePosition(C.order))}}catch(n){k.e(n)}finally{k.f()}}},{key:"setMaxNodeCount",value:function(n){this.maxNodeCount=n,this.scrollView.content.getComponent(e_).height=(this.nodeHeight+this.spacing)*this.maxNodeCount}},{key:"getAllNodes",value:function(){return this.nodePool}},{key:"getVisibleNodes",value:function(){return this.nodePool.filter(function(n){return n.isVisible()})}},{key:"getNodePosition",value:function(n){return new eQ(0,-(this.nodeHeight+this.spacing)*n-this.nodeHeight/2,0)}},{key:"getNodeScrollOffset",value:function(n){return-this.getNodePosition(n).y-this.uiTransform.node.worldPosition.y-this.uiTransform.height/2+this.viewport.node.worldPosition.y}},{key:"getNodeByOrder",value:function(n){return Ax.search(this.nodePool,function(w){return w.order===n})}},{key:"getInvisibleNode",value:function(){return Ax.search(this.nodePool,function(n){return!n.isVisible()})}},{key:"createNodePool",value:function(){if(!(this.nodePool.length>0)){var n=Math.ceil(this.viewport.height/this.nodeHeight)+1+this.extendCount;this.setMaxNodeCount(this.maxNodeCount);for(var w=0;w<n;w++){var k,C=eA(this.nodePrefab);null===(k=this.scrollView.content)||void 0===k||k.addChild(C),C.setPosition(this.getNodePosition(this.nodePool.length));var _=C.addComponent(Ai);_.order=w,_.setVisible(!1),this.nodePool.push(_)}}}},{key:"getNodeBoundingBoxWorld",value:function(n){var w,k,C=this.getNodePosition(n).y+(null!==(w=null===(k=this.scrollView.content)||void 0===k?void 0:k.worldPosition.y)&&void 0!==w?w:0);return{top:C+this.nodeHeight/2,bot:C-this.nodeHeight/2}}},{key:"abortScrollSignal",value:function(){this.scrollSignal.abort()}},{key:"handleScrollSignalAborted",value:function(){this.scrollView.stopAutoScroll(),this.updateVisibility()}},{key:"handleExternalSignalAborted",value:function(n,w){w.aborted||(this.scrollView.stopAutoScroll(),this.scrollView.scrollToOffset(n,0),this.updateVisibility())}}]),v}(eO)).prototype,"viewport",[_j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_8=n(_5.prototype,"spacing",[_Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_9=n(_5.prototype,"nodePrefab",[_X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_7=n(_5.prototype,"maxNodeCount",[_Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ae=n(_5.prototype,"extendCount",[_J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n(_5.prototype,"scrollToOrder",[_Q],Object.getOwnPropertyDescriptor(_5.prototype,"scrollToOrder"),_5.prototype),n(_5.prototype,"scrollToTop",[_$],Object.getOwnPropertyDescriptor(_5.prototype,"scrollToTop"),_5.prototype),n(_5.prototype,"scrollToOffset",[_0],Object.getOwnPropertyDescriptor(_5.prototype,"scrollToOffset"),_5.prototype),n(_5.prototype,"updateVisibility",[_1],Object.getOwnPropertyDescriptor(_5.prototype,"updateVisibility"),_5.prototype),n(_5.prototype,"handleScrollSignalAborted",[_2],Object.getOwnPropertyDescriptor(_5.prototype,"handleScrollSignalAborted"),_5.prototype),n(_5.prototype,"handleExternalSignalAborted",[_4],Object.getOwnPropertyDescriptor(_5.prototype,"handleExternalSignalAborted"),_5.prototype),_3=_5))||_3)||_3);ew._RF.pop(),ew._RF.push({},"ba822axo49BibgkqkEhhqVp","DashboardPage",void 0);var AG,AH,AV,Aq,AW,AK,Aj,AY,AX,AZ,AJ,AQ=eS.ccclass,A$=eS.property,A0=eS.disallowMultiple,A1=eS.requireComponent,A2=(Aa=AQ("DashboardPage"),Ar=A1(eN),Ao=A1(eH),As=z.required(),Al=A$({type:ek,displayName:"Page's container"}),Au=z.required(),Ac=z.required(),Ah=A$({type:ek,displayName:"Placeholder"}),Ap=z.required(),Ad=A$({displayName:"Don't create prefab",tooltip:"Tell the component to not create the prefab even if it hasn't create yet"}),Ay=A$({displayName:"Darken background"}),Af=A$({type:eD,min:0,max:255,displayName:"Background opacity",visible:function(){return this.darkenBackground}}),Av=A$({displayName:"Use navbar shadow"}),Ag=A$({type:eD,min:0,max:255,displayName:"Navbar shadow opacity",visible:function(){return this.useNavbarShadow}}),Am=z.required(),Ab=z.required(),Aw=z.onlyRunInLifeCycleAsync,AS=z.onlyRunInLifeCycle,Ak=z.onlyRunInLifeCycleAsync,Aa(AC=A0(AC=Ar(AC=Ao((A_=n((AE=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"container",A_,A(n)),_(n,"containerUIOpacity",AA,A(n)),_(n,"placeholder",AT,A(n)),_(n,"placeholderUIOpacity",AP,A(n)),_(n,"hasCreated",AR,A(n)),n.pagePrefab=null,_(n,"darkenBackground",AI,A(n)),_(n,"backgroundOpacity",AL,A(n)),_(n,"useNavbarShadow",AO,A(n)),_(n,"navbarShadowOpacity",AD,A(n)),_(n,"uiOpacity",AM,A(n)),_(n,"widgetComponent",AN,A(n)),n}return T(c,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(eH),this.widgetComponent=this.getComponent(eN),this.containerUIOpacity=this.container.getComponent(eH),this.placeholderUIOpacity=this.placeholder.getComponent(eH),z.validateRequiredProperties(this)}},{key:"start",value:function(){this.container.active=!0,this.placeholder.active=!0}},{key:"getWidget",value:function(){return this.widgetComponent}},{key:"show",value:function(){this.uiOpacity.opacity=255}},{key:"hide",value:function(){this.uiOpacity.opacity=0}},{key:"mount",value:(L=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=this.hasCreated;if(n)return[3,2];return[4,this.create()];case 1:n=w.sent();w.label=2;case 2:this.mountInLifeCycle();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"mountInLifeCycle",value:function(){this.placeholderUIOpacity.opacity=0,this.containerUIOpacity.opacity=255,H.trackCurrentPage(this.node.name,!0)}},{key:"unmount",value:function(){255===this.placeholderUIOpacity.opacity&&0===this.containerUIOpacity.opacity||(this.placeholderUIOpacity.opacity=255,this.containerUIOpacity.opacity=0)}},{key:"transitionIn",value:function(){return Promise.resolve()}},{key:"transitionOut",value:function(){return Promise.resolve()}},{key:"hasLoadedPage",value:function(){return!0}},{key:"getContainer",value:function(){return this.container}},{key:"getDarkenBackground",value:function(){return this.darkenBackground?this.backgroundOpacity:0}},{key:"getNavbarShadow",value:function(){return this.useNavbarShadow?this.navbarShadowOpacity:0}},{key:"create",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:if(!(this.pagePrefab&&!this.hasCreated))return[3,2];n=eA(this.pagePrefab);this.container.addChild(n);return[4,N.waitTweenAsync(0)];case 1:w.sent(),this.hasCreated=!0;w.label=2;case 2:return[2]}})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"container",[As,Al],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AA=n(AE.prototype,"containerUIOpacity",[Au],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AT=n(AE.prototype,"placeholder",[Ac,Ah],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AP=n(AE.prototype,"placeholderUIOpacity",[Ap],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AR=n(AE.prototype,"hasCreated",[Ad],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AI=n(AE.prototype,"darkenBackground",[Ay],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AL=n(AE.prototype,"backgroundOpacity",[Af],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),AO=n(AE.prototype,"useNavbarShadow",[Av],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AD=n(AE.prototype,"navbarShadowOpacity",[Ag],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),AM=n(AE.prototype,"uiOpacity",[Am],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AN=n(AE.prototype,"widgetComponent",[Ab],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(AE.prototype,"mount",[Aw],Object.getOwnPropertyDescriptor(AE.prototype,"mount"),AE.prototype),n(AE.prototype,"mountInLifeCycle",[AS],Object.getOwnPropertyDescriptor(AE.prototype,"mountInLifeCycle"),AE.prototype),n(AE.prototype,"create",[Ak],Object.getOwnPropertyDescriptor(AE.prototype,"create"),AE.prototype),AC=AE))||AC)||AC)||AC)||AC);ew._RF.pop(),ew._RF.push({},"18bbbp5z2VHVKp4jjjmsAhu","ThemeProgressBar",void 0);var A4,A3,A5,A6,A8,A9,A7,Te,Tt,Tn,Ti,Ta,Tr,To,Ts,Tl,Tu,Th=eS.ccclass,Tp=eS.property,Td=(AG=Th("ThemeProgressBar"),AH=Tp(ek),AV=Tp(ek),Aq=Tp(ek),AW=Tp(ek),AG((AY=n((Aj=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"progressBar",AY,A(n)),_(n,"progressText",AX,A(n)),_(n,"leftCap",AZ,A(n)),_(n,"rightCap",AJ,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("ThemeProgressBar: progressBar not found");if(!this.progressText)throw new Error("ThemeProgressBar: progressText not found");if(!this.leftCap)throw new Error("ThemeProgressBar: leftCap not found");if(!this.rightCap)throw new Error("ThemeProgressBar: rightCap not found")}},{key:"setProgress",value:function(n,w){n<=0?(this.leftCap.active=!1,this.rightCap.active=!1):(this.leftCap.active=!0,this.rightCap.active=!0);var k=this.progressBar.getComponent(e2);if(!k)throw new Error("ThemeProgressBar: progressBarComponent not found");k.progress=n/w;var C=this.progressText.getComponent(eT);if(!C)throw new Error("ThemeProgressBar: progressTextComponent not found");C.string="".concat(n,"/").concat(w)}}]),s}(eO)).prototype,"progressBar",[AH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AX=n(Aj.prototype,"progressText",[AV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AZ=n(Aj.prototype,"leftCap",[Aq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AJ=n(Aj.prototype,"rightCap",[AW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AK=Aj))||AK);ew._RF.pop(),ew._RF.push({},"e62f9TdkTxOyJy6vcnplnCB","LockAnimator",void 0);var Ty,Tf,Tv,Tg,Tm,Tb,Tw,TS,Tk,TC,TE,T_,TA,TT,TP,TR,TI,TL,TO,TD,TM,TN,Tz,TB,TF,Tx,TU,TG=eS.ccclass,TH=eS.disallowMultiple,TV=eS.property,Tq=[50,160],TW=(A4=TG("LockAnimator"),A3=TV(e$),A5=TV(e7),A6=TV(tm),A8=TV(tm),A9=TV(tm),A7=TV(sn),Te=TV({type:eD,min:0}),A4(Tt=TH((Ti=n((Tn=function(n){w(y,n);var I,L,O,D=k(y);function y(){var n;C(this,y);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"floatingParticles",Ti,A(n)),_(n,"iconAnimation",Ta,A(n)),_(n,"lockClip",Tr,A(n)),_(n,"unlockClip",To,A(n)),_(n,"tryToUnlockClip",Ts,A(n)),_(n,"trailTemplate",Tl,A(n)),_(n,"trailCount",Tu,A(n)),n.trails=[],n}return T(y,[{key:"onLoad",value:function(){this.validateRequiredComponents(),this.prepareTrails(),this.floatingParticles.node.active=!1}},{key:"unlock",value:(O=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:this.floatingParticles.node.active=!0,this.floatingParticles.resetSystem();return[4,this.playAnimation(this.unlockClip.name,n)];case 1:w.sent(),this.floatingParticles.stopSystem();return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"fireExplosionParticles",value:function(){this.explodeTrails()}},{key:"lock",value:function(){this.playAnimation(this.lockClip.name),this.floatingParticles.node.active&&this.floatingParticles.stopSystem()}},{key:"explodeTrails",value:function(){var n=this;return Promise.all(this.trails.map(function(w){return N.runTweenAsync(n.getExplodeTrail(w))}))}},{key:"getExplodeTrail",value:function(n,w){var k=arguments.length>1&&void 0!==w?w:0,C=tn(0,2*Math.PI),_=tn(Tq[0],Tq[1])*Math.cos(C),A=tn(Tq[0],Tq[1])*Math.sin(C),T=new eQ(_,A,n.node.position.z),I=n.node.scale.clone();return ez(n.node).delay(k).call(function(){n.node.setPosition(0,0),n.reset(),n.node.active=!0}).to(.5,{position:T.clone()},{easing:"expoOut"}).to(.5,{scale:new eQ(0,0,1)},{easing:"expoIn"}).call(function(){n.node.setPosition(0,0),n.node.scale=I,n.reset(),n.node.active=!1})}},{key:"prepareTrails",value:function(){this.trailTemplate.node.active=!1;for(var n=0;n<this.trailCount;n++){var w=eA(this.trailTemplate.node);w.setParent(this.node),w.active=!1,this.trails.push(w.getComponent(sn))}}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"playAnimation",value:(L=M(function(n,w){var k;return _ts_generator(this,function(C){k=this;return[2,null!=w&&w.aborted?Promise.resolve():new Promise(function(C){k.iconAnimation.once(e7.EventType.FINISHED,function(){C()}),null==w||w.addAbortListener(function(){k.iconAnimation.off(e7.EventType.FINISHED),k.iconAnimation.stop(),C()}),k.iconAnimation.play(n)})]})}),function(n,w){return L.apply(this,arguments)})},{key:"playTryToUnlockAnimation",value:(I=M(function(){return _ts_generator(this,function(n){return[2,this.playAnimation(this.tryToUnlockClip.name)]})}),function(){return I.apply(this,arguments)})}]),y}(eO)).prototype,"floatingParticles",[A3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ta=n(Tn.prototype,"iconAnimation",[A5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tr=n(Tn.prototype,"lockClip",[A6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),To=n(Tn.prototype,"unlockClip",[A8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ts=n(Tn.prototype,"tryToUnlockClip",[A9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tl=n(Tn.prototype,"trailTemplate",[A7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=n(Tn.prototype,"trailCount",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Tt=Tn))||Tt)||Tt);ew._RF.pop(),ew._RF.push({},"aef0d6qo8hNUJ7qNl2wuT29","ThemeBlock",void 0);var TK,Tj,TY,TX,TZ,TJ,TQ,T$,T0,T1,T2,T4,T3,T5=eS.ccclass,T6=eS.property,T8={progress:0,max:10,isLocked:!0,theme:el.SUMMER,skins:["fruit"]},T9=GameCore.Utils.Array,T7=(Ty=T5("ThemeBlock"),Tf=T6(ek),Tv=T6(ek),Tg=T6(TW),Tm=T6({type:ek,group:"Container"}),Tb=T6({type:eH,group:"Container"}),Tw=T6({type:ek,group:"Theme"}),TS=T6({type:ex,group:"Theme"}),Tk=T6({type:K,group:"Title"}),TC=T6({type:eH,group:"Title"}),TE=T6({type:ex,group:"Tile"}),T_=T6({type:eH,group:"Tile"}),TA=T6(eW),TT=z.onlyRunInLifeCycleAsync,Ty((TI=n((TR=function(n){w(m,n);var L,O,D,x,U=k(m);function m(){var n;C(this,m);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=U.call.apply(U,[this].concat(k)),_(n,"mask",TI,A(n)),_(n,"progressBar",TL,A(n)),_(n,"lockAnimator",TO,A(n)),_(n,"container",TD,A(n)),_(n,"containerOpacity",TM,A(n)),_(n,"themeLoadingRing",TN,A(n)),_(n,"themeSprite",Tz,A(n)),_(n,"titleLocalizer",TB,A(n)),_(n,"titleOpacity",TF,A(n)),_(n,"tileBlockIconSprite",Tx,A(n)),_(n,"newTilesOpacity",TU,A(n)),n.signal=new F,n.payload=T8,n}return T(m,[{key:"isLocked",get:function(){return this.payload.isLocked},set:function(n){this.payload.isLocked=n,this.updateInfo()}},{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateInfo",value:function(n){var w=arguments.length>0&&void 0!==n?n:T8;this.payload=w;var k=w.progress,C=w.max,_=w.isLocked,A=w.theme,T=w.skins;this.signal.abort();var I=new F;this.signal=I,this.updateTitle(A),this.updateSkinAsync(T,I),this.updateThemeAsync(A,I);var L=this.progressBar.getComponent(Td);if(!L)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=_,this.progressBar.active=!_,this.lockAnimator.node.active=_,_||L.setProgress(k,C)}},{key:"playUnlockAnim",value:(x=M(function(n){var w,k,C,_;var A=arguments;return _ts_generator(this,function(T){switch(T.label){case 0:w=A.length>1&&void 0!==A[1]?A[1]:T8;this.payload=I(I({},w),{},{isLocked:!1});k=w.progress,C=w.max,_=this.progressBar.getComponent(Td);if(!_)throw new Error("ThemeBlock: progressBarComponent not found");this.mask.active=!0,this.progressBar.active=!1,this.lockAnimator.node.active=!0,_.setProgress(k,C);return[4,this.animateUnlockedState(n)];case 1:T.sent();return[2]}})}),function(n){return x.apply(this,arguments)})},{key:"updateTitle",value:function(n){var w=CA[n];this.titleLocalizer.key=w}},{key:"updateSkinAsync",value:(D=M(function(n,w){var k,C,_,A,T,I,L,O,D,N,z;return _ts_generator(this,function(F){switch(F.label){case 0:k=this.tileBlockIconSprite.length,C=n.length,_=n.map(function(){var n=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,B.loadSkinPreviewAsync(n)];case 1:return[2,w.sent()]}})});return function(w){return n.apply(this,arguments)}}());return[4,Promise.all(_)];case 1:A=F.sent();if(!w.aborted&&this.tileBlockIconSprite){if(C<=k){for(T=Math.floor(k/C),I=k%C,L=j(T9.fillWith(C,function(){return T})),O=0;O<I;O++)L[O]++;for(D=0,N=0;N<C;N++)for(z=0;z<L[N]&&D<k;z++,D++)this.tileBlockIconSprite[D].spriteFrame=A[N][z]}else this.tileBlockIconSprite.forEach(function(n,w){n.spriteFrame=A[w%C][0]})}return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"updateThemeAsync",value:(O=M(function(n,w){var k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:this.themeSprite.spriteFrame=null;k=B.getAsset("".concat(ep[n],"/spriteFrame"),e9);C=k;if(C)return[3,2];this.themeLoadingRing.active=!0;return[4,B.loadThemePreviewAsync(n)];case 1:C=k=A.sent();A.label=2;case 2:_=k;if(_)return[3,4];return[4,B.loadThemePreviewAsync(el.SUMMER)];case 3:_=k=A.sent();A.label=4;case 4:this.themeSprite&&k&&!w.aborted&&(this.themeSprite.spriteFrame=k,this.themeLoadingRing.active=!1);return[2]}})}),function(n,w){return O.apply(this,arguments)})},{key:"animateUnlockedState",value:(L=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:k=this.mask.getComponent(eH),C=this.progressBar.getComponent(eH);if(!k)throw new Error("ThemeBlock: maskUIOpacity not found");if(!C)throw new Error("ThemeBlock: progressBarUIOpacity not found");this.mask.active=!0,k.opacity=null!==(w=k.opacity)&&void 0!==w?w:255,this.progressBar.active=!0,C.opacity=0;return[4,this.lockAnimator.unlock(n)];case 1:_.sent(),this.lockAnimator.node.active=!1;return[4,Promise.all([N.runTweenAsync(ez(k).to(.25,{opacity:0}),n),N.runTweenAsync(ez(C).to(.25,{opacity:255}),n)])];case 2:_.sent(),this.mask.active=!1,k.opacity=0,C.opacity=255;return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"setVisible",value:function(n){this.containerOpacity.opacity=n?255:0,this.titleOpacity.opacity=n?255:0,this.newTilesOpacity.opacity=n?255:0}}]),m}(eO)).prototype,"mask",[Tf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TL=n(TR.prototype,"progressBar",[Tv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TO=n(TR.prototype,"lockAnimator",[Tg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TD=n(TR.prototype,"container",[Tm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TM=n(TR.prototype,"containerOpacity",[Tb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TN=n(TR.prototype,"themeLoadingRing",[Tw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tz=n(TR.prototype,"themeSprite",[TS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TB=n(TR.prototype,"titleLocalizer",[Tk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TF=n(TR.prototype,"titleOpacity",[TC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tx=n(TR.prototype,"tileBlockIconSprite",[TE],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),TU=n(TR.prototype,"newTilesOpacity",[T_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(TR.prototype,"isLocked",[TA],Object.getOwnPropertyDescriptor(TR.prototype,"isLocked"),TR.prototype),n(TR.prototype,"updateSkinAsync",[TT],Object.getOwnPropertyDescriptor(TR.prototype,"updateSkinAsync"),TR.prototype),TP=TR))||TP);ew._RF.pop(),ew._RF.push({},"b3a4dy5XgpIT6stybzgYjnu","CollectionsContent",void 0);var Pe,Pt,Pn,Pi,Pa,Pr,Po,Ps,Pl,Pu=eS.ccclass,Ph=eS.property,Pp=globalThis.game.storage,Pd=(TK=Pu("CollectionsContent"),Tj=Ph(aE),TY=Ph(AU),TX=Ph(i_),TZ=Ph({type:eM,displayName:"Offset from top of scroll view",tooltip:"The offset between the first theme tab and the top of the scroll view"}),TJ=z.onlyRunInLifeCycleAsync,TQ=z.onlyRunInLifeCycleAsync,TK((T1=n((T0=function(n){w(p,n);var L,O,D=k(p);function p(){var n;C(this,p);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return(n=D.call.apply(D,[this].concat(k))).animateThemeBlockUnlockIndex=null,_(n,"panelAnimator",T1,A(n)),_(n,"themeScrollView",T2,A(n)),_(n,"contentOpacity",T4,A(n)),n.themeScrollViewInited=!1,n.payloads=[],n.preservedScrollPosition=new e4,_(n,"offsetFromTopOfScrollView",T3,A(n)),n.hideContent=function(){n.contentOpacity.changeStateFade(!1,.1)},n.showContent=function(){n.contentOpacity.changeStateFade(!0,.1)},n}return T(p,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"listenEvents",value:function(){this.node.scene.on(i9.HIDE_UI,this.hideContent),this.node.scene.on(i9.SHOW_UI,this.showContent),this.themeScrollView.listenEvents()}},{key:"unlistenEvents",value:function(){this.unlistenUIEvents(),this.themeScrollView.unlistenEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(i9.HIDE_UI,this.hideContent),this.node.scene.off(i9.SHOW_UI,this.showContent)}},{key:"init",value:function(n){var w=this;this.payloads=n,this.themeScrollViewInited||(this.themeScrollViewInited=!0,this.themeScrollView.init(function(n){var k=w.animateThemeBlockUnlockIndex===n.order,C=w.payloads[n.order],_=n.getComponent(T7);_.updateInfo(I(I({},C),{},{isLocked:!!k||C.isLocked})),_.setVisible(!0),_.container.scale=new eQ(.4,.4,.4),ez(_.container).to(.3,{scale:eQ.ONE},{easing:"quadOut"}).start()}))}},{key:"preserveScrollPosition",value:function(){this.themeScrollView.scrollView.stopAutoScroll(),this.preservedScrollPosition.set(this.themeScrollView.scrollView.getScrollOffset())}},{key:"restoreScrollPosition",value:function(){this.themeScrollView.scrollView.scrollToOffset(this.preservedScrollPosition,0)}},{key:"updateUnlockedProgress",value:function(n){var w=this,k=Pp.getStorageData("collection","animateMapPackUnlock"),C=Pp.getStorageData("collection","lastMapPack");n.forEach(function(n,_){var A=n.progress,T=n.max,I=n.isLocked;if(A<T&&!I&&k&&C!==_+1)return w.animateThemeBlockUnlockIndex=_,Pp.setStorageData("collection","animateMapPackUnlock",!1),void Pp.setStorageData("collection","lastMapPack",_+1)})}},{key:"shouldAnimateThemeBlockUnlock",value:function(){return null!==this.animateThemeBlockUnlockIndex}},{key:"playThemeTabUnlockAnim",value:(O=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:if(!this.animateThemeBlockUnlockIndex)return[3,2];w=this.themeScrollView.getNodeByOrder(this.animateThemeBlockUnlockIndex);if(!(w&&w.isVisible()))return[3,2];k=w.getComponent(T7);if(!k)return[3,2];C=sB.getCollectionUnlockProgress()[this.animateThemeBlockUnlockIndex];return[4,k.playUnlockAnim(n,I(I({},C),{},{isLocked:!0}))];case 1:_.sent(),this.animateThemeBlockUnlockIndex=null;_.label=2;case 2:return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"scrollToCurrentUnlockingTheme",value:(L=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,this.themeScrollView.scrollToOrder(n,w)];case 1:k.sent();return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),p}(eO)).prototype,"panelAnimator",[Tj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T2=n(T0.prototype,"themeScrollView",[TY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T4=n(T0.prototype,"contentOpacity",[TX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T3=n(T0.prototype,"offsetFromTopOfScrollView",[TZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 407.5}}),n(T0.prototype,"playThemeTabUnlockAnim",[TJ],Object.getOwnPropertyDescriptor(T0.prototype,"playThemeTabUnlockAnim"),T0.prototype),n(T0.prototype,"scrollToCurrentUnlockingTheme",[TQ],Object.getOwnPropertyDescriptor(T0.prototype,"scrollToCurrentUnlockingTheme"),T0.prototype),T$=T0))||T$);ew._RF.pop(),ew._RF.push({},"dab8cbliOBAeZ7iVs959mBm","CollectionsPage",void 0);var Py,Pf,Pv,Pg,Pm,Pb,Pw,PS,Pk,PC,PE,P_,PA,PT,PP,PR,PI,PL,PO,PD,PM,PN,Pz,PB,PF,Px,PU,PG,PH,PV,Pq,PW,PK,Pj,PY,PX,PZ,PJ,PQ,P$=(Pe=(0,eS.ccclass)("CollectionsPage"),Pt=z.required(),Pn=z.onlyRunInLifeCycleAsync,Pi=z.onlyRunInLifeCycle,Pa=z.onlyRunInLifeCycleAsync,Pr=z.onlyRunInLifeCycleAsync,Pe((Pl=n((Ps=function(n){w(v,n);var I,L,z,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return(n=F.call.apply(F,[this].concat(k))).payload=null,_(n,"panelAnimationController",Pl,A(n)),n}return T(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(am),O(D(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(B=M(function(){return _ts_generator(this,function(n){O(D(v.prototype),"start",this).call(this);return[2]})}),function(){return B.apply(this,arguments)})},{key:"setPayload",value:function(n){this.payload=n}},{key:"mount",value:(z=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"mount",this).call(this)];case 1:n.sent(),this.onMount();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,!this.themeContent&&(this.themeContent=this.container.getComponentInChildren(Pd),!this.themeContent))throw new Error("No theme content found");this.payload&&this.themeContent.init(this.payload);var n=sB.getCollectionUnlockProgress();this.themeContent.updateUnlockedProgress(n)}},{key:"transitionIn",value:(L=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:return[4,O(D(v.prototype),"transitionIn",this).call(this)];case 1:k.sent(),this.themeContent.restoreScrollPosition(),this.themeContent.listenEvents();n=N.runTweenAsync(ez(this.containerUIOpacity).to(.2,{opacity:255})),w=this.panelAnimationController.showUI();return[4,Promise.all([n,w])];case 2:k.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"transitionOut",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"transitionOut",this).call(this)];case 1:n.sent(),this.themeContent.preserveScrollPosition(),this.themeContent.unlistenUIEvents();return[4,this.panelAnimationController.hideUI()];case 2:n.sent(),this.themeContent.unlistenEvents();return[2]}})}),function(){return I.apply(this,arguments)})}]),v}(A2)).prototype,"panelAnimationController",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Ps.prototype,"mount",[Pn],Object.getOwnPropertyDescriptor(Ps.prototype,"mount"),Ps.prototype),n(Ps.prototype,"onMount",[Pi],Object.getOwnPropertyDescriptor(Ps.prototype,"onMount"),Ps.prototype),n(Ps.prototype,"transitionIn",[Pa],Object.getOwnPropertyDescriptor(Ps.prototype,"transitionIn"),Ps.prototype),n(Ps.prototype,"transitionOut",[Pr],Object.getOwnPropertyDescriptor(Ps.prototype,"transitionOut"),Ps.prototype),Po=Ps))||Po);ew._RF.pop(),ew._RF.push({},"2381b1mKt1PUq5W+fsaaOYP","PageManager",void 0);var P0,P1,P2,P4,P3,P5,P6,P8,P9,P7,Re,Rt,Rn,Ri=eS.ccclass,Ra=eS.property,Rr=eS.disallowMultiple,Ro=eS.requireComponent,Rs=GameCore.Utils.Array,Rl=(Py=Ri("PageManagerItem"),Pf=Ra(A2),Pv=Ra({type:eU(nk)}),Py((Pb=n((Pm=T(function e(){C(this,e),_(this,"page",Pb,this),_(this,"pageType",Pw,this)})).prototype,"page",[Pf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pw=n(Pm.prototype,"pageType",[Pv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pg=Pm))||Pg),Ru=(PS=Ri("PageManager"),Pk=Ro(e_),PC=z.required(),PE=Ra({type:eH,displayName:"Background Mask",group:"Background Mask"}),P_=Ra({type:eM,displayName:"Transition duration",group:"Background Mask"}),PA=Ra({type:eM,displayName:"Transition delay",group:"Background Mask"}),PT=z.required(),PP=Ra({type:eH,displayName:"Nav Bar Shadow",group:"Nav Bar Shadow"}),PR=Ra({type:eM,displayName:"Transition duration",group:"Nav Bar Shadow"}),PI=Ra({type:eM,displayName:"Transition delay",group:"Nav Bar Shadow"}),PL=Ra({type:[Rl]}),PO=Ra({type:eU(nk)}),PD=z.required(),PM=z.onlyRunInLifeCycleAsync,PN=z.onlyRunInLifeCycleAsync,Pz=z.onlyRunInLifeCycle,PB=z.onlyRunInLifeCycle,PF=z.onlyRunInLifeCycle,Px=z.onlyRunInLifeCycleAsync,PU=z.onlyRunInLifeCycleAsync,PG=z.onlyRunInLifeCycleAsync,PS(PH=Rr(PH=Pk((Pq=n((PV=function(n){w(S,n);var I,L,O,D,B,F,x,U,G,H=k(S);function S(){var n;C(this,S);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=H.call.apply(H,[this].concat(k)),_(n,"backgroundMask",Pq,A(n)),_(n,"backgroundMaskTransitionDuration",PW,A(n)),_(n,"backgroundMaskTransitionDelay",PK,A(n)),_(n,"navBarShadow",Pj,A(n)),_(n,"navBarShadowTransitionDuration",PY,A(n)),_(n,"navBarShadowTransitionDelay",PX,A(n)),_(n,"pageItems",PZ,A(n)),_(n,"currentScreen",PJ,A(n)),_(n,"uiTransform",PQ,A(n)),n}return T(S,[{key:"unmountAndHideAll",value:function(){var n=this;this.pageItems.forEach(function(w){var k=w.page;w.pageType!==n.currentScreen&&(k.unmount(),k.hide())})}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(e_),z.validateRequiredProperties(this),eY.on(V.VIEW_RESIZED,this.init,this)}},{key:"onDestroy",value:function(){eY.off(V.VIEW_RESIZED,this.init,this)}},{key:"init",value:function(){var n=this;this.pageItems.forEach(function(w,k){var C=w.page.getWidget(),_=n.getPageIndex(n.currentScreen);C.right=-(k-_)*n.uiTransform.width,C.left=(k-_)*n.uiTransform.width,C.updateAlignment()})}},{key:"updateCollectionsContentPayload",value:function(n){var w=this.getPage(nk.collections);w&&_instanceof(w,P$)&&w.setPayload(n)}},{key:"navigate",value:(G=M(function(n,w,k,C){var _,A;return _ts_generator(this,function(T){switch(T.label){case 0:_=n.from,A=n.to;if(!(null!==_))return[3,2];return[4,this.navigateFromPage(_,A,w,k,C)];case 1:T.sent();return[3,4];case 2:return[4,this.navigateFromNull(A,k,C)];case 3:T.sent();T.label=4;case 4:return[2]}})}),function(n,w,k,C){return G.apply(this,arguments)})},{key:"navigateFromPage",value:(U=M(function(n,w,k,C,_){var A,T,I,L,O,D,M,N,z,B,F,x,U;return _ts_generator(this,function(G){switch(G.label){case 0:A=this,T=this.validateNavigationRequest(n,w),I=T.toPage,L=T.fromPage;this.currentScreen=w;O=this.uiTransform.width,D=this.getPageIndex(n),M=this.getPageIndex(w),N=Math.min(D,M),z=Math.max(D,M),B=(z-N)*O,F=D<M?1:-1,x=this.pageItems.slice(N,z+1);x.forEach(function(n,w){var k=n.page;k.show(),k.getWidget().enabled=!1,k.node.position=new eQ((w+N-D)*O,k.node.position.y,k.node.position.z)});U=!I.hasLoadedPage();U&&this.showLoadingScreen();return[4,this.mountPage(I,C)];case 1:G.sent();return[4,k.callAsync(function(){return A.performFullTransition({from:n,to:w,fromPage:L,toPage:I,distance:B,direction:F,items:x})})];case 2:G.sent(),k.call(function(){return A.cleanupPages(I,x.filter(function(n){return n.pageType!==w}))});return[4,k.callAsync(function(){return A.transitionInPage(I,_)})];case 3:G.sent(),U&&this.hideLoadingScreen();return[2]}})}),function(n,w,k,C,_){return U.apply(this,arguments)})},{key:"hideLoadingScreen",value:function(){en.closeLoadingScreen()}},{key:"showLoadingScreen",value:function(){en.showLoadingScreen()}},{key:"cleanupPages",value:function(n,w){var k=n.getWidget();k.enabled=!0,k.left=0,k.right=0,e1.instance.emit("canvas-resize"),w.forEach(function(n){n.page.unmount(),n.page.hide()})}},{key:"performFullTransition",value:(x=M(function(n){var w,k,C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:w=n.from,k=n.to,C=n.fromPage,_=n.distance,A=n.direction,T=n.items,I=n.toPage;this.node.scene.emit(t5,{from:w,to:k});return[4,Promise.all([C.transitionOut(),this.transition(_,A,T),this.handleBackgroundMask(this.backgroundMaskTransitionDuration,I.getDarkenBackground()),this.handleNavBarShadow(this.navBarShadowTransitionDuration,I.getNavbarShadow())])];case 1:L.sent();return[2]}})}),function(n){return x.apply(this,arguments)})},{key:"mountPage",value:(F=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,n.mount()];case 1:k.sent();return[4,null==w?void 0:w(n)];case 2:k.sent();return[2]}})}),function(n,w){return F.apply(this,arguments)})},{key:"validateNavigationRequest",value:function(n,w){if(n!==this.currentScreen)throw new Error("PageManager: Cannot navigate from a different screen. Perhaps you forgot to update the currentScreen property.");var k=this.getPage(this.currentScreen),C=this.getPage(w);if(!C||!k)throw new Error("PageManager: Cannot navigate to/from a null page. Perhaps you forgot to add the page to the pageItems array in the editor.");return{toPage:C,fromPage:k}}},{key:"navigateFromNull",value:(B=M(function(n,w,k){var C;return _ts_generator(this,function(_){switch(_.label){case 0:C=this.getPage(this.currentScreen);C.show(),this.currentScreen=n;return[4,this.mountPage(C,w)];case 1:_.sent(),this.node.scene.emit(t5,{from:null,to:n});return[4,this.transitionInPage(C,k)];case 2:_.sent();return[2]}})}),function(n,w,k){return B.apply(this,arguments)})},{key:"transitionInPage",value:(D=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,n.transitionIn()];case 1:k.sent();return[4,null==w?void 0:w(n)];case 2:k.sent();return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"getPage",value:function(n){var w=this.getPageIndex(n);return -1!==w?this.pageItems[w].page:null}},{key:"handleBackgroundMask",value:(O=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,N.runTweenAsync(ez(this.backgroundMask).delay(this.backgroundMaskTransitionDelay).to(n,{opacity:w}).start())];case 1:k.sent();return[2]}})}),function(n,w){return O.apply(this,arguments)})},{key:"handleNavBarShadow",value:(L=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,N.runTweenAsync(ez(this.navBarShadow).delay(this.navBarShadowTransitionDelay).to(n,{opacity:w}).start())];case 1:k.sent();return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"getPageIndex",value:function(n){return Rs.searchIndex(this.pageItems,function(w){return w.pageType===n})}},{key:"transition",value:(I=M(function(n,w,k){return _ts_generator(this,function(C){switch(C.label){case 0:return[4,Promise.all(k.map(function(k){var C=k.page;return N.runTweenAsync(ez(C.node).to(.5,{position:new eQ(C.node.position.x-n*w,C.node.position.y,C.node.position.z)},{easing:eG.quintInOut}))}))];case 1:C.sent();return[2]}})}),function(n,w,k){return I.apply(this,arguments)})}]),S}(eO)).prototype,"backgroundMask",[PC,PE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PW=n(PV.prototype,"backgroundMaskTransitionDuration",[P_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),PK=n(PV.prototype,"backgroundMaskTransitionDelay",[PA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .3}}),Pj=n(PV.prototype,"navBarShadow",[PT,PP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PY=n(PV.prototype,"navBarShadowTransitionDuration",[PR],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),PX=n(PV.prototype,"navBarShadowTransitionDelay",[PI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .3}}),PZ=n(PV.prototype,"pageItems",[PL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),PJ=n(PV.prototype,"currentScreen",[PO],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return nk.home}}),PQ=n(PV.prototype,"uiTransform",[PD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(PV.prototype,"navigate",[PM],Object.getOwnPropertyDescriptor(PV.prototype,"navigate"),PV.prototype),n(PV.prototype,"navigateFromPage",[PN],Object.getOwnPropertyDescriptor(PV.prototype,"navigateFromPage"),PV.prototype),n(PV.prototype,"hideLoadingScreen",[Pz],Object.getOwnPropertyDescriptor(PV.prototype,"hideLoadingScreen"),PV.prototype),n(PV.prototype,"showLoadingScreen",[PB],Object.getOwnPropertyDescriptor(PV.prototype,"showLoadingScreen"),PV.prototype),n(PV.prototype,"cleanupPages",[PF],Object.getOwnPropertyDescriptor(PV.prototype,"cleanupPages"),PV.prototype),n(PV.prototype,"performFullTransition",[Px],Object.getOwnPropertyDescriptor(PV.prototype,"performFullTransition"),PV.prototype),n(PV.prototype,"mountPage",[PU],Object.getOwnPropertyDescriptor(PV.prototype,"mountPage"),PV.prototype),n(PV.prototype,"navigateFromNull",[PG],Object.getOwnPropertyDescriptor(PV.prototype,"navigateFromNull"),PV.prototype),PH=PV))||PH)||PH)||PH);ew._RF.pop(),ew._RF.push({},"500274Qu9dAjJwYv27wMaMU","StarProgressBar",void 0);var Rc,Rh,Rp,Rd,Ry,Rf,Rv=eS.ccclass,Rg=eS.property,Rm=(P0=Rv("StarProgressBar"),P1=Rg(rw),P2=Rg(eT),P4=Rg(eD),P3=Rg(eD),P5=Rg(e3),P0((P9=n((P8=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"progressBar",P9,A(n)),_(n,"progressLabel",P7,A(n)),_(n,"current",Re,A(n)),_(n,"total",Rt,A(n)),_(n,"separator",Rn,A(n)),n}return T(u,[{key:"setRange",value:function(n,w){this.total=w,this.current=n,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"updateProgress",value:function(){this.progressBar.progress=Math.min(this.current,this.total)/this.total,this.updateProgressLabel()}},{key:"updateProgressLabel",value:function(){this.progressLabel.string="".concat(this.current).concat(this.separator).concat(this.total)}},{key:"animateTo",value:(I=M(function(n,w,k){var C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:C=this,_=Math.min(n,this.total)/this.total,A=this.current,T=1,I=ez(this.progressBar).to(3,{progress:_},{easing:"quadOut",onUpdate:function(w,_){_&&(C.current=A+Math.floor((n-A)*_),null==k||k(C.current),C.current===A-T&&(T++,ez(C.progressLabel.node).to(.05,{scale:new eQ(1.2,1.2,1.2)}).to(.05,{scale:eQ.ONE}).start()),C.updateProgressLabel())}});null==w||w.addAbortListener(function(){C.current=n,C.updateProgress()});return[4,N.runTweenAsync(I,w)];case 1:L.sent();return[2]}})}),function(n,w,k){return I.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),u}(eO)).prototype,"progressBar",[P1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P7=n(P8.prototype,"progressLabel",[P2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=n(P8.prototype,"current",[P4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=n(P8.prototype,"total",[P3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=n(P8.prototype,"separator",[P5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P6=P8))||P6);ew._RF.pop(),ew._RF.push({},"83036ocqiZHXrI3Aq0dBJRD","EventButton",void 0);var Rb,Rw,RS,Rk,RC,RE,R_,RA,RT,RP,RR,RI=eS.ccclass,RL=eS.property,RO=(Rc=RI("EventButton"),Rh=RL({type:eU(Cv)}),Rp=RL(eW),Rc((Rf=n((Ry=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"eventType",Rf,A(n)),n._isAvailable=!1,n}return T(s,[{key:"isAvailable",get:function(){return this._isAvailable},set:function(n){this._isAvailable=n,this.fakeClick()}},{key:"handleClick",value:function(){this.node.scene.emit(t6,{type:this.eventType})}},{key:"setAnimationState",value:function(n){this.animationController.setValue("RESET-SPECIAL",this._isAvailable),O(D(s.prototype),"setAnimationState",this).call(this,n)}}]),s}(im)).prototype,"eventType",[Rh],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Cv.STAR_CHEST}}),n(Ry.prototype,"isAvailable",[Rp],Object.getOwnPropertyDescriptor(Ry.prototype,"isAvailable"),Ry.prototype),Rd=Ry))||Rd);ew._RF.pop(),ew._RF.push({},"87a11fQFYVFcphsqf5ivVof","DashboardHeader",void 0);var RD,RM,RN,Rz,RB,RF,Rx,RU,RG,RH,RV,Rq,RW,RK,Rj,RY,RX,RZ,RJ=eS.ccclass,RQ=eS.property,R$=globalThis.game.player,R0=(Rb=RJ("DashboardHeader"),Rw=RQ({type:Rm,displayName:"Progress bar",group:"Star Chest"}),RS=RQ({type:RO,displayName:"Button Component",group:"Star Chest"}),Rk=RQ({type:tm,displayName:"Default Rest animation",group:"Star Chest"}),RC=RQ({type:tm,displayName:"Special Rest animation",group:"Star Chest"}),Rb((RA=n((R_=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"starProgressBar",RA,A(n)),_(n,"chestButton",RT,A(n)),_(n,"defaultRestAnimation",RP,A(n)),_(n,"specialRestAnimation",RR,A(n)),n.handleStarsUpdateEvent=function(w){var k,C=null!=w?w:null===(k=R$.getGameData())||void 0===k?void 0:k.stars;void 0!==C&&(n.starProgressBar.setRange(C,20),n.updateStarChestButtonAnimation(C))},n}return T(s,[{key:"__preload",value:function(){this.validateRequiredComponents(),eY.on(t2,this.handleStarsUpdateEvent)}},{key:"onDestroy",value:function(){eY.off(t2,this.handleStarsUpdateEvent)}},{key:"updateStarProgress",value:function(n){this.handleStarsUpdateEvent(n)}},{key:"updateStarChestButtonAnimation",value:function(n){this.chestButton.isAvailable=n>=20}},{key:"validateRequiredComponents",value:function(){if(!this.starProgressBar)throw new Error("DashboardHeader: starProgressBar not found");if(!this.chestButton)throw new Error("DashboardHeader: chestButton not found");if(!this.defaultRestAnimation)throw new Error("DashboardHeader: defaultRestAnimation not found");if(!this.specialRestAnimation)throw new Error("DashboardHeader: specialRestAnimation not found")}},{key:"handleClickedSettingsButton",value:function(){en.openScreen(ei.SETTINGS_SCREEN)}}]),s}(eO)).prototype,"starProgressBar",[Rw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RT=n(R_.prototype,"chestButton",[RS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RP=n(R_.prototype,"defaultRestAnimation",[Rk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RR=n(R_.prototype,"specialRestAnimation",[RC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RE=R_))||RE);ew._RF.pop(),ew._RF.push({},"3b954Re2cRHvYJeBVAukYp9","JourneyLevelAvatar",void 0);var R1,R2,R4,R3,R5,R6,R8,R9,R7,Ie,It,In,Ii=eS.ccclass,Ia=eS.property,Ir=eS.executeInEditMode,Io=(RD=Ii("JourneyLevelAvatar"),RM=Ia({type:ex,displayName:"Avatar node"}),RN=Ia(ek),Rz=Ia(e7),RB=Ia(eH),RF=Ia({type:tm,group:"Animation"}),Rx=Ia({type:tm,group:"Animation"}),RU=Ia({type:tm,group:"Animation"}),RG=Ia({type:e9,displayName:"Avatar sprite"}),RD(RH=Ir((Rq=n((RV=function(n){w(d,n);var I,L,O,D=k(d);function d(){var n;C(this,d);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"sprite",Rq,A(n)),_(n,"lockIcon",RW,A(n)),_(n,"animation",RK,A(n)),_(n,"opacity",Rj,A(n)),_(n,"flashAnimation",RY,A(n)),_(n,"unlockAnimation",RX,A(n)),_(n,"spawnAnimation",RZ,A(n)),n}return T(d,[{key:"avatarSprite",get:function(){var n,w;return null!==(n=null===(w=this.sprite)||void 0===w?void 0:w.spriteFrame)&&void 0!==n?n:null},set:function(n){this.sprite&&(this.sprite.spriteFrame=n)}},{key:"playUnlockAnimation",value:(O=M(function(){var n,w,k,C,_,A,T,I,L,O,D;return _ts_generator(this,function(M){switch(M.label){case 0:n=this.playAnimation(this.unlockAnimation),w=this.lockIcon.position.x,k=this.lockIcon.position.y,C=[45,135],_=(Math.random()*(C[1]-C[0])+C[0])*(Math.PI/180),A=this.lockIcon.position.x+150*Math.cos(_),T=this.lockIcon.position.y+150*Math.sin(_),I=k-400,L=N.runTweenAsync(ez(this.lockIcon).delay(.3).to(.2,{position:new eQ(A,T,this.lockIcon.position.z)},{easing:"sineOut"}).to(.4,{position:new eQ(A,I,this.lockIcon.position.z)},{easing:"cubicIn"})),O=[0,360],D=N.runTweenAsync(ez(this.lockIcon).delay(.3).to(.6,{eulerAngles:new eQ(0,0,Math.random()*(O[1]-O[0])*(A>w?-1:1))},{easing:"sineOut"}));return[4,Promise.all([n,L,D])];case 1:M.sent(),this.lockIcon.position=new eQ(w,k,this.lockIcon.position.z),this.lockIcon.eulerAngles=new eQ(0,0,0);return[2]}})}),function(){return O.apply(this,arguments)})},{key:"playFlashAnimation",value:(L=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:w=this.node.position.y,k=this.playAnimation(this.flashAnimation),C=N.runTweenAsync(ez(this.node).to(.1,{position:new eQ(this.node.position.x,this.node.position.y+10,this.node.position.z)},{easing:"sineOut"}).to(.1,{position:new eQ(this.node.position.x,w,this.node.position.z)},{easing:"sineIn"}),n);return[4,Promise.all([k,C])];case 1:_.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"playSpawnAnimation",value:function(){this.opacity.opacity=255,this.playAnimation(this.spawnAnimation)}},{key:"hideImmediately",value:function(){this.opacity.opacity=0,this.node.setScale(eQ.ZERO)}},{key:"playAnimation",value:(I=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,N.runAnimationAsync(this.animation,n.name)];case 1:w.sent();return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){var n=this;if(!this.sprite)throw new Error("JourneyLevelAvatar: Avatar node is required");if(!this.lockIcon)throw new Error("JourneyLevelAvatar: Lock icon is required");if(!this.flashAnimation)throw new Error("JourneyLevelAvatar: Flash animation is required");if(!this.unlockAnimation)throw new Error("JourneyLevelAvatar: Unlock animation is required");if(!this.animation)throw new Error("JourneyLevelAvatar: Animation component is required");if(!this.animation.clips.some(function(w){return null!==w&&(w.name===n.flashAnimation.name||w.name===n.unlockAnimation.name||w.name===n.spawnAnimation.name)}))throw new Error("JourneyLevelAvatar: Animation component does not contain required animations")}}]),d}(eO)).prototype,"sprite",[RM],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),RW=n(RV.prototype,"lockIcon",[RN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RK=n(RV.prototype,"animation",[Rz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rj=n(RV.prototype,"opacity",[RB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RY=n(RV.prototype,"flashAnimation",[RF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RX=n(RV.prototype,"unlockAnimation",[Rx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RZ=n(RV.prototype,"spawnAnimation",[RU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(RV.prototype,"avatarSprite",[RG],Object.getOwnPropertyDescriptor(RV.prototype,"avatarSprite"),RV.prototype),RH=RV))||RH)||RH);ew._RF.pop(),ew._RF.push({},"a392bibG75JPKzG0y2ZS2YY","JourneyProgressBar",void 0);var Is,Il,Iu,Ic,Ih,Ip,Id,Iy,If,Iv,Ig,Im,Ib,Iw,IS,Ik,IC,IE,I_,IA,IT,IP=eS.ccclass,IR=eS.property,II=eS.executeInEditMode,IL=(R1=IP("JourneyProgressBar"),R2=IR(rw),R4=IR(eT),R3=IR(eH),R5=IR(eD),R6=IR(eD),R8=IR(e3),R1(R9=II((Ie=n((R7=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"progressBar",Ie,A(n)),_(n,"progressLabel",It,A(n)),_(n,"labelUIOpacity",In,A(n)),n.currentProgress=10,n.totalProgress=10,n.labelSeparator="/",n}return T(u,[{key:"total",get:function(){return this.totalProgress}},{key:"current",get:function(){return this.currentProgress}},{key:"separator",get:function(){return this.labelSeparator},set:function(n){this.labelSeparator=n,this.updateProgress()}},{key:"setRange",value:function(n,w){this.totalProgress=w;var k=n;k>w&&(k=w),this.currentProgress=k,this.updateProgress()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"animateTo",value:(I=M(function(n){var w,k,C,_,A,T,I,L,O,D,M,z,B,F,x,U;return _ts_generator(this,function(G){switch(G.label){case 0:w=this,k=n.nextCurr,C=n.nextTotal,_=n.numberOfProgressBar,A=void 0===_?0:_,T=n.onProgressBarPassed,I=n.signal,L=k/C,O=ez(this.labelUIOpacity).to(.2,{opacity:0}),D=ez(this.labelUIOpacity).to(.2,{opacity:255}),M=A<1?1:Math.sqrt(A)+1,z=0===A?L:A+L,B=1,F=this.progressBar.progress,x=z,U=N.runOnUpdateAsync(this.node,M,function(n){var k=eG.sineInOut(n),C=ts(F,x,k);w.progressBar.progress=C%1,C>B&&(B=0===C?1:Math.ceil(C),null==T||T())},I);return[4,Promise.all([N.runTweenAsync(O,I),U])];case 1:G.sent(),this.currentProgress=k,this.totalProgress=C,this.updateProgress();return[4,N.runTweenAsync(D,I)];case 2:return[2,(G.sent(),this.labelUIOpacity.opacity=255,L)]}})}),function(n){return I.apply(this,arguments)})},{key:"updateProgress",value:function(){this.progressBar.progress=this.currentProgress/this.totalProgress,this.progressLabel.string="".concat(this.currentProgress).concat(this.separator).concat(this.totalProgress)}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("JourneyProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("JourneyProgressBar: Missing required component Label")}}]),u}(eO)).prototype,"progressBar",[R2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=n(R7.prototype,"progressLabel",[R4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=n(R7.prototype,"labelUIOpacity",[R3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(R7.prototype,"total",[R5],Object.getOwnPropertyDescriptor(R7.prototype,"total"),R7.prototype),n(R7.prototype,"current",[R6],Object.getOwnPropertyDescriptor(R7.prototype,"current"),R7.prototype),n(R7.prototype,"separator",[R8],Object.getOwnPropertyDescriptor(R7.prototype,"separator"),R7.prototype),R9=R7))||R9)||R9);ew._RF.pop(),ew._RF.push({},"8a41bfxLylDhLk57kewW14A","JourneyProgressAnimator",void 0);var IO,ID,IM,IN,Iz,IB,IF,Ix,IU,IG,IH,IV,Iq,IW,IK,Ij,IY,IX,IZ,IJ,IQ,I$,I0,I1,I2,I4,I3,I5,I6,I8,I9,I7,Le=eS.ccclass,Lt=eS.property,Ln=(Is=Le("ProgressConfiguration"),Il=Lt(e9),Iu=Lt(e3),Is((Ih=n((Ic=T(function e(){C(this,e),_(this,"avatar",Ih,this),_(this,"themeId",Ip,this)})).prototype,"avatar",[Il],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ip=n(Ic.prototype,"themeId",[Iu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic)),Id=Le("JourneyProgressAnimator"),Iy=Lt(IL),If=Lt(ek),Iv=Lt(ex),Ig=Lt(Io),Im=Lt({type:eM,displayName:"Next Level Y Offset on Animation",group:"Unlocked Animation"}),Ib=z.onlyRunInLifeCycleAsync,Iw=z.onlyRunInLifeCycle,Id((IC=n((Ik=function(n){w(m,n);var I,L,O,D,F,x,U=k(m);function m(){var n;C(this,m);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=U.call.apply(U,[this].concat(k)),_(n,"progressBar",IC,A(n)),_(n,"currentLevelAvatarNode",IE,A(n)),_(n,"currentLevelAvatar",I_,A(n)),_(n,"nextLevelAvatar",IA,A(n)),_(n,"nextLevelYOffset",IT,A(n)),n.isAnimating=!1,n}return T(m,[{key:"setRange",value:function(n,w){this.progressBar.setRange(n,w)}},{key:"animateTo",value:(x=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:if(this.isAnimating)return[2,(console.warn("JourneyProgressAnimator: animation already in progress"),Promise.resolve())];this.isAnimating=!0;k=n!==this.progressBar.current;if(!k)return[3,2];return[4,this.progressBar.animateTo({nextCurr:n,nextTotal:this.progressBar.total,signal:w})];case 1:k=C.sent();C.label=2;case 2:this.isAnimating=!1;return[2]}})}),function(n,w){return x.apply(this,arguments)})},{key:"animateToNextLevel",value:(F=M(function(n){var w,k,C,_,A,T,I,L,O,D;return _ts_generator(this,function(M){switch(M.label){case 0:w=this,k=n.nextCurr,C=n.nextTotal,_=n.mapsPassed,A=n.signal;if(!this.isAnimating)return[3,1];console.warn("JourneyProgressAnimator: animation already in progress");return[3,8];case 1:this.isAnimating=!0;T=_.length-2;if(0!==T)return[3,3];return[4,this.progressBar.animateTo({nextCurr:k,nextTotal:C,signal:A})];case 2:return[2,(M.sent(),void(this.isAnimating=!1))];case 3:return[4,this.animateTargetAvaToCenter(A)];case 4:M.sent();I=1;return[4,this.progressBar.animateTo({signal:A,nextCurr:k,nextTotal:C,numberOfProgressBar:T,onProgressBarPassed:function(){if(1===I)return w.nextLevelAvatar.playUnlockAnimation(),void(I+=1);if(I>=_.length)throw new Error("JourneyProgressAnimator: currThemeIndex out of bounds");w.nextLevelAvatar.playFlashAnimation(A),w.setNextLevelAvatar(_[I].theme),I+=1}})];case 5:M.sent();return[4,this.animateTargetAvaToPrev(A)];case 6:M.sent();L=_[_.length-1].theme,O=_[_.length-2].theme;this.setCurrentLevelAvatar(O),this.nextLevelAvatar.hideImmediately(),this.moveTargetAvaToOriginal();D=this.nextLevelAvatar;return[4,this.getSpriteFrameByThemeId(L)];case 7:D.avatarSprite=M.sent(),this.nextLevelAvatar.playSpawnAnimation(),this.isAnimating=!1;M.label=8;case 8:return[2]}})}),function(n){return F.apply(this,arguments)})},{key:"animateTargetAvaToCenter",value:(D=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=new eQ(0,this.nextLevelYOffset+this.nextLevelAvatar.node.position.y,this.nextLevelAvatar.node.position.z);return[4,N.runTweenAsync(ez(this.nextLevelAvatar.node).to(1,{position:w},{easing:"cubicInOut"}),n)];case 1:k.sent(),this.nextLevelAvatar.node.position=w;return[2]}})}),function(n){return D.apply(this,arguments)})},{key:"moveTargetAvaToOriginal",value:function(){this.nextLevelAvatar.node.position=this.originalNextLevelAvatarPosition.clone()}},{key:"animateTargetAvaToPrev",value:(O=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=this.currentLevelAvatarNode.position.clone();return[4,N.runTweenAsync(ez(this.nextLevelAvatar.node).to(1,{position:w},{easing:"cubicInOut"}),n)];case 1:k.sent(),this.nextLevelAvatar.node.position=w;return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"getSpriteFrameByThemeId",value:(L=M(function(n){return _ts_generator(this,function(w){return[2,B.loadThemeThumbnailAsync(n)]})}),function(n){return L.apply(this,arguments)})},{key:"loadAndSetAvatar",value:(I=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:return[4,this.getSpriteFrameByThemeId(n)];case 1:k=C.sent();k?this.setAvatar(k,w):console.warn("JourneyProgressAnimator: ".concat(n," is null"));return[2]}})}),function(n,w){return I.apply(this,arguments)})},{key:"setAvatar",value:function(n,w){_instanceof(w,Io)?w.avatarSprite=n:w.spriteFrame=n}},{key:"setCurrentLevelAvatar",value:function(n){this.loadAndSetAvatar(n,this.currentLevelAvatar)}},{key:"setNextLevelAvatar",value:function(n){this.loadAndSetAvatar(n,this.nextLevelAvatar)}},{key:"onLoad",value:function(){this.validateRequiredComponents(),this.originalNextLevelAvatarPosition=this.nextLevelAvatar.node.position.clone()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),m}(eO)).prototype,"progressBar",[Iy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IE=n(Ik.prototype,"currentLevelAvatarNode",[If],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I_=n(Ik.prototype,"currentLevelAvatar",[Iv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IA=n(Ik.prototype,"nextLevelAvatar",[Ig],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IT=n(Ik.prototype,"nextLevelYOffset",[Im],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),n(Ik.prototype,"loadAndSetAvatar",[Ib],Object.getOwnPropertyDescriptor(Ik.prototype,"loadAndSetAvatar"),Ik.prototype),n(Ik.prototype,"setAvatar",[Iw],Object.getOwnPropertyDescriptor(Ik.prototype,"setAvatar"),Ik.prototype),IS=Ik))||IS);ew._RF.pop(),ew._RF.push({},"c2ddaEnKBVFvrM5x5nbfT7h","HomeContent",void 0);var Li,La,Lr,Lo,Ls,Ll,Lu,Lc,Lh,Lp,Ld,Ly,Lf,Lv,Lg,Lm,Lb,Lw=eS.ccclass,LS=eS.property,Lk=globalThis.game,LC=Lk.storage,LE=Lk.monitorError,L_=GameCore.Utils,LA=L_.Array,LT=L_.Json,LP=(IO=Lw("HomeContent"),ID=z.required(),IM=LS({type:K,group:"Play Button"}),IN=z.required(),Iz=LS({type:eI,group:"Play Button"}),IB=z.required(),IF=LS({type:ek,group:"Play Button"}),Ix=z.required(),IU=LS({type:ek,group:"Play Button"}),IG=z.required(),IH=LS(Ln),IV=z.required(),Iq=LS(R0),IW=z.required(),IK=LS(eH),Ij=z.required(),IY=LS(_U),IX=z.onlyRunInLifeCycleAsync,IZ=z.onlyRunInLifeCycleAsync,IJ=z.onlyRunInLifeCycleAsync,IQ=z.onlyRunInLifeCycleAsync,I$=z.onlyRunInLifeCycleAsync,IO((I2=n((I1=function(n){w(v,n);var L,O,D,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"playButtonLocalizer",I2,A(n)),_(n,"playButton",I4,A(n)),_(n,"playBackground",I3,A(n)),_(n,"hardLevelBackground",I5,A(n)),_(n,"journeyProgressAnimator",I6,A(n)),_(n,"dashboardHeader",I8,A(n)),_(n,"overlayDuringAnim",I9,A(n)),_(n,"coinContainer",I7,A(n)),n}return T(v,[{key:"onLoad",value:function(){z.validateRequiredProperties(this)}},{key:"getCoinContainer",value:function(){return this.coinContainer}},{key:"handlePlayButtonPress",value:function(){this.playButton.interactable=!1,this.node.scene.emit(t4)}},{key:"setPlayButton",value:function(n){this.playButtonLocalizer.setParams([n.toString()]);var w=n%5==0;this.playBackground.active=!w,this.hardLevelBackground.active=w}},{key:"updateStarProgress",value:function(n){this.dashboardHeader.updateStarProgress(n)}},{key:"setUnlockProgress",value:function(n,w){var k=arguments.length>1&&void 0!==w&&w;this.setProgress(n),this.updateCurrentMapInStorage(n,k)}},{key:"shouldPlayUnlockAnimation",value:function(){var n,w,k=LC.getStorage("dashboard");if(null==k)return null==LE||LE.sendException(new Error("DashboardScene: dashboardStorage not found")),!1;if(!(null!==(n=k.animateToCurrentLevel)&&void 0!==n&&n))return!1;var C=LC.getStorage("tournament");if(null==C)return null==LE||LE.sendException(new Error("DashboardScene: tournamentStorage not found")),!1;if(null!==(w=C.animateTournamentLeader)&&void 0!==w&&w)return!1;var _=k.lastMapPayload,A=sB.getCurrentMapProgress();return LT.encode(_)!==LT.encode(A)&&!(LA.searchIndex(sO.mapOrder,function(n){return n.id===_.id})>LA.searchIndex(sO.mapOrder,function(n){return n.id===A.id}))}},{key:"playUnlockProgressAnimation",value:function(n){var w=LC.getStorage("dashboard");if(null==w)throw new Error("DashboardScene: dashboardStorage not found");var k=w.lastMapPayload,C=sB.getCurrentMapProgress(),_=LA.searchIndex(sO.mapOrder,function(n){return n.id===k.id}),A=LA.searchIndex(sO.mapOrder,function(n){return n.id===C.id}),T=sO.mapOrder.slice(_,A+2);return k.id===C.id?this.playUnlockProgressAnimationOnly(C,k,n):this.playUnlockProgressAndPackAnimation(k,C,T,n)}},{key:"playUnlockProgressAndPackAnimation",value:(B=M(function(n,w,k,C){return _ts_generator(this,function(_){switch(_.label){case 0:this.setProgress(I({},n)),this.updateCurrentMapInStorage(I({},w),!0),this.playButton.interactable=!1;return[4,this.showOwnOverlay(C)];case 1:_.sent();return[4,this.journeyProgressAnimator.animateToNextLevel({nextCurr:w.progress,nextTotal:w.max,mapsPassed:k,signal:C})];case 2:_.sent();return[4,this.hideOwnOverlay(C)];case 3:_.sent(),this.playButton.interactable=!0;return[2]}})}),function(n,w,k,C){return B.apply(this,arguments)})},{key:"playUnlockProgressAnimationOnly",value:(D=M(function(n,w,k){var C;return _ts_generator(this,function(_){switch(_.label){case 0:this.setProgress(I(I({},n),{},{progress:w.progress})),this.updateCurrentMapInStorage(I({},n),!0);C=n.progress;return[4,this.showOwnOverlay(k)];case 1:_.sent();return[4,this.journeyProgressAnimator.animateTo(C,k)];case 2:_.sent();return[4,this.hideOwnOverlay(k)];case 3:_.sent();return[2]}})}),function(n,w,k){return D.apply(this,arguments)})},{key:"hideOwnOverlay",value:(O=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,N.runTweenAsync(ez(this.overlayDuringAnim).to(.3,{opacity:0}),n)];case 1:w.sent(),this.overlayDuringAnim.opacity=0;return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"showOwnOverlay",value:(L=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,N.runTweenAsync(ez(this.overlayDuringAnim).to(.3,{opacity:150}),n)];case 1:w.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"setProgress",value:function(n){var w=n.currentTheme,k=n.nextTheme,C=n.progress,_=n.max;this.journeyProgressAnimator.setCurrentLevelAvatar(w),this.journeyProgressAnimator.setNextLevelAvatar(null!=k?k:w),this.journeyProgressAnimator.setRange(C,_)}},{key:"updateCurrentMapInStorage",value:function(n,w){var k=arguments.length>1&&void 0!==w&&w,C=LC.getStorage("dashboard");if(null!=C){var _=C.animateToCurrentLevel;LC.setStorageData("dashboard","animateToCurrentLevel",!k&&_),LC.setStorageData("dashboard","lastMapPayload",n)}else null==LE||LE.sendException(new Error("DashboardScene: dashboardStorage not found"))}}]),v}(eO)).prototype,"playButtonLocalizer",[ID,IM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I4=n(I1.prototype,"playButton",[IN,Iz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I3=n(I1.prototype,"playBackground",[IB,IF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I5=n(I1.prototype,"hardLevelBackground",[Ix,IU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I6=n(I1.prototype,"journeyProgressAnimator",[IG,IH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I8=n(I1.prototype,"dashboardHeader",[IV,Iq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I9=n(I1.prototype,"overlayDuringAnim",[IW,IK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I7=n(I1.prototype,"coinContainer",[Ij,IY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(I1.prototype,"playUnlockProgressAnimation",[IX],Object.getOwnPropertyDescriptor(I1.prototype,"playUnlockProgressAnimation"),I1.prototype),n(I1.prototype,"playUnlockProgressAndPackAnimation",[IZ],Object.getOwnPropertyDescriptor(I1.prototype,"playUnlockProgressAndPackAnimation"),I1.prototype),n(I1.prototype,"playUnlockProgressAnimationOnly",[IJ],Object.getOwnPropertyDescriptor(I1.prototype,"playUnlockProgressAnimationOnly"),I1.prototype),n(I1.prototype,"hideOwnOverlay",[IQ],Object.getOwnPropertyDescriptor(I1.prototype,"hideOwnOverlay"),I1.prototype),n(I1.prototype,"showOwnOverlay",[I$],Object.getOwnPropertyDescriptor(I1.prototype,"showOwnOverlay"),I1.prototype),I0=I1))||I0);ew._RF.pop(),ew._RF.push({},"f555belwQ1NHJr4np65OtcU","NavManager",void 0);var LR,LI,LL,LO,LD,LM,LN,Lz,LB,LF,Lx,LU,LG,LH,LV,Lq,LW,LK,Lj,LY,LX,LZ,LJ,LQ,L$,L0,L1,L2,L4,L3,L5,L6,L8,L9=eS.ccclass,L7=eS.property,Oe=GameCore.Utils.Array,Ot=q.Layout,On=(Li=L9("NavManager"),La=L7(ek),Lr=L7(ek),Lo=L7(t1),Ls=L7({type:eN,group:"Widgets"}),Ll=L7({type:eN,group:"Widgets"}),Lu=L7({type:eN,group:"Widgets"}),Lc=L7(e_),Li((Ld=n((Lp=function(n){w(v,n);var I,O,D,z,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"selectorNode",Ld,A(n)),_(n,"selectedButtonNode",Ly,A(n)),_(n,"autoLayout",Lf,A(n)),_(n,"navWidget",Lv,A(n)),_(n,"backgroundWidget",Lg,A(n)),_(n,"layoutWidget",Lm,A(n)),_(n,"uiTransform",Lb,A(n)),n.navButtons=[],n.isNavigating=!1,n}return T(v,[{key:"currentButton",get:function(){return this.selectedButton}},{key:"onLoad",value:function(){var n;this.navButtons=this.node.getComponentsInChildren("NavButton"),this.selectedButton=null===(n=this.selectedButtonNode)||void 0===n?void 0:n.getComponentInChildren("NavButton"),eY.on(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this),eY.on(V.VIEW_RESIZED,this.handleViewResized,this),this.handleOrientationChanged(s5.getCurrentLayout())}},{key:"onDestroy",value:function(){eY.off(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this),eY.off(V.VIEW_RESIZED,this.handleViewResized,this)}},{key:"select",value:(B=M(function(n){var w;return _ts_generator(this,function(k){w=this;if(!this.isNavigating){if(!Oe.has(this.navButtons,n))throw new Error("NavManager: Button not found");if(n!==this.selectedButton){if(!n.isWIP)return[2,(this.isNavigating=!0,this.node.scene.emit(t3,{from:this.selectedButton.buttonType,to:n.buttonType}),new Promise(function(k){w.node.scene.once(t5,function(){var C=w.selectedButton.deselect();w.autoLayout.selectedIndex=w.navButtons.indexOf(n),w.selectedButton=n;var _=w.autoLayout.getSelectedWorldX()-n.getSelectedWorldDistanceX(),A=w.playSelectorAnimation(_),T=n.select();Promise.all([C,T,A]).then(function(){w.isNavigating=!1,k()})})}))];this.handleWIPButton()}}return[2]})}),function(n){return B.apply(this,arguments)})},{key:"selectUsingSceneTransition",value:(z=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:w=this.isNavigating;if(w)return[3,4];if(!Oe.has([nk.store],n.buttonType))return[3,1];k=this.handleWIPButton();return[3,3];case 1:return[4,this.select(n)];case 2:k=C.sent();C.label=3;case 3:w=k;C.label=4;case 4:return[2]}})}),function(n){return z.apply(this,arguments)})},{key:"selectByType",value:(D=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=Oe.search(this.navButtons,function(w){return w.buttonType===n});if(!w)throw new Error("NavManager: Button not found");return[4,this.selectUsingSceneTransition(w)];case 1:k.sent();return[2]}})}),function(n){return D.apply(this,arguments)})},{key:"handleWIPButton",value:function(){en.openScreen(ei.STAR_CHEST_SCREEN)}},{key:"selectDefaultNavBtn",value:(O=M(function(){var n,w;return _ts_generator(this,function(k){n=this;if(!this.currentButton||!Oe.has(this.navButtons,this.currentButton))throw new Error("NavManager: Button not found");w=this.currentButton.buttonType;return[2,(this.node.scene.emit(t3,{from:null,to:w}),new Promise(function(w){n.node.scene.once(t5,function(){n.autoLayout.selectedIndex=n.navButtons.indexOf(n.currentButton);var k=n.navButtons.map(function(w){return w===n.currentButton?w.select(!1):w.deselect(!1,!0)}),C=n.autoLayout.getSelectedWorldX()-n.currentButton.getSelectedWorldDistanceX();n.selectorNode.worldPosition=new eQ(C,n.selectorNode.worldPosition.y,0),Promise.all(k).then(function(){w()})})}))]})}),function(){return O.apply(this,arguments)})},{key:"playSelectorAnimation",value:(I=M(function(n){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:w=this,k=new eQ(1,1,1),C=this.selectorNode.worldPosition.clone(),_=new eQ(1.2*k.x,.8*k.y,1);return[4,N.runTweenAsync(ez(this.selectorNode).to(.3,{worldPosition:new eQ(n,C.y,0)},{easing:"quintInOut",onUpdate:function(n,C){if(void 0!==C){var A=w.calculateCurrentSquashScale(k,_,C);w.selectorNode.scale=A}}}))];case 1:A.sent();return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"setIgnoreInput",value:function(n){var w,k=!(arguments.length>0&&void 0!==n)||n,C=L(this.navButtons);try{for(C.s();!(w=C.n()).done;){var _=w.value,A=_.getComponentInChildren(eI);A&&(A.interactable=!k)}}catch(n){C.e(n)}finally{C.f()}}},{key:"calculateCurrentSquashScale",value:function(n,w,k){var C=this.splitIntoSquashRatio(k);return n.clone().lerp(w,C)}},{key:"splitIntoSquashRatio",value:function(n){return n<.5?2*n:1-2*(n-.5)}},{key:"handleOrientationChanged",value:function(n){n===Ot.Portrait?(this.navWidget.isAlignLeft=!0,this.navWidget.isAlignRight=!0,this.backgroundWidget.left=-50,this.backgroundWidget.right=-50,this.layoutWidget.left=0,this.layoutWidget.right=0):n===Ot.Landscape&&(this.navWidget.isAlignLeft=!1,this.navWidget.isAlignRight=!1,this.backgroundWidget.left=0,this.backgroundWidget.right=0,this.layoutWidget.left=25,this.layoutWidget.right=25,this.uiTransform.width=1e3)}},{key:"handleViewResized",value:function(){this.selectedButton&&this.selectorNode.setWorldPosition(this.selectedButton.node.worldPosition.x,this.selectorNode.worldPosition.y,0)}}]),v}(eO)).prototype,"selectorNode",[La],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ly=n(Lp.prototype,"selectedButtonNode",[Lr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lf=n(Lp.prototype,"autoLayout",[Lo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lv=n(Lp.prototype,"navWidget",[Ls],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lg=n(Lp.prototype,"backgroundWidget",[Ll],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lm=n(Lp.prototype,"layoutWidget",[Lu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lb=n(Lp.prototype,"uiTransform",[Lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lh=Lp))||Lh);ew._RF.pop(),ew._RF.push({},"d48a1TnKg1F4YRzzKmQOD5k","DashboardScene",void 0);var Oi=eS.ccclass,Oa=eS.disallowMultiple,Or=eS.property,Oo=globalThis.game,Os=Oo.event,Ol=Oo.storage,Ou=Oo.player,Oc=Oo.leaderboard,Oh=GameCore,Op=Oh.Events,Od=Oh.Match.Modes,Oy=Oh.Configs.DailyRewards,Of=Oh.Utils,Ov=Of.Time,Og=Of.Array;LR=Oi("DashboardScene"),LI=z.required(),LL=Or(EL),LO=z.required(),LD=Or(On),LM=z.required(),LN=Or(nT),Lz=z.required(),LB=Or(Ru),LF=z.required(),Lx=Or(_T),LU=z.onlyRunInLifeCycle,LG=z.onlyRunInLifeCycle,LH=z.onlyRunInLifeCycleAsync,LV=z.onlyRunInLifeCycleAsync,Lq=z.onlyRunInLifeCycleAsync,LW=z.onlyRunInLifeCycleAsync,LK=z.onlyRunInLifeCycle,Lj=z.onlyRunInLifeCycleAsync,LY=z.onlyRunInLifeCycleAsync,LX=z.onlyRunInLifeCycleAsync,LZ=z.onlyRunInLifeCycleAsync,LJ=z.onlyRunInLifeCycleAsync,LQ=z.onlyRunInLifeCycleAsync,L$=z.onlyRunInLifeCycleAsync,L0=z.onlyRunInLifeCycle,LR(L1=Oa((L4=n((L2=function(n){w(R,n);var L,O,D,B,x,U,H,V,q,W,K,j,Y,X,Z=k(R);function R(){var n;C(this,R);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=Z.call.apply(Z,[this].concat(k)),_(n,"coinManager",L4,A(n)),_(n,"navManager",L3,A(n)),_(n,"bgComp",L5,A(n)),_(n,"pageManager",L6,A(n)),_(n,"pageAnimSkipOverlay",L8,A(n)),n.firstNavigation=!0,n.isFirstNavToCollections=!0,n.isFirstNavToTournament=!0,n.navigationSignal=null,n.attemptCallSubscribeBot=function(){"subscribeBotAsync"in GameSDK.extra&&GameSDK.extra.subscribeBotAsync().catch(function(n){console.warn("subscribeBotAsync",n)})},n.playBgAnim=M(function(){var w,k,C,_,A,T,L;return _ts_generator(this,function(O){switch(O.label){case 0:k=Ol.getStorage("dashboard");if(null==k)throw new Error("DashboardScene: dashboardStorage not found");C=null!==(w=k.animateToCurrentLevel)&&void 0!==w&&w,_=I({},k.lastMapPayload),A=sB.getCurrentMapProgress(),T=_.currentTheme===A.currentTheme&&_.nextTheme===A.nextTheme,L=A.currentTheme;if(!(C&&!T))return[3,5];return[4,N.waitTweenAsync(2)];case 1:O.sent();O.label=2;case 2:O.trys.push([2,4,,5]);return[4,n.bgComp.animateToNextTheme(L)];case 3:O.sent();return[3,5];case 4:O.sent();return[3,5];case 5:return[2]}})}),n}return T(R,[{key:"__preload",value:function(){}},{key:"listenNavigationEvents",value:function(){this.node.scene.on(t3,this.onNavigate,this)}},{key:"listenDashboardEvents",value:function(){this.node.scene.on(t4,this.handlePlayButtonPress,this),this.node.scene.on(t6,this.handleEventButtonPress,this)}},{key:"onLoad",value:function(){z.validateRequiredProperties(this),this.listenNavigationEvents(),this.listenDashboardEvents(),this.coinManager.init(),sB.init(),this.setPlayerLevel(),this.initBgComp(),this.pageManager.updateCollectionsContentPayload(sB.getCollectionUnlockProgress())}},{key:"setPlayerLevel",value:function(){var n,w=(null!==(n=Ou.getGameData())&&void 0!==n?n:{}).level,k=void 0===w?1:w;k=0===k?1:k,Ou.setGameData({level:k})}},{key:"start",value:function(){Ou.getPlayerSetting("music")&&this.updateMusic(),this.playBgAnim(),this.pageManager.init(),this.navManager.selectDefaultNavBtn(),this.scheduleOnce(this.preloadScenes,3)}},{key:"preloadScenes",value:function(){es.preloadGameScene()}},{key:"initBgComp",value:function(){var n,w=Ol.getStorage("dashboard");if(null==w)throw new Error("DashboardScene: dashboardStorage not found");var k=null!==(n=w.animateToCurrentLevel)&&void 0!==n&&n,C=I({},w.lastMapPayload),_=sB.getCurrentMapProgress(),A=C.currentTheme===_.currentTheme&&C.nextTheme===_.nextTheme,T=_.currentTheme;k&&!A?this.bgComp.setCurrentTheme(C.currentTheme):this.bgComp.setCurrentTheme(T)}},{key:"handlePlayButtonPress",value:(X=M(function(){var n,w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:T.trys.push([0,3,,4]);w=sB.getCurrentMapProgress(),k=(null!==(n=Ou.getGameData())&&void 0!==n?n:{}).level,C=void 0===k?1:k;return[4,sQ.setMatchCustomDataAsync({level:C})];case 1:T.sent();return[4,sQ.startMatchAsync(Od.SINGLE)];case 2:T.sent(),this.updateCurrentMapInStorage(w),Ol.setStorageData("collection","lastMapPack",w.id),Ol.setStorageData("collection","animateMapPackUnlock",!1);_=Ol.getStorage("leaderboard_content").lastTabOpened;this.getPlayerLeader(_).then(function(n){if(n){var w=n.score;Ol.setStorageData("leaderboard_content","previousScore",w)}}),es.switchScene(eu.GAME_SCENE,{level:C});return[3,4];case 3:A=T.sent();return[2,void console.error(A)];case 4:return[2]}})}),function(){return X.apply(this,arguments)})},{key:"getPlayerLeader",value:(Y=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:w="global"===n?ed.GLOBAL:ed.FRIENDS;if(!w)return[2,null];k=Ou.getPlayerId();return[4,Oc.getLeadersByPlayerIdsAsync(w,[k])];case 1:C=_.sent();return[2,0===C.length?null:C[0]]}})}),function(n){return Y.apply(this,arguments)})},{key:"updateCurrentMapInStorage",value:function(n){Ol.setStorageData("dashboard","animateToCurrentLevel",!1),Ol.setStorageData("dashboard","lastMapPayload",n)}},{key:"updateMusic",value:(j=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=G.getCurrentMusic()!==nL.BG_MUSIC;if(!n)return[3,3];return[4,G.setVolumeMusic(0,!0)];case 1:w.sent();return[4,N.waitTweenAsync(1)];case 2:n=w.sent();w.label=3;case 3:G.playMusic(nL.BG_MUSIC),G.turnUpMusic();return[2]}})}),function(){return j.apply(this,arguments)})},{key:"checkDailyRewardsOpenable",value:function(){var n=Ou.getPlayerData().dailyRewarded,w=n.logDays,k=void 0===w?[]:w,C=n.lastRewarded,_=void 0===C?0:C;if(k.length>Oy.MaxDays)return!0;if(Oy.MockTime>0&&Date.now()-_>=1e3*Oy.MockTime)return!0;return!Ov.isToday(_)}},{key:"onNavigate",value:(K=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=(this.firstNavigation&&(this.firstNavigation=!1,this.pageManager.unmountAndHideAll()),n.to);switch(w){case nk.store:return[3,1];case nk.collections:return[3,2];case nk.tournaments:return[3,5];case nk.leaderboard:return[3,5];case nk.home:return[3,7]}return[3,9];case 1:return[3,10];case 2:return[4,this.triggerPageNavigation(n)];case 3:k.sent();return[4,this.handleLogicAfterNavigateToCollections()];case 4:k.sent(),this.cleanupAfterPageNavigation();return[3,10];case 5:return[4,this.triggerPageNavigation(n)];case 6:k.sent(),this.cleanupAfterPageNavigation();return[3,10];case 7:return[4,this.handleNavigateToHome(n)];case 8:k.sent();return[3,10];case 9:throw new Error("DashboardScene: Unhandled page name");case 10:return[2]}})}),function(n){return K.apply(this,arguments)})},{key:"handleLogicAfterNavigateToCollections",value:(W=M(function(){var n,w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:w=null===(n=this.pageManager.getPage(nk.collections))||void 0===n?void 0:n.getContainer().getComponentInChildren(Pd);if(null==w)throw new Error("CollectionsContent not found");k=new F,C=w.shouldAnimateThemeBlockUnlock();_=C;if(!_)return[3,2];return[4,this.openSkipOverlay(k)];case 1:_=T.sent();T.label=2;case 2:return[4,this.tryPlayScrollToCollectionAnim(w,k)];case 3:T.sent();return[4,w.playThemeTabUnlockAnim(k)];case 4:T.sent();A=C;if(!A)return[3,6];return[4,this.closeSkipOverlay()];case 5:A=T.sent();T.label=6;case 6:k.abort();return[2]}})}),function(){return W.apply(this,arguments)})},{key:"closeSkipOverlay",value:(q=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.pageAnimSkipOverlay.close()];case 1:n.sent();return[2]}})}),function(){return q.apply(this,arguments)})},{key:"openSkipOverlay",value:(V=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,this.pageAnimSkipOverlay.open({onSkip:function(){return n.abort()},opacity:200})];case 1:w.sent();return[2]}})}),function(n){return V.apply(this,arguments)})},{key:"tryPlayScrollToCollectionAnim",value:(H=M(function(n,w){var k,C;return _ts_generator(this,function(_){switch(_.label){case 0:k=sB.getCurrentUnlockingThemeIndex();C=this.isFirstNavToCollections&&null!==k;if(!C)return[3,2];return[4,n.scrollToCurrentUnlockingTheme(k,w)];case 1:C=(_.sent(),this.isFirstNavToCollections=!1);_.label=2;case 2:return[2]}})}),function(n,w){return H.apply(this,arguments)})},{key:"cleanupAfterPageNavigation",value:function(){this.navManager.setIgnoreInput(!1)}},{key:"triggerPageNavigation",value:(U=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:null===(w=this.navigationSignal)||void 0===w||w.abort(),this.navigationSignal=new F;return[4,this.pageManager.navigate(n,this.navigationSignal)];case 1:k.sent();return[2]}})}),function(n){return U.apply(this,arguments)})},{key:"handleNavigateToHome",value:(x=M(function(n){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:k=this;null===(w=this.navigationSignal)||void 0===w||w.abort(),this.navigationSignal=new F;return[4,this.pageManager.navigate(n,this.navigationSignal,M(function(){return _ts_generator(this,function(n){k.initializeHomepageCoinManager();return[2]})}))];case 1:C.sent();return[4,this.handleLogicAfterNavigateToHome()];case 2:C.sent();return[2]}})}),function(n){return x.apply(this,arguments)})},{key:"handleLogicAfterNavigateToHome",value:(B=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.tryOpenDailyRewardsScreen()];case 1:n.sent(),this.attemptCallSubscribeBot();return[4,this.waitUntilCoinManagerFinishesAnyAnimation()];case 2:n.sent();return[4,this.waitUntilPageAnimSkipOverlayCloses()];case 3:n.sent();return[4,this.tryNavigateToTournament()];case 4:n.sent();return[4,this.tryPlayLevelUpAnimation()];case 5:n.sent();return[2]}})}),function(){return B.apply(this,arguments)})},{key:"waitUntilCoinManagerFinishesAnyAnimation",value:function(){return this.coinManager.untilFinishesCollectAnim()}},{key:"waitUntilPageAnimSkipOverlayCloses",value:function(){return this.pageAnimSkipOverlay.untilClosed()}},{key:"tryNavigateToTournament",value:(D=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!Ol.getStorage("tournament").animateTournamentLeader)return[3,2];return[4,this.navManager.selectByType(nk.tournaments)];case 1:return[2,n.sent()];case 2:if(!this.isFirstNavToTournament)return[3,8];this.isFirstNavToTournament=!1;n.label=3;case 3:n.trys.push([3,7,,8]);if(!("getTournamentAsync"in GameSDK))throw new Error("Unavailable feature: tournament");return[4,GameSDK.getTournamentAsync()];case 4:if(!(n.sent().getEndTime()<Date.now()/1e3))return[3,6];return[4,this.navManager.selectByType(nk.tournaments)];case 5:return[2,n.sent()];case 6:return[3,8];case 7:n.sent();return[3,8];case 8:return[2]}})}),function(){return D.apply(this,arguments)})},{key:"tryPlayLevelUpAnimation",value:(O=M(function(){var n,w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:w=this,k=null===(n=this.pageManager.getPage(nk.home))||void 0===n?void 0:n.getContainer().getComponentInChildren(LP);if(null==k)throw new Error("DashboardScene: Homepage not found");C=new F;C.chain(this.navigationSignal);_=k.shouldPlayUnlockAnimation(),A=this.shouldPlayPackUnlockAnimation();T=_;if(!T)return[3,7];I=A;if(!I)return[3,2];return[4,this.pageAnimSkipOverlay.open({onSkip:function(){return C.abort()},opacity:150})];case 1:I=O.sent();O.label=2;case 2:return[4,k.playUnlockProgressAnimation(C)];case 3:O.sent();L=A;if(!L)return[3,6];return[4,this.pageAnimSkipOverlay.close()];case 4:O.sent();return[4,C.callAsync(function(){return w.navManager.selectByType(nk.collections)})];case 5:L=O.sent();O.label=6;case 6:T=L;O.label=7;case 7:return[2]}})}),function(){return O.apply(this,arguments)})},{key:"shouldPlayPackUnlockAnimation",value:function(){var n=Ol.getStorage("dashboard");if(null==n)throw new Error("DashboardScene: dashboardStorage not found");var w=n.lastMapPayload,k=sB.getCurrentMapProgress();return Og.searchIndex(sO.mapOrder,function(n){return n.id===w.id})!==Og.searchIndex(sO.mapOrder,function(n){return n.id===k.id})}},{key:"initializeHomepageCoinManager",value:function(){var n,w=null===(n=this.pageManager.getPage(nk.home))||void 0===n?void 0:n.getContainer().getComponentInChildren(LP);if(null==w)throw new Error("DashboardScene: Homepage not found");this.coinManager.setTargetContainer(w.getCoinContainer()),this.coinManager.emitCoinAmount()}},{key:"tryOpenDailyRewardsScreen",value:(L=M(function(){return _ts_generator(this,function(n){if(this.checkDailyRewardsOpenable())return[2,(en.openScreen(ei.DAILY_REWARDS_SCREEN),new Promise(function(n){Os.on(Op.CLOSED_SCREEN,function t(w){w.screenName===eo[ei.DAILY_REWARDS_SCREEN]&&(n(),Os.off(Op.CLOSED_SCREEN,t))})}))];return[2]})}),function(){return L.apply(this,arguments)})},{key:"handleEventButtonPress",value:function(n){switch(n.type){case Cv.STAR_CHEST:en.openScreen(ei.STAR_CHEST_SCREEN);break;case Cv.BALLOON:en.showNotificationScreenWithLocalizedKey("error.soon");break;default:throw new Error("DashboardScene: Unhandled event button type")}}},{key:"handleTestLayoutButtonClicked",value:function(){}}]),R}(eO)).prototype,"coinManager",[LI,LL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L3=n(L2.prototype,"navManager",[LO,LD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L5=n(L2.prototype,"bgComp",[LM,LN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L6=n(L2.prototype,"pageManager",[Lz,LB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L8=n(L2.prototype,"pageAnimSkipOverlay",[LF,Lx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(L2.prototype,"preloadScenes",[LU],Object.getOwnPropertyDescriptor(L2.prototype,"preloadScenes"),L2.prototype),n(L2.prototype,"initBgComp",[LG],Object.getOwnPropertyDescriptor(L2.prototype,"initBgComp"),L2.prototype),n(L2.prototype,"handlePlayButtonPress",[LH],Object.getOwnPropertyDescriptor(L2.prototype,"handlePlayButtonPress"),L2.prototype),n(L2.prototype,"onNavigate",[LV],Object.getOwnPropertyDescriptor(L2.prototype,"onNavigate"),L2.prototype),n(L2.prototype,"handleLogicAfterNavigateToCollections",[Lq],Object.getOwnPropertyDescriptor(L2.prototype,"handleLogicAfterNavigateToCollections"),L2.prototype),n(L2.prototype,"tryPlayScrollToCollectionAnim",[LW],Object.getOwnPropertyDescriptor(L2.prototype,"tryPlayScrollToCollectionAnim"),L2.prototype),n(L2.prototype,"cleanupAfterPageNavigation",[LK],Object.getOwnPropertyDescriptor(L2.prototype,"cleanupAfterPageNavigation"),L2.prototype),n(L2.prototype,"triggerPageNavigation",[Lj],Object.getOwnPropertyDescriptor(L2.prototype,"triggerPageNavigation"),L2.prototype),n(L2.prototype,"handleNavigateToHome",[LY],Object.getOwnPropertyDescriptor(L2.prototype,"handleNavigateToHome"),L2.prototype),n(L2.prototype,"waitUntilCoinManagerFinishesAnyAnimation",[LX],Object.getOwnPropertyDescriptor(L2.prototype,"waitUntilCoinManagerFinishesAnyAnimation"),L2.prototype),n(L2.prototype,"waitUntilPageAnimSkipOverlayCloses",[LZ],Object.getOwnPropertyDescriptor(L2.prototype,"waitUntilPageAnimSkipOverlayCloses"),L2.prototype),n(L2.prototype,"tryNavigateToTournament",[LJ],Object.getOwnPropertyDescriptor(L2.prototype,"tryNavigateToTournament"),L2.prototype),n(L2.prototype,"tryPlayLevelUpAnimation",[LQ],Object.getOwnPropertyDescriptor(L2.prototype,"tryPlayLevelUpAnimation"),L2.prototype),n(L2.prototype,"tryOpenDailyRewardsScreen",[L$],Object.getOwnPropertyDescriptor(L2.prototype,"tryOpenDailyRewardsScreen"),L2.prototype),n(L2.prototype,"handleEventButtonPress",[L0],Object.getOwnPropertyDescriptor(L2.prototype,"handleEventButtonPress"),L2.prototype),L1=L2))||L1);ew._RF.pop(),ew._RF.push({},"1be4fAboTNK3IFk6IiygYLZ","PageContent",void 0);var Om,Ob,Ow,OS,Ok,OC,OE=eS.ccclass,O_=q.Layout;OE("PageContent")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"__preload",value:function(){this.widget=this.getComponent(eN),this.uiTransform=this.getComponent(e_)}},{key:"onLoad",value:function(){eY.on(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(s5.getCurrentLayout())}},{key:"onDestroy",value:function(){eY.off(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:function(n){n===O_.Portrait?(this.widget.isAlignLeft=!0,this.widget.isAlignRight=!0):n===O_.Landscape&&(this.widget.isAlignLeft=!1,this.widget.isAlignRight=!1,this.uiTransform.width=1e3)}}]),o}(eO));ew._RF.pop(),ew._RF.push({},"c68178FyxlCOqbCt/+wktvw","PageHeader",void 0);var OA,OT,OP,OR,OI,OL,OO,OD,OM,ON,Oz,OB=eS.ccclass,OF=eS.property,Ox=q.Layout;Om=OB("PageHeader"),Ob=OF(eN),Ow=OF(ek),Om((Ok=n((OS=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"widget",Ok,A(n)),_(n,"leaves",OC,A(n)),n}return T(s,[{key:"onLoad",value:function(){eY.on(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(s5.getCurrentLayout())}},{key:"onDestroy",value:function(){eY.off(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"handleOrientationChanged",value:function(n){n===Ox.Portrait?(this.leaves.active=!1,this.widget.left=-80,this.widget.right=-80):n===Ox.Landscape&&(this.leaves.active=!0,this.widget.left=0,this.widget.right=0)}}]),s}(eO)).prototype,"widget",[Ob],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OC=n(OS.prototype,"leaves",[Ow],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OS));ew._RF.pop(),ew._RF.push({},"53f87ljsxFJUKsBbXk8WVkJ","HomePage",void 0);var OU,OG=eS.ccclass,OH=eS.property,OV=globalThis.game,Oq=OV.player,OW=OV.storage,OK=OV.monitorError,Oj=GameCore.Utils.Number;OA=OG("HomePage"),OT=z.required(),OP=OH({type:eT,group:"Placeholders"}),OR=z.required(),OI=z.onlyRunInLifeCycleAsync,OL=z.onlyRunInLifeCycle,OO=z.onlyRunInLifeCycleAsync,OD=z.onlyRunInLifeCycleAsync,OA((ON=n((OM=function(n){w(v,n);var L,N,z,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"coinLabel",ON,A(n)),_(n,"panelAnimationController",Oz,A(n)),n}return T(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(am),O(D(v.prototype),"onLoad",this).call(this)}},{key:"onEnable",value:function(){this.node.scene.on(i9.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"onDisable",value:function(){this.node.scene.off(i9.COIN_CHANGED,this.updatePlaceholderCoins,this)}},{key:"updatePlaceholderCoins",value:(B=M(function(n){return _ts_generator(this,function(w){this.coinLabel.string=Oj.getShortNumber(n.coins,3);return[2]})}),function(n){return B.apply(this,arguments)})},{key:"mount",value:(z=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"mount",this).call(this)];case 1:n.sent(),this.onMount();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"onMount",value:function(){var n,w,k;if(!this.homeContent&&(this.homeContent=this.container.getComponentInChildren(LP),!this.homeContent))throw new Error("HomePage: homeContent not found");var C=Oq.getGameData(),_=null!==(n=null==C?void 0:C.coins)&&void 0!==n?n:0;this.updatePlaceholderCoins({coins:_});var A=null!==(w=null==C?void 0:C.level)&&void 0!==w?w:1;this.homeContent.setPlayButton(A);var T=null!==(k=null==C?void 0:C.stars)&&void 0!==k?k:0;this.homeContent.updateStarProgress(T),this.initUnlockProgressData()}},{key:"initUnlockProgressData",value:function(){var n=this.homeContent.shouldPlayUnlockAnimation(),w=I({},sB.getCurrentMapProgress()),k=OW.getStorage("dashboard");if(null==k)return null==OK||OK.sendException(new Error("DashboardScene: dashboardStorage not found")),void(n||this.homeContent.setUnlockProgress(w));var C=I({},k.lastMapPayload);n?this.homeContent.setUnlockProgress(C):this.homeContent.setUnlockProgress(w)}},{key:"transitionIn",value:(N=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"transitionIn",this).call(this)];case 1:n.sent();return[4,this.panelAnimationController.showUI()];case 2:n.sent();return[2]}})}),function(){return N.apply(this,arguments)})},{key:"transitionOut",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"transitionOut",this).call(this)];case 1:n.sent();return[4,this.panelAnimationController.hideUI()];case 2:n.sent();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"hasLoadedPage",value:function(){return!0}}]),v}(A2)).prototype,"coinLabel",[OT,OP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oz=n(OM.prototype,"panelAnimationController",[OR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(OM.prototype,"mount",[OI],Object.getOwnPropertyDescriptor(OM.prototype,"mount"),OM.prototype),n(OM.prototype,"onMount",[OL],Object.getOwnPropertyDescriptor(OM.prototype,"onMount"),OM.prototype),n(OM.prototype,"transitionIn",[OO],Object.getOwnPropertyDescriptor(OM.prototype,"transitionIn"),OM.prototype),n(OM.prototype,"transitionOut",[OD],Object.getOwnPropertyDescriptor(OM.prototype,"transitionOut"),OM.prototype),OM));ew._RF.pop(),ew._RF.push({},"332aaP3dkhKxZNHiMFB1bKn","LeaderboardIsEmpty",void 0);var OY,OX,OZ,OJ,OQ,O$,O0,O1,O2,O4,O3,O5,O6,O8,O9,O7,De,Dt,Dn,Di,Da=(0,eS.ccclass)("LeaderboardIsEmpty")(OU=function(n){w(l,n);var _,A=k(l);function l(){return C(this,l),A.apply(this,arguments)}return T(l,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"show",value:(_=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:this.uiOpacity.opacity=255;n=this.node.position.clone(),w=ez(this.node);w.to(.05,{position:n.clone().add3f(5,0,0)}),w.to(.05,{position:n.clone().add3f(-5,0,0)});k=ez(this.node).repeat(2,w);k.to(.05,{position:n});return[4,N.runTweenAsync(k)];case 1:C.sent();return[2]}})}),function(){return _.apply(this,arguments)})},{key:"hide",value:function(){this.uiOpacity.opacity=0}}]),l}(eO))||OU;ew._RF.pop(),ew._RF.push({},"aa4b0d0u0hLeqd3+/PQZ/QD","SwitchButton",void 0);var Dr,Do,Ds,Dl,Du,Dc,Dh,Dp=eS.ccclass,Dd=eS.property,Dy=eS.requireComponent,Df=globalThis.game.analytics,Dv=GameCore,Dg=Dv.Utils.Array,Dm=Dv.Plugins.Analytics.Events,Db=(OY=Dp("SwitchButton"),OX=Dy([eI,e7]),OZ=Dd(eW),OJ=Dd(ek),OQ=Dd(ek),O$=Dd(eW),O0=Dd({visible:function(){return this.useSound},type:nD}),O1=Dd(eW),O2=Dd({visible:function(){return this.useDesktopHover},type:tm}),O4=Dd({visible:function(){return this.useDesktopHover},type:tm}),OY(O3=OX((O6=n((O5=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"enable",O6,A(n)),_(n,"nodeOn",O8,A(n)),_(n,"nodeOff",O9,A(n)),_(n,"useSound",O7,A(n)),_(n,"soundKey",De,A(n)),_(n,"useDesktopHover",Dt,A(n)),_(n,"mouseEnterClip",Dn,A(n)),_(n,"mouseLeaveClip",Di,A(n)),n.isMouseLeaved=!1,n.onMouseEnter=function(w){n.useDesktopHover&&n.buttonComponent.interactable&&(n.isMouseLeaved=!1,n.animationComponent.play(n.mouseEnterClip.name))},n.onMouseLeave=function(w){n.useDesktopHover&&n.buttonComponent.interactable&&(n.isMouseLeaved||(n.isMouseLeaved=!0,n.animationComponent.play(n.mouseLeaveClip.name)))},n}return T(s,[{key:"__preload",value:function(){this.buttonComponent=this.getComponent(eI),this.animationComponent=this.getComponent(e7),this.validateRequiredComponents()}},{key:"onLoad",value:function(){var n=this.animationComponent.clips.map(function(n){return null==n?void 0:n.name}).filter(function(n){return null!=n&&"string"==typeof n});this.useDesktopHover&&(Dg.has(n,this.mouseEnterClip.name)||this.animationComponent.addClip(this.mouseEnterClip),Dg.has(n,this.mouseLeaveClip.name)||this.animationComponent.addClip(this.mouseLeaveClip))}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"onEnable",value:function(){this.node.on(ek.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(ek.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(ek.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(ek.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"switch",value:function(){return!!this.node.active&&(Df.event(Dm.BUTTON_CLICK,{button_name:this.node.name,enable:!this.enable}),this.useSound&&G.playSound(io[this.soundKey]),this.updateStatus(!this.enable))}},{key:"setEnabled",value:function(n){this.node.active&&this.updateStatus(n)}},{key:"updateStatus",value:function(n){return this.enable===n||(this.onMouseLeave(null),this.enable=n,this.nodeOn.active=n,this.nodeOff.active=!n),this.enable}}]),s}(eO)).prototype,"enable",[OZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),O8=n(O5.prototype,"nodeOn",[OJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O9=n(O5.prototype,"nodeOff",[OQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O7=n(O5.prototype,"useSound",[O$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),De=n(O5.prototype,"soundKey",[O0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return nD[nL.BUTTON_CLICK]}}),Dt=n(O5.prototype,"useDesktopHover",[O1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Dn=n(O5.prototype,"mouseEnterClip",[O2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Di=n(O5.prototype,"mouseLeaveClip",[O4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O3=O5))||O3)||O3);ew._RF.pop(),ew._RF.push({},"2871awUXL9J0I+rBEFNHN7o","Tabs",void 0);var Dw,DS,Dk,DC,DE,D_,DA,DT,DP,DR=eS.ccclass,DI=eS.property,DL=globalThis.game.analytics,DO=GameCore.Plugins.Analytics.Events,DD=(Dr=DR("Tabs"),Do=DI(Db),Ds=DI(Db),Dr((Dc=n((Du=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"tabWorld",Dc,A(n)),_(n,"tabFriends",Dh,A(n)),n}return T(s,[{key:"onLoad",value:function(){"MsGames"===GameSDK.getSDKName()&&(this.tabWorld.node.active=!1,this.tabFriends.node.active=!1)}},{key:"setInteractableButtons",value:function(n){this.tabWorld.getComponent(eI).interactable=n,this.tabFriends.getComponent(eI).interactable=n}},{key:"updateStatus",value:function(n){this.tabWorld.setEnabled("global"===n),this.tabFriends.setEnabled("friends"===n)}},{key:"handleTabWorldSelect",value:function(){this.tabWorld.setEnabled(!0),this.tabFriends.setEnabled(!1),G.playSound(nL.BUTTON_CLICK),DL.event(DO.BUTTON_CLICK,{button_name:this.node.name,screen_name:H.getCurrentPage()}),this.node.scene.emit(Cg.WORLD_TAB_SELECTED)}},{key:"handleTabFriendsSelect",value:function(){this.tabWorld.setEnabled(!1),this.tabFriends.setEnabled(!0),G.playSound(nL.BUTTON_CLICK),DL.event(DO.BUTTON_CLICK,{button_name:this.node.name,screen_name:H.getCurrentPage()}),this.node.scene.emit(Cg.FRIENDS_TAB_SELECTED)}}]),s}(eO)).prototype,"tabWorld",[Do],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dh=n(Du.prototype,"tabFriends",[Ds],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dl=Du))||Dl);ew._RF.pop(),ew._RF.push({},"91613SO4bxPDq9dH9zxyIef","LeaderboardTimer",void 0);var DM,DN,Dz,DB,DF,Dx=eS.ccclass,DU=eS.property,DG=GameCore.Utils.Time,DH=globalThis.game.language,DV=(Dw=Dx("LeaderboardTimer"),DS=DU(e_),Dk=DU(ek),DC=DU(K),Dw((DA=n((D_=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"background",DA,A(n)),_(n,"calendar",DT,A(n)),_(n,"timerLocalizer",DP,A(n)),n.alreadyShown=!1,n}return T(u,[{key:"onLoad",value:function(){this.timerOpacity=this.timerLocalizer.node.getComponent(eH),this.validateRequiredComponents(),this.backgroundDefaultWidth=this.background.width,this.calendarDefaultPosition=this.calendar.position.clone()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"show",value:(I=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:if(!(!this.alreadyShown&&!n.aborted))return[3,3];this.alreadyShown=!0;w=ez(this.calendar).to(.3,{scale:eQ.ONE},{easing:"backOut"}).to(.3,{position:this.calendarDefaultPosition.clone()},{easing:"quadOut"}),k=ez(this.background).delay(.3).to(.3,{width:this.backgroundDefaultWidth},{easing:"quadOut"}),C=ez(this.timerOpacity).to(.3,{opacity:255});return[4,Promise.all([N.runTweenAsync(w,n),N.runTweenAsync(k,n)])];case 1:_.sent(),this.calendar.scale=eQ.ONE,this.calendar.position=this.calendarDefaultPosition.clone(),this.background.width=this.backgroundDefaultWidth;return[4,N.runTweenAsync(C,n)];case 2:_.sent(),this.timerOpacity.opacity=255;_.label=3;case 3:return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"reset",value:function(){this.alreadyShown||(this.calendar.position=this.background.node.position.clone(),this.calendar.scale=eQ.ZERO,this.background.width=0,this.timerOpacity.opacity=0)}},{key:"setTimeLabel",value:function(n){if(n){var w=new Date,k=0;if("manually"===n)k=0;else if("daily"===n)k=Date.UTC(w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate()+1);else if("weekly"===n){var C=w.getUTCDay(),_=0===C?1:8-C;k=Date.UTC(w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate()+_)}else k="monthly"===n?Date.UTC(w.getUTCFullYear(),w.getUTCMonth()+1):Date.UTC(w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate()+1);try{var A=DG.getRelativeTime(k/1e3,DH.getCurrentLocale());this.timerLocalizer.key="game.endsIn",this.timerLocalizer.setParams([A])}catch(n){this.timerLocalizer.key="game.endsSoon"}}else this.timerLocalizer.key="game.endsSoon"}}]),u}(eO)).prototype,"background",[DS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DT=n(D_.prototype,"calendar",[Dk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DP=n(D_.prototype,"timerLocalizer",[DC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DE=D_))||DE);ew._RF.pop(),ew._RF.push({},"69c90PvoTtGfZyDw8FbbOvV","LeaderSkeleton",void 0);var Dq,DW,DK,Dj,DY,DX,DZ,DJ,DQ,D$,D0,D1,D2,D4,D3,D5,D6,D8,D9,D7,Me,Mt,Mn,Mi,Ma,Mr,Mo,Ms,Ml,Mu,Mc,Mh,Mp,My,Mf,Mv,Mg,Mm,Mb,Mw,MS,Mk,MC,ME,M_=eS.ccclass,MA=eS.disallowMultiple,MT=eS.property,MP=(DM=M_("LeaderSkeleton"),DN=MT(ek),DM(Dz=MA((DF=n((DB=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"container",DF,A(n)),n}return T(c,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"hide",value:(L=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=this;return[4,N.runTweenAsync(ez(this.uiOpacity).to(.2,{opacity:0}).call(function(){w.node.active=!1}),n)];case 1:k.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"show",value:(I=M(function(n,w){var k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:k=this;this.node.active=!0,this.uiOpacity.opacity=0;C=this.container.position.clone();this.container.position=new eQ(C.x,C.y-100,C.z);_=ez(this.container).delay(n);_.to(.2,{position:C},{easing:"cubicOut"});A=ez(this.uiOpacity).delay(n);A.to(.2,{opacity:255},{easing:"cubicOut"}),w.addAbortListener(function(){k.container.position=C,k.uiOpacity.opacity=255});return[4,Promise.all([N.runTweenAsync(_,w),N.runTweenAsync(A,w)])];case 1:T.sent();return[2]}})}),function(n,w){return I.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),c}(eO)).prototype,"container",[DN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dz=DB))||Dz)||Dz);ew._RF.pop(),ew._RF.push({},"53da1+ne4RJ4p0kTjp52K/1","Leader",void 0);var MR,MI,ML,MO,MD,MM,MN,Mz,MB,MF,Mx,MU,MG,MH=eS.ccclass,MV=eS.property,Mq=GameCore.Utils.Number,MW=(Dq=MH("Leader"),DW=MV(eT),DK=MV(eH),Dj=MV({type:ek,group:"Container"}),DY=MV({type:ex,group:"Background"}),DX=MV({type:e9,group:"Background"}),DZ=MV({type:ex,group:"Rank"}),DJ=MV({type:eT,group:"Rank"}),DQ=MV({type:e9,group:"Rank"}),D$=MV({type:e9,group:"Rank"}),D0=MV({type:e9,group:"Rank"}),D1=MV({type:e9,group:"Rank"}),D2=MV({type:ex,group:"Avatar"}),D4=MV({type:eH,group:"Avatar"}),D3=MV({type:ex,group:"Score"}),D5=MV({type:eT,group:"Score"}),D6=MV({type:e9,group:"Score"}),D8=MV({type:eH,group:"Score"}),D9=MV({type:eH}),D7=MV({type:e_}),Me=z.onlyRunInLifeCycle,Mt=z.onlyRunInLifeCycleAsync,Mn=z.onlyRunInLifeCycle,Dq((Mr=n((Ma=function(n){w(g,n);var I,L,O,D,B,x=k(g);function g(){var n;C(this,g);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=x.call.apply(x,[this].concat(k)),_(n,"nameLabel",Mr,A(n)),_(n,"nameOpacity",Mo,A(n)),_(n,"container",Ms,A(n)),_(n,"background",Ml,A(n)),_(n,"highlightBackground",Mu,A(n)),_(n,"rankSprite",Mc,A(n)),_(n,"rankLabel",Mh,A(n)),_(n,"goldRank",Mp,A(n)),_(n,"silverRank",My,A(n)),_(n,"bronzeRank",Mf,A(n)),_(n,"highlightRank",Mv,A(n)),_(n,"avatar",Mg,A(n)),_(n,"avatarOpacity",Mm,A(n)),_(n,"scoreBackground",Mb,A(n)),_(n,"scoreLabel",Mw,A(n)),_(n,"highlightScoreBackground",MS,A(n)),_(n,"scoreOpacity",Mk,A(n)),_(n,"uiOpacity",MC,A(n)),_(n,"uiTransform",ME,A(n)),n.signal=new F,n}return T(g,[{key:"onLoad",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultRank=this.rankSprite.spriteFrame,this.defaultScoreBackground=this.scoreBackground.spriteFrame,this.defaultAvatar=this.avatar.spriteFrame,this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateInfo",value:function(n,w){this.updateBackground(n),this.updateRank(n,w),this.updatePhoto(n),this.updateUsername(n),this.updateScore(n)}},{key:"updateBackground",value:function(n){this.background.spriteFrame=n.isHighlight?this.highlightBackground:this.defaultBackground}},{key:"updateRank",value:function(n,w){var k=n.rank;this.rankLabel.string=w&&k>w?"".concat(w,"+"):k.toString(),this.rankSprite.spriteFrame=this.defaultRank;var C=new eC(Ck);switch(n.isHighlight&&(this.rankSprite.spriteFrame=this.highlightRank,C=new eC(CE)),k){case 1:this.rankSprite.spriteFrame=this.goldRank,C=new eC(Cm);break;case 2:this.rankSprite.spriteFrame=this.silverRank,C=new eC(Cb);break;case 3:this.rankSprite.spriteFrame=this.bronzeRank,C=new eC(Cw)}this.rankLabel.shadowColor=C,this.rankLabel.outlineColor=C}},{key:"updatePhoto",value:(B=M(function(n){var w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:this.signal.abort();w=new F;if(this.signal=w,!this.avatar)return[3,5];k=n.playerId,C=n.photo;if(!bU.isAvatarCached(n.playerId,70))return[3,2];return[4,bU.getPlayerAvatar(C,k,70,w)];case 1:_=T.sent();if(!_||w.aborted)return[2];this.setPhoto(_);return[3,5];case 2:this.avatar.spriteFrame=this.defaultAvatar;return[4,N.waitTweenAsync(.1,w)];case 3:if(T.sent(),!!w.aborted)return[3,5];return[4,bU.getPlayerAvatar(C,k,70,w)];case 4:A=T.sent();A&&!w.aborted&&this.setPhoto(A);T.label=5;case 5:return[2]}})}),function(n){return B.apply(this,arguments)})},{key:"setPhoto",value:function(n){this.node.active&&(n.packable=!0,this.avatar.spriteFrame=n)}},{key:"updateUsername",value:function(n){this.nameLabel.string=n.name,this.nameLabel.color=new eC(n.isHighlight?CC:CS)}},{key:"updateScore",value:function(n){var w=Math.floor(n.score);this.scoreLabel.string=Mq.getShortNumber(w,7);var k=this.scoreLabel.getComponent(eT);k.outlineColor=new eC(n.isHighlight?CE:Ck),k.shadowColor=new eC(n.isHighlight?CE:Ck),this.scoreBackground.spriteFrame=n.isHighlight?this.highlightScoreBackground:this.defaultScoreBackground}},{key:"runShowUpAnimation",value:(D=M(function(n,w){var k,C,_,A,T;var I=arguments;return _ts_generator(this,function(L){switch(L.label){case 0:k=this,C=I.length>2&&void 0!==I[2]?I[2]:.3;this.setVisible(!1);_=this.container.position.clone();this.container.position=new eQ(_.x,_.y-100,_.z);A=ez(this.container).delay(w);A.to(C,{position:_},{easing:"backOut"});T=ez(this.uiOpacity).delay(w);T.to(C,{opacity:255},{easing:"cubicOut",onUpdate:function(){k.nameOpacity.opacity=k.uiOpacity.opacity,k.scoreOpacity.opacity=k.uiOpacity.opacity,k.avatarOpacity.opacity=k.uiOpacity.opacity}}),n.addAbortListener(function(){k.container.position=_,k.uiOpacity.opacity=255,k.avatar.node.active=!0});return[4,Promise.all([N.runTweenAsync(A,n),N.runTweenAsync(T,n)])];case 1:L.sent();return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"runWorldPositionAnimation",value:(O=M(function(n,w,k){var C;return _ts_generator(this,function(_){switch(_.label){case 0:C=ez(this.node).to(w,{worldPosition:n},{easing:"quadOut"});return[4,N.runTweenAsync(C,k)];case 1:_.sent();return[2]}})}),function(n,w,k){return O.apply(this,arguments)})},{key:"runScaleAnimation",value:(L=M(function(n,w,k){var C;return _ts_generator(this,function(_){switch(_.label){case 0:C=ez(this.node).to(w,{scale:new eQ(n,n,n)},{easing:"backOut"});return[4,N.runTweenAsync(C,k)];case 1:_.sent();return[2]}})}),function(n,w,k){return L.apply(this,arguments)})},{key:"runUpdateDataAnimation",value:(I=M(function(n,w,k,C,_,A){var T;return _ts_generator(this,function(I){switch(I.label){case 0:T=this;return[4,N.runOnUpdateAsync(this.node,_,function(_){var A=Math.floor(n+(w-n)*_),I=Math.floor(k+(C-k)*_);T.updateRank({rank:A,isHighlight:!0}),T.updateScore({score:I,isHighlight:!0})},A)];case 1:I.sent();return[2]}})}),function(n,w,k,C,_,A){return I.apply(this,arguments)})},{key:"setVisible",value:function(n){var w=n?255:0;this.uiOpacity.opacity=w,this.nameOpacity.opacity=w,this.scoreOpacity.opacity=w,this.avatarOpacity.opacity=w}}]),g}(eO)).prototype,"nameLabel",[DW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=n(Ma.prototype,"nameOpacity",[DK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ms=n(Ma.prototype,"container",[Dj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ml=n(Ma.prototype,"background",[DY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mu=n(Ma.prototype,"highlightBackground",[DX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mc=n(Ma.prototype,"rankSprite",[DZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mh=n(Ma.prototype,"rankLabel",[DJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mp=n(Ma.prototype,"goldRank",[DQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),My=n(Ma.prototype,"silverRank",[D$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mf=n(Ma.prototype,"bronzeRank",[D0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mv=n(Ma.prototype,"highlightRank",[D1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mg=n(Ma.prototype,"avatar",[D2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mm=n(Ma.prototype,"avatarOpacity",[D4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mb=n(Ma.prototype,"scoreBackground",[D3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mw=n(Ma.prototype,"scoreLabel",[D5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MS=n(Ma.prototype,"highlightScoreBackground",[D6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mk=n(Ma.prototype,"scoreOpacity",[D8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MC=n(Ma.prototype,"uiOpacity",[D9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ME=n(Ma.prototype,"uiTransform",[D7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Ma.prototype,"updateInfo",[Me],Object.getOwnPropertyDescriptor(Ma.prototype,"updateInfo"),Ma.prototype),n(Ma.prototype,"updatePhoto",[Mt],Object.getOwnPropertyDescriptor(Ma.prototype,"updatePhoto"),Ma.prototype),n(Ma.prototype,"setPhoto",[Mn],Object.getOwnPropertyDescriptor(Ma.prototype,"setPhoto"),Ma.prototype),Mi=Ma))||Mi);ew._RF.pop(),ew._RF.push({},"173acdyc/VOnLkPsoSfdfnr","Leaders",void 0);var MK,Mj,MY,MX,MZ,MJ,MQ,M$,M0,M1,M2,M4,M3,M5,M6,M8,M9,M7,Ne,Nt,Nn,Ni,Na,Nr,No,Ns,Nl=eS.ccclass,Nu=eS.property,Nc=globalThis.game.player,Nh=GameCore.Utils.Array,Np=(MR=Nl("Leaders"),MI=Nu(AU),ML=Nu(MW),MO=Nu(eD),MD=z.onlyRunInLifeCycleAsync,MM=z.onlyRunInLifeCycleAsync,MN=z.onlyRunInLifeCycleAsync,Mz=z.onlyRunInLifeCycleAsync,MR((Mx=n((MF=function(n){w(m,n);var O,D,N,B,F,x,U=k(m);function m(){var n;C(this,m);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=U.call.apply(U,[this].concat(k)),_(n,"scrollView",Mx,A(n)),_(n,"tempLeader",MU,A(n)),_(n,"maxLeader",MG,A(n)),n.leaderData=[],n.displayLeaderData=[],n.displayPlayerLeader=null,n.isHidden=!0,n}return T(m,[{key:"onLoad",value:function(){this.uiTransform=this.getComponent(e_),this.batchNodes=this.getComponents(sp),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"__preload",value:function(){this.currentPlayerId=Nc.getPlayerId()}},{key:"updateData",value:(x=M(function(n){return _ts_generator(this,function(w){this.isHidden=!1,this.leaderData=n,this.leaderData.forEach(function(n,w){n.rank=w+1}),this.setupDisplayLeadersData();return[2]})}),function(n){return x.apply(this,arguments)})},{key:"initScrollViews",value:function(){var n=this;this.scrollView.setMaxNodeCount(this.leaderData.length),this.scrollView.init(function(w){var k=w.getComponent(MW),C=n.displayLeaderData[w.order],_=C.playerId,A=C.photo,T=C.name,I=C.score;k.setVisible(!0),k.updateInfo({playerId:_,isHighlight:n.currentPlayerId===_,name:T,photo:A,rank:w.order+1,score:I},n.maxLeader)}),this.setBatchNodes(!0)}},{key:"playRankChangeAnimation",value:(F=M(function(n,w,k,C){var _,A,T,I,L,O,D,M,N,z,B,F;return _ts_generator(this,function(x){switch(x.label){case 0:if(w>=k)return[3,4];_=this.displayLeaderData,A=Nh.search(_,function(n){return n.playerId===Nc.getPlayerId()});if(!A)return[3,4];T=A.rank;if(!_[C-1])return[3,4];I=this.scrollView.getNodeByOrder(A.rank-1);if(!I)return[3,4];L=null==I?void 0:I.getComponent(MW);if(!L)return[3,4];L.setVisible(!1),this.tempLeader.setVisible(!0),this.tempLeader.updatePhoto({playerId:Nc.getPlayerId(),photo:A.photo}),this.tempLeader.node.worldPosition=I.node.worldPosition.clone();return[4,this.tempLeader.runScaleAnimation(1.1,.5,n)];case 1:x.sent();O=Math.min(.5*(T-C),2),D=[this.tempLeader.runUpdateDataAnimation(T,C,w,k,O,n),this.scrollToLeaderRank(C,O,n)],M=this.scrollView.scrollView.getMaxScrollOffset().y,N=this.scrollView.getNodeScrollOffset(C-1),z=eQ.ZERO;if(N<0)z=new eQ(this.tempLeader.node.worldPosition.x,this.node.worldPosition.y+this.scrollView.getNodePosition(C-1).y+this.uiTransform.height/2,this.tempLeader.node.worldPosition.z);else if(this.scrollView.scrollView.getScrollOffset().y>=M-5){if(N<M)z=new eQ(this.tempLeader.node.worldPosition.x,this.scrollView.viewport.node.worldPosition.y,this.tempLeader.node.worldPosition.z);else{F=this.scrollView.getNodeByOrder(C-1);z=null!==(B=null==F?void 0:F.node.worldPosition.clone())&&void 0!==B?B:eQ.ZERO}}z.equals(eQ.ZERO)||D.push(this.tempLeader.runWorldPositionAnimation(z,O,n));return[4,Promise.all(D)];case 2:x.sent();return[4,Promise.all([this.tempLeader.runScaleAnimation(1,.25,n),this.playPostRankChangeAnimation(C,T,n)])];case 3:x.sent(),this.tempLeader.setVisible(!1),I.node.worldPosition=this.tempLeader.node.worldPosition.clone(),this.setupDisplayLeadersData(),this.scrollView.updateNodeVisibility(),this.scrollView.updateLayout();x.label=4;case 4:return[2]}})}),function(n,w,k,C){return F.apply(this,arguments)})},{key:"playShowLeadersAnimation",value:(B=M(function(n){var w,k,C,_,A;var T=arguments;return _ts_generator(this,function(I){switch(I.label){case 0:w=this,k=T.length>1&&void 0!==T[1]?T[1]:.1;if(!!this.isHidden)return[3,2];C=[],_=this.scrollView.getAllNodes();if(_.sort(function(n,w){return n.order-w.order}).forEach(function(n,k){var _=n.getComponent(MW);_.setVisible(k<w.leaderData.length),n.isVisible()&&C.push(_)}),C.length<1)return[3,2];C=C.slice(0,_.length-1);A=.3;return[4,Promise.all(C.map(function(){var C=M(function(C,_){var T;return _ts_generator(this,function(I){switch(I.label){case 0:T=w.isHidden;if(T)return[3,2];return[4,C.runShowUpAnimation(n,_*k,A)];case 1:T=I.sent();I.label=2;case 2:return[2]}})});return function(n,w){return C.apply(this,arguments)}}()))];case 1:I.sent();I.label=2;case 2:return[2]}})}),function(n){return B.apply(this,arguments)})},{key:"scrollToPlayerLeader",value:(N=M(function(n,w){var k;return _ts_generator(this,function(C){switch(C.label){case 0:k=this.displayPlayerLeader;if(!k)return[3,2];return[4,this.scrollToLeaderRank(this.displayPlayerLeader.rank,n,w)];case 1:k=C.sent();C.label=2;case 2:return[2]}})}),function(n,w){return N.apply(this,arguments)})},{key:"updateDisplayPlayerLeaderForRankChanging",value:function(n,w,k){if(!this.displayPlayerLeader)return!1;this.displayPlayerLeader.score=n,this.displayLeaderData.sort(function(n,w){return w.score-n.score});var C=this.displayLeaderData.indexOf(this.displayPlayerLeader)+1;return k===C?(this.displayPlayerLeader.score=w,this.displayPlayerLeader.rank=k,!1):(this.displayPlayerLeader.rank=C,this.tempLeader.updateInfo({playerId:Nc.getPlayerId(),isHighlight:!0,name:this.displayPlayerLeader.name,photo:this.displayPlayerLeader.photo,rank:this.displayPlayerLeader.rank,score:n}),!0)}},{key:"hideLeaders",value:function(){this.isHidden=!0;var n,w=this.scrollView.getAllNodes().map(function(n){return n.getComponent(MW)}),k=L(w);try{for(k.s();!(n=k.n()).done;){var C=n.value;null==C||C.setVisible(!1)}}catch(n){k.e(n)}finally{k.f()}this.setBatchNodes(!1)}},{key:"getLeaderData",value:function(){return this.leaderData}},{key:"setBatchNodes",value:function(n){this.batchNodes.every(function(w){w.enabled=n})}},{key:"setupDisplayLeadersData",value:function(){var n=this,w=Nh.search(this.leaderData,function(w){return w.playerId===n.currentPlayerId});w?(this.displayLeaderData=this.leaderData.filter(function(w){return w.playerId!==n.currentPlayerId}),this.displayPlayerLeader=I({},w),this.displayLeaderData.splice(w.rank-1,0,this.displayPlayerLeader)):(this.displayPlayerLeader=null,this.displayLeaderData=this.leaderData)}},{key:"playPostRankChangeAnimation",value:(D=M(function(n,w,k){var C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:C=null!=n?n:0,_=this.scrollView.getVisibleNodes().filter(function(n){return n.order>=C-1&&n.order<w}),A=_.map(function(n){return n.getComponent(MW)}),T=this.scrollView.nodeHeight+this.scrollView.spacing,I=[];A.forEach(function(n,w){n.updateRank({rank:_[w].order+2,isHighlight:!1});var C=n.node.worldPosition.clone();I.push(n.runWorldPositionAnimation(C.add3f(0,-T,0),.25,k))});return[4,Promise.all(I)];case 1:L.sent();return[2]}})}),function(n,w,k){return D.apply(this,arguments)})},{key:"scrollToLeaderRank",value:(O=M(function(n,w,k){return _ts_generator(this,function(C){switch(C.label){case 0:return[4,this.scrollView.scrollToOrder(n-1,k,w)];case 1:C.sent();return[2]}})}),function(n,w,k){return O.apply(this,arguments)})}]),m}(eO)).prototype,"scrollView",[MI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MU=n(MF.prototype,"tempLeader",[ML],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MG=n(MF.prototype,"maxLeader",[MO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(MF.prototype,"updateData",[MD],Object.getOwnPropertyDescriptor(MF.prototype,"updateData"),MF.prototype),n(MF.prototype,"playRankChangeAnimation",[MM],Object.getOwnPropertyDescriptor(MF.prototype,"playRankChangeAnimation"),MF.prototype),n(MF.prototype,"scrollToPlayerLeader",[MN],Object.getOwnPropertyDescriptor(MF.prototype,"scrollToPlayerLeader"),MF.prototype),n(MF.prototype,"scrollToLeaderRank",[Mz],Object.getOwnPropertyDescriptor(MF.prototype,"scrollToLeaderRank"),MF.prototype),MB=MF))||MB);ew._RF.pop(),ew._RF.push({},"2aa67vEWR9HaJkCtpsuUyRX","LeaderboardContent",void 0);var Ny,Nf,Nv,Ng,Nm,Nb,Nw,NS=eS.ccclass,Nk=eS.property,NC=globalThis.game,NE=NC.storage,N_=NC.leaderboard,NA=NC.player,NT=NC.monitorError,NP=GameCore,NR=NP.Utils.Object,NI=NP.Configs.Leaderboards,NL=function(n){w(o,n);var _=k(o);function o(n){var w;return C(this,o),(w=_.call(this,n)).name="EmptyLeaderboardError",w}return T(o)}(Z(Error)),NO=(MK=NS("LeaderboardContent"),Mj=z.required(),MY=Nk(DD),MX=z.required(),MZ=Nk(DV),MJ=z.required(),MQ=Nk(Np),M$=Nk({type:[MP]}),M0=z.required(),M1=Nk(Da),M2=z.required(),M4=Nk(i_),M3=z.onlyRunInLifeCycleAsync,M5=z.onlyRunInLifeCycleAsync,M6=z.onlyRunInLifeCycleAsync,M8=z.onlyRunInLifeCycleAsync,M9=z.onlyRunInLifeCycleAsync,M7=z.onlyRunInLifeCycleAsync,MK((Nn=n((Nt=function(n){w(g,n);var I,L,O,D,N,B,x=k(g);function g(){var n;C(this,g);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=x.call.apply(x,[this].concat(k)),_(n,"tabs",Nn,A(n)),_(n,"timer",Ni,A(n)),_(n,"leaders",Na,A(n)),_(n,"leaderSkeletons",Nr,A(n)),_(n,"leaderboardIsEmpty",No,A(n)),_(n,"contentOpacity",Ns,A(n)),n.isHidden=!0,n.currentLb=null,n.animAbortSignal=new F,n.hasPlayedAppearAnim={friends:!1,global:!1,tournament:!1},n.handleFriendsTabSelected=M(function(){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:NE.setStorageData("leaderboard_content","lastTabOpened","friends"),n.cleanupSideEffects();w=n.animAbortSignal;C.label=1;case 1:C.trys.push([1,3,,4]);return[4,n.updateStatus(w,"friends")];case 2:C.sent();return[3,4];case 3:k=C.sent();w.call(function(){var n=_instanceof(k,Error)?k:new Error("Unknown error during loading friends leaderboard.");console.error("LeaderboardContent",n),null==NT||NT.sendException(n),en.showNotificationScreenWithLocalizedKey("error.noFriendsLb",2)});return[3,4];case 4:return[2]}})}),n.handleWorldTabSelected=M(function(){var w,k;return _ts_generator(this,function(C){switch(C.label){case 0:NE.setStorageData("leaderboard_content","lastTabOpened","global"),n.cleanupSideEffects();w=n.animAbortSignal;C.label=1;case 1:C.trys.push([1,3,,4]);return[4,n.updateStatus(w,"global")];case 2:C.sent();return[3,4];case 3:k=C.sent();w.call(function(){var n=_instanceof(k,Error)?k:new Error("Unknown error during loading global leaderboard.");console.error("LeaderboardContent",n),null==NT||NT.sendException(n),en.showNotificationScreenWithLocalizedKey("error.noWorldLb",2)});return[3,4];case 4:return[2]}})}),n.hideContent=function(){n.contentOpacity.changeStateFade(!1,.1)},n.showContent=function(){n.contentOpacity.changeStateFade(!0,.1)},n}return T(g,[{key:"__preload",value:function(){this.leaders.maxLeader=NI.Limit}},{key:"onLoad",value:function(){z.validateRequiredProperties(this)}},{key:"listenEvents",value:function(){this.node.scene.on(Cg.FRIENDS_TAB_SELECTED,this.handleFriendsTabSelected),this.node.scene.on(Cg.WORLD_TAB_SELECTED,this.handleWorldTabSelected),this.node.scene.on(i9.HIDE_UI,this.hideContent),this.node.scene.on(i9.SHOW_UI,this.showContent)}},{key:"unlistenEvents",value:function(){this.node.scene.off(Cg.FRIENDS_TAB_SELECTED,this.handleFriendsTabSelected),this.node.scene.off(Cg.WORLD_TAB_SELECTED,this.handleWorldTabSelected),this.unlistenUIEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(i9.HIDE_UI,this.hideContent),this.node.scene.off(i9.SHOW_UI,this.showContent)}},{key:"loadLeaderboard",value:(B=M(function(n,w){var k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:k=this,C=this.getLeaderboardName(n);_=null!==C;if(!_)return[3,3];return[4,w.callAsync(function(){return N_.requestLeaderboardAsync(C,NI.Limit)})];case 1:A.sent(),w.call(function(){var n=N_.getLeaderboard(C);k.currentLb=null!=n?n:k.currentLb});return[4,w.callAsync(M(function(){return _ts_generator(this,function(w){return[2,k.loadPlayerLeaderData(n)]})}))];case 2:_=A.sent();A.label=3;case 3:return[2]}})}),function(n,w){return B.apply(this,arguments)})},{key:"getLeaderboardName",value:function(n){return"friends"===n?ed.FRIENDS:ed.GLOBAL}},{key:"showLoading",value:(N=M(function(n){var w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:w=this,k=C.length>1&&void 0!==C[1]?C[1]:0;return[4,Promise.all([this.leaders.scrollView.unlistenEvents(),this.leaders.scrollView.scrollToTop(n).then(function(){w.leaders&&(w.leaders.scrollView.scrollView.enabled=!1,w.leaders.scrollView.listenEvents())}),this.leaderSkeletons.map(function(w,C){return w.show(C*k,n)})])];case 1:_.sent();return[2]}})}),function(n){return N.apply(this,arguments)})},{key:"hideLoading",value:(D=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,Promise.all(this.leaderSkeletons.map(function(w){return w.hide(n)}))];case 1:w.sent();return[2]}})}),function(n){return D.apply(this,arguments)})},{key:"entering",value:function(){this.timer.reset(),this.isHidden=!1;var n=NE.getStorageData("leaderboard_content","lastTabOpened");"friends"===n?this.handleFriendsTabSelected():"global"===n&&this.handleWorldTabSelected()}},{key:"enter",value:function(){this.listenEvents()}},{key:"hide",value:function(){this.isHidden=!0}},{key:"cleanup",value:function(){this.unlistenEvents(),this.cleanupSideEffects()}},{key:"cleanupSideEffects",value:function(){this.animAbortSignal.abort(),this.animAbortSignal=new F,this.leaders.hideLeaders(),this.leaderboardIsEmpty.hide()}},{key:"updateStatus",value:(O=M(function(n,w){var k,C,_,A,T;return _ts_generator(this,function(I){switch(I.label){case 0:A=this;if(!(void 0!==n&&!this.isHidden))return[3,7];this.tabs.updateStatus(w);return[4,this.showLoading(n)];case 1:I.sent();I.label=2;case 2:I.trys.push([2,4,,5]);return[4,this.loadLeaderboard(w,n)];case 3:I.sent();return[3,5];case 4:T=I.sent();if(!_instanceof(T,NL))throw T;return[2,void n.call(function(){A.leaderboardIsEmpty.show(),A.hideLoading(n)})];case 5:null===(k=this.timer)||void 0===k||k.setTimeLabel(null===(C=this.currentLb)||void 0===C?void 0:C.resettable),null===(_=this.timer)||void 0===_||_.show(n),this.hideLoading(n);return[4,n.callAsync(function(n){return A.playLeadersShowupAnimation(w,n)})];case 6:I.sent();I.label=7;case 7:return[2]}})}),function(n,w){return O.apply(this,arguments)})},{key:"playLeadersShowupAnimation",value:(L=M(function(n,w){var k,C,_,A,T,I,L,O,D,M,N,z,B;return _ts_generator(this,function(F){switch(F.label){case 0:k=this;if(!this.currentLb)return[3,6];C=NA.getPlayerId(),_=this.currentLb.leaders[C],A=NE.getStorage("leaderboard_content").previousScore,T=null!=_?_:{},I=T.score,L=T.rank,O=NR.vals(this.currentLb.leaders);O.sort(function(n,w){return w.score-n.score});D=-1!==A&&A<I&&L<=NI.Limit;this.leaders.updateData(O);M=!1;_&&D&&(M=this.leaders.updateDisplayPlayerLeaderForRankChanging(A,I,L)),this.leaders.initScrollViews(),this.leaders.scrollView.scrollView.enabled=!0;N=this.hasPlayedAppearAnim[n]?0:.1;return[4,w.callAsync(function(){return k.leaders.playShowLeadersAnimation(w,N)})];case 1:F.sent(),this.hasPlayedAppearAnim[n]=!0;z=_;if(!z)return[3,5];return[4,w.callAsync(function(){return k.leaders.scrollToPlayerLeader(1,w)})];case 2:F.sent();B=M&&-1!==A;if(!B)return[3,4];return[4,w.callAsync(function(n){return k.leaders.playRankChangeAnimation(n,A,I,L)})];case 3:B=(F.sent(),NE.setStorageData("leaderboard_content","previousScore",I));F.label=4;case 4:z=B;F.label=5;case 5:F.label=6;case 6:return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"loadPlayerLeaderData",value:(I=M(function(n){var w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:w=NA.getPlayerId();if(null===this.currentLb)throw new Error("LeaderboardContent: Leaderboard is not found.");k=this.currentLb.leaders;if(0===Object.keys(k).length)throw new NL("LeaderboardContent: Leaderboard is empty.");if(!!k[w])return[3,2];C=this.getLeaderboardName(n);if(null===C)throw new Error("LeaderboardContent: Leaderboard name is not found.");return[4,N_.getLeadersByPlayerIdsAsync(C,[w])];case 1:_=T.sent();if(0!==_.length){A=_[0];k[w]=A}T.label=2;case 2:return[2]}})}),function(n){return I.apply(this,arguments)})}]),g}(eO)).prototype,"tabs",[Mj,MY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ni=n(Nt.prototype,"timer",[MX,MZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Na=n(Nt.prototype,"leaders",[MJ,MQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nr=n(Nt.prototype,"leaderSkeletons",[M$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),No=n(Nt.prototype,"leaderboardIsEmpty",[M0,M1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ns=n(Nt.prototype,"contentOpacity",[M2,M4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Nt.prototype,"loadLeaderboard",[M3],Object.getOwnPropertyDescriptor(Nt.prototype,"loadLeaderboard"),Nt.prototype),n(Nt.prototype,"showLoading",[M5],Object.getOwnPropertyDescriptor(Nt.prototype,"showLoading"),Nt.prototype),n(Nt.prototype,"hideLoading",[M6],Object.getOwnPropertyDescriptor(Nt.prototype,"hideLoading"),Nt.prototype),n(Nt.prototype,"updateStatus",[M8],Object.getOwnPropertyDescriptor(Nt.prototype,"updateStatus"),Nt.prototype),n(Nt.prototype,"playLeadersShowupAnimation",[M9],Object.getOwnPropertyDescriptor(Nt.prototype,"playLeadersShowupAnimation"),Nt.prototype),n(Nt.prototype,"loadPlayerLeaderData",[M7],Object.getOwnPropertyDescriptor(Nt.prototype,"loadPlayerLeaderData"),Nt.prototype),Ne=Nt))||Ne);ew._RF.pop(),ew._RF.push({},"ae514KD4phHMYC0AD3CIw68","LeaderboardPage",void 0);var ND,NM,NN,Nz,NB,NF,Nx,NU,NG,NH,NV,Nq,NW,NK,Nj,NY,NX,NZ;Ny=(0,eS.ccclass)("LeaderboardPage"),Nf=z.required(),Nv=z.onlyRunInLifeCycleAsync,Ng=z.onlyRunInLifeCycleAsync,Nm=z.onlyRunInLifeCycleAsync,Ny((Nw=n((Nb=function(n){w(v,n);var I,L,z,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"panelAnimationController",Nw,A(n)),n}return T(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(am),O(D(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(B=M(function(){return _ts_generator(this,function(n){O(D(v.prototype),"start",this).call(this);return[2]})}),function(){return B.apply(this,arguments)})},{key:"mount",value:(z=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"mount",this).call(this)];case 1:if(n.sent(),this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(NO),!this.content)throw new Error("LeaderboardPage: Leaders not found");return[2]}})}),function(){return z.apply(this,arguments)})},{key:"transitionIn",value:(L=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:this.content.entering();return[4,O(D(v.prototype),"transitionIn",this).call(this)];case 1:k.sent();n=N.runTweenAsync(ez(this.containerUIOpacity).to(.2,{opacity:255})),w=this.panelAnimationController.showUI();return[4,Promise.all([n,w])];case 2:k.sent(),this.content.enter();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"transitionOut",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"transitionOut",this).call(this)];case 1:n.sent(),this.content.unlistenUIEvents(),this.content.leaders.setBatchNodes(!1);return[4,this.panelAnimationController.hideUI()];case 2:n.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"unmount",value:function(){var n,w;null===(n=this.content)||void 0===n||n.hide(),null===(w=this.content)||void 0===w||w.cleanup(),O(D(v.prototype),"unmount",this).call(this)}}]),v}(A2)).prototype,"panelAnimationController",[Nf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Nb.prototype,"mount",[Nv],Object.getOwnPropertyDescriptor(Nb.prototype,"mount"),Nb.prototype),n(Nb.prototype,"transitionIn",[Ng],Object.getOwnPropertyDescriptor(Nb.prototype,"transitionIn"),Nb.prototype),n(Nb.prototype,"transitionOut",[Nm],Object.getOwnPropertyDescriptor(Nb.prototype,"transitionOut"),Nb.prototype),Nb));ew._RF.pop(),ew._RF.push({},"0d1c02Npp9IXrjlFdl8co2L","TopLeader",void 0);var NJ,NQ,N$,N0,N1,N2,N4,N3,N5,N6,N8,N9,N7,ze,zt,zn,zi,za,zr,zo,zs,zl,zu,zc,zh,zp,zd,zy=eS.ccclass,zf=eS.property,zv=GameCore.Utils.Number,zg=(ND=zy("TopLeader"),NM=zf(eT),NN=zf(ek),Nz=zf({type:ex}),NB=zf({type:eH}),NF=zf({type:eT}),Nx=zf({type:eH}),NU=z.onlyRunInLifeCycle,NG=z.onlyRunInLifeCycleAsync,NH=z.onlyRunInLifeCycleAsync,ND((NW=n((Nq=function(n){w(y,n);var I,L,O,D=k(y);function y(){var n;C(this,y);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"nameLabel",NW,A(n)),_(n,"defaultAvatar",NK,A(n)),_(n,"avatar",Nj,A(n)),_(n,"avatarOpacity",NY,A(n)),_(n,"scoreLabel",NX,A(n)),_(n,"uiOpacity",NZ,A(n)),n.signal=new F,n}return T(y,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateInfo",value:function(n){this.updateUsername(n),this.updatePhoto(n),this.updateScore(n)}},{key:"updateUsername",value:function(n){this.nameLabel&&(this.nameLabel.string=n.name)}},{key:"updatePhoto",value:(O=M(function(n){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:this.signal.abort();w=new F;this.signal=w,this.defaultAvatar.active=!bU.isAvatarCached(n.playerId,128),this.avatar.spriteFrame=null;k=n.playerId,C=n.photo;return[4,bU.getPlayerAvatar(C,k,128,w)];case 1:_=A.sent();_&&!w.aborted&&this.setPhoto(_);return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"setPhoto",value:(L=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:if(!this.node.active)return[3,2];n.packable=!0,this.avatar.spriteFrame=n;w=ez(this.avatarOpacity).to(.2,{opacity:255});return[4,N.runTweenAsync(w,this.signal)];case 1:k.sent(),this.defaultAvatar.active=!1;k.label=2;case 2:return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"updateScore",value:function(n){if(this.scoreLabel){var w=Math.floor(n.score);this.scoreLabel.string=zv.getShortNumber(w,7)}}},{key:"runShowUpAnimation",value:(I=M(function(n){var w,k,C,_;var A=arguments;return _ts_generator(this,function(T){switch(T.label){case 0:w=A.length>1&&void 0!==A[1]?A[1]:.3,k=A.length>2?A[2]:void 0;this.node.scale=eQ.ZERO;C=ez(this.node).delay(n).to(w,{scale:new eQ(1,1,1)},{easing:"backOut"}),_=ez(this.uiOpacity).delay(n).to(w,{opacity:255});return[4,Promise.all([N.runTweenAsync(C,k),N.runTweenAsync(_,k)])];case 1:T.sent();return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"setVisible",value:function(n){var w=n?255:0;this.uiOpacity.opacity=w,this.avatarOpacity.opacity=w}}]),y}(eO)).prototype,"nameLabel",[NM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NK=n(Nq.prototype,"defaultAvatar",[NN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nj=n(Nq.prototype,"avatar",[Nz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NY=n(Nq.prototype,"avatarOpacity",[NB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NX=n(Nq.prototype,"scoreLabel",[NF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NZ=n(Nq.prototype,"uiOpacity",[Nx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Nq.prototype,"updateInfo",[NU],Object.getOwnPropertyDescriptor(Nq.prototype,"updateInfo"),Nq.prototype),n(Nq.prototype,"updatePhoto",[NG],Object.getOwnPropertyDescriptor(Nq.prototype,"updatePhoto"),Nq.prototype),n(Nq.prototype,"setPhoto",[NH],Object.getOwnPropertyDescriptor(Nq.prototype,"setPhoto"),Nq.prototype),NV=Nq))||NV);ew._RF.pop(),ew._RF.push({},"8cd04RxbahLDaxq9FJf6hBh","TournamentBlock",void 0);var zm,zb,zw,zS,zk,zC=eS.ccclass,zE=eS.property,z_=globalThis.game,zA=z_.leaderboard,zT=z_.player,zP=z_.language,zR=GameCore.Utils,zI=zR.Time,zL=zR.Object,zO=zR.Array,zD=zR.Number,zM=(NJ=zC("TournamentBlock"),NQ=zE(ek),N$=zE(eT),N0=zE(K),N1=zE(K),N2=zE(K),N4=zE(K),N3=zE(e_),N5=zE({type:ex}),N6=zE(ek),N8=zE(ek),N9=zE(zg),N7=z.onlyRunInLifeCycleAsync,ze=z.onlyRunInLifeCycle,NJ((zi=n((zn=function(n){w(m,n);var I,L,O,D,F,x,U=k(m);function m(){var n;C(this,m);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=U.call.apply(U,[this].concat(k)),_(n,"container",zi,A(n)),_(n,"title",za,A(n)),_(n,"titleLocalizer",zr,A(n)),_(n,"timeLocalizer",zo,A(n)),_(n,"playerCountLocalizer",zs,A(n)),_(n,"playButtonLocalize",zl,A(n)),_(n,"uiTransform",zu,A(n)),_(n,"banner",zc,A(n)),_(n,"bannerMask",zh,A(n)),_(n,"bannerLoadingRing",zp,A(n)),_(n,"topLeader",zd,A(n)),n.hasPlayedAnimation=!1,n}return T(m,[{key:"onLoad",value:function(){this.uiOpacity=this.node.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateInfo",value:(x=M(function(n){var w,k,C,_,A,T,I,L;return _ts_generator(this,function(O){switch(O.label){case 0:this.payload=n;w=n.endTime,k=n.title,C=n.payload.playerName,_=n.tournamentType,A=n.payload,T=A.leaderboardId,I=A.themeId;L=T;if(!L)return[3,2];this.topLeader.setVisible(!1),this.topLeader.node.active=!1,this.setPlayerCountWaiting(),"PAGE_HOSTED"===_?this.updateTitleTournamentTitle(k):this.updateTitleWithPlayerName(null!=C?C:k),this.updateEndTime(w),this.updateTournamentBanner(I);return[4,this.fetchAndUpdateLeadersPayload(T,{leaders:[],amountPlayer:0},k)];case 1:L=O.sent();O.label=2;case 2:return[2]}})}),function(n){return x.apply(this,arguments)})},{key:"fetchAndUpdateLeadersPayload",value:(F=M(function(n,w,k){var C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:C=w;T.label=1;case 1:T.trys.push([1,3,,4]);return[4,this.getLeadersPayload(n)];case 2:_=T.sent();_&&(C=_);return[3,4];case 3:A=T.sent();console.error("Fetch lb for tournament ".concat(k),A);return[3,4];case 4:this.updateLeadersPayload(C);return[2]}})}),function(n,w,k){return F.apply(this,arguments)})},{key:"updateLeadersPayload",value:function(n){this.leadersPayload=n;var w=this.leadersPayload,k=w.player,C=w.amountPlayer,_=w.leaders;this.updatePlayerCount(C),this.updatePlayButtonLabel(void 0!==k),this.updateTopLeader(null!=_?_:[])}},{key:"updateTitleWithPlayerName",value:function(n){void 0!==n&&(this.titleLocalizer.enabled=!0,this.titleLocalizer.setParams([n]))}},{key:"updateTitleTournamentTitle",value:function(n){this.titleLocalizer.enabled=!1,this.title.string=n}},{key:"updateEndTime",value:function(n){try{var w=zI.getRelativeTime(n,zP.getCurrentLocale());this.timeLocalizer.key="game.endsIn",this.timeLocalizer.setParams([w])}catch(n){this.timeLocalizer.key="game.endsSoon"}}},{key:"updatePlayerCount",value:function(n){var w=zD.getShortNumber(n,3);1===n?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([w]))}},{key:"setPlayerCountWaiting",value:function(){this.playerCountLocalizer.key="status.loading"}},{key:"updateTopLeader",value:(D=M(function(n){var w,k;return _ts_generator(this,function(C){if(0!==n.length){k=n[0];GameCore.Configs.Mockup.Leaderboards.Enabled&&(k=null!==(w=zO.search(n,function(n){return 1===n.rank}))&&void 0!==w?w:k),this.topLeader.node.active=!0,this.topLeader.updateInfo(k),this.topLeader.runShowUpAnimation(0,.2)}return[2]})}),function(n){return D.apply(this,arguments)})},{key:"updateTournamentBanner",value:(O=M(function(n){var w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:w=B.getAsset("".concat(ep[n],"/spriteFrame"),e9);k=w;if(k)return[3,2];this.bannerMask.active=!0,this.bannerLoadingRing.active=!0;return[4,B.loadThemePreviewAsync(n)];case 1:k=w=_.sent();_.label=2;case 2:C=w;if(C)return[3,4];return[4,B.loadThemePreviewAsync(el.SUMMER)];case 3:C=w=_.sent();_.label=4;case 4:this.banner&&w&&(this.banner.spriteFrame=w,this.bannerMask.active=!1,this.bannerLoadingRing.active=!1);return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"updatePlayButtonLabel",value:function(n){this.playButtonLocalize.key=n?"game.continue":"game.join"}},{key:"getLeadersPayload",value:(L=M(function(n){var w,k,C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:k=zA.getLeaderboardName(n);if(!k)return[2,null];return[4,sL.getAllLeaderboardAsync(n)];case 1:C=L.sent();if(!C)return[2,null];_=zL.vals(C.leaders);_.sort(function(n,w){return n.rank-w.rank});A=zT.getPlayerId();return[4,zA.getLeadersByPlayerIdsAsync(k,[A])];case 2:T=L.sent(),I={leaders:_,amountPlayer:null!==(w=C.amountPlayer)&&void 0!==w?w:0};return[2,(T.length>0&&(I.player=T[0]),I)]}})}),function(n){return L.apply(this,arguments)})},{key:"runShowPopUpAnimation",value:(I=M(function(n,w,k){var C,_,A,T,I;return _ts_generator(this,function(L){switch(L.label){case 0:C=this;this.node.scale=new eQ(.8,.8,.8),this.uiOpacity.opacity=0;_=this.container.position.clone();this.container.position=new eQ(_.x,_.y-100,_.z);A=ez(this.node).delay(n);A.to(w,{scale:eQ.ONE},{easing:"elasticOut"});T=ez(this.container).delay(n);T.to(w,{position:_},{easing:"backOut"});I=ez(this.uiOpacity).delay(n);I.to(w,{opacity:255},{easing:"cubicOut"}),k.addAbortListener(function(){C.node.scale=eQ.ONE,C.container.position=_,C.uiOpacity.opacity=255});return[4,Promise.all([N.runTweenAsync(A,k),N.runTweenAsync(T,k),N.runTweenAsync(I,k)])];case 1:L.sent();return[2]}})}),function(n,w,k){return I.apply(this,arguments)})},{key:"handleOnTournamentClicked",value:function(){var n=this.payload.id||"";if(et.validateTournamentExpired(n))return this.node.scene.emit(sT.RELOAD_TOURNAMENT),void en.showNotificationScreenWithLocalizedKey("error.tourEnded",2);try{var w=JSON.stringify(this.payload);en.showTournamentDetailScreen(w,"tournament_start",this.hasPlayedAnimation),this.hasPlayedAnimation=!0}catch(n){console.warn("handleOnTournamentClicked",n)}}}]),m}(eO)).prototype,"container",[NQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),za=n(zn.prototype,"title",[N$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=n(zn.prototype,"titleLocalizer",[N0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zo=n(zn.prototype,"timeLocalizer",[N1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=n(zn.prototype,"playerCountLocalizer",[N2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zl=n(zn.prototype,"playButtonLocalize",[N4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zu=n(zn.prototype,"uiTransform",[N3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zc=n(zn.prototype,"banner",[N5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zh=n(zn.prototype,"bannerMask",[N6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zp=n(zn.prototype,"bannerLoadingRing",[N8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zd=n(zn.prototype,"topLeader",[N9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(zn.prototype,"fetchAndUpdateLeadersPayload",[N7],Object.getOwnPropertyDescriptor(zn.prototype,"fetchAndUpdateLeadersPayload"),zn.prototype),n(zn.prototype,"updateLeadersPayload",[ze],Object.getOwnPropertyDescriptor(zn.prototype,"updateLeadersPayload"),zn.prototype),zt=zn))||zt);ew._RF.pop(),ew._RF.push({},"a409buwLfZLQq7cmBGiqhF5","TournamentBlockSkeleton",void 0);var zN,zz,zB,zF,zx,zU,zG,zH,zV,zq,zW,zK,zj,zY=eS.ccclass,zX=eS.property,zZ=(zm=zY("TournamentBlockSkeleton"),zb=zX(ek),zm((zk=n((zS=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"container",zk,A(n)),n}return T(c,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"hide",value:(L=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=this;return[4,N.runTweenAsync(ez(this.uiOpacity).to(.2,{opacity:0}).call(function(){w.node.active=!1}),n)];case 1:k.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"show",value:(I=M(function(n,w){var k,C,_,A,T;return _ts_generator(this,function(I){switch(I.label){case 0:k=this;this.node.active=!0,this.node.scale=new eQ(.8,.8,.8),this.uiOpacity.opacity=0;C=this.container.position.clone();this.container.position=new eQ(C.x,C.y-100,C.z);_=ez(this.node).delay(n);_.to(.2,{scale:eQ.ONE},{easing:"elasticOut"});A=ez(this.container).delay(n);A.to(.2,{position:C},{easing:"backOut"});T=ez(this.uiOpacity).delay(n);T.to(.2,{opacity:255},{easing:"cubicOut"}),w.addAbortListener(function(){k.node.scale=eQ.ONE,k.container.position=C,k.uiOpacity.opacity=255});return[4,Promise.all([N.runTweenAsync(_,w),N.runTweenAsync(A,w),N.runTweenAsync(T,w)])];case 1:I.sent();return[2]}})}),function(n,w){return I.apply(this,arguments)})}]),c}(eO)).prototype,"container",[zb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zw=zS))||zw);ew._RF.pop(),ew._RF.push({},"5f82fye3oxHQrxKbP9TC2di","TournamentsBoard",void 0);var zJ,zQ,z$,z0,z1,z2=eS.ccclass,z4=eS.property,z3=globalThis.game.player,z5=(zN=z2("TournamentsBoard"),zz=z4(ta),zB=z4(ek),zF=z4(eB),zx=z4(ek),zU=z4(e_),zN((zV=n((zH=function(n){w(c,n);var I,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"tournamentBlockPrefab",zV,A(n)),n.tournamentBlockArray=[],_(n,"inactiveNodeContainer",zq,A(n)),_(n,"layout",zW,A(n)),_(n,"createTournamentButton",zK,A(n)),_(n,"viewport",zj,A(n)),n}return T(c,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"start",value:function(){for(var n=0;n<20;n++)this.addTournamentBlock();this.tournamentBlockContentHeight=this.tournamentBlockArray[0].uiTransform.contentSize.height+this.layout.spacingY}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateData",value:function(n){var w=this,k=!1;n.forEach(function(n,C){var _=w.tournamentBlockArray[C];n.payload.playerId===z3.getPlayerId()&&(k=!0),_||(_=w.addTournamentBlock()),w.layout.node.addChild(_.node),_.updateInfo(n)}),k||this.setCreateTournamentButtonActive(!0)}},{key:"addTournamentBlock",value:function(){var n=eA(this.tournamentBlockPrefab);this.inactiveNodeContainer.addChild(n);var w=n.getComponent(zM);return this.tournamentBlockArray.push(w),w}},{key:"removeTournamentBlocks",value:function(){var n,w=this.getActiveTournamentBlocks(),k=L(w);try{for(k.s();!(n=k.n()).done;){var C=n.value;this.inactiveNodeContainer.addChild(C.node)}}catch(n){k.e(n)}finally{k.f()}this.setCreateTournamentButtonActive(!1)}},{key:"getActiveTournamentBlocks",value:function(){var n=this;return this.tournamentBlockArray.filter(function(w){return w.node.parent===n.layout.node})}},{key:"setCreateTournamentButtonActive",value:function(n){n?this.layout.node.addChild(this.createTournamentButton):this.layout.node.removeChild(this.createTournamentButton),this.createTournamentButton.active=n}},{key:"showTournamentBlocks",value:(I=M(function(n,w){var k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:k=this.getActiveTournamentBlocks();if(k.length<1)return[3,2];C=Math.ceil(n/this.tournamentBlockContentHeight),_=Math.min(k.length,C);return[4,Promise.all(k.map(function(){var n=M(function(n,k){return _ts_generator(this,function(C){switch(C.label){case 0:if(!(k<_))return[3,2];return[4,n.runShowPopUpAnimation(.1*k,.3,w)];case 1:C.sent();return[3,3];case 2:n.uiOpacity.opacity=255;C.label=3;case 3:return[2]}})});return function(w,k){return n.apply(this,arguments)}}()))];case 1:A.sent();A.label=2;case 2:return[2]}})}),function(n,w){return I.apply(this,arguments)})},{key:"updateVisibility",value:function(){var n,w=this.viewport.getBoundingBoxToWorld(),k=w.yMax,C=w.yMin,_=this.getActiveTournamentBlocks(),A=L(_);try{for(A.s();!(n=A.n()).done;){var T=n.value,I=T.uiTransform;if(void 0!==I){var O=I.getBoundingBoxToWorld(),D=O.yMax,M=O.yMin,N=D<C||M>k;T.uiOpacity.opacity=N?0:255}}}catch(n){A.e(n)}finally{A.f()}}}]),c}(eO)).prototype,"tournamentBlockPrefab",[zz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zq=n(zH.prototype,"inactiveNodeContainer",[zB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zW=n(zH.prototype,"layout",[zF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zK=n(zH.prototype,"createTournamentButton",[zx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zj=n(zH.prototype,"viewport",[zU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zG=zH))||zG);ew._RF.pop(),ew._RF.push({},"f8a7b0St3FAkb1PvvvJTLCh","TournamentsNotAvailable",void 0);var z6,z8,z9,z7,Be,Bt,Bn,Bi,Ba,Br,Bo,Bs,Bl,Bu,Bc,Bh=eS.ccclass,Bp=eS.property,Bd=(zJ=Bh("TournamentsNotAvailable"),zQ=Bp(ek),zJ((z1=n((z0=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"createButton",z1,A(n)),n}return T(u,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"show",value:(I=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:this.createButton.active=!0,this.uiOpacity.opacity=255;n=this.node.position.clone(),w=ez(this.node);w.to(.05,{position:n.clone().add3f(5,0,0)}),w.to(.05,{position:n.clone().add3f(-5,0,0)});k=ez(this.node).repeat(2,w);k.to(.05,{position:n});return[4,N.runTweenAsync(k)];case 1:C.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"hide",value:function(){this.createButton.active=!1,this.uiOpacity.opacity=0}}]),u}(eO)).prototype,"createButton",[zQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z$=z0))||z$);ew._RF.pop(),ew._RF.push({},"199fcQ5IEZFbJCfSrGNrGDQ","TournamentContent",void 0);var By,Bf,Bv,Bg,Bm,Bb,Bw,BS,Bk=eS.ccclass,BC=eS.property,BE=globalThis.game,B_=BE.storage,BA=BE.match,BT=GameCore.Utils,BP=BT.Object,BR=BT.Array,BI=(z6=Bk("TournamentContent"),z8=BC({type:aE}),z9=BC(z5),z7=BC(Bd),Be=BC(tb),Bt=BC({type:[zZ]}),Bn=BC(i_),z6((Br=n((Ba=function(n){w(y,n);var I,L,O,D,N=k(y);function y(){var n;C(this,y);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=N.call.apply(N,[this].concat(k)),_(n,"panelAnimator",Br,A(n)),_(n,"tournamentsBoard",Bo,A(n)),_(n,"tournamentsNotAvailable",Bs,A(n)),_(n,"scrollView",Bl,A(n)),_(n,"skeletons",Bu,A(n)),_(n,"contentOpacity",Bc,A(n)),n.animAbortSignal=null,n.softAbortSignal=null,n.hideContent=function(){n.contentOpacity.changeStateFade(!1,.1)},n.showContent=function(){n.contentOpacity.changeStateFade(!0,.1)},n}return T(y,[{key:"onLoad",value:function(){this.uiTransform=this.node.getComponent(e_),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.scrollView.node.on(tb.EventType.SCROLLING,this.onScrolling,this),this.node.scene.on(sT.RELOAD_TOURNAMENT,this.reload,this),this.node.scene.on(i9.HIDE_UI,this.hideContent),this.node.scene.on(i9.SHOW_UI,this.showContent)}},{key:"unlistenEvents",value:function(){this.scrollView.node.off(tb.EventType.SCROLLING,this.onScrolling,this),this.node.scene.off(sT.RELOAD_TOURNAMENT,this.reload,this),this.unlistenUIEvents()}},{key:"unlistenUIEvents",value:function(){this.node.scene.off(i9.HIDE_UI,this.hideContent),this.node.scene.off(i9.SHOW_UI,this.showContent)}},{key:"onScrolling",value:function(){this.tournamentsBoard.updateVisibility()}},{key:"enableUIAnimator",value:function(){this.panelAnimator.enabled=!0}},{key:"disableUIAnimator",value:function(){this.panelAnimator.enabled=!1}},{key:"enter",value:(D=M(function(){var n,w,k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:this.listenEvents();w=null===this.animAbortSignal&&null===this.softAbortSignal;if(!w)return[3,2];this.animAbortSignal=new F,this.softAbortSignal=new F;return[4,this.showLoading(this.animAbortSignal)];case 1:w=(T.sent(),!this.isAborted());T.label=2;case 2:if(!w)return[3,10];return[4,et.requestTournamentDataAsync()];case 3:k=T.sent();C=this.isAborted();if(C)return[3,9];return[4,this.hideLoading(this.animAbortSignal)];case 4:T.sent();_=this.isAborted();if(_)return[3,8];if(!(0!==k.length||null!==(n=this.softAbortSignal)&&void 0!==n&&n.aborted))return[3,6];this.tryShowTournamentResult(),this.scrollView.enabled=!0,this.tournamentsBoard.updateData(k);return[4,this.tournamentsBoard.showTournamentBlocks(this.uiTransform.contentSize.height-this.tournamentsBoard.layout.paddingTop,this.animAbortSignal)];case 5:A=(T.sent(),this.tournamentsBoard.updateVisibility());return[3,7];case 6:A=this.tournamentsNotAvailable.show();T.label=7;case 7:_=A;T.label=8;case 8:C=_;T.label=9;case 9:T.label=10;case 10:return[2]}})}),function(){return D.apply(this,arguments)})},{key:"showLoading",value:(O=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:this.scrollView.scrollToTop(0),this.scrollView.enabled=!1;return[4,Promise.all([this.skeletons.map(function(w){return w.show(0,n)})])];case 1:w.sent();return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"hideLoading",value:(L=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,Promise.all([this.skeletons.map(function(w){return w.hide(n)})])];case 1:w.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"tryShowTournamentResult",value:function(){try{if(!B_.getStorage("tournament").animateTournamentLeader)return;var n=et.getAllTournamentData(),w=BA.getMatchState().customData.tournamentId;if(!w)throw new Error("Tournament ID not found");var k=BR.search(n,function(n){return n.id===w});if(!k)throw new Error("Tournament not found");var C=JSON.stringify(k);en.showTournamentDetailScreen(C,"tournament_end")}catch(n){B_.setStorageData("tournament","animateTournamentLeader",!1),console.warn("showTournamentResult",n)}}},{key:"processCreateTournament",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:w.trys.push([0,2,,3]);return[4,sQ.processCreateTournamentAsync()];case 1:w.sent();return[3,3];case 2:n=w.sent();if(!BP.hasOwn(n,"code"))return[2,void en.showNotificationScreenWithLocalizedKey("error.createTourFail",2)];if("USER_INPUT"===n.code)return[2];if("PLAYER_HAS_TOURNAMENT"===n.code)return[2,void en.showNotificationScreenWithLocalizedKey("error.tourExists",2)];"INVALID_OPERATION"===n.code&&BP.hasOwn(n,"message")&&"string"==typeof n.message&&en.showNotificationScreen(n.message,2),en.showNotificationScreenWithLocalizedKey("error.createTourFail",2);return[3,3];case 3:this.reload();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"isAborted",value:function(){var n,w;return null===(n=null===(w=this.animAbortSignal)||void 0===w?void 0:w.aborted)||void 0===n||n}},{key:"cleanup",value:function(){var n;this.unlistenEvents(),null===(n=this.animAbortSignal)||void 0===n||n.abort(),this.animAbortSignal=null,this.tournamentsBoard.removeTournamentBlocks(),this.tournamentsNotAvailable.hide()}},{key:"softAbort",value:function(){var n;null===(n=this.softAbortSignal)||void 0===n||n.abort(),this.softAbortSignal=null}},{key:"reload",value:function(){this.softAbort(),this.cleanup(),this.enter()}}]),y}(eO)).prototype,"panelAnimator",[z8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=n(Ba.prototype,"tournamentsBoard",[z9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bs=n(Ba.prototype,"tournamentsNotAvailable",[z7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bl=n(Ba.prototype,"scrollView",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bu=n(Ba.prototype,"skeletons",[Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Bc=n(Ba.prototype,"contentOpacity",[Bn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=Ba))||Bi);ew._RF.pop(),ew._RF.push({},"bce5eh0LHVP2bCJ6u+kFjuA","TournamentPage",void 0);var BL,BO,BD,BM,BN;By=(0,eS.ccclass)("TournamentPage"),Bf=z.required(),Bv=z.onlyRunInLifeCycleAsync,Bg=z.onlyRunInLifeCycle,Bm=z.onlyRunInLifeCycleAsync,Bb=z.onlyRunInLifeCycleAsync,By((BS=n((Bw=function(n){w(v,n);var I,L,z,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"panelAnimationController",BS,A(n)),n}return T(v,[{key:"onLoad",value:function(){this.panelAnimationController=this.getComponent(am),O(D(v.prototype),"onLoad",this).call(this)}},{key:"start",value:(B=M(function(){return _ts_generator(this,function(n){O(D(v.prototype),"start",this).call(this);return[2]})}),function(){return B.apply(this,arguments)})},{key:"mount",value:(z=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,O(D(v.prototype),"mount",this).call(this)];case 1:n.sent(),this.onMount();return[2]}})}),function(){return z.apply(this,arguments)})},{key:"onMount",value:function(){if(this.containerUIOpacity.opacity=0,this.content=this.container.getComponentInChildren(BI),!this.content)throw new Error("LeaderboardPage: Leaders not found")}},{key:"transitionIn",value:(L=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:return[4,O(D(v.prototype),"transitionIn",this).call(this)];case 1:k.sent();n=N.runTweenAsync(ez(this.containerUIOpacity).to(.2,{opacity:255})),w=this.panelAnimationController.showUI();return[4,Promise.all([n,w])];case 2:k.sent(),this.content.enter();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"transitionOut",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:null===(n=this.content)||void 0===n||n.softAbort(),this.content.unlistenUIEvents();return[4,O(D(v.prototype),"transitionOut",this).call(this)];case 1:w.sent();return[4,this.panelAnimationController.hideUI()];case 2:w.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"unmount",value:function(){var n;null===(n=this.content)||void 0===n||n.cleanup(),O(D(v.prototype),"unmount",this).call(this)}}]),v}(A2)).prototype,"panelAnimationController",[Bf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Bw.prototype,"mount",[Bv],Object.getOwnPropertyDescriptor(Bw.prototype,"mount"),Bw.prototype),n(Bw.prototype,"onMount",[Bg],Object.getOwnPropertyDescriptor(Bw.prototype,"onMount"),Bw.prototype),n(Bw.prototype,"transitionIn",[Bm],Object.getOwnPropertyDescriptor(Bw.prototype,"transitionIn"),Bw.prototype),n(Bw.prototype,"transitionOut",[Bb],Object.getOwnPropertyDescriptor(Bw.prototype,"transitionOut"),Bw.prototype),Bw));ew._RF.pop(),ew._RF.push({},"b8271vI+3pO9q8SKMYpqLKv","EventBadge",void 0);var Bz,BB,BF,Bx,BU,BG,BH,BV,Bq=eS.ccclass,BW=eS.property;BL=Bq("EventBadge"),BO=BW(eT),BD=BW(e3),BL((BN=n((BM=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"label",BN,A(n)),n}return T(s,[{key:"text",get:function(){return this.label.string},set:function(n){this.label.string=n}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.label)throw new Error("EventBadge: Missing required component Label")}}]),s}(eO)).prototype,"label",[BO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(BM.prototype,"text",[BD],Object.getOwnPropertyDescriptor(BM.prototype,"text"),BM.prototype),BM));ew._RF.pop(),ew._RF.push({},"7712cs4XLJAgpKqlO3gPqkF","EventProgressBar",void 0);var BK,Bj,BY,BX,BZ,BJ,BQ,B$,B0,B1,B2,B4,B3,B5,B6,B8,B9,B7,Fe,Ft,Fn,Fi,Fa,Fr,Fo,Fs,Fl,Fu,Fc,Fh,Fp,Fd,Fy,Ff,Fv,Fg,Fm,Fb,Fw,FS,Fk,FC,FE,F_,FA,FT,FP,FR=eS.ccclass,FI=eS.property;Bz=FR("EventProgressBar"),BB=FI(rw),BF=FI(eT),Bx=FI(e3),BU=FI({range:[0,1,.01],slide:!0,tooltip:"i18n:progress.progress"}),Bz((BH=n((BG=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"progressBar",BH,A(n)),_(n,"progressLabel",BV,A(n)),n}return T(s,[{key:"text",get:function(){return this.progressLabel.string},set:function(n){this.progressLabel.string=n}},{key:"progress",get:function(){return this.progressBar.progress},set:function(n){this.progressBar.progress=n}},{key:"__preload",value:function(){}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){if(!this.progressBar)throw new Error("EventProgressBar: Missing required component TapperedProgressBar");if(!this.progressLabel)throw new Error("EventProgressBar: Missing required component Label")}}]),s}(eO)).prototype,"progressBar",[BB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BV=n(BG.prototype,"progressLabel",[BF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(BG.prototype,"text",[Bx],Object.getOwnPropertyDescriptor(BG.prototype,"text"),BG.prototype),n(BG.prototype,"progress",[BU],Object.getOwnPropertyDescriptor(BG.prototype,"progress"),BG.prototype),BG));ew._RF.pop(),ew._RF.push({},"7741dWPNcdHRqGVvif/L/MP","NavButton",void 0);var FL,FO,FD,FM,FN,Fz=eS.ccclass,FB=eS.property,FF=eS.executeInEditMode,Fx=globalThis.game.analytics,FU=GameCore.Plugins.Analytics.Events;BK=Fz("NavButton"),Bj=FB(eW),BY=FB({group:{name:"Animation"},displayName:"Is Selected",tooltip:"This is for the editor only and will be ignored at runtime",editorOnly:!0}),BX=FB({type:eM,group:{name:"Animation"}}),BZ=FB({type:eM,group:{name:"Animation"}}),BJ=FB({type:eM,group:{name:"Animation"}}),BQ=FB({type:eM,group:{name:"Animation"}}),B$=FB({type:eM,group:{name:"Animation"}}),B0=FB({group:{name:"Animation"}}),B1=FB({type:eM,group:{name:"Animation"}}),B2=FB({type:eM,group:{name:"Animation"}}),B4=FB({group:{name:"Animation"}}),B3=FB({type:eM,group:{name:"Animation"}}),B5=FB({type:eM,group:{name:"Animation"}}),B6=FB({type:eM,group:{name:"Animation"}}),B8=FB({type:eM,group:{name:"Animation"}}),B9=FB({type:eM,group:{name:"Animation"}}),B7=FB({type:e_}),Fe=FB(ek),Ft=FB(eH),Fn=FB({type:e_}),Fi=FB({type:eU(nk)}),Fa=FB(On),BK(Fr=FF((Fs=n((Fo=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"wip",Fs,A(n)),_(n,"isSelectedInEditor",Fl,A(n)),_(n,"animationDuration",Fu,A(n)),_(n,"selectedSpacing",Fc,A(n)),_(n,"deselectedSpacing",Fh,A(n)),_(n,"selectedIconY",Fp,A(n)),_(n,"selectedIconX",Fd,A(n)),_(n,"selectedIconScale",Fy,A(n)),_(n,"deselectedIconY",Ff,A(n)),_(n,"deselectedIconX",Fv,A(n)),_(n,"deselectedIconScale",Fg,A(n)),_(n,"initTextY",Fm,A(n)),_(n,"selectedTextY",Fb,A(n)),_(n,"selectedTextX",Fw,A(n)),_(n,"deselectedTextY",FS,A(n)),_(n,"deselectedTextX",Fk,A(n)),_(n,"spacer",FC,A(n)),_(n,"icon",FE,A(n)),_(n,"text",F_,A(n)),_(n,"uiTransform",FA,A(n)),_(n,"screenType",FT,A(n)),_(n,"navManager",FP,A(n)),n.isSelected=!1,n.onMouseEnter=function(w){n.isSelected||n.playHoverOnAnimation()},n.onMouseLeave=function(w){n.isSelected||n.playHoverOffAnimation()},n}return T(c,[{key:"isWIP",get:function(){return this.wip}},{key:"buttonType",get:function(){return this.screenType}},{key:"update",value:function(){}},{key:"onEnable",value:function(){this.node.on(ek.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.on(ek.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onDisable",value:function(){this.node.off(ek.EventType.MOUSE_ENTER,this.onMouseEnter),this.node.off(ek.EventType.MOUSE_LEAVE,this.onMouseLeave)}},{key:"onEditorUpdate",value:function(){null!==this.icon&&void 0!==this.icon&&null!==this.text&&void 0!==this.icon&&null!==this.spacer&&void 0!==this.spacer&&(this.isSelectedInEditor?(this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255):(this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.initTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0))}},{key:"setSelected",value:function(){var n,w;this.isSelected||(G.playSound(nL.PATCH_SHIFT),this.navManager.selectUsingSceneTransition(this),Fx.event(FU.BUTTON_CLICK,{button_name:null!==(n=null===(w=this.node.parent)||void 0===w?void 0:w.name)&&void 0!==n?n:this.node.name,screen_name:H.getCurrentPage()}))}},{key:"select",value:(L=M(function(){var n;var w=arguments;return _ts_generator(this,function(k){switch(k.label){case 0:n=!(w.length>0&&void 0!==w[0])||w[0];if(this.isSelected)throw new Error("NavButton: Already selected");this.isSelected=!0;if(!n)return[3,2];return[4,N.runTweenAsync(this.playSelectAnimation())];case 1:k.sent();return[3,3];case 2:this.icon.setScale(this.selectedIconScale),this.icon.setPosition(this.selectedIconX,this.selectedIconY,0),this.text.node.setPosition(this.selectedTextX,this.selectedTextY,0),this.spacer.width=this.selectedSpacing,this.text.opacity=255;k.label=3;case 3:return[2]}})}),function(){return L.apply(this,arguments)})},{key:"deselect",value:(I=M(function(){var n,w;var k=arguments;return _ts_generator(this,function(C){switch(C.label){case 0:n=!(k.length>0&&void 0!==k[0])||k[0],w=k.length>1&&void 0!==k[1]&&k[1];if(!this.isSelected&&!w)throw new Error("NavButton: Already deselected");this.isSelected=!1;if(!n)return[3,2];return[4,N.runTweenAsync(this.deselectAnimation())];case 1:C.sent();return[3,3];case 2:this.icon.setScale(this.deselectedIconScale),this.icon.setPosition(this.deselectedIconX,this.deselectedIconY,0),this.text.node.setPosition(this.deselectedTextX,this.deselectedTextY,0),this.spacer.width=this.deselectedSpacing,this.text.opacity=0;C.label=3;case 3:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"getSelectedWorldDistanceX",value:function(){var n=new eQ(this.selectedIconX,this.selectedIconY,0),w=new eQ(this.deselectedIconX,this.deselectedIconY,0),k=this.node.scale.clone();this.node.scale=this.selectedIconScale;var C=this.uiTransform.convertToWorldSpaceAR(n),_=this.uiTransform.convertToWorldSpaceAR(w);return this.node.scale=k,_.x-C.x}},{key:"playHoverOnAnimation",value:function(){var n=ez(this.icon);return n.to(.1,{scale:this.deselectedIconScale.clone().add3f(.1,.1,0)},{easing:"cubicIn"}),N.runTweenAsync(n)}},{key:"playHoverOffAnimation",value:function(){var n=ez(this.icon);return n.to(.1,{scale:this.deselectedIconScale},{easing:"cubicOut"}),N.runTweenAsync(n)}},{key:"playSelectAnimation",value:function(){var n=this;return ez(this.spacer).to(this.animationDuration,{width:this.selectedSpacing},{easing:"linear",onUpdate:function(w,k){if(void 0!==k){var C=eG.quintInOut(k),_=eG.backOut(k),A=eG.linear(k),T=k<.5?2*k:1,I=n.deselectedIconY+(n.selectedIconY-n.deselectedIconY)*_,L=n.deselectedIconX+(n.selectedIconX-n.deselectedIconX)*A;n.icon.setPosition(L,I,0);var O=n.deselectedIconScale.clone().lerp(n.selectedIconScale,C);n.icon.setScale(O.x,O.y,n.icon.scale.z);var D=255*T,M=n.deselectedTextY+(n.selectedTextY-n.deselectedTextY)*A,N=n.deselectedTextX+(n.selectedTextX-n.deselectedTextX)*A;n.text.opacity=D,n.text.node.setPosition(N,M,0)}}})}},{key:"deselectAnimation",value:function(){var n=this;return ez(this.spacer).to(this.animationDuration,{width:this.deselectedSpacing},{easing:"linear",onUpdate:function(w,k){if(void 0!==k){var C=ts(n.selectedIconY,n.deselectedIconY,k),_=ts(n.selectedIconX,n.deselectedIconX,k);n.icon.setPosition(_,C,0);var A=ts(255,0,k<.5?2*k:1);n.text.opacity=A;var T=ts(n.selectedTextY,n.deselectedTextY,k),I=ts(n.selectedTextX,n.deselectedTextX,k);n.text.node.setPosition(I,T,0);var L=n.selectedIconScale.clone().lerp(n.deselectedIconScale,eG.quintInOut(k));n.icon.setScale(L.x,L.y,n.icon.scale.z)}}})}},{key:"onLoad",value:function(){this.uiTransform=this.getComponent(e_),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}}]),c}(eO)).prototype,"wip",[Bj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fl=n(Fo.prototype,"isSelectedInEditor",[BY],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fu=n(Fo.prototype,"animationDuration",[BX],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .3}}),Fc=n(Fo.prototype,"selectedSpacing",[BZ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 150}}),Fh=n(Fo.prototype,"deselectedSpacing",[BJ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 88}}),Fp=n(Fo.prototype,"selectedIconY",[BQ],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),Fd=n(Fo.prototype,"selectedIconX",[B$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fy=n(Fo.prototype,"selectedIconScale",[B0],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new eQ(1,1,1)}}),Ff=n(Fo.prototype,"deselectedIconY",[B1],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fv=n(Fo.prototype,"deselectedIconX",[B2],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fg=n(Fo.prototype,"deselectedIconScale",[B4],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new eQ(.8,.8,1)}}),Fm=n(Fo.prototype,"initTextY",[B3],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return -100}}),Fb=n(Fo.prototype,"selectedTextY",[B5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return -10}}),Fw=n(Fo.prototype,"selectedTextX",[B6],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),FS=n(Fo.prototype,"deselectedTextY",[B8],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fk=n(Fo.prototype,"deselectedTextX",[B9],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),FC=n(Fo.prototype,"spacer",[B7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FE=n(Fo.prototype,"icon",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F_=n(Fo.prototype,"text",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FA=n(Fo.prototype,"uiTransform",[Fn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FT=n(Fo.prototype,"screenType",[Fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FP=n(Fo.prototype,"navManager",[Fa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fr=Fo))||Fr);ew._RF.pop(),ew._RF.push({},"091aai5+ANDeZfFN8JFkbyi","TournamentButton",void 0);var FG,FH,FV,Fq,FW,FK=eS.ccclass,Fj=eS.property,FY=globalThis.game.leaderboard;FL=FK("TournamentButton"),FO=Fj(ek),FD=z.onlyRunInLifeCycleAsync,FL((FN=n((FM=function(n){w(d,n);var I,O,D=k(d);function d(){var n;C(this,d);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"hotIcon",FN,A(n)),n}return T(d,[{key:"onLoad",value:(O=M(function(){var n,w,k,C,_,A,T,I,O,D;return _ts_generator(this,function(M){switch(M.label){case 0:M.trys.push([0,11,,12]);return[4,et.requestTournamentDataAsync()];case 1:w=M.sent(),k=L(w);M.label=2;case 2:M.trys.push([2,8,9,10]);k.s();M.label=3;case 3:if(!!(n=k.n()).done)return[3,7];C=n.value.payload,_=C.leaderboardId,A=C.playerId;if(!(_&&"global"===A))return[3,6];T=FY.getLeaderboardName(_);I=T;if(!I)return[3,5];return[4,FY.requestLeaderboardAsync(T,0)];case 4:I=(M.sent(),this.checkAndShowHotIcon(T));M.label=5;case 5:if(I)return[3,7];M.label=6;case 6:return[3,3];case 7:return[3,10];case 8:O=M.sent();k.e(O);return[3,10];case 9:k.f();return[7];case 10:return[3,12];case 11:D=M.sent();console.info("Error in TournamentButton",D);return[3,12];case 12:return[2]}})}),function(){return O.apply(this,arguments)})},{key:"checkAndShowHotIcon",value:function(n){if(!this.node.activeInHierarchy)return!1;var w=FY.getLeaderboard(n);return!!w&&!(w.amountPlayer<30)&&(this.showHotIcon(),!0)}},{key:"showHotIcon",value:(I=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:this.hotIcon.active=!0,this.hotIcon.scale=eQ.ZERO;n=ez(this.hotIcon).to(.5,{scale:eQ.ONE},{easing:"backOut"});return[4,N.runTweenAsync(n)];case 1:k.sent();w=ez(this.hotIcon).delay(1).to(.3,{scale:new eQ(1.1,1.1)},{easing:"backIn"}).to(.3,{scale:eQ.ONE},{easing:"backOut"});ez(this.hotIcon).repeatForever(w).start();return[2]}})}),function(){return I.apply(this,arguments)})}]),d}(eO)).prototype,"hotIcon",[FO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(FM.prototype,"showHotIcon",[FD],Object.getOwnPropertyDescriptor(FM.prototype,"showHotIcon"),FM.prototype),FM));ew._RF.pop(),ew._RF.push({},"9b83boaSv9PE6mRFqy0MSI8","GameScene",void 0);var FX,FZ,FJ,FQ,F$,F0,F1=eS.ccclass,F2=eS.property,F4=eS.disallowMultiple,F3=globalThis.game.player,F5=q.Layout,F6=GameCore.Match.Modes,F8=[nL.COMBO_1,nL.COMBO_2,nL.COMBO_3,nL.COMBO_4,nL.COMBO_5,nL.COMBO_6,nL.COMBO_7,nL.COMBO_8,nL.COMBO_9,nL.COMBO_10,nL.COMBO_11,nL.COMBO_12,nL.COMBO_13,nL.TILE_MATCH,nL.BOMB_DEFUSE,nL.BOMB_EXPLODE_1,nL.BOMB_EXPLODE_2,nL.TILE_SELECT,nL.THUNDERBOLT,nL.SHUFFLE_ITEM,nL.LEVEL_START,nL.LEVEL_COMPLETE,nL.LEVEL_FAIL];FG=F1("GameScene"),FH=F2(EL),FG(FV=F4((FW=n((Fq=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"coinManager",FW,A(n)),n.handleGameExit=function(){es.switchScene(eu.DASHBOARD_SCENE)},n.handleShowResults=function(){es.switchScene(eu.CHALLENGE_RESULT_SCENE)},n.handleGameMaskWhenLayoutChanged=function(n){var w=tr("Canvas/Game/GameObjects");if(w){var k=w.getComponent(tS);k&&(k.enabled=n===F5.Landscape)}},n}return T(u,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenGameEvents()}},{key:"onLoad",value:function(){this.coinManager.init()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenGameEvents",value:function(){eY.on(V.ORIENTATION_CHANGED,this.handleGameMaskWhenLayoutChanged),this.node.scene.on(i9.GAME_EXIT,this.handleGameExit),this.node.scene.on(i9.SHOW_CHALLENGE_RESULTS,this.handleShowResults)}},{key:"start",value:function(){F3.getPlayerSetting("music")&&this.updateMusic(),this.preloadSounds(),this.scheduleOnce(this.preloadScenes,3)}},{key:"preloadSounds",value:function(){for(var n=0,w=F8;n<w.length;n++){var k=w[n];B.loadAudioClipAsync(k)}}},{key:"preloadScenes",value:function(){es.preloadDashboardScene()}},{key:"updateMusic",value:(I=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=sQ.getMatchMode()===F6.TOURNAMENT,w=n?nL.TOURNAMENT_MUSIC:nL.BG_MUSIC;k=G.getCurrentMusic()!==w;if(!k)return[3,3];return[4,G.setVolumeMusic(0,!0)];case 1:C.sent();return[4,N.waitTweenAsync(1)];case 2:k=C.sent();C.label=3;case 3:G.playMusic(w,n),G.setVolumeMusic(n?.4:.3,!0);return[2]}})}),function(){return I.apply(this,arguments)})}]),u}(eO)).prototype,"coinManager",[FH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FV=Fq))||FV);ew._RF.pop(),ew._RF.push({},"0c0b4cnFOFJ6pJmGNHnMo7m","ComboEffect",void 0);var F9,F7,xe,xt,xn,xi,xa=eS.ccclass,xr=eS.property;FX=xa("ComboEffect"),FZ=xr(eH),FJ=xr(e$),FX((F$=n((FQ=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"circleOpacity",F$,A(n)),_(n,"particle",F0,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(i9.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(n){n>1&&(this.circleOpacity.node.scale=eQ.ZERO,this.circleOpacity.opacity=60,this.particle.resetSystem(),ez(this.circleOpacity.node).to(.2,{scale:new eQ(1.3,1.3,1.3)},{easing:"quadOut"}).start(),ez(this.circleOpacity).delay(.3).to(.2,{opacity:0},{easing:"expoIn"}).start())}}]),s}(eO)).prototype,"circleOpacity",[FZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F0=n(FQ.prototype,"particle",[FJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FQ));ew._RF.pop(),ew._RF.push({},"0506aJZ1EdPqJejQ2PpB980","ComboLabel",void 0);var xo,xs,xl,xc,xh,xp,xd,xy,xf=eS.ccclass,xv=eS.property;F9=xf("ComboLabel"),F7=xv(eT),xe=xv(ek),F9((xn=n((xt=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"comboNumber",xn,A(n)),_(n,"comboContainer",xi,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.opacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"start",value:function(){this.node.scene.on(i9.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(n){0===n?this.opacity.opacity=0:n>1?(this.opacity.opacity=255,this.comboNumber.string="".concat(n),ez(this.comboContainer).to(.1,{scale:new eQ(1.3,1.3,1.3)},{easing:"sineIn"}).to(.1,{scale:eQ.ONE},{easing:"sineOut"}).start()):this.opacity.opacity=0}}]),s}(eO)).prototype,"comboNumber",[F7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xi=n(xt.prototype,"comboContainer",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt));ew._RF.pop(),ew._RF.push({},"51871oF8CFOkp81rgCf90UQ","ComboPopup",void 0);var xg,xm,xb,xw,xS,xk,xC,xE,x_,xA,xT,xP,xR,xI=eS.ccclass,xL=eS.property,xO=q.Layout,xD=["good","great","excellent"];xo=xI("ComboPopup"),xs=z.required(),xl=xL(K),xc=z.required(),xh=xL(e7),xo((xd=n((xp=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"spriteLocalizer",xd,A(n)),_(n,"animation",xy,A(n)),n}return T(s,[{key:"__preload",value:function(){this.widget=this.getComponent(eN),z.validateRequiredProperties(this)}},{key:"onLoad",value:function(){eY.on(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this),this.handleOrientationChanged(s5.getCurrentLayout())}},{key:"onDestroy",value:function(){eY.off(V.ORIENTATION_CHANGED,this.handleOrientationChanged,this)}},{key:"start",value:function(){this.node.scene.on(i9.COMBO_UPDATED,this.handleOnComboUpdated,this)}},{key:"handleOnComboUpdated",value:function(n){if(!(n<2))for(var w=xD.length-1;w>=0;w--){var k=xD[w];if(n>=w+2){this.spriteLocalizer.key=k,this.animation.play();break}}}},{key:"handleOrientationChanged",value:function(n){n===xO.Portrait?this.widget.left=20:n===xO.Landscape&&(this.widget.left=800)}}]),s}(eO)).prototype,"spriteLocalizer",[xs,xl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xy=n(xp.prototype,"animation",[xc,xh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xp));ew._RF.pop(),ew._RF.push({},"a0819yK3HpO2505QqLUOChz","PlayerScore",void 0);var xM,xN,xz,xB,xF,xx,xU,xG,xH,xV,xq,xW,xK,xj,xY,xX,xZ,xJ,xQ,x$,x0,x1,x2,x4=eS.ccclass,x3=eS.property,x5=(xg=x4("PlayerScore"),xm=x3(ek),xb=x3(eT),xw=x3(eH),xS=x3(eH),xk=x3(ex),xg((x_=n((xE=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"crown",x_,A(n)),_(n,"playerScore",xA,A(n)),_(n,"playerScoreUiOpacity",xT,A(n)),_(n,"waitingUiOpacity",xP,A(n)),_(n,"avatar",xR,A(n)),n}return T(u,[{key:"showCrown",value:function(n){this.crown.active=n}},{key:"setPlayerScore",value:function(n){this.playerScore.string=n.toString()}},{key:"playWaitingAnimation",value:function(){this.waitingUiOpacity.node.active=!0,this.playerScoreUiOpacity.node.active=!1,this.waitingUiOpacity.opacity=130,this.playerScoreUiOpacity.opacity=0;var n=ez(this.waitingUiOpacity).to(1,{opacity:130},{easing:"sineInOut"}).to(1,{opacity:255},{easing:"sineInOut"}).delay(.25);this.waitingAnimation=ez(this.waitingUiOpacity).repeatForever(n).start()}},{key:"stopWaitingAnimation",value:function(){this.waitingAnimation&&this.waitingAnimation.stop(),this.waitingUiOpacity.opacity=0,this.playerScoreUiOpacity.opacity=255,this.waitingUiOpacity.node.active=!1,this.playerScoreUiOpacity.node.active=!0}},{key:"loadPhoto",value:(I=M(function(n,w){var k,C;return _ts_generator(this,function(_){switch(_.label){case 0:_.trys.push([0,2,,3]);return[4,bU.getPlayerAvatar(n,w,128)];case 1:k=_.sent();if(!k)throw new Error("Failed to create sprite frame");k.packable=!0,this.avatar.spriteFrame=k;return[3,3];case 2:C=_.sent();return[2,void console.error(C)];case 3:return[2]}})}),function(n,w){return I.apply(this,arguments)})}]),u}(eO)).prototype,"crown",[xm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xA=n(xE.prototype,"playerScore",[xb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xT=n(xE.prototype,"playerScoreUiOpacity",[xw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xP=n(xE.prototype,"waitingUiOpacity",[xS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xR=n(xE.prototype,"avatar",[xk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xC=xE))||xC);ew._RF.pop(),ew._RF.push({},"4b062RYQK5PQbgs7yH66gDw","ChallengeResultScene",void 0);var x6,x8,x9,x7,Ue,Ut=eS.ccclass,Un=eS.disallowMultiple,Ui=eS.property,Ua=globalThis.game,Ur=Ua.match,Uo=Ua.player,Us=Ua.monitorError,Ul=GameCore.Utils.Object;xM=Ut("ChallengeResultScene"),xN=Ui(K),xz=Ui(K),xB=Ui(K),xF=Ui({type:x5,group:"Score"}),xx=Ui({type:x5,group:"Score"}),xU=Ui(yg),xG=Ui(g0),xH=Ui(e7),xV=z.onlyRunInLifeCycle,xq=z.onlyRunInLifeCycle,xW=z.onlyRunInLifeCycle,xK=z.onlyRunInLifeCycle,xM(xj=Un((xX=n((xY=function(n){w(c,n);var I,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"drawLocalizer",xX,A(n)),_(n,"winLocalizer",xZ,A(n)),_(n,"loseLocalizer",xJ,A(n)),_(n,"playerScore",xQ,A(n)),_(n,"opponentScore",x$,A(n)),_(n,"paperConfetti",x0,A(n)),_(n,"levelManager",x1,A(n)),_(n,"headerAnimation",x2,A(n)),n.goToDashboardScene=function(){es.switchScene(eu.DASHBOARD_SCENE)},n}return T(c,[{key:"__preload",value:function(){this.validateRequiredComponents(),this.listenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenEvents",value:function(){this.node.scene.on(V.RESULT_SCENE_HOME,this.goToDashboardScene),this.node.scene.on(V.RESULT_SCENE_REPLAY,this.handleTryAgainClicked,this)}},{key:"start",value:function(){this.scheduleOnce(this.preloadScenes,3);try{var n,w,k=Ur.getMatchState(),C=k.customData,_=C.playerId,A=C.opponentId;if(null===_||null===A)throw new Error("ResultScene: playerId is ".concat(_," and opponentId is ").concat(A,". Expected to not be null."));var T=Uo.getPlayer().photo,I=null!==(n=k.profiles[_])&&void 0!==n?n:{},L=I.score,O=void 0===L?0:L,D=I.finished,M=void 0!==D&&D,N=null!==(w=k.profiles[A])&&void 0!==w?w:{},z=N.photo,B=void 0===z?"":z,F=N.score,x=void 0===F?0:F,U=N.finished,G=void 0!==U&&U,H=M&&G,V=H&&O>x,q=H&&x>O;this.playerScore.loadPhoto(T,_),this.opponentScore.loadPhoto(B,A),this.playerScore.setPlayerScore(O),this.opponentScore.setPlayerScore(x),this.playerScore.showCrown(V),this.opponentScore.showCrown(q),M&&G?O===x?this.playStatusAnimation("Draw"):V?this.playStatusAnimation("Win"):q&&this.playStatusAnimation("Lose"):(M||this.playerScore.playWaitingAnimation(),G||this.opponentScore.playWaitingAnimation(),this.playWinAnimation())}catch(n){console.warn("ResultScene: Error on load",n),this.goToDashboardScene()}}},{key:"preloadScenes",value:function(){es.preloadDashboardScene()}},{key:"handleTryAgainClicked",value:(I=M(function(){var n,w,k,C,_,A,T,I,L,O,D,M,N,z;return _ts_generator(this,function(B){switch(B.label){case 0:w=(null!==(n=Uo.getGameData())&&void 0!==n?n:{}).level,k=void 0===w?1:w;k=Math.max(1,k);return[4,this.levelManager.loadLevelData(k)];case 1:C=B.sent();B.label=2;case 2:B.trys.push([2,4,,5]);if(!C)throw new Error("Level data is not found");_=Ur.getMatchState().customData.opponentId;if(!_)throw new Error("Opponent id is not found");en.showLoadingScreen();A=uh.generateFen(C),T=C.mode,I=void 0===T?"":T,L=C.rules,O=void 0===L?{addRandomTilesPerMove:0,maxSpaceOfPair:0}:L,D=C.time,M=void 0===D?0:D,N=C.level;return[4,Ur.challenge.friend.processAsync({playerId:Uo.getPlayerId(),opponentId:_,extraData:{level:N,fen:A,gravity:I,rules:O,time:M}})];case 3:B.sent(),en.closeLoadingScreen(),this.goToGameScene();return[3,5];case 4:z=B.sent();if(Ul.hasOwn(z,"code")&&"USER_INPUT"===z.code)return[2,void en.closeLoadingScreen()];console.warn("ReplayChallengeFriend",z),en.closeLoadingScreen(),en.showNotificationScreenWithLocalizedKey("error.challengeFail",2),null==Us||Us.sendException(_instanceof(z,Error)?z:new Error("ReplayChallengeFriend"+JSON.stringify(z))),this.scheduleOnce(this.goToDashboardScene,2);return[3,5];case 5:return[2]}})}),function(){return I.apply(this,arguments)})},{key:"handleHomeClicked",value:function(){this.goToDashboardScene()}},{key:"goToGameScene",value:function(){es.switchScene(eu.GAME_SCENE)}},{key:"playWaitingAnimation",value:function(){this.triggerConfettiAnimation(),G.playSound(nL.LEVEL_COMPLETE)}},{key:"playStatusAnimation",value:function(n){var w=this;"Win"===n&&this.triggerConfettiAnimation();var k=this.getSpriteLocalizer(n);k.node.active=!0,k.waitLocalized().then(function(){switch(n){case"Draw":w.playDrawAnimation();break;case"Win":w.playWinAnimation();break;case"Lose":w.playLoseAnimation()}})}},{key:"getSpriteLocalizer",value:function(n){switch(n){case"Draw":return this.drawLocalizer;case"Win":return this.winLocalizer;case"Lose":return this.loseLocalizer}}},{key:"playDrawAnimation",value:function(){this.headerAnimation.play("RibbonDraw"),G.playSound(nL.LEVEL_FAIL)}},{key:"playWinAnimation",value:function(){this.headerAnimation.play("RibbonWin"),G.playSound(nL.LEVEL_COMPLETE)}},{key:"playLoseAnimation",value:function(){this.headerAnimation.play("RibbonLose"),G.playSound(nL.LEVEL_FAIL)}},{key:"triggerConfettiAnimation",value:function(){var n=this;this.scheduleOnce(function(){var w,k=L(n.paperConfetti);try{for(k.s();!(w=k.n()).done;)w.value.play()}catch(n){k.e(n)}finally{k.f()}},.2)}}]),c}(eO)).prototype,"drawLocalizer",[xN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xZ=n(xY.prototype,"winLocalizer",[xz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xJ=n(xY.prototype,"loseLocalizer",[xB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xQ=n(xY.prototype,"playerScore",[xF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x$=n(xY.prototype,"opponentScore",[xx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x0=n(xY.prototype,"paperConfetti",[xU],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),x1=n(xY.prototype,"levelManager",[xG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x2=n(xY.prototype,"headerAnimation",[xH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(xY.prototype,"playDrawAnimation",[xV],Object.getOwnPropertyDescriptor(xY.prototype,"playDrawAnimation"),xY.prototype),n(xY.prototype,"playWinAnimation",[xq],Object.getOwnPropertyDescriptor(xY.prototype,"playWinAnimation"),xY.prototype),n(xY.prototype,"playLoseAnimation",[xW],Object.getOwnPropertyDescriptor(xY.prototype,"playLoseAnimation"),xY.prototype),n(xY.prototype,"triggerConfettiAnimation",[xK],Object.getOwnPropertyDescriptor(xY.prototype,"triggerConfettiAnimation"),xY.prototype),xj=xY))||xj);ew._RF.pop(),ew._RF.push({},"c0a5fPghzxBxpXiudxt+Qd4","TestParticleSystemScene",void 0);var Uc,Uh=eS.ccclass,Up=eS.property;x6=Uh("TestParticleSystemScene"),x8=Up(ek),x9=z.required(),x6((Ue=n((x7=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"stars",Ue,A(n)),n}return T(s,[{key:"__preload",value:function(){es.markIsTestScene(eu.TEST_PARTICLE_SYSTEM_SCENE)}},{key:"onLoad",value:function(){GameSDK.startGameAsync().catch(function(n){console.warn("GameSDK.startGameAsync",n)})}},{key:"start",value:function(){var n=this.stars.getComponent(yg);null==n||n.play()}}]),s}(eO)).prototype,"stars",[x8,x9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x7));ew._RF.pop(),ew._RF.push({},"f3521L4Mn5I3bhxr0QZJ9y9","BackgroundMask",void 0);var Ud,Uy,Uf,Uv,Ug,Um,Ub,Uw,US,Uk,UC,UE,U_,UA,UT=eS.ccclass,UP=eS.requireComponent;UT("BackgroundMask")(Uc=UP([eH])(Uc=function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"onLoad",value:function(){var n=this.getComponent(eH);n?(this.opacity=n,this.updateMaskAlpha()):console.warn("BackgroundMask: UIOpacity not found")}},{key:"updateMaskAlpha",value:function(){var n,w,k=this.opacity.opacity/255;n=k,(w=document.getElementById("app-mask"))&&(w.style.background="rgb(0 0 0 / ".concat(n,")"))}}]),o}(eO))||Uc);ew._RF.pop(),ew._RF.push({},"cecf2nUBzhIWZw7uJgVliXz","CongratulationScreen",void 0);var UR,UI,UL,UO,UD,UM,UN,Uz,UB,UF,Ux,UU,UG,UH,UV,Uq,UW,UK,Uj,UY,UX,UZ,UJ,UQ=eS.ccclass,U$=eS.property,U0=eS.disallowMultiple,U1=eS.requireComponent,U2=GameCore.Events,U4=globalThis.game.event;Ud=UQ("CongratulationScreen"),Uy=U1(ey),Uf=U$(ek),Uv=U$(ek),Ug=U$(eI),Um=U$(eI),Ub=U$(eI),Ud(Uw=U0(Uw=Uy((Uk=n((US=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"congratulation",Uk,A(n)),_(n,"confirmation",UC,A(n)),_(n,"closeButtonComponent",UE,A(n)),_(n,"yesButtonComponent",U_,A(n)),_(n,"noButtonComponent",UA,A(n)),n.handleOpeningScreen=function(w){if(!n.screen)throw new Error("CongratulationScreen: screen not found");n.validateEventPayload(w)&&(n.closeButtonComponent.interactable=!0,n.yesButtonComponent.interactable=!0,n.noButtonComponent.interactable=!0)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(s,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.confirmationUIOpacity=this.confirmation.getComponent(eH),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){U4.on(U2.OPENING_SCREEN,this.handleOpeningScreen),U4.on(U2.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){U4.off(U2.OPENING_SCREEN,this.handleOpeningScreen),U4.off(U2.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return n.screenName===this.node.name}},{key:"open",value:function(){this.confirmation.active=!1,this.congratulation.active=!0}},{key:"close",value:function(){this.closeButtonComponent.interactable=!1,this.yesButtonComponent.interactable=!1,this.noButtonComponent.interactable=!1,en.closeScreen(ei.CONGRATULATION_SCREEN)}},{key:"handleStartOver",value:function(){this.confirmation.active=!0,this.congratulation.active=!1,ez(this.confirmationUIOpacity).set({opacity:0}).to(.2,{opacity:255}).start(),ez(this.confirmation).set({scale:new eQ(.8,.8,.8)}).to(.2,{scale:new eQ(1,1,1)},{easing:"backOut"}).start()}},{key:"handleYesStartOver",value:function(){this.close(),this.node.scene.emit(i9.START_OVER,1)}},{key:"handleNoStartOver",value:function(){this.requestGameReplay()}},{key:"handleClickedClose",value:function(){this.requestGameReplay()}},{key:"requestGameReplay",value:function(){this.close(),this.node.scene.emit(i9.GAME_REPLAY,{level:this.screen.data.level})}}]),s}(eO)).prototype,"congratulation",[Uf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UC=n(US.prototype,"confirmation",[Uv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UE=n(US.prototype,"closeButtonComponent",[Ug],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U_=n(US.prototype,"yesButtonComponent",[Um],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UA=n(US.prototype,"noButtonComponent",[Ub],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uw=US))||Uw)||Uw);ew._RF.pop(),ew._RF.push({},"01c067hcjNDc7prJzSE6UEq","DayBlock",void 0);var U3,U5,U6,U8,U9,U7,Ge,Gt,Gn,Gi,Ga,Gr,Go,Gs,Gl,Gc,Gh,Gp,Gd,Gy,Gf,Gv=eS.ccclass,Gg=eS.property,Gm=(UR=Gv("DayBlock"),UI=Gg({type:ex,group:"Background"}),UL=Gg({type:ex,group:"Background"}),UO=Gg({type:e9,group:"Background"}),UD=Gg({type:e9,group:"Background"}),UM=Gg(eT),UN=Gg(K),Uz=Gg(eT),UB=Gg(ek),UF=Gg(ek),Ux=Gg(ek),UR((UH=n((UG=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"background",UH,A(n)),_(n,"topBackground",UV,A(n)),_(n,"blueBackground",Uq,A(n)),_(n,"blueTopBackground",UW,A(n)),_(n,"dayLabel",UK,A(n)),_(n,"dayLocalizer",Uj,A(n)),_(n,"coinLabel",UY,A(n)),_(n,"rewardItemsNode",UX,A(n)),_(n,"checkNode",UZ,A(n)),_(n,"glowNodes",UJ,A(n)),n}return T(s,[{key:"onLoad",value:function(){this.uiOpacity=this.getComponent(eH),this.initDefaultProperties(),this.validateRequiredComponents()}},{key:"initDefaultProperties",value:function(){this.defaultBackground=this.background.spriteFrame,this.defaultTopBackground=this.topBackground.spriteFrame,this.defaultDayLabelOutlineColor=new eC(this.dayLabel.outlineColor),this.blueDayLabelOutlineColor=new eC("#3469bf")}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"updateInfo",value:function(n){this.updateBackground(n),this.updateDayLabel(n),this.coinLabel.string=n.value.toString(),this.updateRewardItems(n)}},{key:"updateBackground",value:function(n){if(this.blueTopBackground&&this.blueBackground)switch(n.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"rewarded":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(n){this.dayLocalizer.setParams([n.day.toString()]);var w=this.defaultDayLabelOutlineColor;"rewarded"!==n.status&&(w=this.blueDayLabelOutlineColor),this.dayLabel.outlineColor=w,this.dayLabel.shadowColor=w}},{key:"updateRewardItems",value:function(n){switch(n.status){case"ready":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!0);break;case"waiting":this.rewardItemsNode.active=!0,this.checkNode.active=!1,this.setGlowNodesActive(!1);break;case"rewarded":this.rewardItemsNode.active=!1,this.checkNode.active=!0,this.setGlowNodesActive(!1)}}},{key:"setGlowNodesActive",value:function(n){this.glowNodes&&this.glowNodes.forEach(function(w){w.active=n})}}]),s}(eO)).prototype,"background",[UI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UV=n(UG.prototype,"topBackground",[UL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uq=n(UG.prototype,"blueBackground",[UO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UW=n(UG.prototype,"blueTopBackground",[UD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UK=n(UG.prototype,"dayLabel",[UM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uj=n(UG.prototype,"dayLocalizer",[UN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UY=n(UG.prototype,"coinLabel",[Uz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UX=n(UG.prototype,"rewardItemsNode",[UB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UZ=n(UG.prototype,"checkNode",[UF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UJ=n(UG.prototype,"glowNodes",[Ux],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),UU=UG))||UU);ew._RF.pop(),ew._RF.push({},"cc662r8eR5Al6FdOBdcAkHG","DailyRewardsScreen",void 0);var Gb=eS.ccclass,Gw=eS.property,GS=eS.requireComponent,Gk=GameCore,GC=Gk.Events,GE=Gk.Utils,G_=GE.Object,GA=GE.Array,GT=Gk.Configs.DailyRewards,GP=globalThis.game,GR=GP.event,GI=GP.dailyRewards,GL=GP.player,GO=GP.monitorError;U3=Gb("DailyRewardsScreen"),U5=GS(ey),U6=z.required(),U8=z.required(),U9=Gw(ek),U7=z.required(),Ge=Gw(eI),Gt=z.required(),Gn=Gw(eI),Gi=Gw([Gm]),Ga=z.onlyRunInLifeCycleAsync,Gr=z.onlyRunInLifeCycle,Go=z.onlyRunInLifeCycleAsync,Gs=z.onlyRunInLifeCycle,U3(Gl=U5((Gh=n((Gc=function(n){w(b,n);var O,D,B,x,U,G=k(b);function b(){var n;C(this,b);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=G.call.apply(G,[this].concat(k)),_(n,"screen",Gh,A(n)),n.rewardsData=[],n.debugScreenOpened=!1,n.debugUpdatedRewardsData=!1,_(n,"loadingRing",Gp,A(n)),_(n,"claimButton",Gd,A(n)),_(n,"claimX2Button",Gy,A(n)),_(n,"dailyBlocks",Gf,A(n)),n.handleOpeningScreen=function(w){n.validateEventPayload(w)&&(n.enabled=!0)},n.handleOpenedScreen=function(){var w=M(function(w){return _ts_generator(this,function(k){n.validateEventPayload(w)&&n.open();return[2]})});return function(n){return w.apply(this,arguments)}}(),n}return T(b,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),z.validateRequiredProperties(this),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"listenScreenEvents",value:function(){GR.on(GC.OPENING_SCREEN,this.handleOpeningScreen),GR.on(GC.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){GR.off(GC.OPENING_SCREEN,this.handleOpeningScreen),GR.off(GC.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name}},{key:"open",value:function(){this.prepareScreen(),this.openAsync()}},{key:"openAsync",value:(U=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.updateRewardsData()];case 1:n.sent();return[4,this.updateScreenToMatchData()];case 2:n.sent();return[2]}})}),function(){return U.apply(this,arguments)})},{key:"updateScreenToMatchData",value:function(){return this.loginDailyRewards(),this.updateDayBlocks(),this.loadingRing.active=!1,this.setInteractableButtons(!0),this.runPopUpAnimation()}},{key:"prepareScreen",value:function(){this.debugScreenOpened=!0,this.loadingRing.active=!0,this.setInteractableButtons(!1),this.node.scene.emit(i9.HIDE_UI),this.resetState()}},{key:"close",value:function(){GR.emit(GC.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(i9.SHOW_UI)}},{key:"resetState",value:function(){var n,w=L(this.dailyBlocks);try{for(w.s();!(n=w.n()).done;){var k=n.value;k.uiOpacity.opacity=0,k.node.scale=new eQ(1.2,1.2,1.2)}}catch(n){w.e(n)}finally{w.f()}}},{key:"runPopUpAnimation",value:(x=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=this;this.screen.container||console.warn("DailyRewardScreen: screen not found");return[4,Promise.all(this.dailyBlocks.map(function(w,k){return n.runAppearTween(w,.15*k)}))];case 1:w.sent();return[2]}})}),function(){return x.apply(this,arguments)})},{key:"runAppearTween",value:(B=M(function(n,w){var k,C;return _ts_generator(this,function(_){switch(_.label){case 0:k=ez(n.uiOpacity).delay(w).to(.3,{opacity:255},{easing:"quadOut"}),C=ez(n.node).delay(w).to(.3,{scale:eQ.ONE},{easing:"backOut"});return[4,Promise.all([N.runTweenAsync(k),N.runTweenAsync(C)])];case 1:_.sent();return[2]}})}),function(n,w){return B.apply(this,arguments)})},{key:"handleOnClaim",value:function(){this.setInteractableButtons(!1);var n=this.getCurrentRewardData();if(!n)return null==GO||GO.sendException(new Error("DailyRewardsScreen: rewardData not found"),{nodeIsActive:this.node.activeInHierarchy,nodeHasParent:null!==this.node.parent&&void 0!==this.node.parent,hasLoadedRewardsData:this.debugUpdatedRewardsData,hasOpenedScreen:this.debugScreenOpened}),en.showNotificationScreenWithLocalizedKey("error.rewardFail",2),void this.setInteractableButtons(!0);this.claimReward(n)}},{key:"handleOnClaimX2",value:(D=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:this.setInteractableButtons(!1);n=this.getCurrentRewardData();if(!n)return[2,(null==GO||GO.sendException(new Error("DailyRewardsScreen: rewardData not found"),{nodeIsActive:this.node.activeInHierarchy,nodeHasParent:null!==this.node.parent&&void 0!==this.node.parent,hasLoadedRewardsData:this.debugUpdatedRewardsData,hasOpenedScreen:this.debugScreenOpened}),en.showNotificationScreenWithLocalizedKey("error.rewardFail",2),void this.setInteractableButtons(!0))];return[4,ea.showRewardVideoAdAsync({})];case 1:w.sent()?this.claimReward(n,!0):this.setInteractableButtons(!0);return[2]}})}),function(){return D.apply(this,arguments)})},{key:"getCurrentRewardData",value:function(){return GA.search(this.rewardsData,function(n){return"ready"===n.status})}},{key:"claimReward",value:function(n,w){var k=arguments.length>1&&void 0!==w&&w,C=n.value*(k?2:1),_=new F;if(this.node.scene.emit(i9.ADD_COINS,{coins:C,collectionAnimation:{animateTextOnly:!1,signal:_}}),n.items){var A=n.items.hint*(k?2:1),T=n.items.thunder*(k?2:1),I=n.items.storm*(k?2:1),L=GL.getGameData();L?(GL.setGameData({items:{hint:L.items.hint+A,thunder:L.items.thunder+T,storm:L.items.storm+I,pliers:L.items.pliers}}),this.close()):this.close()}else this.close()}},{key:"updateRewardsData",value:(O=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:return[4,GI.requestDailyRewardsAsync()];case 1:k.sent();for(n=I({},GI.getDailyRewards()),w=0;w<GT.MaxDays;w++)n[w]=I(I({},n[w]),{},{value:sE[w].value,items:sE[w].items});n&&(this.rewardsData=G_.vals(n),this.debugUpdatedRewardsData=!0,console.log("DailyRewardsScreen: rewardsData",this.rewardsData));return[2]}})}),function(){return O.apply(this,arguments)})},{key:"loginDailyRewards",value:function(){GI.logLoginReward()}},{key:"updateDayBlocks",value:function(){var n=this;this.dailyBlocks.length>this.rewardsData.length&&(console.warn("DailyRewardsScreen: dailyBlocks not enough"),null==GO||GO.sendException(new Error("DailyRewardsScreen: dailyBlocks not enough"),{dailyBlocksCount:this.dailyBlocks.length,rewardsDataCount:this.rewardsData.length,nodeIsActive:this.node.activeInHierarchy,nodeHasParent:null!==this.node.parent&&void 0!==this.node.parent,hasLoadedRewardsData:this.debugUpdatedRewardsData,hasOpenedScreen:this.debugScreenOpened})),this.dailyBlocks.forEach(function(w,k){if(!(k>=n.rewardsData.length)){var C=n.rewardsData[k],_=C.id,A=C.type,T=C.value,I=C.status;w.updateInfo({day:_,type:A,value:T,status:I})}})}},{key:"setInteractableButtons",value:function(n){this.claimButton.interactable=n,this.claimX2Button.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}}]),b}(eO)).prototype,"screen",[U6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gp=n(Gc.prototype,"loadingRing",[U8,U9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gd=n(Gc.prototype,"claimButton",[U7,Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gy=n(Gc.prototype,"claimX2Button",[Gt,Gn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gf=n(Gc.prototype,"dailyBlocks",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),n(Gc.prototype,"updateScreenToMatchData",[Ga],Object.getOwnPropertyDescriptor(Gc.prototype,"updateScreenToMatchData"),Gc.prototype),n(Gc.prototype,"claimReward",[Gr],Object.getOwnPropertyDescriptor(Gc.prototype,"claimReward"),Gc.prototype),n(Gc.prototype,"updateRewardsData",[Go],Object.getOwnPropertyDescriptor(Gc.prototype,"updateRewardsData"),Gc.prototype),n(Gc.prototype,"setInteractableButtons",[Gs],Object.getOwnPropertyDescriptor(Gc.prototype,"setInteractableButtons"),Gc.prototype),Gl=Gc))||Gl);ew._RF.pop(),ew._RF.push({},"5a6aeaMAdtMGYA8B1wIuhDa","DayBlockRed",void 0);var GD,GM,GN,Gz,GB,GF,Gx,GU,GG,GH;(0,eS.ccclass)("DayBlockRed")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o,[{key:"updateBackground",value:function(n){if(this.blueTopBackground&&this.blueBackground)switch(n.status){case"ready":this.background.spriteFrame=this.blueBackground,this.topBackground.spriteFrame=this.blueTopBackground;break;case"waiting":this.background.spriteFrame=this.defaultBackground,this.topBackground.spriteFrame=this.defaultTopBackground}}},{key:"updateDayLabel",value:function(n){this.dayLocalizer.setParams([n.day.toString()]);var w=this.defaultDayLabelOutlineColor;"ready"===n.status&&(w=this.blueDayLabelOutlineColor),this.dayLabel.shadowColor=w,this.dayLabel.outlineColor=w}}]),o}(Gm));ew._RF.pop(),ew._RF.push({},"6fed95tFh5MRKzFqaFB2Ts8","GetCoinScreen",void 0);var GV,Gq,GW,GK,Gj,GY,GX,GZ,GJ,GQ,G$,G0,G1,G2,G4,G3,G5,G6,G8,G9,G7,He,Ht,Hn,Hi,Ha,Hr,Ho,Hs,Hl,Hh=eS.ccclass,Hp=eS.property,Hd=eS.requireComponent,Hy=globalThis.game.event,Hf=GameCore.Events;GD=Hh("GetCoinScreen"),GM=Hd(ey),GN=Hp(eT),Gz=Hp(eI),GB=Hp(eI),GD(GF=GM((GU=n((Gx=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"quantityLabel",GU,A(n)),_(n,"closeButtonComponent",GG,A(n)),_(n,"getNowButtonComponent",GH,A(n)),n.handleOpeningScreen=function(w){console.log("GetCoinScreen.OPENING_SCREEN",w),n.validateEventPayload(w)&&(n.setInteractableButtons(!0),n.updateStatus())},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(u,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Hy.on(Hf.OPENING_SCREEN,this.handleOpeningScreen),Hy.on(Hf.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Hy.off(Hf.OPENING_SCREEN,this.handleOpeningScreen),Hy.off(Hf.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return"screenName"in n&&n.screenName===this.node.name&&(this.payload=n,!0)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(i9.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),Hy.emit(Hf.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(i9.SHOW_UI)}},{key:"updateStatus",value:function(){this.updateCoinQuantity()}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("GetCoinScreen: screen not found")}},{key:"updateCoinQuantity",value:function(){var n=this.getQuantity();n&&this.updateQuantityLabel(n)}},{key:"updateQuantityLabel",value:function(n){this.quantityLabel.string="x".concat(n.toString())}},{key:"getQuantity",value:function(){var n=this.payload.screenData;return n&&"quantity"in n&&n.quantity&&"number"==typeof n.quantity?n.quantity:0}},{key:"handleAddCoin",value:function(){var n=this.getQuantity();this.node.scene.emit(i9.ADD_COINS,{coins:n,collectionAnimation:{animateTextOnly:!1},skipAnimation:!0}),this.close()}},{key:"handleGetNowButtonClicked",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:G.stopAllSounds();return[4,ea.showRewardVideoAdAsync({})];case 1:n.sent()&&this.handleAddCoin();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"setInteractableButtons",value:function(n){this.closeButtonComponent.interactable=n,this.getNowButtonComponent.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}}]),u}(eO)).prototype,"quantityLabel",[GN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GG=n(Gx.prototype,"closeButtonComponent",[Gz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GH=n(Gx.prototype,"getNowButtonComponent",[GB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GF=Gx))||GF);ew._RF.pop(),ew._RF.push({},"f016fTAlsNKRYkdu72AyCLI","GetItemScreen",void 0);var Hv,Hg,Hm,Hb,Hw,HS,Hk,HC,HE=eS.ccclass,H_=eS.property,HA=globalThis.game,HT=HA.event,HP=HA.player,HR=HA.analytics,HI=HA.language,HL=GameCore,HO=HL.Events,HD=HL.Utils.Array,HM=HL.Plugins.Analytics.Events,HN=Object.values(X);GV=HE("GetItemScreen"),Gq=H_({type:ta,group:"Item"}),GW=H_({type:ex,group:"Item"}),GK=H_({type:e9,group:"Item"}),Gj=H_({type:e9,group:"Item"}),GY=H_({type:e9,group:"Item"}),GX=H_({type:e9,group:"Item"}),GZ=H_({type:eT,group:"Title"}),GJ=H_({type:K,group:"Title"}),GQ=H_({type:eT,group:"Description"}),G$=H_({type:K,group:"Description"}),G0=H_(eT),G1=H_({type:eI,group:"Buttons"}),G2=H_({type:eI,group:"Buttons"}),G4=H_({type:eI,group:"Buttons"}),GV((G5=n((G3=function(n){w(p,n);var I,L,O,D=k(p);function p(){var n;C(this,p);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=D.call.apply(D,[this].concat(k)),_(n,"itemFxPrefab",G5,A(n)),_(n,"itemSprite",G6,A(n)),_(n,"hintSpriteFrame",G8,A(n)),_(n,"stormSpriteFrame",G9,A(n)),_(n,"thunderSpriteFrame",G7,A(n)),_(n,"pliersSpriteFrame",He,A(n)),_(n,"titleLabel",Ht,A(n)),_(n,"titleLocalizer",Hn,A(n)),_(n,"descriptionLabel",Hi,A(n)),_(n,"descriptionLocalizer",Ha,A(n)),_(n,"coinLabel",Hr,A(n)),_(n,"closeButtonComponent",Ho,A(n)),_(n,"buyItemButtonComponent",Hs,A(n)),_(n,"getNowButtonComponent",Hl,A(n)),n.handleOpeningScreen=function(w){if(!n.screen)throw new Error("GetItemScreen: screen not found");n.validateEventPayload(w)&&n.validateEventPayloadData(w.screenData)&&(n.setInteractableButtons(!0),n.data=w.screenData,n.updateStatus(w.screenData))},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(p,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){HT.on(HO.OPENING_SCREEN,this.handleOpeningScreen),HT.on(HO.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){HT.off(HO.OPENING_SCREEN,this.handleOpeningScreen),HT.off(HO.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name}},{key:"validateEventPayloadData",value:function(n){return!!n&&!(!("item"in n)||!HD.has(HN,n.item))&&"quantity"in n&&"number"==typeof n.quantity&&!("localizedMessageKey"in n&&void 0!==n.localizedMessageKey&&!HI.hasTextKey(n.localizedMessageKey))}},{key:"open",value:function(){this.node.scene.emit(i9.GAME_PAUSE)}},{key:"close",value:function(){this.setInteractableButtons(!1),HT.emit(HO.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(i9.GAME_RESUME)}},{key:"updateStatus",value:function(n){this.updateItemIcon(n.item),this.updateTitle(n.item),n.localizedMessageKey&&this.updateDescription(n.localizedMessageKey),this.updateButtons(n.item)}},{key:"updateItemIcon",value:function(n){switch(n){case X.HINT:this.itemSprite.spriteFrame=this.hintSpriteFrame;break;case X.STORM:this.itemSprite.spriteFrame=this.stormSpriteFrame;break;case X.THUNDER:this.itemSprite.spriteFrame=this.thunderSpriteFrame;break;case X.PLIERS:this.itemSprite.spriteFrame=this.pliersSpriteFrame}}},{key:"getItemLocalizedTitleKey",value:function(n){switch(n){case X.HINT:return"item.hint";case X.STORM:return"item.storm";case X.THUNDER:return"item.thunder";case X.PLIERS:return"item.pliers"}}},{key:"updateTitle",value:function(n){this.titleLocalizer.key=this.getItemLocalizedTitleKey(n)}},{key:"updateDescription",value:function(n){this.descriptionLocalizer.key=n}},{key:"updateButtons",value:function(n){var w=this.canBuyItem(n);this.buyItemButtonComponent.node.active=w,this.getNowButtonComponent.node.active=!w,w&&(this.coinLabel.string="".concat(3*sS[n]))}},{key:"canBuyItem",value:function(n){var w=HP.getGameData();return!!w&&w.coins>=3*sS[n]}},{key:"handleAddItem",value:(O=M(function(){return _ts_generator(this,function(n){this.data.item&&(HR.event(HM.EARN_ITEM,{item_name:this.data.item,value:3}),this.node.scene.emit(i9.ADD_ITEM,{animate:{startWorldPosition:this.itemSprite.node.worldPosition.clone()},item:this.data.item,quantity:3}));return[2]})}),function(){return O.apply(this,arguments)})},{key:"handleGetNowButtonClicked",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:this.stopAllSounds();return[4,ea.showRewardVideoAdAsync({})];case 1:n.sent()&&(this.handleAddItem(),this.close());return[2]}})}),function(){return L.apply(this,arguments)})},{key:"handleBuyItemButtonClicked",value:(I=M(function(){return _ts_generator(this,function(n){this.node.scene.emit(i9.REMOVE_COINS,{coins:3*sS[this.data.item],collectionAnimation:{animateTextOnly:!0}}),this.handleAddItem(),this.close();return[2]})}),function(){return I.apply(this,arguments)})},{key:"stopAllSounds",value:function(){var n;null===(n=tr("Sound"))||void 0===n||null===(n=n.getComponent(ef))||void 0===n||n.stopAll()}},{key:"setInteractableButtons",value:function(n){this.closeButtonComponent.interactable=n,this.buyItemButtonComponent.interactable=n,this.getNowButtonComponent.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}}]),p}(eO)).prototype,"itemFxPrefab",[Gq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G6=n(G3.prototype,"itemSprite",[GW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G8=n(G3.prototype,"hintSpriteFrame",[GK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G9=n(G3.prototype,"stormSpriteFrame",[Gj],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G7=n(G3.prototype,"thunderSpriteFrame",[GY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=n(G3.prototype,"pliersSpriteFrame",[GX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=n(G3.prototype,"titleLabel",[GZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=n(G3.prototype,"titleLocalizer",[GJ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi=n(G3.prototype,"descriptionLabel",[GQ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ha=n(G3.prototype,"descriptionLocalizer",[G$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hr=n(G3.prototype,"coinLabel",[G0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=n(G3.prototype,"closeButtonComponent",[G1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hs=n(G3.prototype,"buyItemButtonComponent",[G2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hl=n(G3.prototype,"getNowButtonComponent",[G4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G3));ew._RF.pop(),ew._RF.push({},"4d6710xA7hAk65cGA4Dgdrc","GetRewardsScreen",void 0);var Hz,HB=eS.ccclass,HF=eS.requireComponent,Hx=eS.property,HU=GameCore.Events,HG=globalThis.game.event;Hv=HB("GetRewardsScreen"),Hg=HF(ey),Hm=Hx(K),Hb=Hx(eI),Hv(Hw=Hg((Hk=n((HS=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"adStartingLocalizer",Hk,A(n)),_(n,"skipButton",HC,A(n)),n.handleOpeningScreen=function(w){n.validateEventPayload(w)&&n.setInteractableButtons(!0)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(u,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){HG.on(HU.OPENING_SCREEN,this.handleOpeningScreen),HG.on(HU.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){HG.off(HU.OPENING_SCREEN,this.handleOpeningScreen),HG.off(HU.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.runAdStartingAnimation()}},{key:"close",value:function(n){this.setInteractableButtons(!1),HG.emit(HU.CLOSE_SCREEN,{screenName:this.node.name,screenData:{getRewardsSuccess:n}})}},{key:"runAdStartingAnimation",value:function(){var n=this,w=5;this.adStartingLocalizer.setParams([w.toString()]);this.schedule(function(){w<=0?n.stopAdStartingAnimation():(w--,n.adStartingLocalizer.setParams([w.toString()]))},1,6)}},{key:"stopAdStartingAnimation",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:this.unscheduleAllCallbacks();return[4,ea.showRewardedInterstitialAdAsync({})];case 1:n=w.sent();this.close(n);return[2]}})}),function(){return I.apply(this,arguments)})},{key:"handleClickedSkip",value:function(){this.unscheduleAllCallbacks(),this.close(!1)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(n){this.skipButton.interactable=n}}]),u}(eO)).prototype,"adStartingLocalizer",[Hm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HC=n(HS.prototype,"skipButton",[Hb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw=HS))||Hw);ew._RF.pop(),ew._RF.push({},"bfe1eXch0ZMKIz1ofLKc2Iv","HardLevelScreen",void 0);var HH,HV,Hq,HW,HK,Hj,HY,HX,HZ,HJ,HQ,H$,H0,H1=eS.ccclass,H2=eS.requireComponent,H4=GameCore.Events,H3=globalThis.game.event;H1("HardLevelScreen")(Hz=H2(ey)(Hz=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).handleOpeningScreen=function(w){n.validateEventPayload(w)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(o,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){H3.on(H4.OPENING_SCREEN,this.handleOpeningScreen),H3.on(H4.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){H3.off(H4.OPENING_SCREEN,this.handleOpeningScreen),H3.off(H4.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation()}},{key:"close",value:function(){en.closeScreen(ev[this.node.name])}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}}]),o}(eO))||Hz);ew._RF.pop(),ew._RF.push({},"2db0dg4dI9GCKCdFOMrBFsQ","GetRewardsEffect",void 0);var H5,H6,H8,H9,H7,Ve,Vt,Vn,Vi,Va,Vr,Vo,Vs,Vl,Vh,Vp,Vd,Vy,Vf,Vv,Vg,Vm,Vb,Vw,VS,Vk,VC,VE,V_,VA,VT,VP,VR,VI,VL,VO=eS.ccclass,VD=eS.property,VM=(HH=VO("GetRewardsEffect"),HV=VD(e9),Hq=VD(e9),HW=VD(e9),HK=VD(e9),Hj=VD(yg),HH((HZ=n((HX=function(n){w(c,n);var I,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"hint",HZ,A(n)),_(n,"thunder",HJ,A(n)),_(n,"storm",HQ,A(n)),_(n,"pliers",H$,A(n)),_(n,"particles",H0,A(n)),n}return T(c,[{key:"__preload",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"playAnimation",value:(I=M(function(n,w){var k,C;return _ts_generator(this,function(_){switch(_.label){case 0:k=this,C=-30*(n.length-1)/2+90;return[4,Promise.all(n.map(function(n,_){var A=k.createSprite(n),T=C+30*_,I=.15*_;A.node.position=new eQ(300*Math.cos(Math.PI/180*T),300*Math.sin(Math.PI/180*T),0);var L=ez(A.node);return L.delay(I),L.to(.6,{position:eQ.ZERO,scale:new eQ(.7,.7,.7)},{easing:"backIn"}),N.runTweenAsync(L).then(function(){w(),G.playSound(nL.COLLECT_STARS),k.playExplodeEffect(),A.node.destroy()})}))];case 1:_.sent();return[2]}})}),function(n,w){return I.apply(this,arguments)})},{key:"playExplodeEffect",value:function(){var n,w=L(this.particles);try{for(w.s();!(n=w.n()).done;){var k=n.value;k.stop(),k.play()}}catch(n){w.e(n)}finally{w.f()}}},{key:"createSprite",value:function(n){var w=this.getSpriteFrame(n),k=(new ek).addComponent(ex);return k.spriteFrame=w,k.node.parent=this.node,k.node.scale=new eQ(1.5,1.5,1.5),k}},{key:"getSpriteFrame",value:function(n){switch(n){case"hint":return this.hint;case"thunder":return this.thunder;case"storm":return this.storm;case"pliers":return this.pliers;default:return null}}}]),c}(eO)).prototype,"hint",[HV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HJ=n(HX.prototype,"thunder",[Hq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HQ=n(HX.prototype,"storm",[HW],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H$=n(HX.prototype,"pliers",[HK],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H0=n(HX.prototype,"particles",[Hj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),HY=HX))||HY);ew._RF.pop(),ew._RF.push({},"31829DUddVEq6NgIYHvnI68","LevelCompleteScreen",void 0);var VN,Vz=eS.ccclass,VB=eS.property,VF=eS.requireComponent,Vx=GameCore,VU=Vx.Events,VG=Vx.Utils.Valid,VH=globalThis.game,VV=VH.event,Vq=VH.player,VW="Coin Container";H5=Vz("LevelCompleteScreen"),H6=VF(ey),H8=VB(eT),H9=VB(eT),H7=VB(eH),Ve=VB(VM),Vt=VB({type:eI,group:"Play Button"}),Vn=VB({type:ek,group:"Play Button"}),Vi=VB({type:eH,group:"Play Button"}),Va=VB({type:ek,group:"Play Button"}),Vr=VB({type:ek,group:"Play Button"}),Vo=VB({type:e7,group:VW}),Vs=VB({type:_U,group:VW}),Vl=VB({type:e7,group:VW}),Vh=VB({type:tm,group:VW}),Vp=VB({type:tm,group:VW}),Vd=VB(yg),Vy=z.onlyRunInLifeCycleAsync,H5(Vf=H6((Vg=n((Vv=function(n){w(S,n);var I,O,D,B,x,U,G,H,V=k(S);function S(){var n;C(this,S);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return(n=V.call.apply(V,[this].concat(k))).level=1,n.coins=40,n.currentCoins=0,n.score=0,n.playAnimation=!1,n.getRewardsSuccess=!1,n.lookingForRewards=!1,n.playButtonSignal=new F,_(n,"coinText",Vg,A(n)),_(n,"scoreText",Vm,A(n)),_(n,"lookingForRewardsText",Vb,A(n)),_(n,"getRewardsEffect",Vw,A(n)),_(n,"playButton",VS,A(n)),_(n,"playBackground",Vk,A(n)),_(n,"shineBackground",VC,A(n)),_(n,"hardLevelBackground",VE,A(n)),_(n,"playButtonContainer",V_,A(n)),_(n,"coinAnimation",VA,A(n)),_(n,"coinContainer",VT,A(n)),_(n,"coinContainerAnimation",VP,A(n)),_(n,"coinContainerEnterClip",VR,A(n)),_(n,"coinContainerExitClip",VI,A(n)),_(n,"particles",VL,A(n)),n.handleOpeningScreen=function(w){if(!n.screen)throw new Error("StarChestScreen: screen not found");n.validateEventPayload(w)&&(n.playButton.interactable=!0)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n.handleParticleEnd=M(function(){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=n.level;if(!w)return[3,2];return[4,N.waitTweenAsync(.15)];case 1:w=k.sent();k.label=2;case 2:return[4,Promise.all([n.animateCoin(),n.animateScore()])];case 3:k.sent();if(!n.lookingForRewards)return[3,5];return[4,n.handleLookingForRewards()];case 4:k.sent();return[3,7];case 5:return[4,n.animateVisiblePlayButton(!0)];case 6:k.sent();k.label=7;case 7:return[2]}})}),n}return T(S,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){VV.on(VU.OPENING_SCREEN,this.handleOpeningScreen),VV.on(VU.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){VV.off(VU.OPENING_SCREEN,this.handleOpeningScreen),VV.off(VU.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){var w=null!=n?n:{},k=w.screenName,C=w.screenData;return k===this.node.name&&!!VG.isObject(C)&&(VG.isNumber(C.level)&&(this.level=C.level,this.coins=this.level<5?sm:sb),VG.isNumber(C.coins)&&(this.currentCoins=C.coins),VG.isNumber(C.score)&&(this.score=C.score),this.playAnimation=!1,VG.isObject(C.overrideAnimation)&&(this.playAnimation="LevelCompleteOpenScreen"===C.overrideAnimation.openScreen),this.lookingForRewards=!1,VG.isBoolean(C.lookingForRewards)&&(this.lookingForRewards=C.lookingForRewards),this.getRewardsSuccess=!1,VG.isBoolean(C.getRewardsSuccess)&&(this.getRewardsSuccess=C.getRewardsSuccess),!0)}},{key:"open",value:function(){this.updateStatus(),this.node.scene.emit(i9.HIDE_UI),this.tryPlayAnimation()}},{key:"close",value:(H=M(function(){var n,w,k,C;var _=arguments;return _ts_generator(this,function(A){switch(A.label){case 0:w=_.length>0&&void 0!==_[0]&&_[0],k=L(this.particles);try{for(k.s();!(n=k.n()).done;){C=n.value;C.stop()}}catch(n){k.e(n)}finally{k.f()}return[4,N.runAnimationAsync(this.coinContainerAnimation,this.coinContainerExitClip.name)];case 1:A.sent(),VV.emit(VU.CLOSE_SCREEN,{screenName:this.node.name,screenData:{canShowRewardsAd:w}}),this.node.scene.emit(i9.ABORT_COIN_ANIMATION);return[2]}})}),function(){return H.apply(this,arguments)})},{key:"updateStatus",value:function(){this.updateCoinContainer(),this.updatePlayButton(),this.lookingForRewardsText.opacity=0}},{key:"updateCoinContainer",value:function(){this.coinContainer.updateCoins({coins:this.currentCoins})}},{key:"updatePlayButton",value:function(){var n=Vq.getGameData();if(n){var w=(this.level+1>n.totalLevel?this.level:this.level+1)%5==0;this.playBackground.active=!w,this.hardLevelBackground.active=w}}},{key:"tryPlayAnimation",value:function(){if(this.playAnimation){this.screen.setScreenOpacity(255),this.coinText.string="x0",this.scoreText.string="0",this.animateVisiblePlayButton(!1,!1);var n,w=L(this.particles);try{for(w.s();!(n=w.n()).done;)n.value.play()}catch(n){w.e(n)}finally{w.f()}var k=this.screen.getComponent(e7);k?k.once(e7.EventType.FINISHED,this.handleParticleEnd):this.handleParticleEnd()}else{if(this.animateVisiblePlayButton(!0,!1),!this.getRewardsSuccess)return;this.getRewardsEffect.playAnimation(["storm","thunder"],this.animateCollectItemPlayButton.bind(this))}}},{key:"handleLookingForRewards",value:(G=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,this.animateLookingForRewards()];case 1:n.sent(),ea.canShowRewardedInterstitialAd()?this.close(!0):this.animateVisiblePlayButton(!0);return[2]}})}),function(){return G.apply(this,arguments)})},{key:"animateCoin",value:(U=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=this;if(!this.screen.container)return[3,3];this.coinAnimation.play();return[4,N.runOnUpdateAsync(this.node,.8,function(w){var k=ts(0,n.coins,w),C=Math.floor(k);n.coinText.string="x".concat(C)})];case 1:w.sent();return[4,this.animateCoinCollection()];case 2:w.sent(),this.coinText.string="x".concat(this.coins);return[3,4];case 3:console.warn("LevelCompleteScreen: screen not found");w.label=4;case 4:return[2]}})}),function(){return U.apply(this,arguments)})},{key:"animateScore",value:(x=M(function(){var n;return _ts_generator(this,function(w){n=this;N.runOnUpdateAsync(this.scoreText.node,.8,function(w){var k=ts(0,n.score,w);n.scoreText.string="".concat(Math.floor(k))}),this.scoreText.node.setScale(1,1,1),this.scoreText.string="".concat(this.score);return[2]})}),function(){return x.apply(this,arguments)})},{key:"animateCoinCollection",value:(B=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,N.runAnimationAsync(this.coinContainerAnimation,this.coinContainerEnterClip.name)];case 1:n.sent(),this.node.scene.emit(i9.ADD_COINS,{coins:this.coins,collectionAnimation:{floatDuration:.5,flyDuration:.5,animateTextOnly:!1,target:this.coinContainer}});return[2]}})}),function(){return B.apply(this,arguments)})},{key:"animateLookingForRewards",value:(D=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=ez(this.lookingForRewardsText);n.to(.25,{opacity:255},{easing:"linear"}).delay(.25),n.to(.25,{opacity:100},{easing:"linear"}).delay(.125);return[4,N.runTweenAsync(ez(this.lookingForRewardsText).repeat(2,n).to(.25,{opacity:0},{easing:"linear"}))];case 1:w.sent(),this.lookingForRewardsText.opacity=0;return[2]}})}),function(){return D.apply(this,arguments)})},{key:"animateVisiblePlayButton",value:(O=M(function(n){var w,k,C,_,A;var T=arguments;return _ts_generator(this,function(I){switch(I.label){case 0:w=!(T.length>1&&void 0!==T[1])||T[1],k=n?1:0;if(!w)return[3,2];this.playButtonSignal.abort();C=new F;this.playButtonSignal=C;_=n?0:1;this.playButtonContainer.setScale(_,_,this.playButtonContainer.scale.z);A=ez(this.playButtonContainer).to(.5,{scale:new eQ(k,k,1)},{easing:"backOut"});n||(this.playButton.interactable=!1);return[4,N.runTweenAsync(A,C)];case 1:I.sent(),n&&(this.playButton.interactable=!0);return[3,3];case 2:this.playButton.interactable=n,this.playButtonContainer.setScale(k,k,this.playButtonContainer.scale.z);I.label=3;case 3:return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"animateCollectItemPlayButton",value:(I=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:this.playButtonSignal.abort();n=new F;this.playButtonSignal=n;w=ez(this.playButtonContainer).to(.08,{scale:new eQ(.95,1.05,1)}).to(.08,{scale:new eQ(1.05,.95,1)}).to(.08,{scale:new eQ(1,1,1)}),k=ez(this.shineBackground).to(.08,{opacity:50},{easing:"quadOut"}).to(.08,{opacity:0},{easing:"quadIn"});return[4,Promise.all([N.runTweenAsync(w,n),N.runTweenAsync(k,n)])];case 1:C.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"handleClickedPlay",value:function(){this.playButton.interactable=!1,this.close()}}]),S}(eO)).prototype,"coinText",[H8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vm=n(Vv.prototype,"scoreText",[H9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vb=n(Vv.prototype,"lookingForRewardsText",[H7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vw=n(Vv.prototype,"getRewardsEffect",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VS=n(Vv.prototype,"playButton",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vk=n(Vv.prototype,"playBackground",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VC=n(Vv.prototype,"shineBackground",[Vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VE=n(Vv.prototype,"hardLevelBackground",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V_=n(Vv.prototype,"playButtonContainer",[Vr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VA=n(Vv.prototype,"coinAnimation",[Vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VT=n(Vv.prototype,"coinContainer",[Vs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VP=n(Vv.prototype,"coinContainerAnimation",[Vl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VR=n(Vv.prototype,"coinContainerEnterClip",[Vh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VI=n(Vv.prototype,"coinContainerExitClip",[Vp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VL=n(Vv.prototype,"particles",[Vd],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),n(Vv.prototype,"animateCoin",[Vy],Object.getOwnPropertyDescriptor(Vv.prototype,"animateCoin"),Vv.prototype),Vf=Vv))||Vf);ew._RF.pop(),ew._RF.push({},"61985gSEDBMY6nVNc9Q1D6W","LoadingScreen",void 0);var VK,Vj,VY,VX,VZ,VJ,VQ,V$,V0,V1,V2=eS.ccclass,V4=eS.disallowMultiple,V3=eS.requireComponent,V5=GameCore.Events,V6=globalThis.game.event;V2("LoadingScreen")(VN=V4(VN=V3(ey)(VN=function(n){w(o,n);var _=k(o);function o(){var n;C(this,o);for(var w=arguments.length,k=new Array(w),A=0;A<w;A++)k[A]=arguments[A];return(n=_.call.apply(_,[this].concat(k))).handleOpeningScreen=function(w){n.validateEventPayload(w)&&(n.enabled=!0)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n.handleClosingScreen=function(w){n.validateEventPayload(w)&&n.unscheduleAllCallbacks()},n.handleClosedScreen=function(w){n.validateEventPayload(w)&&(n.enabled=!1)},n.handleOnCloseScreen=function(){en.closeScreen(ei.LOADING_SCREEN)},n}return T(o,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){V6.on(V5.OPENING_SCREEN,this.handleOpeningScreen),V6.on(V5.OPENED_SCREEN,this.handleOpenedScreen),V6.on(V5.CLOSING_SCREEN,this.handleClosingScreen),V6.on(V5.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"unListenScreenEvents",value:function(){V6.off(V5.OPENING_SCREEN,this.handleOpeningScreen),V6.off(V5.OPENED_SCREEN,this.handleOpenedScreen),V6.off(V5.CLOSING_SCREEN,this.handleClosingScreen),V6.off(V5.CLOSED_SCREEN,this.handleClosedScreen)}},{key:"validateEventPayload",value:function(n){return n.screenName===this.node.name}},{key:"open",value:function(){if(this.enabled){var n=this.screen.data.duration;n&&n>0&&this.scheduleOnce(this.handleOnCloseScreen,n)}}}]),o}(eO))||VN)||VN);ew._RF.pop(),ew._RF.push({},"6460akNFfhP9pDOT2Z0+s2R","NotificationScreen",void 0);var V8,V9,V7,qe,qt,qn,qi,qa,qr,qo,qs,ql,qh,qp,qd,qy,qf=eS.ccclass,qv=eS.disallowMultiple,qg=eS.requireComponent,qm=eS.property,qb=GameCore,qw=qb.Events,qS=qb.Utils.Valid,qk=globalThis.game.event;VK=qf("NotificationScreen"),Vj=qg(ey),VY=qm(eT),VX=qm(K),VZ=qm(eI),VK(VJ=qv(VJ=Vj((V$=n((VQ=function(n){w(s,n);var I=k(s);function s(){var n;C(this,s);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=I.call.apply(I,[this].concat(k)),_(n,"message",V$,A(n)),_(n,"messageLocalizer",V0,A(n)),_(n,"touchZone",V1,A(n)),n.enableCloseOnTouch=!0,n.handleOpeningScreen=function(w){n.validateEventPayload(w)&&n.updateScreenData(w)},n.handleClosingScreen=function(w){n.validateEventPayload(w)&&n.unscheduleAllCallbacks()},n}return T(s,[{key:"__preload",value:function(){this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"onLoad",value:function(){this.validateRequiredComponents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){qk.on(qw.OPENING_SCREEN,this.handleOpeningScreen),qk.on(qw.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"unListenScreenEvents",value:function(){qk.off(qw.OPENING_SCREEN,this.handleOpeningScreen),qk.off(qw.CLOSING_SCREEN,this.handleClosingScreen)}},{key:"validateEventPayload",value:function(n){return n.screenName===this.node.name}},{key:"updateScreenData",value:function(n){var w=n.screenData;qS.isObject(w)?(void 0!==w.message?this.setMessageManually(w.message):void 0!==w.localizedMessageKey&&this.setMessageUsingLocalizeKey(w.localizedMessageKey),w.duration&&w.duration>0&&this.scheduleOnce(function(){en.closeScreen(ei.NOTIFICATION_SCREEN)},w.duration),!1===w.enableCloseOnTouch?this.enableCloseOnTouch=!1:this.enableCloseOnTouch=!0):console.warn("NotificationScreen: screenData not found")}},{key:"setMessageManually",value:function(n){this.messageLocalizer.enabled=!1,this.message.string=n}},{key:"setMessageUsingLocalizeKey",value:function(n){this.messageLocalizer.enabled=!0,this.messageLocalizer.key=n}},{key:"handleClickedClose",value:function(){this.unscheduleAllCallbacks(),en.closeScreen(ei.NOTIFICATION_SCREEN)}},{key:"closeOnTouch",value:function(){this.enableCloseOnTouch&&this.handleClickedClose()}}]),s}(eO)).prototype,"message",[VY],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V0=n(VQ.prototype,"messageLocalizer",[VX],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V1=n(VQ.prototype,"touchZone",[VZ],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VJ=VQ))||VJ)||VJ);ew._RF.pop(),ew._RF.push({},"7129ca71jRMGaTHxWhEL4F4","QuitLevelScreen",void 0);var qC,qE,q_,qA,qT,qP,qR,qI,qL,qO,qD,qM,qN,qz,qB,qF,qx,qU,qG,qH,qV,qq,qW=eS.ccclass,qK=eS.property,qj=eS.requireComponent,qY=GameCore,qX=qY.Events,qZ=qY.Match.Modes,qJ=globalThis.game,qQ=qJ.event,q$=qJ.storage;V8=qW("QuitLevelScreen"),V9=qj(ey),V7=qK(eT),qe=qK(eT),qt=qK(eI),qn=qK(eT),qi=qK(eT),qa=qK(eI),V8(qr=V9((qs=n((qo=function(n){w(u,n);var I,L=k(u);function u(){var n;C(this,u);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=L.call.apply(L,[this].concat(k)),_(n,"singleDescription",qs,A(n)),_(n,"tournamentDescription",ql,A(n)),_(n,"quitButton",qh,A(n)),_(n,"quitLabel",qp,A(n)),_(n,"endLabel",qd,A(n)),_(n,"continueButton",qy,A(n)),n.handleOpeningScreen=function(w){n.validateEventPayload(w)&&n.setInteractableButtons(!0)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(u,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){qQ.on(qX.OPENING_SCREEN,this.handleOpeningScreen),qQ.on(qX.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){qQ.off(qX.OPENING_SCREEN,this.handleOpeningScreen),qQ.off(qX.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.scene.emit(i9.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),en.closeScreen(ev[this.node.name]),this.node.scene.emit(i9.SHOW_UI),this.node.scene.emit(i9.GAME_RESUME)}},{key:"updateStatus",value:function(){var n=sQ.getMatchMode()===qZ.TOURNAMENT;this.singleDescription.node.active=!n,this.tournamentDescription.node.active=n,this.quitLabel.node.active=!n,this.endLabel.node.active=n}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"setInteractableButtons",value:function(n){this.quitButton.interactable=n,this.continueButton.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}},{key:"handleClickedContinue",value:function(){this.close()}},{key:"handleClickedQuit",value:(I=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:if(this.setInteractableButtons(!1),sQ.getMatchMode()!==qZ.TOURNAMENT)return[3,2];w=(null!==(n=sQ.getMatchCustomData())&&void 0!==n?n:{}).score,k=(void 0===w?0:w)>q$.getStorageData("tournament","previousScore");q$.setStorageData("tournament","animateTournamentLeader",k);return[4,sQ.finishMatchAsync()];case 1:C.sent();C.label=2;case 2:this.node.scene.emit(i9.GAME_EXIT);return[2]}})}),function(){return I.apply(this,arguments)})}]),u}(eO)).prototype,"singleDescription",[V7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ql=n(qo.prototype,"tournamentDescription",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qh=n(qo.prototype,"quitButton",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qp=n(qo.prototype,"quitLabel",[qn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qd=n(qo.prototype,"endLabel",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qy=n(qo.prototype,"continueButton",[qa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qr=qo))||qr);ew._RF.pop(),ew._RF.push({},"85907Tnp/NBq7myeciP/4h3","RescuesScreen",void 0);var q0,q1,q2,q4,q3,q5,q6,q8,q9,q7,We,Wt,Wn,Wi,Wa,Wr,Wo,Ws,Wl,Wu,Wh,Wp,Wd,Wy,Wf,Wv,Wg=eS.ccclass,Wm=eS.property,Wb=eS.disallowMultiple,Ww=eS.requireComponent,WS=GameCore.Events,Wk=globalThis.game,WC=Wk.event,WE=Wk.player;qC=Wg("RescuesScreen"),qE=Ww(ey),q_=Wm(eH),qA=Wm([ek]),qT=Wm(K),qP=Wm(K),qR=Wm(ek),qI=Wm(ek),qL=Wm(e7),qO=Wm(ek),qD=Wm(ek),qC(qM=Wb(qM=qE((qz=n((qN=function(n){w(v,n);var I,L,O,D,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"adOpacity",qz,A(n)),_(n,"animNodes",qB,A(n)),_(n,"titleLocalizer",qF,A(n)),_(n,"descriptionLocalizer",qx,A(n)),_(n,"timer",qU,A(n)),_(n,"bomb",qG,A(n)),_(n,"bombAnim",qH,A(n)),_(n,"replayButton",qV,A(n)),_(n,"buyTimeButton",qq,A(n)),n.handleOpeningScreen=function(w){if(!n.screen)throw new Error("RescuesScreen: screen not found");n.validateEventPayload(w)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){WC.on(WS.OPENING_SCREEN,this.handleOpeningScreen),WC.on(WS.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){WC.off(WS.OPENING_SCREEN,this.handleOpeningScreen),WC.off(WS.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return n.screenName===this.node.name&&(this.payload=n,!0)}},{key:"open",value:(B=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:G.turnOffMusic();return[4,this.resetState()];case 1:n.sent(),this.runOpenAnimation(),this.node.scene.emit(i9.HIDE_UI);return[2]}})}),function(){return B.apply(this,arguments)})},{key:"close",value:function(){G.turnUpMusic(),WC.emit(WS.CLOSE_SCREEN,{screenName:this.node.name})}},{key:"resetState",value:(D=M(function(){var n,w,k,C;return _ts_generator(this,function(_){w=(null===(n=this.payload.screenData)||void 0===n?void 0:n.failKey)===s1;this.titleLocalizer.key=w?"game.boom":"game.timesUp",this.descriptionLocalizer.key=w?"game.bombDesc":"game.timesUpDesc",this.timer.active=!w,this.bomb.active=w,w&&this.bombAnim.play();k=WE.getGameData();if(k){C=k.coins>=sk;this.replayButton.active=!C,this.buyTimeButton.active=C,this.adOpacity.opacity=0}return[2]})}),function(){return D.apply(this,arguments)})},{key:"runOpenAnimation",value:(O=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=this;if(!this.screen.container)return[3,3];return[4,Promise.all(this.animNodes.map(function(w,k){n.runAppearTween(w,.1*k)}))];case 1:w.sent();return[4,this.runShowAdContainer()];case 2:w.sent();return[3,4];case 3:console.warn("TimeUpScreen: screen not found");w.label=4;case 4:return[2]}})}),function(){return O.apply(this,arguments)})},{key:"runAppearTween",value:(L=M(function(n,w){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,N.runTweenAsync(ez(n).set({scale:new eQ(0,0,0)}).delay(w).to(1,{scale:new eQ(1,1,1)},{easing:function(n){return N.elasticOut(n,.1,.45)}}))];case 1:k.sent();return[2]}})}),function(n,w){return L.apply(this,arguments)})},{key:"runShowAdContainer",value:function(){var n=ez(this.adOpacity);return n.delay(1),n.to(.5,{opacity:255}),N.runTweenAsync(n)}},{key:"handleClickReplayButton",value:function(){this.close(),this.node.scene.emit(i9.GAME_REPLAY,{level:this.screen.data.level})}},{key:"handleClickBuyTimeButton",value:function(){this.node.scene.emit(i9.REMOVE_COINS,{coins:sk,collectionAnimation:{animateTextOnly:!0}}),this.startRescue()}},{key:"handleClickAdButton",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,ea.showRewardVideoAdAsync({})];case 1:n.sent()&&this.startRescue();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"startRescue",value:function(){this.node.scene.emit(i9.SHOW_UI),this.node.scene.emit(i9.RESCUE_START),this.close()}}]),v}(eO)).prototype,"adOpacity",[q_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qB=n(qN.prototype,"animNodes",[qA],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qF=n(qN.prototype,"titleLocalizer",[qT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qx=n(qN.prototype,"descriptionLocalizer",[qP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qU=n(qN.prototype,"timer",[qR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qG=n(qN.prototype,"bomb",[qI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qH=n(qN.prototype,"bombAnim",[qL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qV=n(qN.prototype,"replayButton",[qO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qq=n(qN.prototype,"buyTimeButton",[qD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qM=qN))||qM)||qM);ew._RF.pop(),ew._RF.push({},"726c9oCUUBDpboDnHRz7SGZ","PauseScreen",void 0);var W_,WA,WT,WP,WR,WI,WL,WO,WD,WM,WN,Wz,WB,WF,Wx,WU,WG,WH,WV,Wq,WW,WK,Wj,WY,WX,WZ,WJ=eS.ccclass,WQ=eS.property,W$=eS.requireComponent,W0=GameCore,W1=W0.Events,W2=W0.Utils.Device,W4=W0.Match.Modes,W3=globalThis.game,W5=W3.player,W6=W3.event;q0=WJ("PauseScreen"),q1=W$(ey),q2=WQ(ek),q4=WQ(ek),q3=WQ(ek),q5=WQ(Db),q6=WQ(Db),q8=WQ(Db),q9=WQ(eI),q7=WQ(eI),We=WQ(eI),Wt=WQ(eI),Wn=WQ(ek),q0(Wi=q1((Wr=n((Wa=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"musicSetting",Wr,A(n)),_(n,"soundSetting",Wo,A(n)),_(n,"vibrateSetting",Ws,A(n)),_(n,"musicSwitch",Wl,A(n)),_(n,"soundSwitch",Wu,A(n)),_(n,"vibrateSwitch",Wh,A(n)),_(n,"closeButtonComponent",Wp,A(n)),_(n,"continueButtonComponent",Wd,A(n)),_(n,"restartButtonComponent",Wy,A(n)),_(n,"challengeFriendsButtonComponent",Wf,A(n)),_(n,"animNodes",Wv,A(n)),n.triggerSequence="",n.handleOpeningScreen=function(w){n.validateSwitchScreenPayload(w)&&(n.setInteractableButtons(!0),n.updateStatus())},n.handleOpenedScreen=function(w){n.validateSwitchScreenPayload(w)&&n.open()},n.handleResetSequence=function(){n.triggerSequence=""},n.handleTriggerUnlockKey=function(w){if("code"in w){var k=w.code,C=sA.UNLOCK_SEQUENCE;"number"==typeof k&&-1!==C.indexOf(k.toString())&&(n.triggerSequence+=k.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",k,n.triggerSequence,n.triggerSequence===C),n.triggerSequence===C&&(n.node.scene.emit(sA.Events.UNLOCK_DEV_TOOLS),n.node.off(sA.Events.TRIGGER_UNLOCK_KEY)))}},n.updateVibrateButton=function(){var w=n.vibrateSetting.getComponentInChildren(eI),k=n.vibrateSetting.getComponentInChildren(Db),C=n.vibrateSetting.getComponentInChildren(i_);if(w&&k&&C){if(W2.isMobile()){var _,A=null!==(_=W5.getPlayerSetting("vibrate"))&&void 0!==_&&_;k.setEnabled(A)}else w.interactable=!1,k.setEnabled(!1),C.changeState(!1)}else console.warn("SettingsScreen: vibrate button missing components")},n}return T(c,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools()}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){W6.on(W1.OPENING_SCREEN,this.handleOpeningScreen),W6.on(W1.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){W6.off(W1.OPENING_SCREEN,this.handleOpeningScreen),W6.off(W1.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(n){return n.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(sA.Events.TRIGGER_UNLOCK_KEY),this.node.on(sA.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(sA.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(sA.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(sA.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(sA.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(i9.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(sA.Events.TRIGGER_RESET_SEQUENCE),en.closeScreen(ev[this.node.name])}},{key:"updateStatus",value:function(){var n,w,k,C={music:null!==(n=W5.getPlayerSetting("music"))&&void 0!==n&&n,sound:null!==(w=W5.getPlayerSetting("sound"))&&void 0!==w&&w,vibrate:null!==(k=W5.getPlayerSetting("vibrate"))&&void 0!==k&&k};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(C.music),this.soundSwitch.setEnabled(C.sound),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){var n=this;this.screen.container||console.warn("SettingsScreen: screen not found"),this.animNodes.forEach(function(w,k){n.runAppearTween(w,.1*k)})}},{key:"runAppearTween",value:function(n,w){var k=ez(n);k.set({scale:new eQ(0,0,0)}),k.delay(w),k.to(1,{scale:new eQ(1,1,1)},{easing:function(n){return N.elasticOut(n,.1,.45)}}),k.start()}},{key:"setInteractableButtons",value:function(n){this.closeButtonComponent.interactable=n,this.continueButtonComponent.interactable=n,this.restartButtonComponent.interactable=n,this.challengeFriendsButtonComponent.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var n=this.musicSwitch.switch();if(W5.setSetting("music",n),this.node.emit(sA.Events.TRIGGER_UNLOCK_KEY,{code:n?1:0}),n){var w=sQ.getMatchMode();G.playMusic(w===W4.TOURNAMENT?nL.TOURNAMENT_MUSIC:nL.BG_MUSIC)}else G.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var n=this.soundSwitch.switch();W5.setSetting("sound",n),this.node.emit(sA.Events.TRIGGER_UNLOCK_KEY,{code:n?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var n=this.vibrateSwitch.switch();W5.setSetting("vibrate",n)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedResume",value:function(){this.resumeGame()}},{key:"handleClickedClose",value:function(){this.resumeGame()}},{key:"handleClickedReplayGame",value:(L=M(function(){var n,w,k,C;return _ts_generator(this,function(_){switch(_.label){case 0:this.close();w=(null!==(n=W5.getGameData())&&void 0!==n?n:{}).level,k=void 0===w?1:w;C=ea.canShowInterstitialAd();if(!C)return[3,2];return[4,ea.showInterstitialAdAsync({forLevel:k})];case 1:C=_.sent();_.label=2;case 2:sQ.getMatchMode()!==W4.TOURNAMENT?(this.node.scene.emit(i9.GAME_RESUME),this.node.scene.emit(i9.GAME_REPLAY,{level:k})):en.openScreen(ei.START_OVER_SCREEN);return[2]}})}),function(){return L.apply(this,arguments)})},{key:"handleClickedChallengeFriends",value:(I=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if("MsGames"!==GameSDK.getSDKName())return[3,2];en.showLoadingScreen();return[4,GameSDK.extra.shareAsync()];case 1:return[2,(n.sent(),void en.closeLoadingScreen())];case 2:this.close(),this.node.scene.emit(i9.CHALLENGE_FRIENDS);return[2]}})}),function(){return I.apply(this,arguments)})},{key:"resumeGame",value:function(){this.close(),this.node.scene.emit(i9.GAME_RESUME),this.node.scene.emit(i9.SHOW_UI)}}]),c}(eO)).prototype,"musicSetting",[q2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wo=n(Wa.prototype,"soundSetting",[q4],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ws=n(Wa.prototype,"vibrateSetting",[q3],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wl=n(Wa.prototype,"musicSwitch",[q5],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wu=n(Wa.prototype,"soundSwitch",[q6],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wh=n(Wa.prototype,"vibrateSwitch",[q8],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wp=n(Wa.prototype,"closeButtonComponent",[q9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wd=n(Wa.prototype,"continueButtonComponent",[q7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wy=n(Wa.prototype,"restartButtonComponent",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wf=n(Wa.prototype,"challengeFriendsButtonComponent",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wv=n(Wa.prototype,"animNodes",[Wn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Wi=Wa))||Wi);ew._RF.pop(),ew._RF.push({},"61932YLC/5CFrE0eD0ez8Zg","SettingsScreen",void 0);var W8,W9,W7,Ke,Kt,Kn,Ki,Ka,Kr,Ko,Ks,Kl,Kh,Kp,Kd,Ky,Kf,Kv,Kg,Km,Kb,Kw,KS,Kk=eS.ccclass,KC=eS.property,KE=eS.requireComponent,K_=GameCore,KA=K_.Events,KT=K_.Utils.Device,KP=K_.Match.Modes,KR=K_.Configs.Debugger.MonitorError,KI=globalThis.game,KL=KI.player,KO=KI.event,KD=KI.monitorError,KM=KI.frameCapture;W_=Kk("SettingsScreen"),WA=KE(ey),WT=KC(ek),WP=KC(ek),WR=KC(ek),WI=KC(Db),WL=KC(Db),WO=KC(Db),WD=KC(eI),WM=KC(eI),WN=KC(eI),Wz=KC(eI),WB=KC(ek),W_(WF=WA((WU=n((Wx=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"musicSetting",WU,A(n)),_(n,"soundSetting",WG,A(n)),_(n,"vibrateSetting",WH,A(n)),_(n,"musicSwitch",WV,A(n)),_(n,"soundSwitch",Wq,A(n)),_(n,"vibrateSwitch",WW,A(n)),_(n,"closeButtonComponent",WK,A(n)),_(n,"reportButtonComponent",Wj,A(n)),_(n,"shareButtonComponent",WY,A(n)),_(n,"inviteFriendsButtonComponent",WX,A(n)),_(n,"animNodes",WZ,A(n)),n.triggerSequence="",n.handleOpeningScreen=function(w){n.validateSwitchScreenPayload(w)&&(n.setInteractableButtons(!0),n.updateStatus())},n.handleOpenedScreen=function(w){n.validateSwitchScreenPayload(w)&&n.open()},n.handleResetSequence=function(){n.triggerSequence=""},n.handleTriggerUnlockKey=function(w){if("code"in w){var k=w.code,C=sA.UNLOCK_SEQUENCE;"number"==typeof k&&-1!==C.indexOf(k.toString())&&(n.triggerSequence+=k.toString(),console.log("SettingsScreen: handleTriggerUnlockKey",k,n.triggerSequence,n.triggerSequence===C),n.triggerSequence===C&&(n.node.scene.emit(sA.Events.UNLOCK_DEV_TOOLS),n.node.off(sA.Events.TRIGGER_UNLOCK_KEY)))}},n.updateVibrateButton=function(){var w=n.vibrateSetting.getComponentInChildren(eI),k=n.vibrateSetting.getComponentInChildren(Db),C=n.vibrateSetting.getComponentInChildren(i_);if(w&&k&&C){if(KT.isMobile()){var _,A=null!==(_=KL.getPlayerSetting("vibrate"))&&void 0!==_&&_;k.setEnabled(A)}else w.interactable=!1,k.setEnabled(!1),C.changeState(!1)}else console.warn("SettingsScreen: vibrate button missing components")},n}return T(c,[{key:"onLoad",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents(),this.listenUnlockDevTools(),this.reportButtonComponent.node.parent.active=KR.Feedback}},{key:"onDestroy",value:function(){this.unListenScreenEvents(),this.unListenUnlockDevTools()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){KO.on(KA.OPENING_SCREEN,this.handleOpeningScreen),KO.on(KA.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){KO.off(KA.OPENING_SCREEN,this.handleOpeningScreen),KO.off(KA.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateSwitchScreenPayload",value:function(n){return n.screenName===this.node.name}},{key:"listenUnlockDevTools",value:function(){this.node.off(sA.Events.TRIGGER_UNLOCK_KEY),this.node.on(sA.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.on(sA.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"unListenUnlockDevTools",value:function(){this.node.off(sA.Events.TRIGGER_RESET_SEQUENCE,this.handleResetSequence),this.node.off(sA.Events.TRIGGER_UNLOCK_KEY,this.handleTriggerUnlockKey)}},{key:"open",value:function(){this.updateStatus(),this.runPopUpAnimation(),this.node.emit(sA.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(i9.HIDE_UI)}},{key:"close",value:function(){this.setInteractableButtons(!1),this.node.emit(sA.Events.TRIGGER_RESET_SEQUENCE),this.node.scene.emit(i9.SHOW_UI),en.closeScreen(ei.SETTINGS_SCREEN)}},{key:"updateStatus",value:function(){var n,w,k,C={music:null!==(n=KL.getPlayerSetting("music"))&&void 0!==n&&n,sound:null!==(w=KL.getPlayerSetting("sound"))&&void 0!==w&&w,vibrate:null!==(k=KL.getPlayerSetting("vibrate"))&&void 0!==k&&k};this.musicSwitch?this.soundSwitch?(this.musicSwitch.setEnabled(C.music),this.soundSwitch.setEnabled(C.sound),"GameDistributions"!==GameSDK.getSDKName()&&this.scheduleOnce(this.updateVibrateButton,.1)):console.warn("SettingsScreen: soundSwitch not found"):console.warn("SettingsScreen: musicSwitch not found")}},{key:"runPopUpAnimation",value:function(){var n=this;this.screen.container||console.warn("SettingsScreen: screen not found"),this.animNodes.forEach(function(w,k){("ReportButton"!==w.name||KR.Feedback)&&n.runAppearTween(w,.1*k)})}},{key:"runAppearTween",value:function(n,w){var k=ez(n);k.set({scale:new eQ(0,0,0)}),k.delay(w),k.to(1,{scale:new eQ(1,1,1)},{easing:function(n){return N.elasticOut(n,.1,.45)}}),k.start()}},{key:"setInteractableButtons",value:function(n){this.closeButtonComponent.interactable=n,this.reportButtonComponent.interactable=n,this.shareButtonComponent.interactable=n,this.inviteFriendsButtonComponent.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}},{key:"switchMusicButton",value:function(){if(this.musicSwitch){var n=this.musicSwitch.switch();if(KL.setSetting("music",n),this.node.emit(sA.Events.TRIGGER_UNLOCK_KEY,{code:n?1:0}),n){var w=sQ.getMatchMode();G.playMusic(w===KP.TOURNAMENT?nL.TOURNAMENT_MUSIC:nL.BG_MUSIC)}else G.pauseMusic()}else console.warn("SettingsScreen: musicSwitch not found")}},{key:"switchSoundButton",value:function(){if(this.soundSwitch){var n=this.soundSwitch.switch();KL.setSetting("sound",n),this.node.emit(sA.Events.TRIGGER_UNLOCK_KEY,{code:n?3:2})}else console.warn("SettingsScreen: soundSwitch not found")}},{key:"switchVibrateButton",value:function(){if(this.vibrateSwitch){var n=this.vibrateSwitch.switch();KL.setSetting("vibrate",n)}else console.warn("SettingsScreen: vibrateSwitch not found")}},{key:"handleClickedClose",value:function(){this.close()}},{key:"handleClickedReport",value:function(){null==KD||KD.feedbackAsync()}},{key:"handleClickedShare",value:(L=M(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if("FacebookInstant"!==GameSDK.getSDKName())return[3,2];KM.addWideframeRender("renderShareScore",eg),en.showLoadingScreen();return[4,GameSDK.extra.shareBestScoreAsync()];case 1:return[2,(n.sent(),void en.closeLoadingScreen())];case 2:this.close();return[2]}})}),function(){return L.apply(this,arguments)})},{key:"handleClickedInviteFriends",value:(I=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=GameSDK.getSDKName();switch(n){case"MsGames":return[3,1];case"FacebookInstant":return[3,3]}return[3,5];case 1:en.showLoadingScreen();return[4,GameSDK.extra.shareAsync()];case 2:w.sent(),en.closeLoadingScreen();return[3,5];case 3:KM.addWideframeRender("renderShareScore",em),en.showLoadingScreen();return[4,GameSDK.extra.inviteWithBestScoreAsync()];case 4:w.sent(),en.closeLoadingScreen();w.label=5;case 5:return[2]}})}),function(){return I.apply(this,arguments)})}]),c}(eO)).prototype,"musicSetting",[WT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WG=n(Wx.prototype,"soundSetting",[WP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WH=n(Wx.prototype,"vibrateSetting",[WR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WV=n(Wx.prototype,"musicSwitch",[WI],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wq=n(Wx.prototype,"soundSwitch",[WL],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WW=n(Wx.prototype,"vibrateSwitch",[WO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WK=n(Wx.prototype,"closeButtonComponent",[WD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wj=n(Wx.prototype,"reportButtonComponent",[WM],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WY=n(Wx.prototype,"shareButtonComponent",[WN],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WX=n(Wx.prototype,"inviteFriendsButtonComponent",[Wz],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WZ=n(Wx.prototype,"animNodes",[WB],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),WF=Wx))||WF);ew._RF.pop(),ew._RF.push({},"891d37NJ6lLdp3CNLPHxZ6d","StarChest",void 0);var KN,Kz,KB,KF,Kx,KU,KG,KH,KV,Kq,KW,KK,Kj,KY,KX,KZ,KJ,KQ,K$,K0,K1=eS.ccclass,K2=eS.property,K4=(W8=K1("StarChest"),W9=K2(ex),W7=K2(eH),Ke=K2(e$),Kt=K2(eH),Kn=K2(eH),Ki=K2({type:eM,readonly:!0,displayName:"Starting Offset X",group:"Reward Animations"}),Ka=K2({type:eM,readonly:!0,displayName:"Starting Offset Y",group:"Reward Animations"}),Kr=K2({type:eM,displayName:"Centered Offset X",group:"Reward Animations"}),Ko=K2({type:eM,displayName:"Centered Offset Y",group:"Reward Animations"}),Ks=K2({type:eM,min:0,displayName:"Starting Scale",group:"Reward Animations"}),Kl=K2({type:eM,min:0,displayName:"Ending Scale",group:"Reward Animations"}),W8((Kd=n((Kp=function(n){w(v,n);var I,L,O,D,B,F=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=F.call.apply(F,[this].concat(k)),_(n,"sprite",Kd,A(n)),_(n,"glowOpacity",Ky,A(n)),_(n,"explosionParticles",Kf,A(n)),_(n,"circle",Kv,A(n)),_(n,"uiOpacity",Kg,A(n)),n.ogCenterX=0,n.ogCenterY=0,_(n,"endingOffsetX",Km,A(n)),_(n,"endingOffsetY",Kb,A(n)),_(n,"startingScale",Kw,A(n)),_(n,"endingScale",KS,A(n)),n}return T(v,[{key:"startingOffsetX",get:function(){return this.node.position.x}},{key:"startingOffsetY",get:function(){return this.node.position.y}},{key:"__preload",value:function(){this.validateRequiredComponents(),this.ogCenterX=this.startingOffsetX,this.ogCenterY=this.startingOffsetY}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"moveToCenter",value:(B=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=new eQ(this.endingOffsetX,this.endingOffsetY,this.node.position.z);return[4,N.runTweenAsync(ez(this.node).to(.7,{position:w},{easing:"quintInOut"}),n)];case 1:k.sent(),this.node.position=w;return[2]}})}),function(n){return B.apply(this,arguments)})},{key:"respawnAtStartingState",value:function(){this.node.position=new eQ(this.ogCenterX,this.ogCenterY,this.node.position.z),this.glowOpacity.opacity=0,this.sprite.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.glowOpacity.node.setScale(this.startingScale,this.startingScale,this.startingScale),this.uiOpacity.opacity=255}},{key:"scale",value:(D=M(function(n,w){var k,C;return _ts_generator(this,function(_){switch(_.label){case 0:k=this.startingScale+(this.endingScale-this.startingScale)*n,C=new eQ(k,k,k);return[4,Promise.all([N.runTweenAsync(ez(this.sprite.node).to(.2,{scale:C},{easing:"backOut"}),w),N.runTweenAsync(ez(this.glowOpacity.node).to(.2,{scale:C},{easing:"backOut"}),w)])];case 1:_.sent(),this.sprite.node.setScale(C),this.glowOpacity.node.setScale(C);return[2]}})}),function(n,w){return D.apply(this,arguments)})},{key:"startShaking",value:function(){var n=this,w=this.node.position.clone();this.shakingTween={ogPos:w,tw:ez(this.node).to(.1,{},{onUpdate:function(k,C){if(C){var _=w.x+10*(C-.5);n.node.position=new eQ(_,w.y,w.z)}}}).repeatForever().start()}}},{key:"stopShaking",value:function(){this.shakingTween&&(this.shakingTween.tw.stop(),this.node.position=this.shakingTween.ogPos,this.shakingTween=void 0)}},{key:"glow",value:(O=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=this.sprite.node.scale.clone().multiplyScalar(1.1);return[4,Promise.all([N.runTweenAsync(ez(this.sprite.node).to(.2,{scale:w},{easing:"cubicInOut"}),n),N.runTweenAsync(ez(this.glowOpacity.node).to(.2,{scale:w}),n),N.runTweenAsync(ez(this.glowOpacity).to(.5,{opacity:255}),n)])];case 1:k.sent();return[2]}})}),function(n){return O.apply(this,arguments)})},{key:"explode",value:(L=M(function(n){var w,k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:w=this,k=new eQ(8,8,8),C=function(){var C=M(function(){return _ts_generator(this,function(C){switch(C.label){case 0:w.circle.opacity=255,w.circle.node.setScale(eQ.ZERO);return[4,Promise.all([N.runTweenAsync(ez(w.circle).to(.3,{opacity:0}),n),N.runTweenAsync(ez(w.circle.node).to(.3,{scale:k},{easing:"cubicOut"}),n)])];case 1:C.sent(),w.circle.opacity=0,w.circle.node.scale=k;return[2]}})});return function(){return C.apply(this,arguments)}}(),_=function(){var k=M(function(){return _ts_generator(this,function(k){switch(k.label){case 0:return[4,Promise.all([N.runTweenAsync(ez(w.glowOpacity.node).to(.3,{scale:eQ.ZERO},{easing:"cubicOut"}),n),N.runTweenAsync(ez(w.sprite.node).to(.3,{scale:eQ.ZERO},{easing:"cubicOut"}),n)])];case 1:k.sent(),w.sprite.node.setScale(eQ.ZERO),w.glowOpacity.node.setScale(eQ.ZERO);return[2]}})});return function(){return k.apply(this,arguments)}}();return[4,Promise.all([this.explodeParticles(n),C(),_()])];case 1:A.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"explodeParticles",value:(I=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=n.aborted;if(w)return[3,2];this.explosionParticles.node.active=!0,this.explosionParticles.resetSystem();return[4,N.waitTweenAsync(1)];case 1:w=(k.sent(),this.explosionParticles.node.active=!1);k.label=2;case 2:return[2]}})}),function(n){return I.apply(this,arguments)})}]),v}(eO)).prototype,"sprite",[W9],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ky=n(Kp.prototype,"glowOpacity",[W7],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kf=n(Kp.prototype,"explosionParticles",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kv=n(Kp.prototype,"circle",[Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kg=n(Kp.prototype,"uiOpacity",[Kn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(Kp.prototype,"startingOffsetX",[Ki],Object.getOwnPropertyDescriptor(Kp.prototype,"startingOffsetX"),Kp.prototype),n(Kp.prototype,"startingOffsetY",[Ka],Object.getOwnPropertyDescriptor(Kp.prototype,"startingOffsetY"),Kp.prototype),Km=n(Kp.prototype,"endingOffsetX",[Kr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Kb=n(Kp.prototype,"endingOffsetY",[Ko],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Kw=n(Kp.prototype,"startingScale",[Ks],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return .5}}),KS=n(Kp.prototype,"endingScale",[Kl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Kh=Kp))||Kh);ew._RF.pop(),ew._RF.push({},"e414bczbutHJKcOfhl1sc4p","StarChestScreen",void 0);var K3,K5,K6,K8,K9,K7=eS.ccclass,je=eS.property,jt=eS.requireComponent,jn=GameCore.Events,ji=globalThis.game,ja=ji.event,jr=ji.player;KN=K7("StarChestScreen"),Kz=jt(ey),KB=je(Rm),KF=je(eI),Kx=je(eI),KU=je(e7),KG=je(K4),KH=je(eH),KV=je(_T),Kq=je(K),KN(KW=Kz((Kj=n((KK=function(n){w(v,n);var I,L,O,D,B=k(v);function v(){var n;C(this,v);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=B.call.apply(B,[this].concat(k)),_(n,"starProgressBar",Kj,A(n)),_(n,"openButton",KY,A(n)),_(n,"continueButton",KX,A(n)),_(n,"chestAnimation",KZ,A(n)),_(n,"starChest",KJ,A(n)),_(n,"chestUnlockFXMask",KQ,A(n)),_(n,"skipOverlay",K$,A(n)),_(n,"messageLabelLocalizer",K0,A(n)),n.handleOpeningScreen=function(w){if(!n.screen)throw new Error("StarChestScreen: screen not found");n.validateEventPayload(w)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(v,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){ja.on(jn.OPENING_SCREEN,this.handleOpeningScreen),ja.on(jn.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){ja.off(jn.OPENING_SCREEN,this.handleOpeningScreen),ja.off(jn.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name}},{key:"open",value:function(){this.runPopUpAnimation(),this.node.scene.emit(i9.HIDE_UI);var n=jr.getGameData();if(n){var w=n.stars;this.numChestAvailable=Math.floor(w/20),this.starProgressBar.setRange(w,20);var k=this.numChestAvailable>0;this.setInteractableButtons(!0),this.openButton.node.active=k,this.openButton.interactable=k,this.continueButton.node.active=!k,this.continueButton.interactable=!k,this.messageLabelLocalizer.key=this.numChestAvailable?"reward.starChestAvailable":"reward.starChestUnavailable",this.numChestAvailable?this.chestAnimation.play():this.chestAnimation.stop(),this.chestUnlockFXMask.node.active=!1,this.chestUnlockFXMask.opacity=0,this.starChest.respawnAtStartingState()}}},{key:"close",value:function(){ja.emit(jn.CLOSE_SCREEN,{screenName:this.node.name}),this.node.scene.emit(i9.SHOW_UI)}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StarChestScreen: screen not found")}},{key:"handleClickButton",value:(D=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:if(!(0!==this.numChestAvailable))return[3,5];G.turnDownMusic();n=jr.getGameData();if(!n)return[3,4];this.setInteractableButtons(!1);w=n.stars;jr.setGameData({stars:n.stars-20*this.numChestAvailable});k=new F;return[4,this.skipOverlay.open({opacity:200,onSkip:function(){return k.abort()}})];case 1:C.sent();return[4,this.handleUnlockAnimation(w,n.stars,k)];case 2:C.sent();return[4,this.skipOverlay.close()];case 3:C.sent(),G.turnUpMusic(),eY.emit(t2),this.close();C.label=4;case 4:return[3,6];case 5:this.close();C.label=6;case 6:return[2]}})}),function(){return D.apply(this,arguments)})},{key:"handleUnlockAnimation",value:(O=M(function(n,w,k){var C,_,A,T;return _ts_generator(this,function(I){switch(I.label){case 0:C=this;return[4,Promise.all([this.starChest.moveToCenter(k),this.fadeInChestUnlockFX(k)])];case 1:I.sent(),this.chestAnimation.stop(),this.starChest.startShaking();return[4,G.playSound(nL.STAR_CHEST_DRUM_ROLL,{loop:!0})];case 2:I.sent();return[4,N.waitTweenAsync(0)];case 3:I.sent();_=n,A=this.numChestAvailable;return[4,Promise.all([this.starProgressBar.animateTo(w,k,function(n){var w;_-n>=20&&(_=n,A--,C.starChest.scale((w=A,C.numChestAvailable>2?1-w/C.numChestAvailable:.35*(1-w/C.numChestAvailable)),k),G.playSound(nL.STAR_CHEST_OPEN))})])];case 4:I.sent();return[4,N.waitTweenAsync(1,k)];case 5:I.sent(),this.starChest.stopShaking();return[4,this.starChest.glow(k)];case 6:I.sent(),G.stopSound(nL.STAR_CHEST_DRUM_ROLL);T=sw*this.numChestAvailable;this.node.scene.emit(i9.ADD_COINS,{coins:T,collectionAnimation:{animateTextOnly:!1,floatDuration:3,signal:k},skipAnimation:!0});return[4,this.starChest.explode(k)];case 7:I.sent();return[4,N.waitTweenAsync(1,k)];case 8:I.sent();return[4,Promise.all([this.fadeOutChestUnlockFX(k)])];case 9:I.sent();return[2]}})}),function(n,w,k){return O.apply(this,arguments)})},{key:"fadeInChestUnlockFX",value:(L=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:this.chestUnlockFXMask.node.active=!0;return[4,N.runTweenAsync(ez(this.chestUnlockFXMask).to(.5,{opacity:150}),n)];case 1:w.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"fadeOutChestUnlockFX",value:(I=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,N.runTweenAsync(ez(this.chestUnlockFXMask).to(.3,{opacity:0}),n)];case 1:w.sent(),this.chestUnlockFXMask.opacity=0,this.chestUnlockFXMask.node.active=!1;return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"setInteractableButtons",value:function(n){this.openButton.interactable=n,this.continueButton.interactable=n,this.screen.backgroundMask.getComponent(eI).interactable=n}}]),v}(eO)).prototype,"starProgressBar",[KB],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KY=n(KK.prototype,"openButton",[KF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KX=n(KK.prototype,"continueButton",[Kx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KZ=n(KK.prototype,"chestAnimation",[KU],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KJ=n(KK.prototype,"starChest",[KG],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KQ=n(KK.prototype,"chestUnlockFXMask",[KH],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K$=n(KK.prototype,"skipOverlay",[KV],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K0=n(KK.prototype,"messageLabelLocalizer",[Kq],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KW=KK))||KW);ew._RF.pop(),ew._RF.push({},"d6d78U+W5xDwqln9pXXQOaF","TopLeaders",void 0);var jo,js,jl,jh,jp,jd=eS.ccclass,jy=eS.property,jf=(K3=jd("TopLeaders"),K5=jy(zg),K3((K9=n((K8=function(n){w(c,n);var I,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"topLeaders",K9,A(n)),n.leaderData=[],n}return T(c,[{key:"updateData",value:function(n){var w=this;this.leaderData=n.slice(0,3),this.leaderData.slice(0,3).forEach(function(n,k){w.topLeaders[k].updateInfo({playerId:n.playerId,name:n.name,photo:n.photo,score:n.score})})}},{key:"playShowLeadersAnimation",value:(I=M(function(n){var w,k,C;var _=arguments;return _ts_generator(this,function(A){switch(A.label){case 0:w=this,k=_.length>1&&void 0!==_[1]?_[1]:.1,C=.3;return[4,Promise.all(this.leaderData.map(function(){var _=M(function(_,A){var T;return _ts_generator(this,function(_){switch(_.label){case 0:T=w.topLeaders[A];return[4,T.runShowUpAnimation(A*k,C,n)];case 1:_.sent();return[2]}})});return function(n,w){return _.apply(this,arguments)}}()))];case 1:A.sent();return[2]}})}),function(n){return I.apply(this,arguments)})},{key:"hideLeaders",value:function(){var n,w=L(this.topLeaders);try{for(w.s();!(n=w.n()).done;)n.value.setVisible(!1)}catch(n){w.e(n)}finally{w.f()}}}]),c}(eO)).prototype,"topLeaders",[K5],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),K6=K8))||K6);ew._RF.pop(),ew._RF.push({},"fe274iMNmBCzZ13Ie1nGU1R","TournamentLeaderSkeleton",void 0);var jv,jg,jm,jb,jw,jS,jk,jC,jE,j_,jA,jT,jP,jR,jI,jL,jO,jD,jM,jN,jz,jB,jF,jx,jU,jG,jH,jV,jq,jW,jK,jj,jY,jX,jZ,jJ,jQ,j$,j0,j1,j2,j4,j3,j5=eS.ccclass,j6=eS.property,j8=(jo=j5("TournamentLeaderSkeleton"),js=j6(ek),jo((jp=n((jh=function(n){w(c,n);var I,L,O=k(c);function c(){var n;C(this,c);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=O.call.apply(O,[this].concat(k)),_(n,"container",jp,A(n)),n}return T(c,[{key:"__preload",value:function(){this.uiOpacity=this.getComponent(eH),this.validateRequiredComponents()}},{key:"hide",value:(L=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=this;return[4,N.runTweenAsync(ez(this.uiOpacity).to(.2,{opacity:0}).call(function(){w.node.active=!1}),n)];case 1:k.sent();return[2]}})}),function(n){return L.apply(this,arguments)})},{key:"show",value:(I=M(function(n,w){var k,C,_,A;return _ts_generator(this,function(T){switch(T.label){case 0:this.node.active=!0,this.node.scale=new eQ(.8,.8,.8),this.uiOpacity.opacity=0;k=this.container.position.clone();this.container.position=new eQ(k.x,k.y-100,k.z);C=ez(this.node).delay(n);C.to(.2,{scale:eQ.ONE},{easing:"elasticOut"});_=ez(this.container).delay(n);_.to(.2,{position:k},{easing:"backOut"});A=ez(this.uiOpacity).delay(n);A.to(.2,{opacity:255},{easing:"cubicOut"});return[4,Promise.all([N.runTweenAsync(C,w),N.runTweenAsync(_,w),N.runTweenAsync(A,w)])];case 1:T.sent(),this.node.scale=eQ.ONE,this.container.position=k,this.uiOpacity.opacity=255;return[2]}})}),function(n,w){return I.apply(this,arguments)})},{key:"validateRequiredComponents",value:function(){if(!this.uiOpacity)throw new Error("UIOpacity component is not attached to the same node");if(!this.container)throw new Error("Container is not attached to the same node")}}]),c}(eO)).prototype,"container",[js],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=jh))||jl);ew._RF.pop(),ew._RF.push({},"cdaa9B4pK9PFrDmP6/GQcMn","TournamentDetailScreen",void 0);var j9=eS.ccclass,j7=eS.property,Ye=eS.requireComponent,Yt=GameCore,Yn=Yt.Events,Yi=Yt.Utils,Ya=Yi.Object,Yr=Yi.Time,Yo=Yi.Number,Ys=globalThis.game,Yl=Ys.event,Yh=Ys.storage,Yp=Ys.player,Yd=Ys.leaderboard,Yy=Ys.language,Yf=1166;jv=j9("TournamentDetailScreen"),jg=Ye(ey),jm=j7(eT),jb=j7(K),jw=j7(K),jS=j7(K),jk=j7(Np),jC=j7(jf),jE=j7({type:ek,group:"Buttons"}),j_=j7({type:ek,group:"Buttons"}),jA=j7({type:ek,group:"Buttons"}),jT=j7({type:ex}),jP=j7({type:ek}),jR=j7({type:ek}),jI=j7({type:[j8]}),jL=j7(yg),jO=j7({type:e_,group:"Container"}),jD=j7({type:e_,group:"Container"}),jM=z.onlyRunInLifeCycleAsync,jN=z.onlyRunInLifeCycleAsync,jz=z.onlyRunInLifeCycleAsync,jB=z.onlyRunInLifeCycleAsync,jF=z.onlyRunInLifeCycleAsync,jx=z.onlyRunInLifeCycle,jU=z.onlyRunInLifeCycle,jv(jG=jg((jV=n((jH=function(n){w(P,n);var I,O,D,N,x,U,H,V,q,W,K,j,Y,X=k(P);function P(){var n;C(this,P);for(var w=arguments.length,k=new Array(w),T=0;T<w;T++)k[T]=arguments[T];return n=X.call.apply(X,[this].concat(k)),_(n,"title",jV,A(n)),_(n,"titleLocalizer",jq,A(n)),_(n,"timeLocalizer",jW,A(n)),_(n,"playerCountLocalizer",jK,A(n)),_(n,"tournamentLeaders",jj,A(n)),_(n,"topLeaders",jY,A(n)),_(n,"playButton",jX,A(n)),_(n,"continueButton",jZ,A(n)),_(n,"replayButton",jJ,A(n)),_(n,"banner",jQ,A(n)),_(n,"bannerLoadingRing",j$,A(n)),_(n,"bannerMask",j0,A(n)),_(n,"leaderSkeletons",j1,A(n)),_(n,"paperConfetti",j2,A(n)),_(n,"container",j4,A(n)),_(n,"tempContainer",j3,A(n)),n.signal=new F,n.leadersPayload=null,n.handleOpeningScreen=function(w){if(!n.screen)throw new Error("TournamentDetailScreen: screen not found");n.validateEventPayload(w)&&(n.enabled=!0)},n.handleOpenedScreen=function(w){n.validateEventPayload(w)&&n.open()},n}return T(P,[{key:"__preload",value:function(){this.enabled=!1,this.screen=this.getComponent(ey),this.validateRequiredComponents(),this.listenScreenEvents()}},{key:"onDestroy",value:function(){this.unListenScreenEvents()}},{key:"validateRequiredComponents",value:function(){z.lazyValidateProperties(this)}},{key:"listenScreenEvents",value:function(){Yl.on(Yn.OPENING_SCREEN,this.handleOpeningScreen),Yl.on(Yn.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"unListenScreenEvents",value:function(){Yl.off(Yn.OPENING_SCREEN,this.handleOpeningScreen),Yl.off(Yn.OPENED_SCREEN,this.handleOpenedScreen)}},{key:"validateEventPayload",value:function(n){return(null!=n?n:{}).screenName===this.node.name&&(this.payload=n,!0)}},{key:"open",value:function(){this.updateContainer(),this.setInteractableButtons(!0),this.tournamentLeaders.hideLeaders(),this.topLeaders.hideLeaders(),this.updateButtonVisibility(),this.setPlayerCountWaiting(),this.runPopUpAnimation(),this.node.scene.emit(i9.HIDE_UI),this.updateInfo()}},{key:"close",value:function(){en.closeTournamentDetailScreen(),this.setInteractableButtons(!1),this.node.scene.emit(i9.SHOW_UI),this.cleanup()}},{key:"cleanup",value:function(){var n;null===(n=this.signal)||void 0===n||n.abort(),this.signal=new F,this.tournamentLeaders.hideLeaders(),this.topLeaders.hideLeaders()}},{key:"runPopUpAnimation",value:function(){this.screen.container||console.warn("StartLevelScreen: screen not found")}},{key:"updateInfo",value:(Y=M(function(){var n,w,k,C,_,A,T,I,L,O,D,M,N,z,B,F,x,U,G,H,V,q,W,K,j,Y,X,Z,J,Q,$,ee;return _ts_generator(this,function(et){switch(et.label){case 0:T=this,I=this.signal,L=null===(n=this.payload)||void 0===n||null===(n=n.screenData)||void 0===n?void 0:n.tournament;if(!L)return[3,9];O=null===(w=null===(k=this.payload.screenData)||void 0===k?void 0:k.playAnimation)||void 0===w||w,D=JSON.parse(L);D.id=D.id.toString(),this.tournamentPayload=D;M=this.tournamentPayload,N=M.endTime,z=M.payload,B=M.title,F=M.tournamentType,x=z.leaderboardId,U=void 0===x?"":x,G=z.themeId,H=z.playerName;"PAGE_HOSTED"===F?this.updateTitleTournamentTitle(B):this.updateTitleWithPlayerName(null!=H?H:B),this.updateEndTime(N),this.updateTournamentBanner(G,I);V=Yh.getStorage("tournament"),q=V.previousScore,W=V.animateTournamentLeader;Yh.setStorageData("tournament","animateTournamentLeader",!1),this.updateButtonsVisibility(W);return[4,this.showLoading(I)];case 1:et.sent();return[4,this.loadLeaders(U)];case 2:if(et.sent(),!!this.leadersPayload&&0!==this.leadersPayload.leaders.length&&!I.aborted)return[3,4];this.updatePlayerCount(0);return[4,this.hideLoading(I)];case 3:return[2,void et.sent()];case 4:K=this.leadersPayload,j=K.player,Y=K.amountPlayer,X=null!==(C=this.leadersPayload.leaders)&&void 0!==C?C:[];X.sort(function(n,w){return n.rank-w.rank});return[4,this.hideLoading(I)];case 5:if(et.sent(),!this.topLeaders||!this.tournamentLeaders||!!I.aborted)return[3,9];this.updatePlayerCount(Y),this.topLeaders.updateData(X),this.topLeaders.playShowLeadersAnimation(I);Z=null!==(_=null==j?void 0:j.score)&&void 0!==_?_:0,J=null!==(A=null==j?void 0:j.rank)&&void 0!==A?A:0,Q=W&&-1!==q&&q<Z;this.tournamentLeaders.updateData(X);$=!1;j&&Q&&($=this.tournamentLeaders.updateDisplayPlayerLeaderForRankChanging(q,Z,J)),this.tournamentLeaders.initScrollViews(),this.tournamentLeaders.scrollView.scrollView.enabled=!0;return[4,I.callAsync(function(n){return T.runShowUpAnimation(n,O)})];case 6:et.sent();ee=W&&$&&-1!==q&&this.tournamentLeaders;if(!ee)return[3,8];return[4,I.callAsync(function(n){return T.tournamentLeaders.playRankChangeAnimation(n,q,Z,J)})];case 7:ee=(et.sent(),this.tryPlayConfettiEffect(J));et.label=8;case 8:et.label=9;case 9:return[2]}})}),function(){return Y.apply(this,arguments)})},{key:"updateContainer",value:(j=M(function(){var n;return _ts_generator(this,function(w){n=this.tempContainer.height;this.container.node.position=this.tempContainer.node.position.clone(),n<Yf&&this.container.height!==n?(this.container.height=n,e1.instance.emit("canvas-resize")):n>Yf&&this.container.height<Yf&&(this.container.height=Yf,e1.instance.emit("canvas-resize"));return[2]})}),function(){return j.apply(this,arguments)})},{key:"loadLeaders",value:(K=M(function(n){var w;return _ts_generator(this,function(k){switch(k.label){case 0:w=this;return[4,this.getLeadersPayload(n)];case 1:w.leadersPayload=k.sent();return[2]}})}),function(n){return K.apply(this,arguments)})},{key:"showLoading",value:(W=M(function(n){var w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:w=this,k=C.length>1&&void 0!==C[1]?C[1]:0;return[4,Promise.all([this.tournamentLeaders.scrollView.unlistenEvents(),this.tournamentLeaders.scrollView.scrollToTop(n,.1).then(function(){w.tournamentLeaders.scrollView.scrollView.enabled=!1,w.tournamentLeaders.scrollView.listenEvents()}),this.leaderSkeletons.map(function(w,C){return w.show(C*k,n)})])];case 1:_.sent();return[2]}})}),function(n){return W.apply(this,arguments)})},{key:"hideLoading",value:(q=M(function(n){return _ts_generator(this,function(w){switch(w.label){case 0:return[4,Promise.all(this.leaderSkeletons.map(function(w){return w.hide(n)}))];case 1:w.sent();return[2]}})}),function(n){return q.apply(this,arguments)})},{key:"runShowUpAnimation",value:(V=M(function(n){var w,k;var C=arguments;return _ts_generator(this,function(_){switch(_.label){case 0:w=!(C.length>1&&void 0!==C[1])||C[1],k=w?0:.1;return[4,this.tournamentLeaders.playShowLeadersAnimation(n,k)];case 1:_.sent();return[4,this.tournamentLeaders.scrollToPlayerLeader(1.5,n)];case 2:_.sent();return[2]}})}),function(n){return V.apply(this,arguments)})},{key:"tryPlayConfettiEffect",value:function(n){if(!(n>10)){var w,k=L(this.paperConfetti);try{for(k.s();!(w=k.n()).done;)w.value.play()}catch(n){k.e(n)}finally{k.f()}G.playSound(nL.LEADERBOARD_TRIUMPH)}}},{key:"updateTitleWithPlayerName",value:function(n){void 0!==n&&(this.titleLocalizer.enabled=!0,this.titleLocalizer.setParams([n]))}},{key:"updateTitleTournamentTitle",value:function(n){this.titleLocalizer.enabled=!1,this.title.string=n}},{key:"updateEndTime",value:function(n){try{var w=Yr.getRelativeTime(n,Yy.getCurrentLocale(),{style:"short"});this.timeLocalizer.key="game.endsIn",this.timeLocalizer.setParams([w])}catch(n){this.timeLocalizer.key="game.endsSoon"}}},{key:"updateTournamentBanner",value:(H=M(function(n,w){var k,C,_;return _ts_generator(this,function(A){switch(A.label){case 0:this.banner.spriteFrame=null;k=B.getAsset("".concat(eb[n],"/spriteFrame"),e9);C=k;if(C)return[3,2];this.bannerMask.active=!0,this.bannerLoadingRing.active=!0;return[4,B.loadThemeTournamentAsync(n)];case 1:C=k=A.sent();A.label=2;case 2:_=k;if(_)return[3,4];return[4,B.loadThemeTournamentAsync(el.SUMMER)];case 3:_=k=A.sent();A.label=4;case 4:this.banner&&k&&!w.aborted&&(this.banner.spriteFrame=k,this.bannerMask.active=!1,this.bannerLoadingRing.active=!1);return[2]}})}),function(n,w){return H.apply(this,arguments)})},{key:"updatePlayerCount",value:function(n){var w=Yo.getShortNumber(n,3);1===n?this.playerCountLocalizer.key="game.player":(this.playerCountLocalizer.key="game.nPlayers",this.playerCountLocalizer.setParams([w]))}},{key:"setPlayerCountWaiting",value:function(){this.playerCountLocalizer.key="status.loading"}},{key:"getLeadersPayload",value:(U=M(function(n){var w,k,C,_,A,T,I,O,D;return _ts_generator(this,function(M){switch(M.label){case 0:w=Yd.getLeaderboardName(n);if(!w)return[2,null];return[4,sL.getAllLeaderboardAsync(n)];case 1:k=M.sent();if(!k)return[2,null];_=Ya.vals(k.leaders),A=Yp.getPlayerId(),T={leaders:[],amountPlayer:k.amountPlayer},I=L(_);try{for(I.s();!(C=I.n()).done;){O=C.value;O.playerId===A?(T.player=O,T.leaders.push(O)):T.leaders.push(O)}}catch(n){I.e(n)}finally{I.f()}if(!!T.player)return[3,3];return[4,Yd.getLeadersByPlayerIdsAsync(w,[A])];case 2:D=M.sent();D&&D.length>0&&(T.player=D[0],T.leaders.push(D[0]));M.label=3;case 3:return[2,T]}})}),function(n){return U.apply(this,arguments)})},{key:"updateButtonsVisibility",value:function(n){this.playButton.active=!n,this.continueButton.active=n,this.replayButton.active=n}},{key:"handleOnPlay",value:(x=M(function(){var n,w,k;return _ts_generator(this,function(C){switch(C.label){case 0:n=this.tournamentPayload.id||"";if(et.validateTournamentExpired(n))return[2,(this.close(),this.node.scene.emit(sT.RELOAD_TOURNAMENT),void en.showNotificationScreenWithLocalizedKey("error.tourEnded",2))];C.label=1;case 1:C.trys.push([1,4,9,10]);en.showLoadingScreen();return[4,sQ.setMatchCustomDataAsync({level:1,score:0})];case 2:C.sent();return[4,this.processJoinTournament()];case 3:C.sent();return[3,10];case 4:w=C.sent();if(Ya.hasOwn(w,"code")&&"USER_INPUT"===w.code)return[2];C.label=5;case 5:C.trys.push([5,7,,8]);return[4,this.processContinueTournament()];case 6:C.sent();return[3,8];case 7:k=C.sent();if(Ya.hasOwn(k,"code")&&"USER_INPUT"===k.code)return[2];console.error("processPlayButtonPressed",k),en.showNotificationScreenWithLocalizedKey("error.tourJoinFail",2);return[3,8];case 8:return[3,10];case 9:en.closeLoadingScreen();return[7];case 10:return[2]}})}),function(){return x.apply(this,arguments)})},{key:"processJoinTournament",value:(N=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:w.trys.push([0,2,,3]);return[4,this.joinTournamentAsync()];case 1:w.sent(),es.switchScene(eu.GAME_SCENE,{level:1});return[3,3];case 2:n=w.sent();throw console.warn("processJoinTournament",n),n;case 3:return[2]}})}),function(){return N.apply(this,arguments)})},{key:"processContinueTournament",value:(D=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:w.trys.push([0,2,,3]);return[4,this.continueTournamentAsync()];case 1:w.sent(),es.switchScene(eu.GAME_SCENE,{level:1});return[3,3];case 2:n=w.sent();throw console.warn("processContinueTournament",n),n;case 3:return[2]}})}),function(){return D.apply(this,arguments)})},{key:"joinTournamentAsync",value:(O=M(function(){var n;return _ts_generator(this,function(w){switch(w.label){case 0:n=this.tournamentPayload.id||"";return[4,sQ.joinTournamentAsync(n)];case 1:w.sent();return[2]}})}),function(){return O.apply(this,arguments)})},{key:"continueTournamentAsync",value:(I=M(function(){var n,w;return _ts_generator(this,function(k){switch(k.label){case 0:w=null!==(n=GameSDK.context.getID())&&void 0!==n?n:"";return[4,sQ.continueTournamentAsync(w)];case 1:k.sent();return[2]}})}),function(){return I.apply(this,arguments)})},{key:"updateButtonVisibility",value:function(){var n,w,k=(null!==(n=null===(w=this.payload)||void 0===w?void 0:w.screenData)&&void 0!==n?n:{}).tournamentContextType;switch(void 0===k?"tournament_start":k){case"tournament_end":this.playButton.active=!1,this.continueButton.active=!0,this.replayButton.active=!0;break;case"tournament_start":this.playButton.active=!0,this.continueButton.active=!1,this.replayButton.active=!1}}},{key:"setInteractableButtons",value:function(n){this.screen.backgroundMask.getComponent(eI).interactable=n}}]),P}(eO)).prototype,"title",[jm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jq=n(jH.prototype,"titleLocalizer",[jb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jW=n(jH.prototype,"timeLocalizer",[jw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jK=n(jH.prototype,"playerCountLocalizer",[jS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jj=n(jH.prototype,"tournamentLeaders",[jk],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jY=n(jH.prototype,"topLeaders",[jC],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jX=n(jH.prototype,"playButton",[jE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jZ=n(jH.prototype,"continueButton",[j_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jJ=n(jH.prototype,"replayButton",[jA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jQ=n(jH.prototype,"banner",[jT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j$=n(jH.prototype,"bannerLoadingRing",[jP],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j0=n(jH.prototype,"bannerMask",[jR],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j1=n(jH.prototype,"leaderSkeletons",[jI],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j2=n(jH.prototype,"paperConfetti",[jL],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j4=n(jH.prototype,"container",[jO],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j3=n(jH.prototype,"tempContainer",[jD],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),n(jH.prototype,"updateInfo",[jM],Object.getOwnPropertyDescriptor(jH.prototype,"updateInfo"),jH.prototype),n(jH.prototype,"loadLeaders",[jN],Object.getOwnPropertyDescriptor(jH.prototype,"loadLeaders"),jH.prototype),n(jH.prototype,"showLoading",[jz],Object.getOwnPropertyDescriptor(jH.prototype,"showLoading"),jH.prototype),n(jH.prototype,"hideLoading",[jB],Object.getOwnPropertyDescriptor(jH.prototype,"hideLoading"),jH.prototype),n(jH.prototype,"runShowUpAnimation",[jF],Object.getOwnPropertyDescriptor(jH.prototype,"runShowUpAnimation"),jH.prototype),n(jH.prototype,"tryPlayConfettiEffect",[jx],Object.getOwnPropertyDescriptor(jH.prototype,"tryPlayConfettiEffect"),jH.prototype),n(jH.prototype,"updatePlayerCount",[jU],Object.getOwnPropertyDescriptor(jH.prototype,"updatePlayerCount"),jH.prototype),jG=jH))||jG);ew._RF.pop(),ew._RF.push({},"36d58kn8v5POaqgX4C8S3ct","TournamentLeader",void 0);(0,eS.ccclass)("TournamentLeader")(function(n){w(o,n);var _=k(o);function o(){return C(this,o),_.apply(this,arguments)}return T(o)}(MW));ew._RF.pop()}}});(function(n){n("virtual:///prerequisite-imports/main","chunks:///main.js")})(function(n,w){System.register(n,[w],function(n,w){return{setters:[function(w){var k={};for(var C in w)if("default"!==C&&"__esModule"!==C)k[C]=w[C];n(k)}],execute:function(){}}})});