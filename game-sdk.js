function _instanceof(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return e instanceof t}function _array_like_to_array(e,t){if(null==t||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _assert_this_initialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function asyncGeneratorStep(e,t,n,r,a,o,i){try{var s=e[o](i);var u=s.value}catch(e){n(e);return}if(s.done)t(u);else Promise.resolve(u).then(r,a)}function _async_to_generator(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function _next(e){asyncGeneratorStep(o,r,a,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(o,r,a,_next,_throw,"throw",e)}_next(void 0)})}}function _class_call_check(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _construct(){_construct=_is_native_reflect_construct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=Function.bind.apply(e,r);var o=new a;if(n)_set_prototype_of(o,n.prototype);return o};return _construct.apply(null,arguments)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function _create_class(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}function _define_property(e,t,n){if(t in e)Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true});else e[t]=n;return e}function _get(e,t,n){_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_super_prop_base(e,t);if(!r)return;var a=Object.getOwnPropertyDescriptor(r,t);if(a.get)return a.get.call(n||e);return a.value};return _get(e,t,n||e)}function _get_prototype_of(e){_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return _get_prototype_of(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_set_prototype_of(e,t)}function _instanceof1(e,t){if(null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance])return!!t[Symbol.hasInstance](e);return _instanceof(e,t)}function _is_native_function(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};var r=Object.keys(n);if("function"==typeof Object.getOwnPropertySymbols)r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}));r.forEach(function(t){_define_property(e,t,n[t])})}return e}function _possible_constructor_return(e,t){if(t&&("object"===_type_of(t)||"function"==typeof t))return t;return _assert_this_initialized(e)}function _set_prototype_of(e,t){_set_prototype_of=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return _set_prototype_of(e,t)}function _super_prop_base(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=_get_prototype_of(e);if(null===e)break}return e}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,t){if(!e)return;if("string"==typeof e)return _array_like_to_array(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor)n=e.constructor.name;if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(e,t)}function _wrap_native_super(e){var t="function"==typeof Map?new Map:void 0;_wrap_native_super=function(e){if(null===e||!_is_native_function(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_get_prototype_of(this).constructor)}Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _set_prototype_of(Wrapper,e)};return _wrap_native_super(e)}function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"==typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function _create_super(e){var t=_is_native_reflect_construct();return function(){var n=_get_prototype_of(e),r;if(t){var a=_get_prototype_of(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possible_constructor_return(this,r)}}function _ts_generator(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function verb(e){return function(t){return step([e,t])}}function step(o){if(n)throw new TypeError("Generator is already executing.");while(i)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;if(r=0,a)o=[2&o[0],a.value];switch(o[0]){case 0:case 1:a=o;break;case 4:i.label++;return{value:o[1],done:false};case 5:i.label++;r=o[1];o=[0];continue;case 7:o=i.ops.pop();i.trys.pop();continue;default:if(a=i.trys,!(a=a.length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1];a=o;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(o);break}if(a[2])i.ops.pop();i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e];r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}(function(){"use strict";var e=Object.defineProperty;var t=Object.getOwnPropertyNames;var __defNormalProp=function(t,n,r){return n in t?e(t,n,{enumerable:true,configurable:true,writable:true,value:r}):t[n]=r};var __name=function(t,n){return e(t,"name",{value:n,configurable:true})};var __esm=function(e,n){return function(){return e&&(n=(0,e[t(e)[0]])(e=0)),n}};var __export=function(t,n){for(var r in n)e(t,r,{get:n[r],enumerable:true})};var __publicField=function(e,t,n){return __defNormalProp(e,(void 0===t?"undefined":_type_of(t))!=="symbol"?t+"":t,n)};var n;var r=__esm({"<define:__GAME_SDK_CONFIG__>":function(){n={MSGames:{UseLoginFeature:false}}}});var a=__esm({"<define:__INIT_CONFIG__>":function(){}});var o={};__export(o,{default:function(){return i}});var i;var s=__esm({"libs/empty-script.js":function(){"use strict";r();a();i={}}});r();a();s();s();s();s();s();r();a();r();a();r();a();var u=function(){function _Context(e){var t=this;_class_call_check(this,_Context);__publicField(this,"adapter");__publicField(this,"extra");__publicField(this,"currentContextID",null);__publicField(this,"currentContextType","SOLO");__publicField(this,"currentContextPlayers",[]);__publicField(this,"chooseAsyncPopup",null);__publicField(this,"createAsyncPopup",null);__publicField(this,"switchAsyncPopup",null);__publicField(this,"contextIdsByCreate");__publicField(this,"contextIdsByChoose",[]);__publicField(this,"playerIdsInContexts");__publicField(this,"handleOnYes",__name(function(e){return function(){t.extra.isPopupShown=false;e(true)}},"handleOnYes"));__publicField(this,"handleOnNo",__name(function(e){return function(){t.extra.isPopupShown=false;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},"handleOnNo"));this.adapter=e;this.extra=e.extra}_create_class(_Context,[{key:"setCurrentContextId",value:function(e){this.checkSameContext(e);this.currentContextID=e;this.currentContextType="THREAD"}},{key:"initContextInfo",value:function(e,t){var n=GameCore.Utils,r=n.Array,a=n.Number;this.contextIdsByCreate={};this.playerIdsInContexts={};this.contextIdsByChoose=r.fillWith(10,function(){return a.random(10).toString()});if(!e||!t)return;if(["SOLO","THREAD","POST","GROUP"].indexOf(t)<0){console.warn("Invalid context type: ".concat(t));return}this.currentContextID=e;this.currentContextType=t}},{key:"getID",value:function(){return this.currentContextID}},{key:"getType",value:function(){return this.currentContextType}},{key:"loadSwitchAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.switchAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.switchAsyncPopup=new t;return[2]}})})()}},{key:"loadChooseAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.chooseAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.chooseAsyncPopup=new t;return[2]}})})()}},{key:"loadCreateAsyncPopup",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.createAsyncPopup=new t;return[2]}})})()}},{key:"switchAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=this;return _async_to_generator(function(){var t,a;return _ts_generator(this,function(o){switch(o.label){case 0:r.extra.checkPopupShown();return[4,r.extra.awaitRandomDelay()];case 1:o.sent();r.validateSwitchAsyncContextId(e);if("SOLO"===e&&n){r.currentContextID=null;r.currentContextType="SOLO";r.updatePlayers([]);return[2]}return[4,r.loadSwitchAsyncPopup()];case 2:o.sent();return[4,new Promise(function(t,n){if(!r.switchAsyncPopup)r.adapter.extra.exceptionUnsupported();r.switchAsyncPopup.onYes(r.handleOnYes(t));r.switchAsyncPopup.onNo(r.handleOnNo(n));r.switchAsyncPopup.show(e);r.extra.isPopupShown=true})];case 3:o.sent();r.currentContextID=e;r.currentContextType="THREAD";r.createPlayerIdsInContext(e,10);t=r.playerIdsInContexts[e];a=t.map(function(e){return r.createPlayerInfo(e)});r.updatePlayers(a);return[2]}})})()}},{key:"chooseAsync",value:function(e){var t=this;return _async_to_generator(function(){var e,n,r,a;return _ts_generator(this,function(o){switch(o.label){case 0:t.extra.checkPopupShown();return[4,t.extra.awaitRandomDelay()];case 1:o.sent();return[4,t.loadChooseAsyncPopup()];case 2:o.sent();return[4,new Promise(function(e,n){if(!t.chooseAsyncPopup)t.adapter.extra.exceptionUnsupported();t.chooseAsyncPopup.onYes(t.handleOnYes(e));t.chooseAsyncPopup.onNo(t.handleOnNo(n));t.chooseAsyncPopup.show();t.extra.isPopupShown=true})];case 3:o.sent();e=Math.floor(Math.random()*t.contextIdsByChoose.length);n=t.contextIdsByChoose[e];t.checkSameContext(n);t.currentContextID=n;t.currentContextType="THREAD";t.createPlayerIdsInContext(n,2);r=t.playerIdsInContexts[n];a=r.map(function(e){return t.createPlayerInfo(e)});t.updatePlayers(a);return[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.extra.awaitRandomDelay()];case 1:a.sent();return[4,t.validateCreateAsyncPlayerId(e)];case 2:a.sent();return[4,t.loadCreateAsyncPopup()];case 3:a.sent();return[4,new Promise(function(n,r){if(!t.createAsyncPopup)t.adapter.extra.exceptionUnsupported();t.createAsyncPopup.onYes(t.handleOnYes(n));t.createAsyncPopup.onNo(t.handleOnNo(r));t.createAsyncPopup.show(e);t.extra.isPopupShown=true})];case 4:a.sent();if(!t.contextIdsByCreate[e])t.contextIdsByCreate[e]=GameCore.Utils.Number.random(10).toString();n=t.contextIdsByCreate[e];t.checkSameContext(n);t.currentContextID=n;t.currentContextType="THREAD";r=t.createPlayerInfo(e);t.updatePlayers([r]);return[2]}})})()}},{key:"getPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.extra.awaitRandomDelay()];case 1:t.sent();return[2,e.currentContextPlayers]}})})()}},{key:"createPlayerIdsInContext",value:function(e,t){if(!this.playerIdsInContexts[e]){var n=GameCore.Utils,r=n.Array,a=n.Number;var o=Math.floor(Math.random()*t);var i=r.fillWith(o,function(){return a.random(10).toString()});this.playerIdsInContexts[e]=i}return this.playerIdsInContexts[e]}},{key:"createPlayerInfo",value:function(e){return{getID:__name(function(){return e},"getID"),getName:__name(function(){return"Player ".concat(e)},"getName"),getPhoto:__name(function(){return""},"getPhoto")}}},{key:"updatePlayers",value:function(e){if("SOLO"===this.currentContextType){this.currentContextPlayers=[];return}this.currentContextPlayers=e}},{key:"checkSameContext",value:function(e){if(this.currentContextID===e)this.extra.exceptionSameContext()}},{key:"validateCreateAsyncPlayerId",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s;return _ts_generator(this,function(u){switch(u.label){case 0:if(!e||Array.isArray(e)){n="Client does not support no player IDS or multiple player IDs yet";t.extra.exceptionClientUnsupportedOperation(n)}if(!GameCore.Utils.Valid.isString(e)){r="Array of type String contained a value of another type: ".concat(e);t.extra.exceptionInvalidParam(r)}if(e===GameSDK.player.getID()){a="'At least one player id besides the current player must be provided.'";t.extra.exceptionInvalidParam(a)}return[4,GameSDK.player.getConnectedPlayersAsync()];case 1:o=u.sent();i=o.some(function(t){return t.getID()===e});if(i)return[2];s="Provided ID ".concat(e," is not a connected player of the current player.");t.extra.exceptionInvalidParam(s);return[2]}})})()}},{key:"validateSwitchAsyncContextId",value:function(e){this.checkSameContext(e);if(GameCore.Utils.Valid.isString(e))return;var t="Client requires update to support this operation";this.extra.exceptionClientUnsupportedOperation(t)}}]);return _Context}();__name(u,"Context");var c=u;var l=c;r();a();r();a();var _='\n<div id="lds-dual-ring"></div>\n<div id="lds-text">\n    <span id="lds-percent">0</span>%\n</div>\n';var d="#lds-dual-ring{width:64px;height:64px;border-radius:50%;border:6px solid #fff;border-color:#515151 transparent #fff transparent;animation:lds-dual-ring 1.2s linear infinite;-webkit-animation:lds-dual-ring 1.2s linear infinite}#lds-text{color:#fff;font-family:monospace;display:flex;font-size:1.2rem;position:absolute;justify-content:center;align-content:center;align-items:center;width:100%;height:100%;text-shadow:0 .5px 1px #999}#lds-content{top:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;position:absolute;background-color:#515151;pointer-events:none;transition:background-color .5s ease-in-out}@keyframes lds-dual-ring{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}";var f="lds-content";var y=function(){function _LoadingScreenElement(){var e=this;_class_call_check(this,_LoadingScreenElement);__publicField(this,"percentage",0);document.addEventListener("DOMContentLoaded",function(){e.createLoadingElement();e.addLoadingElementStyle();var t=new MutationObserver(function(){var t=document.getElementById("GameDiv");if(!t)return;e.setupLoadingElementSizeAndPosition()});var n={attributes:true,childList:true,subtree:true};var r=document.body;t.observe(r,n)})}_create_class(_LoadingScreenElement,[{key:"createLoadingElement",value:function(){var e=document.createElement("div");e.id=f;e.innerHTML=_;document.body.appendChild(e);return e}},{key:"addLoadingElementStyle",value:function(){var e=document.createElement("style");var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e);e.appendChild(document.createTextNode(d))}},{key:"setupLoadingElementSizeAndPosition",value:function(){var e=document.getElementById(f);if(!e)return;var t=document.getElementById("GameDiv");if(!t)return;var n=t.getBoundingClientRect(),r=n.width,a=n.height;e.style.width="".concat(r,"px");e.style.height="".concat(a,"px");var o=document.body.getBoundingClientRect(),i=o.width,s=o.height;e.style.left="".concat((i-r)/2,"px");e.style.top="".concat((s-a)/2,"px")}},{key:"setLoadingProgress",value:function(e){if(e===this.percentage)return;if(this.percentage>e)return;this.percentage=e;var t=document.getElementById("lds-percent");if(!t)return;t.innerHTML="".concat(e);var n=document.getElementById(f);if(!n)return;var r=Math.min(.9,.1+e/100);n.style.backgroundColor="rgba(81, 81, 81, ".concat(r,")")}},{key:"removeLoadingElement",value:function(){var e=document.getElementById(f);if(!e)return;e.style.backgroundColor="rgba(81, 81, 81, 0)";setTimeout(function(){e.remove()},300)}}]);return _LoadingScreenElement}();__name(y,"LoadingScreenElement");var p=y;var h=p;r();a();var m=function(e){_inherits(_SDKCommonError,e);var t=_create_super(_SDKCommonError);function _SDKCommonError(e,n){_class_call_check(this,_SDKCommonError);var r;r=t.call(this,n);__publicField(_assert_this_initialized(r),"code");r.code=e;return r}return _SDKCommonError}(_wrap_native_super(Error));__name(m,"SDKCommonError");var v=m;var g=v;var w=function(){function _Extra(e){_class_call_check(this,_Extra);__publicField(this,"adapter");__publicField(this,"isPopupShown",false);__publicField(this,"maxWaitGameCoreReadyTime",1e4);__publicField(this,"loadingElement",null);this.adapter=e}_create_class(_Extra,[{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,e.adapter.player.canSubscribeBotAsync()];case 1:t=i.sent();if(!t)return[2,false];n=window.game.analytics;r=GameCore.Plugins.Analytics.Events,a=r.BOT_SUBSCRIBE,o=r.BOT_SUBSCRIBE_POPUP;n.event(o);i.label=2;case 2:i.trys.push([2,5,,6]);return[4,e.waitSDKInitiatedAsync()];case 3:i.sent();return[4,e.adapter.player.subscribeBotAsync()];case 4:i.sent();n.event(a,{success:true});return[2,true];case 5:i.sent();n.event(a,{success:false});return[2,false];case 6:return[2]}})})()}},{key:"checkAndCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,e.adapter.canCreateShortcutAsync()];case 1:t=i.sent();if(!t)return[2];n=window.game.analytics;r=GameCore.Plugins.Analytics.Events,a=r.SHORTCUT_CREATE,o=r.SHORTCUT_CREATE_POPUP;n.event(o);i.label=2;case 2:i.trys.push([2,5,,6]);return[4,e.waitSDKInitiatedAsync()];case 3:i.sent();return[4,e.adapter.createShortcutAsync()];case 4:i.sent();n.event(a,{success:true});return[3,6];case 5:i.sent();n.event(a,{success:false});return[3,6];case 6:return[2]}})})()}},{key:"waitSDKInitiatedAsync",value:function(){return GameCore.Utils.Valid.isValueChangeAsync(window.__sdkInitiated,true)}},{key:"waitGameCoreReadyAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=0;return[2,new Promise(function(n){var r=setInterval(function(){if("GameCore"in window){clearInterval(r);n();return}t+=100;if(t>e.maxWaitGameCoreReadyTime){t=0;console.warn("GameCore is slow to load, please check your network connection.")}},100)})]})})()}},{key:"createLoadingElement",value:function(){if(this.loadingElement)return;this.loadingElement=new h}},{key:"setLoadingElementProgress",value:function(e){if(!this.loadingElement)return;this.loadingElement.setLoadingProgress(e)}},{key:"destroyLoadingElement",value:function(){if(!this.loadingElement)return;this.loadingElement.removeLoadingElement()}},{key:"checkPopupShown",value:function(){if(!this.isPopupShown)return;this.exceptionPendingRequest("Please wait for the popup to close")}},{key:"delayInitialAsync",value:function(){return _async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:e=GameCore.Configs.Mockup.GameSDK.SlowAPI;if(!e.Enabled||e.InitialDelay<=0)return[2];return[4,GameCore.Utils.Time.sleepAsync(e.InitialDelay)];case 1:t.sent();return[2]}})})()}},{key:"delayStartAsync",value:function(){return _async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:e=GameCore.Configs.Mockup.GameSDK.SlowAPI;if(!e.Enabled||e.StartDelay<=0)return[2];return[4,GameCore.Utils.Time.sleepAsync(e.StartDelay)];case 1:t.sent();return[2]}})})()}},{key:"delayPlayerDataAsync",value:function(){return _async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:e=GameCore.Configs.Mockup.GameSDK.SlowAPI;if(!e.Enabled||e.PlayerDataDelay<=0)return[2];return[4,GameCore.Utils.Time.sleepAsync(e.PlayerDataDelay)];case 1:t.sent();return[2]}})})()}},{key:"awaitRandomDelay",value:function(e){var t=arguments.length>0&&void 0!==e?e:1e3;return GameCore.Utils.Time.sleepAsync(Math.random()*t)}},{key:"randomException",value:function(e){var t=Math.floor(Math.random()*e.length);var n=e[t];console.warn("Random exception",n);this["exception".concat(n)]()}},{key:"throwNewCommonError",value:function(e,t){throw new g(e,t)}},{key:"exceptionUserInput",value:function(e){this.throwNewCommonError("USER_INPUT",e)}},{key:"exceptionUnsupported",value:function(){this.throwNewCommonError("UNSUPPORTED","Unsupported method")}},{key:"exceptionInvalidParam",value:function(e){this.throwNewCommonError("INVALID_PARAM",e)}},{key:"exceptionPendingRequest",value:function(e){this.throwNewCommonError("PENDING_REQUEST",e)}},{key:"exceptionMethodNotImplemented",value:function(){this.throwNewCommonError("METHOD_NOT_IMPLEMENTED","Method not implemented")}},{key:"exceptionTournamentNotFound",value:function(e){this.throwNewCommonError("TOURNAMENT_NOT_FOUND",e)}},{key:"exceptionSameContext",value:function(){this.throwNewCommonError("SAME_CONTEXT","Must specify a context other than the current one.")}},{key:"exceptionInvalidOperation",value:function(e){this.throwNewCommonError("INVALID_OPERATION",e)}},{key:"exceptionNetworkFailure",value:function(e){var t=arguments.length>0&&void 0!==e?e:"Request failed to be processed";this.throwNewCommonError("NETWORK_FAILURE",t)}},{key:"exceptionUnknown",value:function(e){this.throwNewCommonError("UNKNOWN",e)}},{key:"exceptionClientUnsupportedOperation",value:function(e){this.throwNewCommonError("CLIENT_UNSUPPORTED_OPERATION",e)}},{key:"exceptionRateLimited",value:function(e){this.throwNewCommonError("RATE_LIMITED",e)}}]);return _Extra}();__name(w,"Extra");var b=w;var I=b;r();a();var P="Tile Connect Remaster".replace(/ /g,"-");var A=function(){function _Player(e){var t=this;_class_call_check(this,_Player);__publicField(this,"adapter");__publicField(this,"extra");__publicField(this,"defaultPlayerInfo");__publicField(this,"currentPlayerInfo");__publicField(this,"infoKey","".concat(P,"_PlayerInfo"));__publicField(this,"dataKey","".concat(P,"_PlayerData"));__publicField(this,"subscribeBot",null);__publicField(this,"connectedPlayers",null);__publicField(this,"getSignature",__name(function(){var e=t.getSignatureFormMockup();if(GameCore.Utils.Valid.isString(e))return e;return"default_token"},"getSignature"));this.adapter=e;this.extra=e.extra;this.initDefaultPlayerInfo()}_create_class(_Player,[{key:"initDefaultPlayerInfo",value:function(){var e="guest-007";this.defaultPlayerInfo={playerId:e,playerName:"Guest",playerPhoto:"https://picsum.photos/seed/".concat(e,"/300/300")};this.currentPlayerInfo=_object_spread({},this.defaultPlayerInfo)}},{key:"initPlayerInfo",value:function(e){this.updateCurrentPlayerInfo(e);GameCore.Utils.Browser.writeLocalStorage(this.infoKey,this.currentPlayerInfo)}},{key:"canSubscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:t.sent();if(!e.subscribeBot)e.extra.exceptionUnsupported();return[2,e.subscribeBot.canSubscribeBotAsync()]}})})()}},{key:"subscribeBotAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockSubscribeBot()];case 1:t.sent();if(!e.subscribeBot)e.extra.exceptionUnsupported();return[2,e.subscribeBot.subscribeBotAsync()]}})})()}},{key:"getID",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object;var a=t.getLocalStorage(this.infoKey);var o=this.currentPlayerInfo.playerId;if(!n.isObject(a))return o;if(r.hasOwn(a,"playerId")&&n.isString(a.playerId))return a.playerId;return o}},{key:"getName",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object;var a=t.getLocalStorage(this.infoKey);var o=this.currentPlayerInfo.playerName;if(!n.isObject(a))return o;if(r.hasOwn(a,"name")&&n.isString(a.name))return a.name;return o}},{key:"getPhoto",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid,r=e.Object;var a=t.getLocalStorage(this.infoKey);var o=this.currentPlayerInfo.playerPhoto;if(!n.isObject(a))return o;if(r.hasOwn(a,"photo")&&n.isString(a.photo))return a.photo;return o}},{key:"getDataAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s;return _ts_generator(this,function(u){switch(u.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:u.sent();n=GameCore.Utils,r=n.Browser,a=n.Valid,o=n.Object;i=r.getLocalStorage(t.dataKey);if(!a.isObject(i))return[2,{}];if(0===e.length)return[2,i];s={};e.forEach(function(e){if(o.hasOwn(i,e))s[e]=i[e]});return[2,s]}})})()}},{key:"setDataAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:return[4,t.extra.delayPlayerDataAsync()];case 1:n.sent();GameCore.Utils.Browser.writeLocalStorage(t.dataKey,e);return[2]}})})()}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,{getPlayerID:__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},"getPlayerID"),getSignature:e.getSignature}]})})()}},{key:"getConnectedPlayersAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockConnectedPlayers()];case 1:t.sent();if(!e.connectedPlayers)e.extra.exceptionUnsupported();return[2,e.connectedPlayers.getConnectedPlayersAsync()]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){if(!e)return;var t=GameCore.Configs.Mockup.Match;var n=t.PlayerInfo.Id===e;var r=t.OpponentInfo.Id===e;if(n){this.currentPlayerInfo.playerId=t.PlayerInfo.Id;if(t.PlayerInfo.Name)this.currentPlayerInfo.playerName=t.PlayerInfo.Name;if(t.PlayerInfo.Photo)this.currentPlayerInfo.playerPhoto=t.PlayerInfo.Photo}if(r){this.currentPlayerInfo.playerId=t.OpponentInfo.Id;if(t.OpponentInfo.Name)this.currentPlayerInfo.playerName=t.OpponentInfo.Name;if(t.OpponentInfo.Photo)this.currentPlayerInfo.playerPhoto=t.OpponentInfo.Photo}}},{key:"getSignatureFormMockup",value:function(){var e=GameCore.Configs.Mockup.Match;var t=e.PlayerInfo.Id===this.getID();var n=e.OpponentInfo.Id===this.getID();if(t)return e.PlayerInfo.Signature;if(n)return e.OpponentInfo.Signature;return null}},{key:"loadMockSubscribeBot",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.subscribeBot)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.subscribeBot=new t(e.adapter);return[2]}})})()}},{key:"loadMockConnectedPlayers",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.connectedPlayers)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.connectedPlayers=new t(e.extra);return[2]}})})()}}]);return _Player}();__name(A,"Player");var x=A;var S=x;r();a();r();a();var k=function(){function _TournamentInstance(e,t,n){var r=arguments.length>2&&void 0!==n&&n;_class_call_check(this,_TournamentInstance);__publicField(this,"id");__publicField(this,"title");__publicField(this,"contextId");__publicField(this,"payload");__publicField(this,"endTime");__publicField(this,"tournamentType");var a=t.config,o=t.data;this.id=e;this.title=a.title;this.contextId="0123".concat(this.id);this.payload=JSON.stringify(null!=o?o:{});var i;this.endTime=null!==(i=a.endTime)&&void 0!==i?i:this.defaultEndTime();this.tournamentType=r?"PAGE_HOSTED":"DEFAULT"}_create_class(_TournamentInstance,[{key:"defaultEndTime",value:function(){return Math.round((Date.now()+6048e5)/1e3)}},{key:"getID",value:function(){return this.id}},{key:"getTitle",value:function(){return this.title}},{key:"getPayload",value:function(){return this.payload}},{key:"getEndTime",value:function(){return this.endTime}},{key:"getContextID",value:function(){return this.contextId}},{key:"getTournamentType",value:function(){return this.tournamentType}},{key:"toObject",value:function(){return{id:this.id,title:this.title,payload:this.payload,endTime:this.endTime,contextId:this.contextId,tournamentType:this.tournamentType}}}]);return _TournamentInstance}();__name(k,"TournamentInstance");var C=k;var D=C;var T=["Unsupported","NetworkFailure","PendingRequest","ClientUnsupportedOperation"];var E=_to_consumable_array(T).concat(["InvalidParam","UserInput"]);var O=_to_consumable_array(T).concat(["InvalidOperation","UserInput"]);var G=_to_consumable_array(T).concat(["InvalidParam","UserInput"]);var N=_to_consumable_array(T).concat(["InvalidParam","UserInput"]);var L=_to_consumable_array(T).concat(["NetworkFailure"]);var B="TournamentsDataMockKey";var M="TournamentLeadersMockKey";var U=function(){function _Tournament(e){var t=this;_class_call_check(this,_Tournament);__publicField(this,"adapter");__publicField(this,"extra");__publicField(this,"context");__publicField(this,"shareAsyncPopup",null);__publicField(this,"createAsyncPopup",null);var n=this;__publicField(this,"processEnterTournament",__name(function(){var e=_async_to_generator(function(e){var t;return _ts_generator(this,function(r){switch(r.label){case 0:t=n.getTournamentData(e);if(!t)return[2];return[4,n.joinAsync(e)];case 1:r.sent();return[2]}})});return function(t){return e.apply(this,arguments)}}(),"processEnterTournament"));__publicField(this,"handleOnYes",__name(function(e){return function(){t.extra.isPopupShown=false;e(true)}},"handleOnYes"));__publicField(this,"handleOnNo",__name(function(e){return function(){t.extra.isPopupShown=false;try{t.extra.exceptionUserInput("Player closed the context menu")}catch(t){e(t)}}},"handleOnNo"));this.adapter=e;this.extra=e.extra;this.context=e.context}_create_class(_Tournament,[{key:"initTournamentInfoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:n=GameCore.Configs.Mockup.GameSDK,r=n.Tournament;if(!r.Enabled)return[2];return[4,t.createMockTournamentsData()];case 1:a.sent();if(!e)return[3,3];return[4,t.processEnterTournament(e)];case 2:a.sent();a.label=3;case 3:return[2]}})})()}},{key:"createMockTournamentsData",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i,s,u,c,l,_,d,f,y,p,h,m,v;return _ts_generator(this,function(g){switch(g.label){case 0:t=GameCore.Utils,n=t.Object;r=GameCore.Configs.Mockup.GameSDK,a=r.Tournament;o=a.NumOfTournament,i=o.Normal,s=o.HostPage;if(!a.Enabled)return[2];u=e.getTournamentsData();c=n.vals(u);l=e.filterExpiredTournaments(c);_=l.filter(function(e){return"DEFAULT"===e.tournamentType});d=l.filter(function(e){return"PAGE_HOSTED"===e.tournamentType});f=_.length;y=d.length;p=i-f;h=s-y;m=e.createDefaultTournaments(p);v=e.createGlobalTournaments(h);return[4,Promise.all(_to_consumable_array(m).concat(_to_consumable_array(v)))];case 1:g.sent();return[2]}})})()}},{key:"filterExpiredTournaments",value:function(e){var t=Date.now()/1e3;var n=e.filter(function(e){return e.endTime>t});var r={};var a=true,o=false,i=void 0;try{for(var s=n[Symbol.iterator](),u;!(a=(u=s.next()).done);a=true){var c=u.value;r[c.id]=c}}catch(e){o=true;i=e}finally{try{if(!a&&null!=s.return)s.return()}finally{if(o)throw i}}this.writeTournamentsData(r);return n}},{key:"createDefaultTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array;var a=window.game.leaderboard;var o=GameSDK.player.getID();var i=GameSDK.player.getName();var s=this;return r.length(e).map(_async_to_generator(function(){var e,t,r,u,c,l,_,d,f,y;return _ts_generator(this,function(p){switch(p.label){case 0:e="".concat(i,"'s Tournament ").concat(n.generateObjectId());t=GameCore.Configs.Mockup.GameSDK.Tournament,r=t.ExtraPlayerTournamentPayload,u=void 0===r?{}:r;return[4,a.createLeaderboardAsync({name:e})];case 1:c=p.sent();l=s.createMockTournamentAsync({initialScore:0,config:{title:e,tournamentTitle:e},data:_object_spread({playerId:o,playerName:i,leaderboardId:c},u)});_=l.getID().toString();if(s.getTournamentLeadersData(_))return[2];d=GameCore.Utils.Number.random(2);f=window.game.player.getConnectedPlayerIds(d,0);y=f.map(function(e){return{playerId:e,score:GameCore.Utils.Number.random(4)}});y.sort(function(e,t){return e.score-t.score});s.writeTournamentLeadersData(_,y);return[2]}})}))}},{key:"createGlobalTournaments",value:function(e){var t=GameCore.Utils,n=t.String,r=t.Array,a=t.Number;var o=window.game.leaderboard;var i=GameCore.Configs.Mockup.GameSDK.Tournament,s=i.ExtraGlobalTournamentPayload,u=void 0===s?{}:s;var c=this;return r.length(e).map(_async_to_generator(function(){var e,t,i,s,l,_,d;return _ts_generator(this,function(f){switch(f.label){case 0:e=n.generateObjectId();t=_object_spread({leaderboardId:e,playerId:"global"},u);i="Global Tournament ".concat(e);return[4,o.createLeaderboardAsync({name:i,_id:e,type:"world_tournament_leaderboard",description:JSON.stringify(t)})];case 1:f.sent();s=c.createMockTournamentAsync({initialScore:0,config:{title:i,tournamentTitle:i},data:t},true);l=s.getID().toString();if(c.getTournamentLeadersData(l))return[2];_=a.random(2);d=r.length(_).map(function(){return{playerId:n.generateObjectId(),score:a.random(4)}});d.sort(function(e,t){return e.score-t.score});c.writeTournamentLeadersData(l,d);return[2]}})}))}},{key:"awaitRandomDelay",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){t=GameCore.Configs.Mockup;n=t.GameSDK.Tournament.RandomDelayMs;return[2,e.extra.awaitRandomDelay(n)]})})()}},{key:"randomError",value:function(e){var t=GameCore.Configs.Mockup;var n=t.GameSDK.Tournament.ErrorRates;var r=100*Math.random()<n;if(!r)return;this.extra.randomException(e)}},{key:"loadCreateTournamentPopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.createAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.createAsyncPopup=new t;return[2]}})})()}},{key:"loadSharePopupAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shareAsyncPopup)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.shareAsyncPopup=new t;return[2]}})})()}},{key:"createAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t.extra.checkPopupShown();return[4,t.awaitRandomDelay()];case 1:a.sent();if(null!==t.context.getID())t.extra.exceptionInvalidOperation("Cannot create tournament while in a context");t.validateCreatePayload(e);t.randomError(E);return[4,t.loadCreateTournamentPopupAsync()];case 2:a.sent();return[4,new Promise(function(n,r){if(!t.createAsyncPopup)t.adapter.extra.exceptionUnsupported();t.createAsyncPopup.onYes(t.handleOnYes(n));t.createAsyncPopup.onNo(t.handleOnNo(r));t.createAsyncPopup.show(e);t.extra.isPopupShown=true})];case 3:a.sent();n=t.createMockTournamentAsync(e);r=n.getContextID();t.setCurrentContextID(r);return[2,n]}})})()}},{key:"createMockTournamentAsync",value:function(e,t){var n=arguments.length>1&&void 0!==t&&t;var r=GameCore.Utils.String.generateObjectId();var a=new D(r,e,n);var o=a.toObject();this.writeTournamentData(r,o);return a}},{key:"postScoreAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:return[4,t.awaitRandomDelay()];case 1:r.sent();t.validateAvailableTournament();if(e<0)t.extra.exceptionInvalidParam("Score must be a positive number");t.randomError(N);n=window.game.player.getPlayerId();t.updateBestScore(n,e);return[2]}})})()}},{key:"shareAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s,u;return _ts_generator(this,function(c){switch(c.label){case 0:t.extra.checkPopupShown();return[4,t.awaitRandomDelay()];case 1:c.sent();t.validateAvailableTournament();t.validateSharePayload(e);t.randomError(G);return[4,t.loadSharePopupAsync()];case 2:c.sent();n=e.score;r=n;a=t.getCurrentTournament();if(a){o=window.game.player.getPlayerId();i=a.getID().toString();s=t.getBestScore(i,o);if(s&&s<n)r=s}return[4,new Promise(function(e,n){if(!t.shareAsyncPopup)t.adapter.extra.exceptionUnsupported();t.shareAsyncPopup.onYes(t.handleOnYes(e));t.shareAsyncPopup.onNo(t.handleOnNo(n));t.shareAsyncPopup.show(r);t.extra.isPopupShown=true})];case 3:c.sent();u=window.game.player.getPlayerId();t.updateBestScore(u,n);return[2]}})})()}},{key:"getTournamentsAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:return[4,e.awaitRandomDelay()];case 1:i.sent();e.randomError(L);t=e.getTournamentsData();n=GameCore.Utils,r=n.Object;a=r.vals(t);o=a.map(function(t){return e.getTournamentInstance(t.id)});return[2,o.filter(function(e){return null!==e})]}})})()}},{key:"joinAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r;return _ts_generator(this,function(a){switch(a.label){case 0:return[4,t.awaitRandomDelay()];case 1:a.sent();if(!GameCore.Utils.Valid.isString(e))t.extra.exceptionInvalidParam("Tournament ID must be a string");n=t.getTournamentInstance(e);if(!n)t.extra.exceptionTournamentNotFound("Tournament could not be found.");t.randomError(O);r=n.getContextID();return[4,GameSDK.context.switchAsync(r)];case 2:a.sent();return[2]}})})()}},{key:"setCurrentContextID",value:function(e){if(_instanceof1(this.context,l))this.context.setCurrentContextId(e)}},{key:"getCurrentTournament",value:function(){var e=this.context.getID();if(!e)return null;var t=this.getTournamentsData();for(var n in t)if(Object.hasOwn(t,n)){var r=t[n];if(r.contextId===e)return this.getTournamentInstance(n)}return null}},{key:"validateCreatePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;if(!r.isObject(e))this.extra.exceptionInvalidParam("Payload must be an object");if(!n.hasOwn(e,"initialScore"))this.extra.exceptionInvalidParam("Payload must have initialScore");if(!n.hasOwn(e,"config"))this.extra.exceptionInvalidParam("Payload must have config");var a=e.initialScore,o=e.config;if(!r.isNumber(a))this.extra.exceptionInvalidParam("initialScore must be a number");if(!r.isObject(o))this.extra.exceptionInvalidParam("Config must be an object");if(!n.hasOwn(o,"title"))this.extra.exceptionInvalidParam("Config must have title");if(!n.hasOwn(o,"tournamentTitle"))this.extra.exceptionInvalidParam("Config must have tournamentTitle");if(n.hasOwn(e,"data")&&!r.isObject(e.data))this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateSharePayload",value:function(e){var t=GameCore.Utils,n=t.Object,r=t.Valid;if(!r.isObject(e))this.extra.exceptionInvalidParam("Payload must be an object");if(!n.hasOwn(e,"score"))this.extra.exceptionInvalidParam("Payload must have score");var a=e.score;if(!r.isNumber(a))this.extra.exceptionInvalidParam("Score must be a number");if(n.hasOwn(e,"data")&&!r.isObject(e.data))this.extra.exceptionInvalidParam("Data must be an object")}},{key:"validateAvailableTournament",value:function(){var e=this.getCurrentTournament();if(e)return;this.extra.exceptionTournamentNotFound("There is no tournament for this context.")}},{key:"getTournamentInstance",value:function(e){var t=this.getTournamentData(e);if(!t)return null;return{getID:__name(function(){return t.id},"getID"),getTitle:__name(function(){return t.title},"getTitle"),getPayload:__name(function(){return t.payload},"getPayload"),getEndTime:__name(function(){return t.endTime},"getEndTime"),getContextID:__name(function(){return t.contextId},"getContextID"),getTournamentType:__name(function(){return t.tournamentType},"getTournamentType")}}},{key:"getTournamentData",value:function(e){var t=this.getTournamentsData();if(!t[e])return null;return t[e]}},{key:"writeTournamentData",value:function(e,t){var n=this.getTournamentsData();n[e]=t;this.writeTournamentsData(n)}},{key:"getTournamentsData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Valid;var r=t.getLocalStorage(B);if(!n.isObject(r))return{};return r}},{key:"writeTournamentsData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Valid;if(!r.isObject(e))return;n.writeLocalStorage(B,e)}},{key:"getBestScore",value:function(e,t){var n=this.getTournamentLeader(e,t);if(!n)return null;var r;return null!==(r=n.score)&&void 0!==r?r:null}},{key:"updateBestScore",value:function(e,t){var n=this.getCurrentTournament();if(!n)return;var r=n.getID().toString();if(!r)return;var a=this.getTournamentLeader(r,e);if(!a){this.writeTournamentLeader(r,{playerId:e,score:t});return}if(a.score<t){a.score=t;this.writeTournamentLeader(r,a)}}},{key:"getTournamentLeader",value:function(e,t){var n=this.getTournamentLeadersData(e);if(!n.length)return null;var r=GameCore.Utils,a=r.Array;var o;return null!==(o=a.search(n,function(e){return e.playerId===t}))&&void 0!==o?o:null}},{key:"getTournamentLeadersData",value:function(e){var t=GameCore.Utils,n=t.Browser,r=t.Object;var a=n.getLocalStorage(M);if(!r.hasOwn(a,e))return[];var o=a[e];if(!Array.isArray(o))return[];o.sort(function(e,t){return t.score-e.score});return o}},{key:"writeTournamentLeader",value:function(e,t){var n=GameCore.Utils,r=n.Array;var a=this.getTournamentLeadersData(e);var o=r.searchIndex(a,function(e){return e.playerId===t.playerId});if(-1===o)a.push(t);else a[o]=t;this.writeTournamentLeadersData(e,a)}},{key:"writeTournamentLeadersData",value:function(e,t){var n=GameCore.Utils,r=n.Browser,a=n.Object;if(!Array.isArray(t))return;var o;var i=null!==(o=r.getLocalStorage(M))&&void 0!==o?o:{};a.assign(i,_define_property({},e,t));r.writeLocalStorage(M,i)}}]);return _Tournament}();__name(U,"Tournament");var F=U;var R=F;var j=function(){function _GameSDK(){_class_call_check(this,_GameSDK);__publicField(this,"extra");__publicField(this,"player");__publicField(this,"context");__publicField(this,"tournament");__publicField(this,"shortcut",null);__publicField(this,"isInitialized",false);__publicField(this,"bannerAdInstances",{});__publicField(this,"rewardedVideoInstance",null);__publicField(this,"interstitialAdInstance",null);__publicField(this,"rewardedInterstitialInstance",null)}_create_class(_GameSDK,[{key:"initialize",value:function(){this.extra=new I(this);this.player=new S(this);this.context=new l(this);this.tournament=new R(this)}},{key:"getLocale",value:function(){return GameCore.Utils.Browser.getLocale()}},{key:"getPlatform",value:function(){var e=GameCore.Utils,t=e.Device;if(t.isAndroid())return"ANDROID";if(t.isIOS())return"IOS";if(t.isDesktop())return"WEB";if(t.isMobile())return"MOBILE_WEB";return null}},{key:"getSDKName",value:function(){return"GameCore"}},{key:"getSDKVersion",value:function(){return"1.0.0"}},{key:"initializeAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(e.isInitialized)return[2];e.initialize();e.extra.createLoadingElement();return[4,e.extra.waitGameCoreReadyAsync()];case 1:i.sent();return[4,e.extra.delayInitialAsync()];case 2:i.sent();t=GameCore.Utils.Browser.getQueryParams();console.info("Browser params:",t);n=t.splashPreview;if(n){e.extra.destroyLoadingElement();return[2]}r=t.playerId;e.player.initPlayerInfo(r);a=t.context_source_id;o=t.context_type;e.context.initContextInfo(a,o);e.isInitialized=true;return[2]}})})()}},{key:"startGameAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:return[4,e.extra.delayStartAsync()];case 1:s.sent();t=90;window.__sdkLoadingCount=t;e.setLoadingProgress(t);e.extra.destroyLoadingElement();n=GameCore.Events,r=GameCore.Utils,a=r.Browser.getQueryParams;o=a();i=o.tournament_id;return[4,e.tournament.initTournamentInfoAsync(i)];case 2:s.sent();window.game.event.emit(n.GAME_SDK_STARTED);return[2]}})})()}},{key:"setLoadingProgress",value:function(e){this.extra.setLoadingElementProgress(e)}},{key:"getEntryPointData",value:function(){var e=GameCore.Utils,t=e.Browser,n=e.Json;var r=t.getQueryParams(),a=r.payload,o=void 0===a?"{}":a;if("string"!=typeof o)return{};return n.decode(o)}},{key:"getEntryPointAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,"no_entry"]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!e)return[2];if(!!t.bannerAdInstances[e])return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Banner ads mock is not enabled");t.bannerAdInstances[e]=new n("banner",e);r.label=2;case 2:return[4,t.bannerAdInstances[e].loadAsync()];case 3:r.sent();return[4,t.bannerAdInstances[e].showAsync()];case 4:r.sent();return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){return _ts_generator(this,function(n){switch(n.label){case 0:if(!t.bannerAdInstances[e])return[2];return[4,t.bannerAdInstances[e].hideAsync()];case 1:n.sent();return[2]}})})()}},{key:"getBannerHeight",value:function(e){return e.BannerHeight}},{key:"getInterstitialAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.interstitialAdInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Interstitial ads mock is not enabled");t.interstitialAdInstance=new n("interstitial",e);r.label=2;case 2:return[2,t.interstitialAdInstance]}})})()}},{key:"getRewardedVideoAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedVideoInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Rewarded video ads mock is not enabled");t.rewardedVideoInstance=new n("rewarded",e);r.label=2;case 2:return[2,t.rewardedVideoInstance]}})})()}},{key:"getRewardedInterstitialAsync",value:function(e){var t=this;return _async_to_generator(function(){var n;return _ts_generator(this,function(r){switch(r.label){case 0:if(!!t.rewardedInterstitialInstance)return[3,2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:n=r.sent().default;if("function"!=typeof n)t.extra.exceptionInvalidOperation("Rewarded interstitial ads mock is not enabled");t.rewardedInterstitialInstance=new n("rewarded_interstitial",e);r.label=2;case 2:return[2,t.rewardedInterstitialInstance]}})})()}},{key:"getTournamentAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n,r,a,o,i;return _ts_generator(this,function(s){switch(s.label){case 0:e.tournament.randomError(["Unsupported","NetworkFailure"]);t=e.context.getID();n=GameCore.Utils,r=n.Array,a=n.Valid;if(!a.isString(t))e.extra.exceptionInvalidOperation("Not in a context");return[4,e.tournament.getTournamentsAsync()];case 1:o=s.sent();i=r.search(o,function(e){return e.getContextID()===t});if(!i)e.extra.exceptionTournamentNotFound("A Tournament with current context was not found");return[2,i]}})})()}},{key:"getSupportedAPIs",value:function(){var e=GameCore.Configs.Mockup.GameSDK.Player.SubscribeBot.CanSubscribeBot;if(e)return["player.canSubscribeBotAsync"];return[]}},{key:"canCreateShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:t.sent();if(!e.shortcut)e.extra.exceptionUnsupported();return[2,e.shortcut.canCreateShortcutAsync()]}})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){switch(t.label){case 0:return[4,e.loadMockAddShortcut()];case 1:t.sent();if(!e.shortcut)e.extra.exceptionUnsupported();return[2,e.shortcut.createShortcutAsync()]}})})()}},{key:"loadMockAddShortcut",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:if(e.shortcut)return[2];return[4,Promise.resolve().then(function(){return s(),o})];case 1:t=n.sent().default;if("function"!=typeof t)return[2];e.shortcut=new t(e);return[2]}})})()}}]);return _GameSDK}();__name(j,"GameSDK");var K=j;var z=K;r();a();r();a();var V=function(){function _AdInstance(e,t){_class_call_check(this,_AdInstance);__publicField(this,"type");__publicField(this,"placementId");this.type=e;this.placementId=t}_create_class(_AdInstance,[{key:"getPlacementID",value:function(){return this.placementId}},{key:"hideAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,Promise.resolve()]})})()}}]);return _AdInstance}();__name(V,"AdInstance");var H=V;var W=H;var Y={instanceId:""};var q=function(e){_inherits(_MSAdInstance,e);var t=_create_super(_MSAdInstance);function _MSAdInstance(e,n){_class_call_check(this,_MSAdInstance);var r;r=t.call(this,e,"");__publicField(_assert_this_initialized(r),"sdk");__publicField(_assert_this_initialized(r),"type");__publicField(_assert_this_initialized(r),"response");r.sdk=n;r.type=e;r.response=Y;return r}_create_class(_MSAdInstance,[{key:"getPlacementID",value:function(){return this.response.instanceId}},{key:"loadAsync",value:function(){var e=this;return new Promise(function(t,n){var r="rewarded"===e.type;e.sdk.loadAdsAsync({isRewardedAd:r,canBackfill:true}).then(function(n){e.response=n;t()}).catch(function(r){if(e.isAdsAlreadyLoadedError(r)){t();return}n(r)})})}},{key:"isAdsAlreadyLoadedError",value:function(e){var t="";try{t=JSON.stringify(e)}catch(e){return false}var n=t.indexOf("LOAD_ADS_CLIENT_FAILURE")>-1;var r=t.indexOf("Ads already loaded.")>-1;return n&&r}},{key:"showAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,new Promise(function(t,n){if(!e.response.instanceId)n(new Error("Ad is not loaded. InstanceId is empty"));e.sdk.showAdsAsync(e.response.instanceId).then(function(r){if(!r.showAdsCompletedAsync){n(new Error("Ad is not loaded. showAdsCompletedAsync is empty"));return}r.showAdsCompletedAsync.then(function(){e.response=Y;t()}).catch(function(e){if(e.code&&"SHOW_ADS_COMPLETED_FAILURE"===e.code)e.code="USER_INPUT";n(e)})}).catch(function(e){n(e)})})]})})()}}]);return _MSAdInstance}(W);__name(q,"MSAdInstance");var Q=q;var J=Q;r();a();var $="Tile Connect Remaster".replace(/ /g,"-");var X=function(e){_inherits(_MSExtra,e);var t=_create_super(_MSExtra);function _MSExtra(e){_class_call_check(this,_MSExtra);var n;n=t.call(this,e);__publicField(_assert_this_initialized(n),"sdk");__publicField(_assert_this_initialized(n),"shareImageBase64");__publicField(_assert_this_initialized(n),"notificationImageBase64");n.sdk=e.sdk;n.adapter=e;return n}_create_class(_MSExtra,[{key:"shareAsync",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,4,,5]);if(!!e.shareImageBase64)return[3,2];return[4,e.loadImageAsync("./public/others/share.jpg")];case 1:t=r.sent();if(t)e.shareImageBase64=t;r.label=2;case 2:return[4,e.sdk.shareAsync({title:$,text:"Play now!",image:e.shareImageBase64})];case 3:r.sent();return[3,5];case 4:n=r.sent();console.warn("shareAsync",n);return[3,5];case 5:return[2]}})})()}},{key:"switchGameAsync",value:function(e,t){var n=GameCore.Utils.Valid.isObject;if(!n(t))return this.exceptionInvalidParam("Data must be an object, but got ".concat(void 0===t?"undefined":_type_of(t)));return this.sdk.switchGameAsync({id:e,payloadData:t})}},{key:"submitGameResultsAsync",value:function(e){return this.sdk.submitGameResultsAsync(e)}},{key:"scheduleNotificationAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(i){switch(i.label){case 0:if(!!t.notificationImageBase64)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,t.loadImageAsync("./assets/images/others/notification.jpg")];case 2:n=i.sent();if(n)t.notificationImageBase64=n;return[3,4];case 3:r=i.sent();console.warn("scheduleNotificationAsync > notificationImageBase64",r);return[3,4];case 4:a={title:$,description:"We miss you!",type:0,minDelayInSeconds:3.6,imageData:t.notificationImageBase64,callToAction:"Play now!"};a=_object_spread({},a,e);console.info("scheduleNotificationAsync");i.label=5;case 5:i.trys.push([5,7,,8]);return[4,t.sdk.scheduleNotificationAsync(a)];case 6:i.sent();return[3,8];case 7:o=i.sent();console.warn("scheduleNotificationAsync",o);return[3,8];case 8:return[2]}})})()}},{key:"isValidDisplayAdPlacement",value:function(e){var t=["top:728x90","bottom:728x90","left:300x250","right:300x250","topleft:300x250","topright:300x250","bottomleft:300x250","bottomright:300x250","top:320x50","right:320x50","bottom:320x50","left:320x50","left:300x600","right:300x600","top:970x250","bottom:970x250","left:160x600","right:160x600"];return t.indexOf(e)>-1}},{key:"getBannerOffset",value:function(){return 20}},{key:"loadImageAsync",value:function(e){return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:return[4,fetch(e).then(function(e){return e.blob()}).then(function(e){var t=GameCore.Utils.Image.blobToDataImage;return t(e)})];case 1:t=n.sent();if(t&&"string"==typeof t)return[2,Promise.resolve(t)];return[2,Promise.reject(new Error("Cannot load image"))]}})})()}}]);return _MSExtra}(I);__name(X,"MSExtra");var Z=X;var ee=Z;r();a();var et=function(e){_inherits(_MSPlayer,e);var t=_create_super(_MSPlayer);function _MSPlayer(e){_class_call_check(this,_MSPlayer);var n;n=t.call(this,e);__publicField(_assert_this_initialized(n),"_personalInfo");__publicField(_assert_this_initialized(n),"signature","");__publicField(_assert_this_initialized(n),"isLoginEnabled",false);n.updateLoginEnabledConfig();return n}_create_class(_MSPlayer,[{key:"updateLoginEnabledConfig",value:function(){var e=n;if(!e)return;var t=e.MSGames;if(!t)return;this.isLoginEnabled=t.UseLoginFeature}},{key:"initPlayerAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,8,,10]);return[4,e.tryGettingSignedInPlayer()];case 1:t=n.sent();if(!(e.isLoginEnabled&&!t))return[3,3];return[4,e.tryMakingPlayerSignedIn()];case 2:t=n.sent();n.label=3;case 3:if(!t)return[3,5];return[4,e.initLoggedMode(t)];case 4:n.sent();return[3,7];case 5:return[4,e.initGuestMode()];case 6:n.sent();n.label=7;case 7:return[3,10];case 8:n.sent();return[4,e.initGuestMode()];case 9:n.sent();return[3,10];case 10:return[2]}})})()}},{key:"updateCurrentPlayerInfo",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o;return _ts_generator(this,function(i){n=GameCore.Utils,r=n.Valid,a=n.Number;o=t.getID();if(!r.isString(o)||!r.isString(e)){o="".concat(a.random(1e5));t.currentPlayerInfo.playerId=o;t.currentPlayerInfo.playerName="Guest_".concat(o)}return[2]})})()}},{key:"initLoggedMode",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a;return _ts_generator(this,function(o){n=e.playerId,r=e.signature,a=e.playerDisplayName;t.currentPlayerInfo.playerId=n;t.currentPlayerInfo.playerName=a;t.signature="".concat(n," ").concat(r);t._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:a,uniqueID:n,scopePermissions:{avatar:"forbid",public_name:"forbid"}};t.initPlayerInfo(n);return[2]})})()}},{key:"initGuestMode",value:function(){var e=this;return _async_to_generator(function(){var t,n;return _ts_generator(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,e.getRandomName()];case 1:t=r.sent();n=t.replace(/ /g,"-");if(n===e.getID())return[2];e.currentPlayerInfo.playerId=n;e.currentPlayerInfo.playerName=t;e._personalInfo={id:n,avatarIdHash:"0",lang:"en",publicName:t,uniqueID:n,scopePermissions:{avatar:"forbid",public_name:"forbid"}};e.initPlayerInfo(n);return[3,3];case 2:r.sent();return[3,3];case 3:return[2]}})})()}},{key:"getRandomName",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,GameCore.Utils.String.generateNameAsync()]})})()}},{key:"tryGettingSignedInPlayer",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t=null;n=e.adapter.sdk;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,n.getSignedInUserAsync()];case 2:t=a.sent();return[3,4];case 3:r=a.sent();console.warn("tryGettingSignedInPlayer",r);return[3,4];case 4:return[2,Promise.resolve(t)]}})})()}},{key:"tryMakingPlayerSignedIn",value:function(){var e=this;return _async_to_generator(function(){var t,n,r;return _ts_generator(this,function(a){switch(a.label){case 0:t=null;n=e.adapter.sdk;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,n.signInAsync()];case 2:t=a.sent();return[3,4];case 3:r=a.sent();console.warn("tryMakingPlayerSignedIn",r);return[3,4];case 4:return[2,Promise.resolve(t)]}})})()}},{key:"getASIDAsync",value:function(){var e;return Promise.resolve(null!==(e=this.getID())&&void 0!==e?e:"")}},{key:"getSignedASIDAsync",value:function(){var e=this;return Promise.resolve({getASID:__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:""},"getASID"),getSignature:__name(function(){return e.signature},"getSignature")})}},{key:"getSignedPlayerInfoAsync",value:function(){var e=this;return Promise.resolve({getPlayerID:__name(function(){var t;return null!==(t=e.getID())&&void 0!==t?t:"10"},"getPlayerID"),getSignature:__name(function(){return e.signature},"getSignature")})}},{key:"canSubscribeBotAsync",value:function(){return Promise.resolve(false)}},{key:"subscribeBotAsync",value:function(){this.adapter.extra.exceptionUnsupported()}},{key:"getConnectedPlayersAsync",value:function(){this.adapter.extra.exceptionUnsupported()}}]);return _MSPlayer}(S);__name(et,"MSPlayer");var en=et;var er=en;var ea=function(e){_inherits(_MSAdapter,e);var t=_create_super(_MSAdapter);function _MSAdapter(e){_class_call_check(this,_MSAdapter);var n;n=t.call(this);__publicField(_assert_this_initialized(n),"sdk");__publicField(_assert_this_initialized(n),"showBannerAdsAsync");__publicField(_assert_this_initialized(n),"adPlacementList",new Set);n.sdk=e;return n}_create_class(_MSAdapter,[{key:"initialize",value:function(){_get(_get_prototype_of(_MSAdapter.prototype),"initialize",this).call(this);this.extra=new ee(this);this.player=new er(this);this.rewardedVideoInstance=new J("rewarded",this.sdk);this.interstitialAdInstance=new J("interstitial",this.sdk)}},{key:"initializeAsync",value:function(){var e=this;var t=this,_superprop_get_initializeAsync=function(){return _get(_get_prototype_of(_MSAdapter.prototype),"initializeAsync",e)};return _async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:if(t.isInitialized)return[2];return[4,_superprop_get_initializeAsync().call(t)];case 1:e.sent();t.isInitialized=false;e.label=2;case 2:e.trys.push([2,4,,5]);return[4,t.player.initPlayerAsync()];case 3:e.sent();t.isInitialized=true;return[3,5];case 4:e.sent();console.warn("Microsoft Games SDK not initialized, running without platform sdk");return[3,5];case 5:t.initShowBannerAdsAsync();return[2]}})})()}},{key:"getLocale",value:function(){return this.sdk.getLocale()}},{key:"getSDKVersion",value:function(){return"v1.0.0-rc.13"}},{key:"getSDKName",value:function(){return"MsGames"}},{key:"canCreateShortcutAsync",value:function(){return _async_to_generator(function(){return _ts_generator(this,function(e){return[2,true]})})()}},{key:"createShortcutAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,e.sdk.promptInstallAsync()];case 1:n.sent();return[3,3];case 2:t=n.sent();console.warn("createShortcutAsync",t);return[3,3];case 3:return[2]}})})()}},{key:"getInterstitialAdAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.interstitialAdInstance]})})()}},{key:"getRewardedVideoAsync",value:function(){var e=this;return _async_to_generator(function(){return _ts_generator(this,function(t){return[2,e.rewardedVideoInstance]})})()}},{key:"loadBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var n,r,a,o,i,s,u,c;return _ts_generator(this,function(l){switch(l.label){case 0:n=GameCore.Utils,r=n.Array;a=GameCore.Configs.Ads.BannerDisplayAdOptions;o=r.search(a,function(t){return t.PlacementId===e});if(!o)return[2];i=o.Position,s=o.BannerWidth,u=o.BannerHeight;c="".concat(i,":").concat(s,"x").concat(u);if(t.extra.isValidDisplayAdPlacement(c))t.adPlacementList.add(c);return[4,t.showBannerAdsAsync()];case 1:l.sent();return[2]}})})()}},{key:"hideBannerAdAsync",value:function(e){var t=this;return _async_to_generator(function(){var e;return _ts_generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,t.sdk.hideDisplayAdsAsync()];case 1:n.sent();return[3,3];case 2:e=n.sent();console.warn("\uD83D\uDE80 > hideBannerAdAsync",e);return[3,3];case 3:return[2]}})})()}},{key:"getEntryPointAsync",value:function(){var e=this;return _async_to_generator(function(){var t;return _ts_generator(this,function(n){t=e.sdk.getEntryPointInfo();return[2,t.entryPointId]})})()}},{key:"initShowBannerAdsAsync",value:function(){var e=GameCore.Utils,t=e.Function;var n=this;this.showBannerAdsAsync=t.debounce(_async_to_generator(function(){var e;return _ts_generator(this,function(t){switch(t.label){case 0:if(0!==n.adPlacementList.size)return[3,1];n.extra.exceptionInvalidOperation("Invalid banner ad placement");return[3,4];case 1:t.trys.push([1,3,,4]);e=_to_consumable_array(n.adPlacementList);return[4,n.sdk.showDisplayAdsAsync(e)];case 2:t.sent();return[3,4];case 3:t.sent();return[3,4];case 4:n.adPlacementList.clear();return[2]}})}),100)}}]);return _MSAdapter}(z);__name(ea,"MSAdapter");var eo=ea;var ei=eo;s();r();a();var es=[];__name(function(e){try{var t=new Error;if(null==t.stack)throw new Error;var n=t.stack.match(/\n/g)||[];var r=n.length;var a=r>=4?n[3]:n[0];if(!a)return e;if(es.indexOf(a)>-1)return e;console.warn("Access:",a);if(["eval","at <","(<"].some(function(e){return a.indexOf(e)>-1}))throw new Error;es.push(a);return e}catch(e){console.warn("Block access:",e);return}},"blockAccess");var eu=__name(function(e,t){},"wrapGetterToBlockObjectAccess");var ec=eu;console.groupCollapsed(" Corecos initialized");function autoDetectAndInitializeSDKAdapter(){var e;var t=window;var n="GameSDK";if("FBInstant"in t){n="FBInstant";e=new i(window.FBInstant)}else if("YaGames"in t){n="Yandex";e=new i(window.YaGames)}else if("$msstart"in t){n="MsGames";e=new ei(window.$msstart)}else if("gdsdk"in t){n="GameDistribution";e=new i(window.gdsdk)}else if("CrazyGames"in t){n="CrazyGames";e=new i(window.CrazyGames.SDK)}else if("GlanceGamingAdInterface"in t){n="Glance";e=new i(window.GlanceGamingAdInterface)}else e=new z;console.info("GameSDK loaded (".concat(n,")"));return e}__name(autoDetectAndInitializeSDKAdapter,"autoDetectAndInitializeSDKAdapter");console.groupCollapsed("\uD83D\uDD79 GameSDK");window.GameSDK=Object.seal(autoDetectAndInitializeSDKAdapter());ec(window,"GameSDK")})();(function(){"use strict";var e=Object.defineProperty;var __name=function(t,n){return e(t,"name",{value:n,configurable:true})};var t={TAG_IDS:"null",BUILD_VERSION:"96"};var n=t;var r=0;var a=__name(function(){var e=setInterval(function(){if(window.__sdkLoadingCount>=99){clearInterval(e);return}if(r===window.__sdkLoadingCount)return;r=window.__sdkLoadingCount;GameSDK.setLoadingProgress(window.__sdkLoadingCount)},300)},"stepProgressLoading");var o=__name(_async_to_generator(function(){return _ts_generator(this,function(e){switch(e.label){case 0:console.info("GameSDK initializing...");console.groupEnd();return[4,GameSDK.initializeAsync()];case 1:e.sent();window.__sdkLoadingCount=1;GameSDK.setLoadingProgress(window.__sdkLoadingCount);a();return[3,2];case 2:return[4,s()];case 3:e.sent();e.label=4;case 4:console.groupEnd();console.info("GameSDK initialized");window.__sdkInitiated=true;return[2]}})}),"initGameSDK");var i={};var s=__name(_async_to_generator(function(){var e,t,r,a,o,i,s;return _ts_generator(this,function(_){switch(_.label){case 0:_.trys.push([0,2,,3]);e=n.TAG_IDS;t=e.split(" ");if(0===t.length)return[2];if(!t[0]||"null"===t[0])return[2];return[4,GameSDK.getEntryPointAsync()];case 1:a=null!==(r=_.sent())&&void 0!==r?r:"no_entry";o=document.createElement("script");o.async=true;o.src="https://www.googletagmanager.com/gtag/js?id=".concat(t[0]);document.head.appendChild(o);i=GameSDK.player.getID();c(i,a,t);l(i);return[3,3];case 2:s=_.sent();u(s);return[3,3];case 3:return[2]}})}),"processGoogleAnalytics");var u=__name(function(e){if(!_instanceof1(e,Error))return;if(!window.game||!window.game.monitorError){window.__errorQueue.push(e);return}window.game.monitorError.sendException(e)},"logError");var c=__name(function(e,t,r){try{window.focus();var a=n.BUILD_VERSION;var o=GameSDK.getEntryPointData()||{},s=o.fbig_ad_id,c=o.fbig_adset_id,l=o.fbig_campaign_id;window.gtag("set","client_id","100.".concat(e));window.gtag("set","user_id",e);window.gtag("set","send_page_view",false);window.gtag("js",new Date);r.forEach(function(e){window.gtag("config",e,{cookie_flags:"SameSite=None;Secure",build:a,medium:t,campaign:l,groups:"GA"})});var _=GameCore.Utils.Browser.getQueryParams();var d=_.entry_point||t;i.user_id=e;i.player_id=e;i.app_version=a;i.traffic_source=t;i.traffic_source_detail=d;i.ad_id=s;i.adset_id=c;i.campaign_id=l;window.gtag("set","user_properties",i)}catch(e){u(e)}finally{window.gtag("event","app_launch",{})}},"initGoogleAnalytics");var l=__name(function(){var e=GameSDK.player.getID();if(!e)return;var t=__name(function(){try{var e=window.game.player;var t=e.getBestScore();var n=e.getPlayerDataByKey("coins");var r=e.isFirstLogin();i.new_user=r;i.coins=n;i.score=t;var a=GameSDK.getEntryPointData();var o=a||{},s=o.content,c=o.notif_id;if(s||c)i.traffic_source_detail=null!=s?s:"notif_".concat(c);window.gtag("set","user_properties",i)}catch(e){u(e)}},"processUserProperties");var n=window.game.event.getEventEmitCount("player-info-loaded")>0;if(n){t();return}window.game.event.once("player-info-loaded",t)},"updateUserPropertiesWhenPlayerInfoLoaded");o()})();